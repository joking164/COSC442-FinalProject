<?xml version="1.0" encoding="UTF-8"?>
<xmi:XMI xmi:version="20131001" xmlns:xmi="http://www.omg.org/spec/XMI/20131001" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:Persistency="http:///schemas/Persistency/NS/0" xmlns:UMLLabProfile="http:///schemas/UMLLabProfile/NS/0" xmlns:ecore="http://www.eclipse.org/emf/2002/Ecore" xmlns:uml="http://www.eclipse.org/uml2/5.0.0/UML" xsi:schemaLocation="http:///schemas/Persistency/NS/0 pathmap://PERSISTENCY_PROFILES/Persistency.profile.uml#Persistency_2-Annotation-Persistency http:///schemas/UMLLabProfile/NS/0 pathmap://UMLLAB_PROFILES/UMLLab.profile.uml#UMLLabProfile-Annotation_2-UMLLabProfile">
  <uml:Model xmi:id="_WLi24FJNEeiyW7NaN4qWdw" name="networking">
    <eAnnotations xmi:id="_WgSX0FJNEeiyW7NaN4qWdw" source="http://ns.yatta.de/umllab">
      <contents xmi:type="ecore:EAnnotation" xmi:id="_WgSX0VJNEeiyW7NaN4qWdw" source="codegen">
        <details xmi:id="_WgSX0lJNEeiyW7NaN4qWdw" key="codegenDirectory" value="/COSC442-FinalProject/src"/>
        <details xmi:id="_bOAEIFJNEeiyW7NaN4qWdw" key="AssociatedSourceCode" value="/COSC442-FinalProject/src/net/sf/freecol/common/networking/AbandonColonyMessage.java;3360306784/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/AskSkillMessage.java;1143914215/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/AssignTeacherMessage.java;2327288732/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/AssignTradeRouteMessage.java;214314664/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/AttackMessage.java;1764183603/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/BuildColonyMessage.java;2212713494/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/BuyMessage.java;1965704034/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/BuyPropositionMessage.java;3725501298/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/CashInTreasureTrainMessage.java;2585024104/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/ChangeStateMessage.java;3346124902/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/ChangeWorkImprovementTypeMessage.java;2304350878/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/ChangeWorkTypeMessage.java;464523932/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/ChatMessage.java;3075149930/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/ChooseFoundingFatherMessage.java;1296496619/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/ClaimLandMessage.java;1317830222/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/ClearSpecialityMessage.java;247504640/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/Client.java;235422402/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/CloseTransactionMessage.java;1807054801/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/Connection.java;1605119991/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/CurrentPlayerNetworkRequestHandler.java;2748422724/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/DOMMessage.java;1987422423/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/DeclareIndependenceMessage.java;3521501666/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/DeclineMoundsMessage.java;4197108223/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/DeliverGiftMessage.java;3791872633/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/DemandTributeMessage.java;181467407/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/DiplomacyMessage.java;3988410619/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/DisbandUnitMessage.java;3039087049/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/DisembarkMessage.java;3570246869/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/EmbarkMessage.java;2437011570/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/EmigrateUnitMessage.java;3894664052/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/EquipForRoleMessage.java;697802950/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/FirstContactMessage.java;3747261836/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/GetNationSummaryMessage.java;3646201909/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/GetTransactionMessage.java;791379071/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/GoodsForSaleMessage.java;816516184/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/InciteMessage.java;238897503/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/IndianDemandMessage.java;160228968/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/JoinColonyMessage.java;1000788133/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/LearnSkillMessage.java;1027487632/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/LoadGoodsMessage.java;1476936114/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/LoginMessage.java;4149467116/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/LootCargoMessage.java;3799757333/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/Message.java;563641439/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/MessageHandler.java;1162832066/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/MissionaryMessage.java;2966646175/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/MonarchActionMessage.java;3835123972/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/MoveMessage.java;1482162664/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/MoveToMessage.java;1567890793/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/NetworkConstants.java;3377552165/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/NetworkReplyObject.java;917332481/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/NetworkRequestHandler.java;1702432459/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/NewLandNameMessage.java;1419843317/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/NewRegionNameMessage.java;689738616/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/PayArrearsMessage.java;1118066232/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/PayForBuildingMessage.java;3177749649/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/PutOutsideColonyMessage.java;3355544347/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/RearrangeColonyMessage.java;4121920557/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/ReceivingThread.java;1559132105/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/RenameMessage.java;3093105450/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/ScoutIndianSettlementMessage.java;895900012/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/ScoutSpeakToChiefMessage.java;4129642618/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/SellMessage.java;3756033726/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/SellPropositionMessage.java;2542573218/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/WorkMessage.java;3140068964/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/SetBuildQueueMessage.java;1638472565/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/SetCurrentStopMessage.java;69694871/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/SetDestinationMessage.java;1495797329/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/SetGoodsLevelsMessage.java;4045095302/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/SetTradeRoutesMessage.java;1808247032/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/SpySettlementMessage.java;704545851/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/TrainUnitInEuropeMessage.java;1247884923/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/TrivialMessage.java;1259942226/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/UnloadGoodsMessage.java;3984261452/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/UpdateTradeRouteMessage.java;3463655380/1;/COSC442-FinalProject/src/net/sf/freecol/common/networking/ServerAPI.java;3292245899/1;"/>
      </contents>
    </eAnnotations>
    <elementImport xmi:id="_Y5fD0FJNEeiyW7NaN4qWdw">
      <importedElement xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
    </elementImport>
    <elementImport xmi:id="_Y5fD0VJNEeiyW7NaN4qWdw">
      <importedElement xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#byte"/>
    </elementImport>
    <elementImport xmi:id="_Y5fD0lJNEeiyW7NaN4qWdw">
      <importedElement xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#char"/>
    </elementImport>
    <elementImport xmi:id="_Y5fD01JNEeiyW7NaN4qWdw">
      <importedElement xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#double"/>
    </elementImport>
    <elementImport xmi:id="_Y5fD1FJNEeiyW7NaN4qWdw">
      <importedElement xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#float"/>
    </elementImport>
    <elementImport xmi:id="_Y5fq4FJNEeiyW7NaN4qWdw">
      <importedElement xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
    </elementImport>
    <elementImport xmi:id="_Y5fq4VJNEeiyW7NaN4qWdw">
      <importedElement xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#long"/>
    </elementImport>
    <elementImport xmi:id="_Y5fq4lJNEeiyW7NaN4qWdw">
      <importedElement xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#short"/>
    </elementImport>
    <elementImport xmi:id="_Y5fq41JNEeiyW7NaN4qWdw">
      <importedElement xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
    </elementImport>
    <packagedElement xmi:type="uml:Package" xmi:id="_YsslAFJNEeiyW7NaN4qWdw" name="net">
      <packagedElement xmi:type="uml:Package" xmi:id="_YsslAVJNEeiyW7NaN4qWdw" name="sf">
        <packagedElement xmi:type="uml:Package" xmi:id="_YstMEFJNEeiyW7NaN4qWdw" name="freecol">
          <packagedElement xmi:type="uml:Package" xmi:id="_YstMEVJNEeiyW7NaN4qWdw" name="common">
            <packagedElement xmi:type="uml:Package" xmi:id="_YstzIFJNEeiyW7NaN4qWdw" name="model">
              <packagedElement xmi:type="uml:Package" xmi:id="_Ys0g0FJNEeiyW7NaN4qWdw" name="Unit">
                <packagedElement xmi:type="uml:Enumeration" xmi:id="_aG55MVJNEeiyW7NaN4qWdw" name="MoveType"/>
                <packagedElement xmi:type="uml:Enumeration" xmi:id="_aHUI4FJNEeiyW7NaN4qWdw" name="UnitState"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Package" xmi:id="_Yt5e4lJNEeiyW7NaN4qWdw" name="FoundingFather">
                <packagedElement xmi:type="uml:Enumeration" xmi:id="_aHquMVJNEeiyW7NaN4qWdw" name="FoundingFatherType"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Package" xmi:id="_Yt_lgFJNEeiyW7NaN4qWdw" name="Player">
                <packagedElement xmi:type="uml:Enumeration" xmi:id="_aH4JkVJNEeiyW7NaN4qWdw" name="NoClaimReason"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Package" xmi:id="_YvezQFJNEeiyW7NaN4qWdw" name="Europe">
                <packagedElement xmi:type="uml:Enumeration" xmi:id="_aJSe0VJNEeiyW7NaN4qWdw" name="MigrationType"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Package" xmi:id="_YxJAIFJNEeiyW7NaN4qWdw" name="Monarch">
                <packagedElement xmi:type="uml:Enumeration" xmi:id="_aKA3kFJNEeiyW7NaN4qWdw" name="MonarchAction"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Package" xmi:id="_YzphkFJNEeiyW7NaN4qWdw" name="NationOptions">
                <packagedElement xmi:type="uml:Enumeration" xmi:id="_aLNKYVJNEeiyW7NaN4qWdw" name="NationState"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_aGwvQFJNEeiyW7NaN4qWdw" name="Colony"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_aGx9YFJNEeiyW7NaN4qWdw" name="Game"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_aGykcVJNEeiyW7NaN4qWdw" name="Player"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_aG3c8FJNEeiyW7NaN4qWdw" name="IndianSettlement"/>
              <packagedElement xmi:type="uml:Enumeration" xmi:id="_aG4EAFJNEeiyW7NaN4qWdw" name="Direction"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_aG4rEVJNEeiyW7NaN4qWdw" name="Tile"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_aG5SIVJNEeiyW7NaN4qWdw" name="Unit"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_aG-xsFJNEeiyW7NaN4qWdw" name="TradeRoute"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_aHJw0FJNEeiyW7NaN4qWdw" name="Goods"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_aHKX4VJNEeiyW7NaN4qWdw" name="Settlement"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_aHXMMFJNEeiyW7NaN4qWdw" name="Ability"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_aHXzQVJNEeiyW7NaN4qWdw" name="TileImprovement"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_aHYaUVJNEeiyW7NaN4qWdw" name="TileImprovementType"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_aHcEsFJNEeiyW7NaN4qWdw" name="GoodsType"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_aHqHIFJNEeiyW7NaN4qWdw" name="FoundingFather"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_aHr8UVJNEeiyW7NaN4qWdw" name="Specification"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_aH3igFJNEeiyW7NaN4qWdw" name="FreeColGameObject"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_aI1y4FJNEeiyW7NaN4qWdw" name="StringTemplate"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_aI6EUFJNEeiyW7NaN4qWdw" name="LostCityRumour"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_aJCnMFJNEeiyW7NaN4qWdw" name="DiplomaticTrade"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_aJDOQVJNEeiyW7NaN4qWdw" name="FreeColObject"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_aJO0cFJNEeiyW7NaN4qWdw" name="Location"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_aJR3wFJNEeiyW7NaN4qWdw" name="Europe"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_aJU7EFJNEeiyW7NaN4qWdw" name="Role"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_aJbBsFJNEeiyW7NaN4qWdw" name="NationSummary"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_aKLPoFJNEeiyW7NaN4qWdw" name="Region"/>
              <packagedElement xmi:type="uml:Interface" xmi:id="_aKgm0FJNEeiyW7NaN4qWdw" name="Nameable"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_aKupQFJNEeiyW7NaN4qWdw" name="WorkLocation"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_aKyToFJNEeiyW7NaN4qWdw" name="BuildableType"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_aK6PcFJNEeiyW7NaN4qWdw" name="ExportData"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_aLBkMFJNEeiyW7NaN4qWdw" name="UnitType"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_aLKuIVJNEeiyW7NaN4qWdw" name="AbstractUnit"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_aLL8QFJNEeiyW7NaN4qWdw" name="HighScore"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_aLMjUFJNEeiyW7NaN4qWdw" name="Nation"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_aLNxcVJNEeiyW7NaN4qWdw" name="NationType"/>
            </packagedElement>
            <packagedElement xmi:type="uml:Package" xmi:id="_YsyEkFJNEeiyW7NaN4qWdw" name="networking">
              <packagedElement xmi:type="uml:Class" xmi:id="_Y5cnkFJNEeiyW7NaN4qWdw" name="AbandonColonyMessage">
                <ownedComment xmi:id="_aWt20FJNEeiyW7NaN4qWdw">
                  <body>The message sent when the client requests abandoning of a colony.</body>
                </ownedComment>
                <generalization xmi:id="_aG1nwFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aRmtUFJNEeiyW7NaN4qWdw" name="colonyId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUiskFJNEeiyW7NaN4qWdw" name="AbandonColonyMessage" specification="_aMfj0FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUiskVJNEeiyW7NaN4qWdw" name="colony" type="_aGwvQFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUisklJNEeiyW7NaN4qWdw" type="_Y5cnkFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.colonyId = colony.getId();&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUjToFJNEeiyW7NaN4qWdw" name="AbandonColonyMessage" specification="_aMgK41JNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUjToVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUjTolJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUjTo1JNEeiyW7NaN4qWdw" type="_Y5cnkFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.colonyId = element.getAttribute(&quot;colony&quot;);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUjTpFJNEeiyW7NaN4qWdw" name="handle" specification="_aMhZAFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUjTpVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUjTplJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUjTp1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUjTqFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
&#xD;
     Colony colony;&#xD;
     try {&#xD;
         colony = player.getOurFreeColGameObject(colonyId, Colony.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
     if (colony.getUnitCount() != 0) {&#xD;
         return DOMMessage.clientError(&quot;Attempt to abandon colony &quot;&#xD;
             + colonyId + &quot; with non-zero unit count &quot;&#xD;
             + Integer.toString(colony.getUnitCount()));&#xD;
     }&#xD;
&#xD;
     // Proceed to abandon&#xD;
     // FIXME: Player.settlements is still being fixed on the client side.&#xD;
     return server.getInGameController()&#xD;
         .abandonSettlement(serverPlayer, colony);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUj6sFJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_Y5iHIFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUj6sVJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return createMessage(getXMLElementTagName(),&#xD;
         &quot;colony&quot;, colonyId);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUj6slJNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_Y5j8UlJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUj6s1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;abandonColony&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_Y5iHIFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aUj6sFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aMiAEFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y5j8UlJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aUj6slJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aWud41JNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;abandonColony&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y5kjYFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aMfj0FJNEeiyW7NaN4qWdw" name="AbandonColonyMessage" method="_aUiskFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aMgK4FJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aMgK4VJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aWud4FJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>AbandonColonyMessage&lt;/code> with the specified&#xD;
     * colony.&#xD;
     *&#xD;
     * @param colony The &lt;code>Colony&lt;/code> to abandon.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aMfj0VJNEeiyW7NaN4qWdw" name="colony" type="_aGwvQFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aMgK4lJNEeiyW7NaN4qWdw" type="_Y5cnkFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aMgK41JNEeiyW7NaN4qWdw" name="AbandonColonyMessage" method="_aUjToFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aMgx8lJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aMgx81JNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aWud4VJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>AbandonColonyMessage&lt;/code> from a supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aMgx8FJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aMgx8VJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aMgx9FJNEeiyW7NaN4qWdw" type="_Y5cnkFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aMhZAFJNEeiyW7NaN4qWdw" name="handle" method="_aUjTpFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aWud4lJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;abandonColony&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the request.&#xD;
     * @param player The &lt;code>Player&lt;/code> abandoning the colony.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> the message is from.&#xD;
     * @return An update &lt;code>Element&lt;/code> defining the new colony&#xD;
     *     and updating its surrounding tiles, or an error&#xD;
     *     &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aMhZAVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aMhZAlJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aMhZA1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aMhZBFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_Y5nmsFJNEeiyW7NaN4qWdw" name="AskSkillMessage">
                <ownedComment xmi:id="_aWud5FJNEeiyW7NaN4qWdw">
                  <body>The message sent when asking for the skill taught at a settlement.</body>
                </ownedComment>
                <generalization xmi:id="_aG7HUFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aRoigFJNEeiyW7NaN4qWdw" name="unitId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aRpJkFJNEeiyW7NaN4qWdw" name="directionString" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUj6tFJNEeiyW7NaN4qWdw" name="AskSkillMessage" specification="_aMinIFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUj6tVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUj6tlJNEeiyW7NaN4qWdw" name="direction" type="_aG4EAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUj6t1JNEeiyW7NaN4qWdw" type="_Y5nmsFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = unit.getId();&#xD;
     this.directionString = String.valueOf(direction);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUj6uFJNEeiyW7NaN4qWdw" name="AskSkillMessage" specification="_aMjOMFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUj6uVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUj6ulJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUj6u1JNEeiyW7NaN4qWdw" type="_Y5nmsFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = element.getAttribute(&quot;unitId&quot;);&#xD;
     this.directionString = element.getAttribute(&quot;direction&quot;);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUkhwFJNEeiyW7NaN4qWdw" name="handle" specification="_aMj1QFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUkhwVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUkhwlJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUkhw1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUkhxFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
&#xD;
     Unit unit;&#xD;
     try {&#xD;
         unit = serverPlayer.getOurFreeColGameObject(unitId, Unit.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     Tile tile;&#xD;
     try {&#xD;
         tile = unit.getNeighbourTile(directionString);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     IndianSettlement is = tile.getIndianSettlement();&#xD;
     if (is == null) {&#xD;
         return DOMMessage.clientError(&quot;There is no native settlement at: &quot;&#xD;
             + tile.getId());&#xD;
     }&#xD;
&#xD;
     MoveType type = unit.getMoveType(is.getTile());&#xD;
     if (type != MoveType.ENTER_INDIAN_SETTLEMENT_WITH_FREE_COLONIST) {&#xD;
         return DOMMessage.clientError(&quot;Unable to enter &quot; + is.getName()&#xD;
             + &quot;: &quot; + type.whyIllegal());&#xD;
     }&#xD;
&#xD;
     // Update the skill&#xD;
     return server.getInGameController()&#xD;
         .askLearnSkill(serverPlayer, unit, is);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUkhxVJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_Y5qqAFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUkhxlJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return createMessage(getXMLElementTagName(),&#xD;
         &quot;unitId&quot;, unitId,&#xD;
         &quot;direction&quot;, directionString);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUkhx1JNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_Y5r4IlJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUkhyFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;askSkill&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_Y5qqAFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aUkhxVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aMlDYFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y5r4IlJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aUkhx1JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aWvE8lJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;askSkill&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y5sfMFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aMinIFJNEeiyW7NaN4qWdw" name="AskSkillMessage" method="_aUj6tFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aMinI1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aMinJFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aWud5VJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>AskSkillMessage&lt;/code> with the&#xD;
     * supplied unit and direction.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is asking.&#xD;
     * @param direction The &lt;code>Direction&lt;/code> the unit is looking.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aMinIVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aMinIlJNEeiyW7NaN4qWdw" name="direction" type="_aG4EAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aMinJVJNEeiyW7NaN4qWdw" type="_Y5nmsFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aMjOMFJNEeiyW7NaN4qWdw" name="AskSkillMessage" method="_aUj6uFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aMjOM1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aMjONFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aWvE8FJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>AskSkillMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aMjOMVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aMjOMlJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aMjONVJNEeiyW7NaN4qWdw" type="_Y5nmsFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aMj1QFJNEeiyW7NaN4qWdw" name="handle" method="_aUkhwFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aWvE8VJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;askSkill&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param player The &lt;code>Player&lt;/code> the message applies to.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     *&#xD;
     * @return An &lt;code>Element&lt;/code> to update the originating player&#xD;
     *         with the result of the query.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aMkcUFJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aMkcUVJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aMkcUlJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aMkcU1JNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_Y5vigFJNEeiyW7NaN4qWdw" name="AssignTeacherMessage">
                <ownedComment xmi:id="_aWvsAFJNEeiyW7NaN4qWdw">
                  <body>The message sent when assigning a teacher.</body>
                </ownedComment>
                <generalization xmi:id="_aG88gFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aRpwoFJNEeiyW7NaN4qWdw" name="studentId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aRqXsFJNEeiyW7NaN4qWdw" name="teacherId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUlI0FJNEeiyW7NaN4qWdw" name="AssignTeacherMessage" specification="_aMlqcFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUlI0VJNEeiyW7NaN4qWdw" name="student" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUlI0lJNEeiyW7NaN4qWdw" name="teacher" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUlI01JNEeiyW7NaN4qWdw" type="_Y5vigFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.studentId = student.getId();&#xD;
     this.teacherId = teacher.getId();&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUlI1FJNEeiyW7NaN4qWdw" name="AssignTeacherMessage" specification="_aMnfoFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUlI1VJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUlI1lJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUlI11JNEeiyW7NaN4qWdw" type="_Y5vigFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.studentId = element.getAttribute(&quot;student&quot;);&#xD;
     this.teacherId = element.getAttribute(&quot;teacher&quot;);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUlI2FJNEeiyW7NaN4qWdw" name="handle" specification="_aMoGsFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUlI2VJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUlI2lJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUlI21JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUlI3FJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
&#xD;
     Unit student;&#xD;
     try {&#xD;
         student = player.getOurFreeColGameObject(studentId, Unit.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     Unit teacher;&#xD;
     try {&#xD;
         teacher = player.getOurFreeColGameObject(teacherId, Unit.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     if (student.getColony() == null) {&#xD;
         return DOMMessage.clientError(&quot;Student not in colony: &quot;&#xD;
             + studentId);&#xD;
     } else if (!student.isInColony()) {&#xD;
         return DOMMessage.clientError(&quot;Student not working colony: &quot;&#xD;
             + studentId);&#xD;
     } else if (teacher.getColony() == null) {&#xD;
         return DOMMessage.clientError(&quot;Teacher not in colony: &quot;&#xD;
             + teacherId);&#xD;
     } else if (!teacher.getColony().canTrain(teacher)) {&#xD;
         return DOMMessage.clientError(&quot;Teacher can not teach: &quot;&#xD;
             + teacherId);&#xD;
     } else if (student.getColony() != teacher.getColony()) {&#xD;
         return DOMMessage.clientError(&quot;Student and teacher not in same colony: &quot;&#xD;
             + studentId);&#xD;
     } else if (!student.canBeStudent(teacher)) {&#xD;
         return DOMMessage.clientError(&quot;Student can not be taught by teacher: &quot;&#xD;
             + studentId);&#xD;
     }&#xD;
&#xD;
     // Proceed to assign.&#xD;
     return server.getInGameController()&#xD;
         .assignTeacher(serverPlayer, student, teacher);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUlv4FJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_Y50bAFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUlv4VJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return createMessage(getXMLElementTagName(),&#xD;
         &quot;student&quot;, studentId,&#xD;
         &quot;teacher&quot;, teacherId);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUlv4lJNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_Y52QMFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUlv41JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;assignTeacher&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_Y50bAFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aUlv4FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aMpU0FJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y52QMFJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aUlv4lJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aWwTEVJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;assignTeacher&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y523QFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aMlqcFJNEeiyW7NaN4qWdw" name="AssignTeacherMessage" method="_aUlI0FJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aMm4kFJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aMm4kVJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aWvsAVJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>AssignTeacherMessage&lt;/code> with the&#xD;
     * supplied student and teacher.&#xD;
     *&#xD;
     * @param student The student &lt;code>Unit&lt;/code>.&#xD;
     * @param teacher The teacher &lt;code>Unit&lt;/code>.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aMmRgFJNEeiyW7NaN4qWdw" name="student" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aMmRgVJNEeiyW7NaN4qWdw" name="teacher" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aMm4klJNEeiyW7NaN4qWdw" type="_Y5vigFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aMnfoFJNEeiyW7NaN4qWdw" name="AssignTeacherMessage" method="_aUlI1FJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aMnfo1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aMnfpFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aWvsAlJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>AssignTeacherMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aMnfoVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aMnfolJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aMnfpVJNEeiyW7NaN4qWdw" type="_Y5vigFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aMoGsFJNEeiyW7NaN4qWdw" name="handle" method="_aUlI2FJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aWwTEFJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;assignTeacher&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param player The &lt;code>Player&lt;/code> the message applies to.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     * @return An update containing the student-teacher assignment or&#xD;
     *     an error &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aMoGsVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aMotwFJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aMotwVJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aMotwlJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_Y58W0FJNEeiyW7NaN4qWdw" name="AssignTradeRouteMessage">
                <ownedComment xmi:id="_aWwTElJNEeiyW7NaN4qWdw">
                  <body>The message sent when assigning a trade route to a unit.</body>
                </ownedComment>
                <generalization xmi:id="_aHDDIFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aRq-wFJNEeiyW7NaN4qWdw" name="unitId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aRrl0FJNEeiyW7NaN4qWdw" name="tradeRouteId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUmW8FJNEeiyW7NaN4qWdw" name="AssignTradeRouteMessage" specification="_aMp74FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUmW8VJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUmW8lJNEeiyW7NaN4qWdw" name="tradeRoute" type="_aG-xsFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUmW81JNEeiyW7NaN4qWdw" type="_Y58W0FJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = unit.getId();&#xD;
     this.tradeRouteId = (tradeRoute == null) ? null : tradeRoute.getId();&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUmW9FJNEeiyW7NaN4qWdw" name="AssignTradeRouteMessage" specification="_aMqi8lJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUmW9VJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUmW9lJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUmW91JNEeiyW7NaN4qWdw" type="_Y58W0FJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = element.getAttribute(&quot;unit&quot;);&#xD;
     this.tradeRouteId = (element.hasAttribute(&quot;tradeRoute&quot;))&#xD;
         ? element.getAttribute(&quot;tradeRoute&quot;)&#xD;
         : null;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUmW-FJNEeiyW7NaN4qWdw" name="handle" specification="_aMrKA1JNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUmW-VJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUmW-lJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUmW-1JNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
&#xD;
     Unit unit;&#xD;
     try {&#xD;
         unit = serverPlayer.getOurFreeColGameObject(unitId, Unit.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     TradeRoute tradeRoute;&#xD;
     if (tradeRouteId == null) {&#xD;
         tradeRoute = null;&#xD;
     } else {&#xD;
         try {&#xD;
             tradeRoute = serverPlayer.getOurFreeColGameObject(tradeRouteId, &#xD;
                 TradeRoute.class);&#xD;
         } catch (Exception e) {&#xD;
             return DOMMessage.clientError(e.getMessage());&#xD;
         }&#xD;
     }&#xD;
&#xD;
     // Proceed to assign.&#xD;
     return server.getInGameController()&#xD;
         .assignTradeRoute(serverPlayer, unit, tradeRoute);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUmW_FJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_Y6AoQFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUmW_VJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>Element result = createMessage(getXMLElementTagName(),&#xD;
         &quot;unit&quot;, unitId);&#xD;
     if (tradeRouteId != null) {&#xD;
         result.setAttribute(&quot;tradeRoute&quot;, tradeRouteId);&#xD;
     }&#xD;
     return result;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUm-AFJNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_Y6CdcFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUm-AVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;assignTradeRoute&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_Y6AoQFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aUmW_FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aMsYIFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y6CdcFJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aUm-AFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aWwTFlJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;assignTradeRoute&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y6FgwFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aMp74FJNEeiyW7NaN4qWdw" name="AssignTradeRouteMessage" method="_aUmW8FJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aMp741JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aMqi8FJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aWwTE1JNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>AssignTradeRouteMessage&lt;/code> with the&#xD;
     * supplied unit and route.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> to assign a trade route to.&#xD;
     * @param tradeRoute The &lt;code>TradeRoute&lt;/code> to assign.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aMp74VJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aMp74lJNEeiyW7NaN4qWdw" name="tradeRoute" type="_aG-xsFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aMqi8VJNEeiyW7NaN4qWdw" type="_Y58W0FJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aMqi8lJNEeiyW7NaN4qWdw" name="AssignTradeRouteMessage" method="_aUmW9FJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aMrKAFJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aMrKAVJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aWwTFFJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>AssignTradeRouteMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aMqi81JNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aMqi9FJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aMrKAlJNEeiyW7NaN4qWdw" type="_Y58W0FJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aMrKA1JNEeiyW7NaN4qWdw" name="handle" method="_aUmW-FJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aWwTFVJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;assignTradeRoute&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     * @return An update containing the assignTradeRouted unit, or an&#xD;
     *     error &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aMrxEFJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aMrxEVJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aMrxElJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_Y6LAUFJNEeiyW7NaN4qWdw" name="AttackMessage">
                <ownedComment xmi:id="_aWw6IFJNEeiyW7NaN4qWdw">
                  <body>The message sent when attacking.</body>
                </ownedComment>
                <generalization xmi:id="_aHFfYFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aRsM4FJNEeiyW7NaN4qWdw" name="unitId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aRsz8VJNEeiyW7NaN4qWdw" name="directionString" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUm-AlJNEeiyW7NaN4qWdw" name="AttackMessage" specification="_aMs_MFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUm-A1JNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUm-BFJNEeiyW7NaN4qWdw" name="direction" type="_aG4EAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUm-BVJNEeiyW7NaN4qWdw" type="_Y6LAUFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = unit.getId();&#xD;
     this.directionString = String.valueOf(direction);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUm-BlJNEeiyW7NaN4qWdw" name="AttackMessage" specification="_aMtmQFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUm-B1JNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUm-CFJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUm-CVJNEeiyW7NaN4qWdw" type="_Y6LAUFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = element.getAttribute(&quot;unit&quot;);&#xD;
     this.directionString = element.getAttribute(&quot;direction&quot;);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUnlEFJNEeiyW7NaN4qWdw" name="handle" specification="_aMu0YFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUnlEVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUnlElJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUnlE1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUnlFFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
     &#xD;
     Unit unit;&#xD;
     try {&#xD;
         unit = serverPlayer.getOurFreeColGameObject(unitId, Unit.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     Tile tile;&#xD;
     try {&#xD;
         tile = unit.getNeighbourTile(directionString);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     MoveType moveType = unit.getMoveType(tile);&#xD;
     if (moveType == MoveType.ENTER_INDIAN_SETTLEMENT_WITH_SCOUT&#xD;
         || moveType == MoveType.ENTER_FOREIGN_COLONY_WITH_SCOUT&#xD;
         || moveType.isAttack()) {&#xD;
         ; // OK&#xD;
     } else {&#xD;
         return DOMMessage.clientError(&quot;Illegal attack move for: &quot; + unitId&#xD;
             + &quot; type: &quot; + moveType&#xD;
             + &quot; from: &quot; + unit.getLocation().getId()&#xD;
             + &quot; to: &quot; + tile.getId());&#xD;
     }&#xD;
&#xD;
     Unit defender = tile.getDefendingUnit(unit);&#xD;
     if (defender == null) {&#xD;
         return DOMMessage.clientError(&quot;Could not find defender&quot;&#xD;
             + &quot; in tile: &quot; + tile.getId()&#xD;
             + &quot; from: &quot; + unit.getLocation().getId());&#xD;
     }&#xD;
&#xD;
     // Proceed to attack.&#xD;
     return server.getInGameController()&#xD;
         .combat(serverPlayer, unit, defender, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUnlFVJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_Y6NckFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUnlFlJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return createMessage(getXMLElementTagName(),&#xD;
         &quot;unit&quot;, this.unitId,&#xD;
         &quot;direction&quot;, this.directionString);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUnlF1JNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_Y6OqsFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUnlGFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;attack&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_Y6NckFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aUnlFVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aMwpkFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y6OqsFJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aUnlF1JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aWxhMVJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;attack&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y6OqsVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aMs_MFJNEeiyW7NaN4qWdw" name="AttackMessage" method="_aUm-AlJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aMs_M1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aMs_NFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aWw6IVJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>AttackMessage&lt;/code> for the supplied unit and&#xD;
     * direction.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> attacking.&#xD;
     * @param direction The &lt;code>Direction&lt;/code> to attack in.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aMs_MVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aMs_MlJNEeiyW7NaN4qWdw" name="direction" type="_aG4EAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aMs_NVJNEeiyW7NaN4qWdw" type="_Y6LAUFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aMtmQFJNEeiyW7NaN4qWdw" name="AttackMessage" method="_aUm-BlJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aMuNUlJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aMuNU1JNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aWw6IlJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>AttackMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aMuNUFJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aMuNUVJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aMuNVFJNEeiyW7NaN4qWdw" type="_Y6LAUFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aMu0YFJNEeiyW7NaN4qWdw" name="handle" method="_aUnlEFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aWxhMFJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;attack&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param player The &lt;code>Player&lt;/code> the message applies to.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     * @return An update encapsulating the attack or an error&#xD;
     *     &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aMu0YVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aMu0YlJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aMu0Y1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aMvbcFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_Y6S8IFJNEeiyW7NaN4qWdw" name="BuildColonyMessage">
                <ownedComment xmi:id="_aWxhMlJNEeiyW7NaN4qWdw">
                  <body>The message sent when the client requests building of a colony.</body>
                </ownedComment>
                <generalization xmi:id="_aHH7oFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aRtbAVJNEeiyW7NaN4qWdw" name="colonyName" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aRuCEVJNEeiyW7NaN4qWdw" name="builderId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUoMIFJNEeiyW7NaN4qWdw" name="BuildColonyMessage" specification="_aMx3sFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUoMIVJNEeiyW7NaN4qWdw" name="colonyName">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aUoMIlJNEeiyW7NaN4qWdw" name="builder" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUoMI1JNEeiyW7NaN4qWdw" type="_Y6S8IFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.colonyName = colonyName;&#xD;
     this.builderId = builder.getId();&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUoMJFJNEeiyW7NaN4qWdw" name="BuildColonyMessage" specification="_aMzF0FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUoMJVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUoMJlJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUoMJ1JNEeiyW7NaN4qWdw" type="_Y6S8IFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.colonyName = element.getAttribute(&quot;name&quot;);&#xD;
     this.builderId = element.getAttribute(&quot;unit&quot;);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUoMKFJNEeiyW7NaN4qWdw" name="handle" specification="_aMzs4FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUoMKVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUoMKlJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUoMK1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUoMLFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
     final Game game = server.getGame();&#xD;
&#xD;
     Unit unit;&#xD;
     try {&#xD;
         unit = player.getOurFreeColGameObject(builderId, Unit.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
     if (!unit.canBuildColony()) {&#xD;
         return DOMMessage.clientError(&quot;Unit &quot; + builderId&#xD;
             + &quot; can not build colony.&quot;);&#xD;
     }&#xD;
&#xD;
     if (colonyName == null) {&#xD;
         return DOMMessage.clientError(&quot;Null colony name&quot;);&#xD;
     } else if (Player.ASSIGN_SETTLEMENT_NAME.equals(colonyName)) {&#xD;
         ; // ok&#xD;
     } else if (game.getSettlementByName(colonyName) != null) {&#xD;
         return DOMMessage.clientError(&quot;Non-unique colony name &quot;&#xD;
             + colonyName);&#xD;
     }&#xD;
&#xD;
     Tile tile = unit.getTile();&#xD;
     if (!player.canClaimToFoundSettlement(tile)) {&#xD;
         return DOMMessage.clientError(&quot;Can not build colony on tile &quot;&#xD;
             + tile + &quot;: &quot; + player.canClaimToFoundSettlementReason(tile));&#xD;
     }&#xD;
&#xD;
     // Build can proceed.&#xD;
     return server.getInGameController()&#xD;
         .buildSettlement(serverPlayer, unit, colonyName);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUozMFJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_Y6VYYFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUozMVJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return createMessage(getXMLElementTagName(),&#xD;
         &quot;name&quot;, colonyName,&#xD;
         &quot;unit&quot;, builderId);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUozMlJNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_Y6WmglJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUozM1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;buildColony&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_Y6VYYFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aUozMFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aM0T8FJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y6WmglJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aUozMlJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aWxhNlJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;buildColony&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y6XNkFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aMx3sFJNEeiyW7NaN4qWdw" name="BuildColonyMessage" method="_aUoMIFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aMx3s1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aMx3tFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aWxhM1JNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>BuildColonyMessage&lt;/code> with the supplied name&#xD;
     * and building unit.&#xD;
     *&#xD;
     * @param colonyName The name for the new colony.&#xD;
     * @param builder The &lt;code>Unit&lt;/code> to do the building.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aMx3sVJNEeiyW7NaN4qWdw" name="colonyName">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aMx3slJNEeiyW7NaN4qWdw" name="builder" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aMyewFJNEeiyW7NaN4qWdw" type="_Y6S8IFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aMzF0FJNEeiyW7NaN4qWdw" name="BuildColonyMessage" method="_aUoMJFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aMzF01JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aMzF1FJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aWxhNFJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>BuildColonyMessage&lt;/code> from a supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aMzF0VJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aMzF0lJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aMzF1VJNEeiyW7NaN4qWdw" type="_Y6S8IFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aMzs4FJNEeiyW7NaN4qWdw" name="handle" method="_aUoMKFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aWxhNVJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;buildColony&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the request.&#xD;
     * @param player The &lt;code>Player&lt;/code> building the colony.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> the message is from.&#xD;
     * @return An update &lt;code>Element&lt;/code> defining the new colony&#xD;
     *     and updating its surrounding tiles, or an error&#xD;
     *     &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aMzs4VJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aMzs4lJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aMzs41JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aMzs5FJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_Y6a38FJNEeiyW7NaN4qWdw" name="BuyMessage">
                <ownedComment xmi:id="_aWyIQFJNEeiyW7NaN4qWdw">
                  <body>The message sent when purchasing at an IndianSettlement.</body>
                </ownedComment>
                <generalization xmi:id="_aHM0IFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aRv3QFJNEeiyW7NaN4qWdw" name="unitId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aRweUFJNEeiyW7NaN4qWdw" name="settlementId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aRxFYVJNEeiyW7NaN4qWdw" name="goods" visibility="private" isLeaf="true" type="_aHJw0FJNEeiyW7NaN4qWdw" isReadOnly="true" association="_aX_pMFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aRxscVJNEeiyW7NaN4qWdw" name="goldString" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUpaQFJNEeiyW7NaN4qWdw" name="BuyMessage" specification="_aM07AFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUpaQVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUpaQlJNEeiyW7NaN4qWdw" name="settlement" type="_aHKX4VJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUpaQ1JNEeiyW7NaN4qWdw" name="goods" type="_aHJw0FJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUpaRFJNEeiyW7NaN4qWdw" name="gold">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aUpaRVJNEeiyW7NaN4qWdw" type="_Y6a38FJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = unit.getId();&#xD;
     this.settlementId = settlement.getId();&#xD;
     this.goods = goods;&#xD;
     this.goldString = Integer.toString(gold);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUpaRlJNEeiyW7NaN4qWdw" name="BuyMessage" specification="_aM1iFFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUpaR1JNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUpaSFJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUpaSVJNEeiyW7NaN4qWdw" type="_Y6a38FJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = element.getAttribute(&quot;unit&quot;);&#xD;
     this.settlementId = element.getAttribute(&quot;settlement&quot;);&#xD;
     this.goods = new Goods(game,&#xD;
         DOMMessage.getChildElement(element, Goods.getXMLElementTagName()));&#xD;
     this.goldString = element.getAttribute(&quot;gold&quot;);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUpaSlJNEeiyW7NaN4qWdw" name="getGold" specification="_Y6dUMFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUpaS1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>try {&#xD;
         return Integer.parseInt(goldString);&#xD;
     } catch (NumberFormatException e) {&#xD;
         return -1;&#xD;
     }&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUqBUFJNEeiyW7NaN4qWdw" name="handle" specification="_aM2wMFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUqBUVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUqBUlJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUqBU1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUqBVFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
&#xD;
     Unit unit;&#xD;
     try {&#xD;
         unit = player.getOurFreeColGameObject(unitId, Unit.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     ServerIndianSettlement settlement;&#xD;
     try {&#xD;
         settlement = (ServerIndianSettlement)unit.getAdjacentIndianSettlementSafely(settlementId);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     // Make sure we are trying to buy something that is there&#xD;
     if (goods.getLocation() != settlement) {&#xD;
         return DOMMessage.clientError(&quot;Goods &quot; + goods.getId()&#xD;
             + &quot; is not at settlement &quot; + settlementId);&#xD;
     }&#xD;
&#xD;
     int gold = getGold();&#xD;
     if (gold &lt; 0) return DOMMessage.clientError(&quot;Bad gold: &quot; + goldString);&#xD;
&#xD;
     // Try to buy.&#xD;
     return server.getInGameController()&#xD;
         .buyFromSettlement(serverPlayer, unit, settlement, goods, gold);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUqBVVJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_Y6d7QFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUqBVlJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>Element result = createMessage(getXMLElementTagName(),&#xD;
         &quot;unit&quot;, unitId,&#xD;
         &quot;settlement&quot;, settlementId,&#xD;
         &quot;gold&quot;, goldString);&#xD;
     result.appendChild(goods.toXMLElement(result.getOwnerDocument()));&#xD;
     return result;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUqBV1JNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_Y6fJYlJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUqBWFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;buy&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_Y6dUMFJNEeiyW7NaN4qWdw" name="getGold" method="_aUpaSlJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aWyvUVJNEeiyW7NaN4qWdw">
                    <body>What is the price currently negotiated for this transaction?&#xD;
     *&#xD;
     * @return The current price.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y6dUMVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_Y6d7QFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aUqBVVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aM3XQFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y6fJYlJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aUqBV1JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aWyvU1JNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;buy&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y6fwcFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aM07AFJNEeiyW7NaN4qWdw" name="BuyMessage" method="_aUpaQFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aM1iEVJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aM1iElJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aWyIQVJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>BuyMessage&lt;/code>.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is buying.&#xD;
     * @param settlement The &lt;code>Settlement&lt;/code> that is trading.&#xD;
     * @param goods The &lt;code>Goods&lt;/code> to buy.&#xD;
     * @param gold The price of the goods.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aM07AVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aM07AlJNEeiyW7NaN4qWdw" name="settlement" type="_aHKX4VJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aM07A1JNEeiyW7NaN4qWdw" name="goods" type="_aHJw0FJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aM1iEFJNEeiyW7NaN4qWdw" name="gold">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aM1iE1JNEeiyW7NaN4qWdw" type="_Y6a38FJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aM1iFFJNEeiyW7NaN4qWdw" name="BuyMessage" method="_aUpaRlJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aM2JIlJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aM2JI1JNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aWyvUFJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>BuyMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aM2JIFJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aM2JIVJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aM2JJFJNEeiyW7NaN4qWdw" type="_Y6a38FJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aM2wMFJNEeiyW7NaN4qWdw" name="handle" method="_aUqBUFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aWyvUlJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;buy&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param player The &lt;code>Player&lt;/code> the message applies to.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     * @return An update following the purchase, or an error&#xD;
     *     &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aM2wMVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aM2wMlJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aM2wM1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aM2wNFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_Y6ko8FJNEeiyW7NaN4qWdw" name="BuyPropositionMessage">
                <ownedComment xmi:id="_aWyvVFJNEeiyW7NaN4qWdw">
                  <body>The message sent when negotiating a purchase at an IndianSettlement.</body>
                </ownedComment>
                <generalization xmi:id="_aHPQYFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aRy6kFJNEeiyW7NaN4qWdw" name="unitId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aRzhoVJNEeiyW7NaN4qWdw" name="settlementId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aR0IsVJNEeiyW7NaN4qWdw" name="goods" visibility="private" isLeaf="true" type="_aHJw0FJNEeiyW7NaN4qWdw" isReadOnly="true" association="_aYGW4VJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aR0vwFJNEeiyW7NaN4qWdw" name="goldString" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUqoYFJNEeiyW7NaN4qWdw" name="BuyPropositionMessage" specification="_aM3-UFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUqoYVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUqoYlJNEeiyW7NaN4qWdw" name="settlement" type="_aHKX4VJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUqoY1JNEeiyW7NaN4qWdw" name="goods" type="_aHJw0FJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUqoZFJNEeiyW7NaN4qWdw" name="gold">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aUqoZVJNEeiyW7NaN4qWdw" type="_Y6ko8FJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = unit.getId();&#xD;
     this.settlementId = settlement.getId();&#xD;
     this.goods = goods;&#xD;
     this.goldString = Integer.toString(gold);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUqoZlJNEeiyW7NaN4qWdw" name="BuyPropositionMessage" specification="_aM5McFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUqoZ1JNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUqoaFJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUqoaVJNEeiyW7NaN4qWdw" type="_Y6ko8FJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = element.getAttribute(&quot;unit&quot;);&#xD;
     this.settlementId = element.getAttribute(&quot;settlement&quot;);&#xD;
     this.goods = new Goods(game,&#xD;
         DOMMessage.getChildElement(element, Goods.getXMLElementTagName()));&#xD;
     this.goldString = element.getAttribute(&quot;gold&quot;);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUrPcFJNEeiyW7NaN4qWdw" name="getGold" specification="_Y6meIFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUrPcVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>try {&#xD;
         return Integer.parseInt(goldString);&#xD;
     } catch (NumberFormatException e) {&#xD;
         return -1;&#xD;
     }&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUrPclJNEeiyW7NaN4qWdw" name="handle" specification="_aM5zgFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUrPc1JNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUrPdFJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUrPdVJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUrPdlJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
&#xD;
     Unit unit;&#xD;
     try {&#xD;
         unit = player.getOurFreeColGameObject(unitId, Unit.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
     if (!unit.hasSpaceLeft()) {&#xD;
         return DOMMessage.clientError(&quot;No space left on unit: &quot;&#xD;
             + unit.getId());&#xD;
     }&#xD;
 &#xD;
     IndianSettlement settlement;&#xD;
     try {&#xD;
         settlement = unit.getAdjacentIndianSettlementSafely(settlementId);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
     // Make sure we are trying to buy something that is there&#xD;
     if (goods.getLocation() != settlement) {&#xD;
         return DOMMessage.clientError(&quot;Goods &quot; + goods.getId()&#xD;
             + &quot; are not in settlement &quot; + settlementId);&#xD;
     }&#xD;
 &#xD;
     // Proceed to price.&#xD;
     return server.getInGameController()&#xD;
         .buyProposition(serverPlayer, unit, settlement, goods, getGold());&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUrPd1JNEeiyW7NaN4qWdw" name="toXMLElement" specification="_Y6nsQFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUrPeFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>Element result = createMessage(getXMLElementTagName(),&#xD;
         &quot;unit&quot;, unitId,&#xD;
         &quot;settlement&quot;, settlementId,&#xD;
         &quot;gold&quot;, goldString);&#xD;
     result.appendChild(goods.toXMLElement(result.getOwnerDocument()));&#xD;
     return result;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUrPeVJNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_Y6o6YFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUrPelJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;buyProposition&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_Y6meIFJNEeiyW7NaN4qWdw" name="getGold" method="_aUrPcFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aWzWYlJNEeiyW7NaN4qWdw">
                    <body>What is the price currently negotiated for this transaction?&#xD;
     *&#xD;
     * @return The current price.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y6nFMFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_Y6nsQFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aUrPd1JNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aM6akFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y6o6YFJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aUrPeVJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aWzWZFJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;buyProposition&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y6o6YVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aM3-UFJNEeiyW7NaN4qWdw" name="BuyPropositionMessage" method="_aUqoYFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aM4lY1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aM4lZFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aWzWYFJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>BuyPropositionMessage&lt;/code>.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is buying.&#xD;
     * @param settlement The &lt;code>Settlement&lt;/code> that is trading.&#xD;
     * @param goods The &lt;code>Goods&lt;/code> to buy.&#xD;
     * @param gold The price of the goods (negative if unknown).</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aM3-UVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aM4lYFJNEeiyW7NaN4qWdw" name="settlement" type="_aHKX4VJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aM4lYVJNEeiyW7NaN4qWdw" name="goods" type="_aHJw0FJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aM4lYlJNEeiyW7NaN4qWdw" name="gold">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aM4lZVJNEeiyW7NaN4qWdw" type="_Y6ko8FJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aM5McFJNEeiyW7NaN4qWdw" name="BuyPropositionMessage" method="_aUqoZlJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aM5Mc1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aM5MdFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aWzWYVJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>BuyPropositionMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aM5McVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aM5MclJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aM5MdVJNEeiyW7NaN4qWdw" type="_Y6ko8FJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aM5zgFJNEeiyW7NaN4qWdw" name="handle" method="_aUrPclJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aWzWY1JNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;buyProposition&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param player The &lt;code>Player&lt;/code> the message applies to.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     * @return This &lt;code>BuyProposition&lt;/code> message as an&#xD;
     *     &lt;code>Element&lt;/code> with updated gold value, or an error&#xD;
     *     &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aM5zgVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aM5zglJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aM5zg1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aM5zhFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_Y6ty4FJNEeiyW7NaN4qWdw" name="CashInTreasureTrainMessage">
                <ownedComment xmi:id="_aWzWZVJNEeiyW7NaN4qWdw">
                  <body>The message sent when cashing in a treasure train.</body>
                </ownedComment>
                <generalization xmi:id="_aHSTsFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aR1W0VJNEeiyW7NaN4qWdw" name="unitId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUr2gFJNEeiyW7NaN4qWdw" name="CashInTreasureTrainMessage" specification="_aM7BoFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUr2gVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUr2glJNEeiyW7NaN4qWdw" type="_Y6ty4FJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = unit.getId();&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUvg4FJNEeiyW7NaN4qWdw" name="CashInTreasureTrainMessage" specification="_aM7osFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUvg4VJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUvg4lJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUvg41JNEeiyW7NaN4qWdw" type="_Y6ty4FJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = element.getAttribute(&quot;unit&quot;);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUvg5FJNEeiyW7NaN4qWdw" name="handle" specification="_aM820FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUvg5VJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUvg5lJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUvg51JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUvg6FJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
&#xD;
     Unit unit;&#xD;
     try {&#xD;
         unit = player.getOurFreeColGameObject(unitId, Unit.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
     if (!unit.canCarryTreasure()) {&#xD;
         return DOMMessage.clientError(&quot;Can not cash in unit &quot; + unitId&#xD;
             + &quot;, can not carry treasure.&quot;);&#xD;
     } else if (!unit.canCashInTreasureTrain()) {&#xD;
         return DOMMessage.clientError(&quot;Can not cash in unit &quot; + unitId&#xD;
             + &quot;, unsuitable location.&quot;);&#xD;
     }&#xD;
&#xD;
     // Cash in.&#xD;
     return server.getInGameController()&#xD;
         .cashInTreasureTrain(serverPlayer, unit);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUvg6VJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_Y6wPIFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUvg6lJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return createMessage(getXMLElementTagName(),&#xD;
         &quot;unit&quot;, unitId);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUwH8FJNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_Y6xdQFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUwH8VJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;cashInTreasureTrain&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_Y6wPIFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aUvg6VJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aM821VJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y6xdQFJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aUwH8FJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aWz9cVJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;cashInTreasureTrain&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y6xdQVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aM7BoFJNEeiyW7NaN4qWdw" name="CashInTreasureTrainMessage" method="_aUr2gFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aM7BolJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aM7Bo1JNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aWzWZlJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>CashInTreasureTrainMessage&lt;/code> with the&#xD;
     * supplied name.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> to cash in.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aM7BoVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aM7BpFJNEeiyW7NaN4qWdw" type="_Y6ty4FJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aM7osFJNEeiyW7NaN4qWdw" name="CashInTreasureTrainMessage" method="_aUvg4FJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aM7os1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aM8PwFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aWzWZ1JNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>CashInTreasureTrainMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aM7osVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aM7oslJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aM8PwVJNEeiyW7NaN4qWdw" type="_Y6ty4FJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aM820FJNEeiyW7NaN4qWdw" name="handle" method="_aUvg5FJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aWz9cFJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;cashInTreasureTrain&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param player The &lt;code>Player&lt;/code> the message applies to.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     * @return An update resulting from cashing in the treasure train,&#xD;
     *     or an error &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aM820VJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aM820lJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aM8201JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aM821FJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_Y61HoFJNEeiyW7NaN4qWdw" name="ChangeStateMessage">
                <ownedComment xmi:id="_aWz9clJNEeiyW7NaN4qWdw">
                  <body>The message sent when changing a unit state.</body>
                </ownedComment>
                <generalization xmi:id="_aHVXAFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aR2k8FJNEeiyW7NaN4qWdw" name="unitId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aR3MAFJNEeiyW7NaN4qWdw" name="stateString" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUwvAFJNEeiyW7NaN4qWdw" name="ChangeStateMessage" specification="_aM9d4FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUwvAVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUwvAlJNEeiyW7NaN4qWdw" name="state" type="_aHUI4FJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUwvA1JNEeiyW7NaN4qWdw" type="_Y61HoFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = unit.getId();&#xD;
     this.stateString = String.valueOf(state);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUwvBFJNEeiyW7NaN4qWdw" name="ChangeStateMessage" specification="_aM-sAFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUwvBVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUwvBlJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUwvB1JNEeiyW7NaN4qWdw" type="_Y61HoFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = element.getAttribute(&quot;unit&quot;);&#xD;
     this.stateString = element.getAttribute(&quot;state&quot;);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUxWEFJNEeiyW7NaN4qWdw" name="handle" specification="_aM_TEFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUxWEVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUxWElJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUxWE1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUxWFFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
&#xD;
     Unit unit;&#xD;
     try {&#xD;
         unit = player.getOurFreeColGameObject(unitId, Unit.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
     // Do not test if it is on the map, units in Europe can change state.&#xD;
&#xD;
     UnitState state;&#xD;
     try {&#xD;
         state = Enum.valueOf(UnitState.class, stateString);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
     if (!unit.checkSetState(state)) {&#xD;
         return DOMMessage.clientError(&quot;Unit &quot; + unitId&#xD;
             + &quot; can not change state: &quot; + unit.getState().toString()&#xD;
             + &quot; -> &quot; + stateString);&#xD;
     }&#xD;
&#xD;
     // Proceed to change.&#xD;
     return server.getInGameController()&#xD;
         .changeState(serverPlayer, unit, state);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUxWFVJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_Y63j4FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUxWFlJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return createMessage(getXMLElementTagName(),&#xD;
         &quot;unit&quot;, unitId,&#xD;
         &quot;state&quot;, stateString);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUx9IFJNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_Y66AIFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUx9IVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;changeState&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_Y63j4FJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aUxWFVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aM_6IFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y66AIFJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aUx9IFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aWz9dlJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;changeState&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y66nMFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aM9d4FJNEeiyW7NaN4qWdw" name="ChangeStateMessage" method="_aUwvAFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aM-E8lJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aM-E81JNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aWz9c1JNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>ChangeStateMessage&lt;/code> with the&#xD;
     * supplied unit and state.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> to change the state of.&#xD;
     * @param state The new state.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aM-E8FJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aM-E8VJNEeiyW7NaN4qWdw" name="state" type="_aHUI4FJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aM-E9FJNEeiyW7NaN4qWdw" type="_Y61HoFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aM-sAFJNEeiyW7NaN4qWdw" name="ChangeStateMessage" method="_aUwvBFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aM-sA1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aM-sBFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aWz9dFJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>ChangeStateMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aM-sAVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aM-sAlJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aM-sBVJNEeiyW7NaN4qWdw" type="_Y61HoFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aM_TEFJNEeiyW7NaN4qWdw" name="handle" method="_aUxWEFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aWz9dVJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;changeState&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param player The &lt;code>Player&lt;/code> the message applies to.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     * @return An update containing the changed unit, or an error&#xD;
     *     &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aM_TEVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aM_TElJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aM_TE1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aM_TFFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_Y6_fsFJNEeiyW7NaN4qWdw" name="ChangeWorkImprovementTypeMessage">
                <ownedComment xmi:id="_aWz9d1JNEeiyW7NaN4qWdw">
                  <body>The message sent when changing a work improvement type.</body>
                </ownedComment>
                <generalization xmi:id="_aHaPgFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aR3zEFJNEeiyW7NaN4qWdw" name="unitId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aR4aIVJNEeiyW7NaN4qWdw" name="improvementId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUykMFJNEeiyW7NaN4qWdw" name="ChangeWorkImprovementTypeMessage" specification="_aNAhMFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUykMVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUykMlJNEeiyW7NaN4qWdw" name="type" type="_aHYaUVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUykM1JNEeiyW7NaN4qWdw" type="_Y6_fsFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = unit.getId();&#xD;
     this.improvementId = type.getId();&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUykNFJNEeiyW7NaN4qWdw" name="ChangeWorkImprovementTypeMessage" specification="_aNBIQFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUykNVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUykNlJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUykN1JNEeiyW7NaN4qWdw" type="_Y6_fsFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = element.getAttribute(&quot;unit&quot;);&#xD;
     this.improvementId = element.getAttribute(&quot;improvementType&quot;);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUzLQFJNEeiyW7NaN4qWdw" name="handle" specification="_aNBvU1JNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUzLQVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUzLQlJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUzLQ1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aUzLRFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
&#xD;
     Unit unit;&#xD;
     try {&#xD;
         unit = player.getOurFreeColGameObject(unitId, Unit.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     Tile tile = unit.getTile();&#xD;
     if (tile == null) {&#xD;
         return DOMMessage.clientError(&quot;Unit is not on the map: &quot; + unitId);&#xD;
     } else if (!unit.hasAbility(Ability.IMPROVE_TERRAIN)) {&#xD;
         return DOMMessage.clientError(&quot;Unit can not improve tiles: &quot;&#xD;
             + unitId);&#xD;
     }&#xD;
&#xD;
     TileImprovementType type = server.getSpecification()&#xD;
         .getTileImprovementType(improvementId);&#xD;
     TileImprovement improvement;&#xD;
     if (type == null) {&#xD;
         return DOMMessage.clientError(&quot;Not a tile improvement type: &quot;&#xD;
             + improvementId);&#xD;
     } else if (type.isNatural()) {&#xD;
         return DOMMessage.clientError(&quot;ImprovementType must not be natural: &quot;&#xD;
             + improvementId);&#xD;
     } else if (!type.isTileTypeAllowed(tile.getType())) {&#xD;
         return DOMMessage.clientError(&quot;ImprovementType not allowed on tile: &quot;&#xD;
             + improvementId);&#xD;
     } else if ((improvement = tile.getTileImprovement(type)) == null) {&#xD;
         if (!type.isWorkerAllowed(unit)) {&#xD;
             return DOMMessage.clientError(&quot;Unit can not create improvement: &quot;&#xD;
                 + improvementId);&#xD;
         }&#xD;
     } else { // Has improvement, check if worker can contribute to it&#xD;
         if (!improvement.isWorkerAllowed(unit)) {&#xD;
             return DOMMessage.clientError(&quot;Unit can not work on improvement: &quot;&#xD;
                 + improvementId);&#xD;
         }&#xD;
     }&#xD;
&#xD;
     // Proceed to change.&#xD;
     return server.getInGameController()&#xD;
         .changeWorkImprovementType(serverPlayer, unit, type);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUzLRVJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_Y7DKEFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUzLRlJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return createMessage(getXMLElementTagName(),&#xD;
         &quot;unit&quot;, unitId,&#xD;
         &quot;improvementType&quot;, improvementId);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aUzyUFJNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_Y7E_QFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aUzyUVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;changeWorkImprovementType&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_Y7DKEFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aUzLRVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aNCWYlJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y7E_QFJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aUzyUFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW0kg1JNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;changeWorkImprovementType&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y7E_QVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aNAhMFJNEeiyW7NaN4qWdw" name="ChangeWorkImprovementTypeMessage" method="_aUykMFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aNAhM1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aNAhNFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aW0kgFJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>ChangeWorkImprovementTypeMessage&lt;/code> with the&#xD;
     * supplied unit and improvement type.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is working.&#xD;
     * @param type The new &lt;code>TileImprovementType&lt;/code>.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNAhMVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNAhMlJNEeiyW7NaN4qWdw" name="type" type="_aHYaUVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNAhNVJNEeiyW7NaN4qWdw" type="_Y6_fsFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aNBIQFJNEeiyW7NaN4qWdw" name="ChangeWorkImprovementTypeMessage" method="_aUykNFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aNBvUFJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aNBvUVJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aW0kgVJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>ChangeWorkImprovementTypeMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNBIQVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNBIQlJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNBvUlJNEeiyW7NaN4qWdw" type="_Y6_fsFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aNBvU1JNEeiyW7NaN4qWdw" name="handle" method="_aUzLQFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW0kglJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;changeWorkImprovementType&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param player The &lt;code>Player&lt;/code> the message applies to.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     * @return An update containing the changed unit, or an error&#xD;
     *     &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNBvVFJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNBvVVJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNCWYFJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNCWYVJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_Y7J3wFJNEeiyW7NaN4qWdw" name="ChangeWorkTypeMessage">
                <ownedComment xmi:id="_aW1LkFJNEeiyW7NaN4qWdw">
                  <body>The message sent when changing the work type of a unit.</body>
                </ownedComment>
                <generalization xmi:id="_aHdS0FJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aR5BMFJNEeiyW7NaN4qWdw" name="unitId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aR5oQVJNEeiyW7NaN4qWdw" name="workTypeId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU0ZYFJNEeiyW7NaN4qWdw" name="ChangeWorkTypeMessage" specification="_aNC9cFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU0ZYVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU0ZYlJNEeiyW7NaN4qWdw" name="workType" type="_aHcEsFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU0ZY1JNEeiyW7NaN4qWdw" type="_Y7J3wFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = unit.getId();&#xD;
     this.workTypeId = workType.getId();&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU0ZZFJNEeiyW7NaN4qWdw" name="ChangeWorkTypeMessage" specification="_aNDkgVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU0ZZVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU0ZZlJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU0ZZ1JNEeiyW7NaN4qWdw" type="_Y7J3wFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = element.getAttribute(&quot;unit&quot;);&#xD;
     this.workTypeId = element.getAttribute(&quot;workType&quot;);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU1AcFJNEeiyW7NaN4qWdw" name="handle" specification="_aNELklJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU1AcVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU1AclJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU1Ac1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU1AdFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
&#xD;
     Unit unit;&#xD;
     try {&#xD;
         unit = player.getOurFreeColGameObject(unitId, Unit.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
     if (!unit.hasTile()) {&#xD;
         return DOMMessage.clientError(&quot;Unit is not on the map: &quot; + unitId);&#xD;
     }&#xD;
&#xD;
     GoodsType type = server.getSpecification().getGoodsType(workTypeId);&#xD;
     if (type == null) {&#xD;
         return DOMMessage.clientError(&quot;Not a goods type: &quot; + workTypeId);&#xD;
     }&#xD;
&#xD;
     // Proceed to changeWorkType.&#xD;
     return server.getInGameController()&#xD;
         .changeWorkType(serverPlayer, unit, type);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU1AdVJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_Y7MUAFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU1AdlJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return createMessage(getXMLElementTagName(),&#xD;
         &quot;unit&quot;, unitId,&#xD;
         &quot;workType&quot;, workTypeId);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU1Ad1JNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_Y7OJMFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU1AeFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;changeWorkType&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_Y7MUAFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aU1AdVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aNEyolJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y7OJMFJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aU1Ad1JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW1LlFJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;changeWorkType&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y7OJMVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aNC9cFJNEeiyW7NaN4qWdw" name="ChangeWorkTypeMessage" method="_aU0ZYFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aNC9c1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aNC9dFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aW1LkVJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>ChangeWorkTypeMessage&lt;/code> with the&#xD;
     * supplied unit and produce.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is working.&#xD;
     * @param workType The &lt;code>GoodsType&lt;/code> to produce.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNC9cVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNC9clJNEeiyW7NaN4qWdw" name="workType" type="_aHcEsFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNDkgFJNEeiyW7NaN4qWdw" type="_Y7J3wFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aNDkgVJNEeiyW7NaN4qWdw" name="ChangeWorkTypeMessage" method="_aU0ZZFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aNDkhFJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aNELkFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aW1LklJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>ChangeWorkTypeMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNDkglJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNDkg1JNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNELkVJNEeiyW7NaN4qWdw" type="_Y7J3wFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aNELklJNEeiyW7NaN4qWdw" name="handle" method="_aU1AcFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW1Lk1JNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;changeWorkType&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param player The &lt;code>Player&lt;/code> the message applies to.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     * @return An update containing the changes, or an error&#xD;
     *     &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNELk1JNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNELlFJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNEyoFJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNEyoVJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_Y7RMgFJNEeiyW7NaN4qWdw" name="ChatMessage">
                <ownedComment xmi:id="_aW1yoFJNEeiyW7NaN4qWdw">
                  <body>The message that contains a chat string.</body>
                </ownedComment>
                <generalization xmi:id="_aHfvEFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aR6PUFJNEeiyW7NaN4qWdw" name="sender" visibility="private">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aR6PUlJNEeiyW7NaN4qWdw" name="message" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aR7dclJNEeiyW7NaN4qWdw" name="privateChat" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU1nglJNEeiyW7NaN4qWdw" name="ChatMessage" specification="_aNFZsFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU1ng1JNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU1nhFJNEeiyW7NaN4qWdw" name="message">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aU1nhVJNEeiyW7NaN4qWdw" name="privateChat">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aU1nhlJNEeiyW7NaN4qWdw" type="_Y7RMgFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.sender = player.getId();&#xD;
     this.message = message;&#xD;
     this.privateChat = privateChat;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU1nh1JNEeiyW7NaN4qWdw" name="ChatMessage" specification="_aNGAxFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU1niFJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU1niVJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU1nilJNEeiyW7NaN4qWdw" type="_Y7RMgFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     sender = element.getAttribute(&quot;sender&quot;);&#xD;
     message = element.getAttribute(&quot;message&quot;);&#xD;
     privateChat = Boolean.parseBoolean(element.getAttribute(&quot;privateChat&quot;));&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU2OkFJNEeiyW7NaN4qWdw" name="getPlayer" specification="_aNHO4FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU2OkVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU2OklJNEeiyW7NaN4qWdw" type="_aGykcVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return game.getFreeColGameObject(sender, Player.class);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU2Ok1JNEeiyW7NaN4qWdw" name="isPrivate" specification="_Y7TBsFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU2OlFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return privateChat;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU21oFJNEeiyW7NaN4qWdw" name="handle" specification="_aNHO41JNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU21oVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU21olJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU21o1JNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
&#xD;
     /* Do not trust the client-supplied sender name */&#xD;
     sender = serverPlayer.getId();&#xD;
&#xD;
     return server.getInGameController().chat(serverPlayer, message,&#xD;
                                              privateChat);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU21pFJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_Y7UP0FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU21pVJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return createMessage(getXMLElementTagName(),&#xD;
         &quot;sender&quot;, sender,&#xD;
         &quot;message&quot;, message,&#xD;
         &quot;privateChat&quot;, String.valueOf(privateChat));&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU21plJNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_Y7U24lJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU21p1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;chat&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_Y7TBsFJNEeiyW7NaN4qWdw" name="isPrivate" method="_aU2Ok1JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW1ypFJNEeiyW7NaN4qWdw">
                    <body>Is this ChatMessage private?&#xD;
     *&#xD;
     * @return True if this ChatMessage is private.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y7TowFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_Y7UP0FJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aU21pFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aNH181JNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y7U24lJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aU21plJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW2ZsVJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;chat&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y7Vd8FJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aNFZsFJNEeiyW7NaN4qWdw" name="ChatMessage" method="_aU1nglJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aNGAwVJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aNGAwlJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aW1yoVJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>ChatMessage&lt;/code> with the&#xD;
     * supplied message.&#xD;
     *&#xD;
     * @param player The player that is sending the message.&#xD;
     * @param message The text of the message to send.&#xD;
     * @param privateChat Whether this message is private.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNFZsVJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNFZslJNEeiyW7NaN4qWdw" name="message">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aNGAwFJNEeiyW7NaN4qWdw" name="privateChat">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aNGAw1JNEeiyW7NaN4qWdw" type="_Y7RMgFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aNGAxFJNEeiyW7NaN4qWdw" name="ChatMessage" method="_aU1nh1JNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aNGn0lJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aNGn01JNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aW1yolJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>ChatMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.&#xD;
     * @throws IllegalStateException if there is problem with the senderID.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNGn0FJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNGn0VJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNGn1FJNEeiyW7NaN4qWdw" type="_Y7RMgFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aNHO4FJNEeiyW7NaN4qWdw" name="getPlayer" method="_aU2OkFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW1yo1JNEeiyW7NaN4qWdw">
                    <body>Who sent this ChatMessage?&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> the player is in.&#xD;
     * @return The player that sent this ChatMessage.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNHO4VJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNHO4lJNEeiyW7NaN4qWdw" type="_aGykcVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aNHO41JNEeiyW7NaN4qWdw" name="handle" method="_aU21oFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW2ZsFJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;chat&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> that handles the message.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     *&#xD;
     * @return Null.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNH18FJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNH18VJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNH18lJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_Y7ZIUFJNEeiyW7NaN4qWdw" name="ChooseFoundingFatherMessage">
                <ownedComment xmi:id="_aW2ZslJNEeiyW7NaN4qWdw">
                  <body>The message sent to choose a founding father.</body>
                </ownedComment>
                <generalization xmi:id="_aHyC8FJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aR8rkFJNEeiyW7NaN4qWdw" name="fathers" isLeaf="true" type="_aHqHIFJNEeiyW7NaN4qWdw" isOrdered="true" isReadOnly="true" association="_aYNroVJNEeiyW7NaN4qWdw">
                  <upperValue xmi:type="uml:LiteralUnlimitedNatural" xmi:id="_aR8rkVJNEeiyW7NaN4qWdw" value="*"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aR9SoFJNEeiyW7NaN4qWdw" name="foundingFatherId" visibility="private">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU3csFJNEeiyW7NaN4qWdw" name="ChooseFoundingFatherMessage" specification="_aNJEEFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU3csVJNEeiyW7NaN4qWdw" name="fathers" type="_aHo5AFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU3cslJNEeiyW7NaN4qWdw" name="ff" type="_aHqHIFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU3cs1JNEeiyW7NaN4qWdw" type="_Y7ZIUFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.fathers = new ArrayList&lt;>();&#xD;
     this.fathers.addAll(fathers);&#xD;
     setFather(ff);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU3ctFJNEeiyW7NaN4qWdw" name="ChooseFoundingFatherMessage" specification="_aNKSMFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU3ctVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU3ctlJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU3ct1JNEeiyW7NaN4qWdw" type="_Y7ZIUFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     final Specification spec = game.getSpecification();&#xD;
     this.fathers = new ArrayList&lt;>();&#xD;
     for (FoundingFatherType type : FoundingFatherType.values()) {&#xD;
         String id = element.getAttribute(type.toString());&#xD;
         if (id == null || id.isEmpty()) continue;&#xD;
         FoundingFather ff = spec.getFoundingFather(id);&#xD;
         this.fathers.add(ff);&#xD;
     }&#xD;
     foundingFatherId = element.getAttribute(&quot;foundingFather&quot;);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU3cuFJNEeiyW7NaN4qWdw" name="getFather" specification="_aNK5Q1JNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU3cuVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU3culJNEeiyW7NaN4qWdw" type="_aHqHIFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return (foundingFatherId == null) ? null&#xD;
         : game.getSpecification().getFoundingFather(this.foundingFatherId);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU4DwFJNEeiyW7NaN4qWdw" name="setFather" specification="_aNLgUVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU4DwVJNEeiyW7NaN4qWdw" name="ff" type="_aHqHIFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU4DwlJNEeiyW7NaN4qWdw" type="_Y7ZIUFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>this.foundingFatherId = (ff == null) ? null : ff.getId();&#xD;
     return this;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU4Dw1JNEeiyW7NaN4qWdw" name="handle" specification="_aNMHYFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU4DxFJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU4DxVJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU4DxlJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU4Dx1JNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final Game game = server.getGame();&#xD;
     final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
     final List&lt;FoundingFather> offered = serverPlayer.getOfferedFathers();&#xD;
     final FoundingFather ff = getFather(game);&#xD;
&#xD;
     if (!serverPlayer.canRecruitFoundingFather()) {&#xD;
         return DOMMessage.clientError(&quot;Player can not recruit fathers: &quot;&#xD;
             + serverPlayer.getId());&#xD;
     } else if (ff == null) {&#xD;
         return DOMMessage.clientError(&quot;No founding father selected&quot;);&#xD;
     } else if (!offered.contains(ff)) {&#xD;
         return DOMMessage.clientError(&quot;Founding father not offered: &quot;&#xD;
             + ff.getId());&#xD;
     }&#xD;
&#xD;
     serverPlayer.updateCurrentFather(ff);&#xD;
     return null;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU4DyFJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_Y7bkkFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU4DyVJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>Element result = createMessage(getXMLElementTagName());&#xD;
     for (FoundingFather f : getFathers()) {&#xD;
         result.setAttribute(f.getType().toString(), f.getId());&#xD;
     }&#xD;
     if (this.foundingFatherId != null) {&#xD;
         result.setAttribute(&quot;foundingFather&quot;, foundingFatherId);&#xD;
     }&#xD;
     return result;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU4DylJNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_Y7cysVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU4Dy1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;chooseFoundingFather&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_Y7bkkFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aU4DyFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aNMudFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y7cysVJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aU4DylJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW2ZuFJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;chooseFoundingFather&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y7cyslJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aNJEEFJNEeiyW7NaN4qWdw" name="ChooseFoundingFatherMessage" method="_aU3csFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aNJEE1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aNJEFFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aW2Zs1JNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>ChooseFoundingFatherMessage&lt;/code> with the specified&#xD;
     * fathers.&#xD;
     *&#xD;
     * @param fathers The &lt;code>FoundingFather&lt;/code>s to choose from.&#xD;
     * @param ff The &lt;code>FoundingFather&lt;/code> to select.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNJEEVJNEeiyW7NaN4qWdw" name="fathers" type="_aHo5AFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNJEElJNEeiyW7NaN4qWdw" name="ff" type="_aHqHIFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNJEFVJNEeiyW7NaN4qWdw" type="_Y7ZIUFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aNKSMFJNEeiyW7NaN4qWdw" name="ChooseFoundingFatherMessage" method="_aU3ctFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aNK5QFJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aNK5QVJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aW2ZtFJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>ChooseFoundingFatherMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNKSMVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNKSMlJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNK5QlJNEeiyW7NaN4qWdw" type="_Y7ZIUFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aNK5Q1JNEeiyW7NaN4qWdw" name="getFather" isLeaf="true" method="_aU3cuFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW2ZtVJNEeiyW7NaN4qWdw">
                    <body>Get the chosen father.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> to lookup the father in.&#xD;
     * @return The chosen &lt;code>FoundingFather&lt;/code>, or null if none set.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNK5RFJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNLgUFJNEeiyW7NaN4qWdw" type="_aHqHIFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aNLgUVJNEeiyW7NaN4qWdw" name="setFather" isLeaf="true" method="_aU4DwFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW2ZtlJNEeiyW7NaN4qWdw">
                    <body>Sets the chosen father.&#xD;
     *&#xD;
     * @param ff The &lt;code>FoundingFather&lt;/code> to choose.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNLgUlJNEeiyW7NaN4qWdw" name="ff" type="_aHqHIFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNLgU1JNEeiyW7NaN4qWdw" type="_Y7ZIUFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aNMHYFJNEeiyW7NaN4qWdw" name="handle" method="_aU4Dw1JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW2Zt1JNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;chooseFoundingFather&quot;-message.&#xD;
     * The server does not need to handle this message type.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the request.&#xD;
     * @param player The &lt;code>Player&lt;/code> abandoning the colony.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> the message is from.&#xD;
     *&#xD;
     * @return Null.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNMucFJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNMucVJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNMuclJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNMuc1JNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_Y7hEIFJNEeiyW7NaN4qWdw" name="ClaimLandMessage">
                <ownedComment xmi:id="_aW3AwFJNEeiyW7NaN4qWdw">
                  <body>The message sent when the client requests claiming land.</body>
                </ownedComment>
                <generalization xmi:id="_aH6l0FJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aR95sFJNEeiyW7NaN4qWdw" name="tileId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aR-gwVJNEeiyW7NaN4qWdw" name="claimantId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aR_H0VJNEeiyW7NaN4qWdw" name="priceString" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU4q0FJNEeiyW7NaN4qWdw" name="ClaimLandMessage" specification="_aNNVgFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU4q0VJNEeiyW7NaN4qWdw" name="tile" type="_aG4rEVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU4q0lJNEeiyW7NaN4qWdw" name="claimant" type="_aH3igFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU4q01JNEeiyW7NaN4qWdw" name="price">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aU4q1FJNEeiyW7NaN4qWdw" type="_Y7hEIFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.tileId = tile.getId();&#xD;
     this.claimantId = claimant.getId();&#xD;
     this.priceString = Integer.toString(price);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU4q1VJNEeiyW7NaN4qWdw" name="ClaimLandMessage" specification="_aNOjoFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU4q1lJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU4q11JNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU4q2FJNEeiyW7NaN4qWdw" type="_Y7hEIFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.tileId = element.getAttribute(&quot;tile&quot;);&#xD;
     this.claimantId = element.getAttribute(&quot;claimant&quot;);&#xD;
     this.priceString = element.getAttribute(&quot;price&quot;);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU5R4FJNEeiyW7NaN4qWdw" name="handle" specification="_aNPKsFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU5R4VJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU5R4lJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU5R41JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU5R5FJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
     final Game game = server.getGame();&#xD;
&#xD;
     Tile tile = game.getFreeColGameObject(tileId, Tile.class);&#xD;
     if (tile == null) {&#xD;
         return DOMMessage.clientError(&quot;Not a file: &quot; + tileId);&#xD;
     }&#xD;
&#xD;
     Unit unit = null;&#xD;
     try {&#xD;
         unit = player.getOurFreeColGameObject(claimantId, Unit.class);&#xD;
     } catch (IllegalStateException e) {} // Expected to fail sometimes...&#xD;
     Settlement settlement = null;&#xD;
     try {&#xD;
         settlement = player.getOurFreeColGameObject(claimantId,&#xD;
                                                     Settlement.class);&#xD;
     } catch (IllegalStateException e) {} // ...as is this one...&#xD;
     if (unit != null) {&#xD;
         if (unit.getTile() != tile) {&#xD;
             return DOMMessage.clientError(&quot;Unit not at tile: &quot; + tileId);&#xD;
         }&#xD;
     } else if (settlement != null) {&#xD;
         if (settlement.getOwner().isEuropean()&#xD;
             &amp;&amp; !settlement.getTile().isAdjacent(tile)) {&#xD;
             return DOMMessage.clientError(&quot;Settlement can not claim tile: &quot;&#xD;
                 + tileId);&#xD;
         }&#xD;
     } else { // ...but not both of them.&#xD;
         return DOMMessage.clientError(&quot;Not a unit or settlement: &quot;&#xD;
             + claimantId);&#xD;
     }&#xD;
&#xD;
     int price;&#xD;
     try {&#xD;
         price = Integer.parseInt(priceString);&#xD;
     } catch (NumberFormatException e) {&#xD;
         return DOMMessage.clientError(&quot;Bad price: &quot; + priceString);&#xD;
     }&#xD;
&#xD;
     // Request is well formed, but there are more possibilities...&#xD;
     int value = player.getLandPrice(tile);&#xD;
     Player owner = tile.getOwner();&#xD;
     Settlement ownerSettlement = tile.getOwningSettlement();&#xD;
     if (owner == null) { // unclaimed, always free&#xD;
         price = 0;&#xD;
     } else if (owner == player) { // capture vacant colony tiles only&#xD;
         if (settlement != null &amp;&amp; ownerSettlement != null&#xD;
             &amp;&amp; tile.isInUse()) {&#xD;
             return DOMMessage.clientError(&quot;Can not claim tile &quot;&#xD;
                 + tile.getId() + &quot;: already owned.&quot;);&#xD;
         }&#xD;
         price = 0;&#xD;
     } else if (owner.isEuropean()) {&#xD;
         if (tile.getOwningSettlement() == null  // its not &quot;nailed down&quot;&#xD;
             || tile.getOwningSettlement() == settlement) { // pre-attached&#xD;
             price = 0;&#xD;
         } else { // must fail&#xD;
             return DOMMessage.clientError(&quot;Can not claim tile &quot; &#xD;
                 + tile.getId() + &quot;: European owners will not sell.&quot;);&#xD;
         }&#xD;
     } else { // natives&#xD;
         NoClaimReason why = player.canClaimForSettlementReason(tile);&#xD;
         switch (why) {&#xD;
         case NONE:&#xD;
             break; // Succeed.&#xD;
         case NATIVES:&#xD;
             if (price >= 0) {&#xD;
                 if (price &lt; value) {&#xD;
                     return DOMMessage.clientError(&quot;Can not claim tile &quot;&#xD;
                         + tile.getId() + &quot;: insufficient offer.&quot;);&#xD;
                 }&#xD;
                 if (!player.checkGold(price)) {&#xD;
                     return DOMMessage.clientError(&quot;Can not pay for tile: &quot;&#xD;
                         + tile.getId() + &quot;: insufficient funds.&quot;);&#xD;
                 }&#xD;
                 // Succeed, sufficient offer&#xD;
             } // else succeed, stealing&#xD;
             break;&#xD;
         default: // Fail&#xD;
             return DOMMessage.clientError(&quot;Can not claim tile &quot;&#xD;
                 + tile.getId() + &quot;: &quot; + why);&#xD;
         }&#xD;
     }&#xD;
&#xD;
     // Proceed to claim.  Note, does not require unit, it is only&#xD;
     // required for permission checking above.  Settlement is required&#xD;
     // to set owning settlement.&#xD;
     return server.getInGameController()&#xD;
         .claimLand(serverPlayer, tile, settlement, price);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU5R5VJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_Y7kHcFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU5R5lJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return createMessage(getXMLElementTagName(),&#xD;
         &quot;tile&quot;, tileId,&#xD;
         &quot;claimant&quot;, claimantId,&#xD;
         &quot;price&quot;, priceString);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU5R51JNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_Y7lVkFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU5R6FJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;claimLand&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_Y7kHcFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aU5R5VJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aNPxwFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y7lVkFJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aU5R51JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW3n0FJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;claimLand&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y7lVkVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aNNVgFJNEeiyW7NaN4qWdw" name="ClaimLandMessage" method="_aU4q0FJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aNN8klJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aNN8k1JNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aW3AwVJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>ClaimLandMessage&lt;/code>.&#xD;
     *&#xD;
     * @param tile The &lt;code>Tile&lt;/code> to claim.&#xD;
     * @param claimant The &lt;code>Unit&lt;/code> or &lt;code>Settlement&lt;/code>&#xD;
     *     claiming the tile.&#xD;
     * @param price The price to pay for the tile, negative if stealing.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNNVgVJNEeiyW7NaN4qWdw" name="tile" type="_aG4rEVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNN8kFJNEeiyW7NaN4qWdw" name="claimant" type="_aH3igFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNN8kVJNEeiyW7NaN4qWdw" name="price">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aNN8lFJNEeiyW7NaN4qWdw" type="_Y7hEIFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aNOjoFJNEeiyW7NaN4qWdw" name="ClaimLandMessage" method="_aU4q1VJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aNOjo1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aNOjpFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aW3AwlJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>ClaimLandMessage&lt;/code> from a supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNOjoVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNOjolJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNOjpVJNEeiyW7NaN4qWdw" type="_Y7hEIFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aNPKsFJNEeiyW7NaN4qWdw" name="handle" method="_aU5R4FJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW3Aw1JNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;claimLand&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param player The &lt;code>Player&lt;/code> the message applies to.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> the message was from.&#xD;
     *&#xD;
     * @return An update, or error &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNPKsVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNPKslJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNPKs1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNPKtFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_Y7pnAFJNEeiyW7NaN4qWdw" name="ClearSpecialityMessage">
                <ownedComment xmi:id="_aW3n0VJNEeiyW7NaN4qWdw">
                  <body>The message sent when clearing a unit speciality.</body>
                </ownedComment>
                <generalization xmi:id="_aH9CEFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aR_u4FJNEeiyW7NaN4qWdw" name="unitId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU548FJNEeiyW7NaN4qWdw" name="ClearSpecialityMessage" specification="_aNQY0FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU548VJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU548lJNEeiyW7NaN4qWdw" type="_Y7pnAFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = unit.getId();&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU5481JNEeiyW7NaN4qWdw" name="ClearSpecialityMessage" specification="_aNQ_4FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU549FJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU549VJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU549lJNEeiyW7NaN4qWdw" type="_Y7pnAFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = element.getAttribute(&quot;unit&quot;);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU5491JNEeiyW7NaN4qWdw" name="handle" specification="_aNRm8VJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU54-FJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU54-VJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU54-lJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU54-1JNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
&#xD;
     Unit unit;&#xD;
     try {&#xD;
         unit = player.getOurFreeColGameObject(unitId, Unit.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     // Try to clear.&#xD;
     return server.getInGameController()&#xD;
         .clearSpeciality(serverPlayer, unit);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU6gAFJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_Y7rcMFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU6gAVJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return createMessage(getXMLElementTagName(),&#xD;
         &quot;unit&quot;, unitId);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU6gAlJNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_Y7sqUlJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU6gA1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;clearSpeciality&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_Y7rcMFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aU6gAFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aNSOAlJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y7sqUlJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aU6gAlJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW3n1VJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;clearSpeciality&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y7tRYFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aNQY0FJNEeiyW7NaN4qWdw" name="ClearSpecialityMessage" method="_aU548FJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aNQY0lJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aNQY01JNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aW3n0lJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>ClearSpecialityMessage&lt;/code> with the&#xD;
     * supplied unit.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> to clear.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNQY0VJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNQY1FJNEeiyW7NaN4qWdw" type="_Y7pnAFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aNQ_4FJNEeiyW7NaN4qWdw" name="ClearSpecialityMessage" method="_aU5481JNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aNQ_41JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aNQ_5FJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aW3n01JNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>ClearSpecialityMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNQ_4VJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNQ_4lJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNRm8FJNEeiyW7NaN4qWdw" type="_Y7pnAFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aNRm8VJNEeiyW7NaN4qWdw" name="handle" method="_aU5491JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW3n1FJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;clearSpeciality&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param player The &lt;code>Player&lt;/code> the message applies to.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     * @return An update containing the cleared unit, or an error&#xD;
     *     &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNRm8lJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNRm81JNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNSOAFJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNSOAVJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_Y7vtoFJNEeiyW7NaN4qWdw" name="Client" isLeaf="true">
                <ownedComment xmi:id="_aW3n1lJNEeiyW7NaN4qWdw">
                  <body>The client connection to a server.</body>
                </ownedComment>
                <ownedAttribute xmi:id="_aSA9AFJNEeiyW7NaN4qWdw" name="logger" visibility="private" isLeaf="true" isStatic="true" type="_aH_eUVJNEeiyW7NaN4qWdw" isReadOnly="true" association="_aYVAYFJNEeiyW7NaN4qWdw">
                  <defaultValue xmi:type="uml:LiteralString" xmi:id="_aSA9AVJNEeiyW7NaN4qWdw" value="Logger.getLogger(Client.class.getName())"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aSA9AlJNEeiyW7NaN4qWdw" name="c" visibility="private" isLeaf="true" type="_Y8LLcFJNEeiyW7NaN4qWdw" isReadOnly="true" association="_aYbuEVJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aSBkEVJNEeiyW7NaN4qWdw" name="host" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aSCLIFJNEeiyW7NaN4qWdw" name="port" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU7HEVJNEeiyW7NaN4qWdw" name="Client" specification="_aIBTgVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU7HElJNEeiyW7NaN4qWdw" name="host">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aU7HE1JNEeiyW7NaN4qWdw" name="port">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aU7HFFJNEeiyW7NaN4qWdw" name="handler" type="_ZAlKUFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU7HFVJNEeiyW7NaN4qWdw" name="name">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aU7HFlJNEeiyW7NaN4qWdw" type="_Y7vtoFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>this.host = host;&#xD;
     this.port = port;&#xD;
     c = new Connection(host, port, handler, name);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU7HF1JNEeiyW7NaN4qWdw" name="getHost" specification="_Y7yJ4FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU7HGFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return host;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU7uIFJNEeiyW7NaN4qWdw" name="getConnection" specification="_Y7yw8FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU7uIVJNEeiyW7NaN4qWdw" type="_Y8LLcFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return c;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU7uIlJNEeiyW7NaN4qWdw" name="setMessageHandler" specification="_aIChoVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU7uI1JNEeiyW7NaN4qWdw" name="mh" type="_ZAlKUFJNEeiyW7NaN4qWdw"/>
                  <language>java</language>
                  <body>c.setMessageHandler(mh);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU7uJFJNEeiyW7NaN4qWdw" name="disconnect" specification="_Y7zYAFJNEeiyW7NaN4qWdw">
                  <language>java</language>
                  <body>c.close();&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU7uJVJNEeiyW7NaN4qWdw" name="send" specification="_aIDIsFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU7uJlJNEeiyW7NaN4qWdw" name="message" type="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                  <language>java</language>
                  <body>c.send(message.toXMLElement());&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU8VMFJNEeiyW7NaN4qWdw" name="send" specification="_aNTcIFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU8VMVJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <language>java</language>
                  <body>c.send(element);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU8VMlJNEeiyW7NaN4qWdw" name="sendAndWait" specification="_aIDvwFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU8VM1JNEeiyW7NaN4qWdw" name="message" type="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                  <language>java</language>
                  <body>c.sendAndWait(message.toXMLElement());&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU8VNFJNEeiyW7NaN4qWdw" name="sendAndWait" specification="_aNTcIlJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU8VNVJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <language>java</language>
                  <body>c.sendAndWait(element);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU88QFJNEeiyW7NaN4qWdw" name="ask" specification="_aIEW0FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU88QVJNEeiyW7NaN4qWdw" name="message" type="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU88QlJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return c.ask(message.toXMLElement());&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU88Q1JNEeiyW7NaN4qWdw" name="ask" specification="_aNUqQFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU88RFJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU88RVJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return c.ask(element);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU88RlJNEeiyW7NaN4qWdw" name="handleReply" specification="_aNUqQ1JNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU88R1JNEeiyW7NaN4qWdw" name="reply" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU88SFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>if (reply != null) {&#xD;
         try {&#xD;
             return c.getMessageHandler().handle(c, reply);&#xD;
         } catch (FreeColException e) {&#xD;
             logger.log(Level.WARNING, &quot;Could not handle reply: &quot; + reply,&#xD;
                        e);&#xD;
         }&#xD;
     }&#xD;
     return null;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_Y7yJ4FJNEeiyW7NaN4qWdw" name="getHost" method="_aU7HF1JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW4O4VJNEeiyW7NaN4qWdw">
                    <body>Gets the host used by the connection.&#xD;
     *&#xD;
     * Used in reconnect.&#xD;
     *&#xD;
     * @return The host.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y7yJ4VJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_Y7yw8FJNEeiyW7NaN4qWdw" name="getConnection" method="_aU7uIFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW4O4lJNEeiyW7NaN4qWdw">
                    <body>Gets the &lt;code>Connection&lt;/code> this &lt;code>Client&lt;/code> uses&#xD;
     * when communicating with the server.&#xD;
     *&#xD;
     * @return The &lt;code>Connection&lt;/code>.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aIChoFJNEeiyW7NaN4qWdw" type="_Y8LLcFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y7zYAFJNEeiyW7NaN4qWdw" name="disconnect" method="_aU7uJFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW4O5FJNEeiyW7NaN4qWdw">
                    <body>Disconnects this client from the server.</body>
                  </ownedComment>
                </ownedOperation>
                <ownedOperation xmi:id="_aIBTgVJNEeiyW7NaN4qWdw" name="Client" method="_aU7HEVJNEeiyW7NaN4qWdw" raisedException="_aH-QMFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aIB6lFJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aIB6lVJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aW4O4FJNEeiyW7NaN4qWdw">
                    <body>Creates a new &lt;code>Client&lt;/code>.&#xD;
     *&#xD;
     * @param host The host to connect to.&#xD;
     * @param port The port to connect to.&#xD;
     * @param handler The &lt;code>MessageHandler&lt;code> to use.&#xD;
     * @param name The name for the connection.&#xD;
     * @exception IOException If an exception is thrown while creating&#xD;
     *     a new {@link Connection}.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aIB6kFJNEeiyW7NaN4qWdw" name="host">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aIB6kVJNEeiyW7NaN4qWdw" name="port">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aIB6klJNEeiyW7NaN4qWdw" name="handler" type="_ZAlKUFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aIB6k1JNEeiyW7NaN4qWdw" name="name">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aIB6llJNEeiyW7NaN4qWdw" type="_Y7vtoFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aIChoVJNEeiyW7NaN4qWdw" name="setMessageHandler" method="_aU7uIlJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW4O41JNEeiyW7NaN4qWdw">
                    <body>Sets the &lt;code>MessageHandler&lt;/code> for this &lt;code>Client&lt;/code>.&#xD;
     * The &lt;code>MessageHandler&lt;/code> is the class responsible for receiving&#xD;
     * and handling the network messages.&#xD;
     *&#xD;
     * @param mh The new &lt;code>MessageHandler&lt;/code> for this client.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aICholJNEeiyW7NaN4qWdw" name="mh" type="_ZAlKUFJNEeiyW7NaN4qWdw"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aIDIsFJNEeiyW7NaN4qWdw" name="send" method="_aU7uJVJNEeiyW7NaN4qWdw" raisedException="_aH-QMFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW4O5VJNEeiyW7NaN4qWdw">
                    <body>Sends the specified message to the server.&#xD;
     *&#xD;
     * @param message The &lt;code>DOMMessage&lt;/code> to send.&#xD;
     * @see #sendAndWait(Element)&#xD;
     * @see #ask(Element)&#xD;
     * @exception IOException</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aIDIsVJNEeiyW7NaN4qWdw" name="message" type="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aIDvwFJNEeiyW7NaN4qWdw" name="sendAndWait" method="_aU8VMlJNEeiyW7NaN4qWdw" raisedException="_aH-QMFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW418FJNEeiyW7NaN4qWdw">
                    <body>Sends the specified message to the server and waits for the reply&#xD;
     * to be returned before returning from this method.&#xD;
     *&#xD;
     * @param message The &lt;code>DOMMessage&lt;/code> to send.&#xD;
     * @see #send(Element)&#xD;
     * @see #ask(Element)&#xD;
     * @exception IOException</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aIDvwVJNEeiyW7NaN4qWdw" name="message" type="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aIEW0FJNEeiyW7NaN4qWdw" name="ask" method="_aU88QFJNEeiyW7NaN4qWdw" raisedException="_aH-QMFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW418lJNEeiyW7NaN4qWdw">
                    <body>Sends the specified message to the server and returns the reply.&#xD;
     *&#xD;
     * @param message The &lt;code>DOMMessage&lt;/code> to send.&#xD;
     * @return The answer from the server or &lt;code>null&lt;/code> if either&#xD;
     *       an error occured or the server did not send a reply.&#xD;
     * @see #sendAndWait&#xD;
     * @see #send&#xD;
     * @exception IOException</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aIEW0VJNEeiyW7NaN4qWdw" name="message" type="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNUDMVJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aNTcIFJNEeiyW7NaN4qWdw" name="send" method="_aU8VMFJNEeiyW7NaN4qWdw" raisedException="_aH-QMFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW4O5lJNEeiyW7NaN4qWdw">
                    <body>Sends the specified message to the server.&#xD;
     *&#xD;
     * @param element The element (root element in a DOM-parsed XML tree) that&#xD;
     *                holds all the information&#xD;
     * @see #sendAndWait(Element)&#xD;
     * @see #ask(Element)&#xD;
     * @exception IOException</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNTcIVJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aNTcIlJNEeiyW7NaN4qWdw" name="sendAndWait" method="_aU8VNFJNEeiyW7NaN4qWdw" raisedException="_aH-QMFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW418VJNEeiyW7NaN4qWdw">
                    <body>Sends the specified message to the server and waits for the reply&#xD;
     * to be returned before returning from this method.&#xD;
     *&#xD;
     * @param element The element (root element in a DOM-parsed XML tree) that&#xD;
     *                holds all the information&#xD;
     * @see #send(Element)&#xD;
     * @see #ask(Element)&#xD;
     * @exception IOException</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNUDMFJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aNUqQFJNEeiyW7NaN4qWdw" name="ask" method="_aU88Q1JNEeiyW7NaN4qWdw" raisedException="_aH-QMFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW4181JNEeiyW7NaN4qWdw">
                    <body>Sends the specified message to the server and returns the reply.&#xD;
     *&#xD;
     * @param element The element (root element in a DOM-parsed XML tree)&#xD;
     *       that holds all the information&#xD;
     * @return The answer from the server or &lt;code>null&lt;/code> if either&#xD;
     *       an error occured or the server did not send a reply.&#xD;
     * @see #sendAndWait&#xD;
     * @see #send&#xD;
     * @exception IOException</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNUqQVJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNUqQlJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aNUqQ1JNEeiyW7NaN4qWdw" name="handleReply" method="_aU88RlJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW419FJNEeiyW7NaN4qWdw">
                    <body>Handle a reply element using the client input handler.&#xD;
     *&#xD;
     * @param reply The reply &lt;code>Element&lt;/code> to handle.&#xD;
     * @return The reply &lt;code>Element&lt;/code>.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNUqRFJNEeiyW7NaN4qWdw" name="reply" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNVRUFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_Y7--MFJNEeiyW7NaN4qWdw" name="CloseTransactionMessage">
                <ownedComment xmi:id="_aW419VJNEeiyW7NaN4qWdw">
                  <body>The message sent to initiate a transaction.</body>
                </ownedComment>
                <generalization xmi:id="_aIIBMFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aSDZQFJNEeiyW7NaN4qWdw" name="unitId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aSEAUVJNEeiyW7NaN4qWdw" name="settlementId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU9jUFJNEeiyW7NaN4qWdw" name="CloseTransactionMessage" specification="_aNV4YFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU9jUVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU9jUlJNEeiyW7NaN4qWdw" name="settlement" type="_aHKX4VJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU9jU1JNEeiyW7NaN4qWdw" type="_Y7--MFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = unit.getId();&#xD;
     this.settlementId = settlement.getId();&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU-KYFJNEeiyW7NaN4qWdw" name="CloseTransactionMessage" specification="_aNWfcFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU-KYVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU-KYlJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU-KY1JNEeiyW7NaN4qWdw" type="_Y7--MFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = element.getAttribute(&quot;unit&quot;);&#xD;
     this.settlementId = element.getAttribute(&quot;settlement&quot;);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU-KZFJNEeiyW7NaN4qWdw" name="handle" specification="_aNXGgFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU-KZVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU-KZlJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU-KZ1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU-KaFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
&#xD;
     Unit unit;&#xD;
     try {&#xD;
         unit = player.getOurFreeColGameObject(unitId, Unit.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     Settlement settlement;&#xD;
     try {&#xD;
         settlement = unit.getAdjacentSettlementSafely(settlementId);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     // Proceed to close&#xD;
     return server.getInGameController()&#xD;
         .closeTransaction(serverPlayer, unit, settlement);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU-KaVJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_Y8CokFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU-KalJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return createMessage(getXMLElementTagName(),&#xD;
         &quot;unit&quot;, unitId,&#xD;
         &quot;settlement&quot;, settlementId);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU-Ka1JNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_Y8Fr4FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU-KbFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;closeTransaction&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_Y8CokFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aU-KaVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aNXtlFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y8Fr4FJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aU-Ka1JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW5dAlJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;closeTransaction&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y8GS8FJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aNV4YFJNEeiyW7NaN4qWdw" name="CloseTransactionMessage" method="_aU9jUFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aNV4Y1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aNV4ZFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aW419lJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>CloseTransactionMessage&lt;/code> with the&#xD;
     * supplied unit and settlement.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> performing the transaction.&#xD;
     * @param settlement The &lt;code>Settlement&lt;/code> where the&#xD;
     *        transaction occurs.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNV4YVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNV4YlJNEeiyW7NaN4qWdw" name="settlement" type="_aHKX4VJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNV4ZVJNEeiyW7NaN4qWdw" type="_Y7--MFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aNWfcFJNEeiyW7NaN4qWdw" name="CloseTransactionMessage" method="_aU-KYFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aNWfc1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aNWfdFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aW5dAFJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>CloseTransactionMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNWfcVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNWfclJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNWfdVJNEeiyW7NaN4qWdw" type="_Y7--MFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aNXGgFJNEeiyW7NaN4qWdw" name="handle" method="_aU-KZFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW5dAVJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;closeTransaction&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param player The &lt;code>Player&lt;/code> the message applies to.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     * @return Null, or an error &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNXtkFJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNXtkVJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNXtklJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNXtk1JNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_Y8LLcFJNEeiyW7NaN4qWdw" name="Connection">
                <ownedComment xmi:id="_aW5dA1JNEeiyW7NaN4qWdw">
                  <body>A network connection.&#xD;
Responsible for both sending and receiving network messages.&#xD;
 *&#xD;
@see #send(Element)&#xD;
@see #sendAndWait(Element)&#xD;
@see #ask(Element)</body>
                </ownedComment>
                <ownedAttribute xmi:id="_aSF1gFJNEeiyW7NaN4qWdw" name="logger" visibility="private" isLeaf="true" isStatic="true" type="_aH_eUVJNEeiyW7NaN4qWdw" isReadOnly="true" association="_aYjC0FJNEeiyW7NaN4qWdw">
                  <defaultValue xmi:type="uml:LiteralString" xmi:id="_aSF1gVJNEeiyW7NaN4qWdw" value="Logger.getLogger(Connection.class.getName())"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aSF1glJNEeiyW7NaN4qWdw" name="DISCONNECT_TAG" isLeaf="true" isStatic="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  <defaultValue xmi:type="uml:LiteralString" xmi:id="_aSF1g1JNEeiyW7NaN4qWdw" value="&quot;disconnect&quot;"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aSGckFJNEeiyW7NaN4qWdw" name="NETWORK_REPLY_ID_TAG" isLeaf="true" isStatic="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  <defaultValue xmi:type="uml:LiteralString" xmi:id="_aSGckVJNEeiyW7NaN4qWdw" value="&quot;networkReplyId&quot;"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aSGcklJNEeiyW7NaN4qWdw" name="QUESTION_TAG" isLeaf="true" isStatic="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  <defaultValue xmi:type="uml:LiteralString" xmi:id="_aSGck1JNEeiyW7NaN4qWdw" value="&quot;question&quot;"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aSGclFJNEeiyW7NaN4qWdw" name="REPLY_TAG" isLeaf="true" isStatic="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  <defaultValue xmi:type="uml:LiteralString" xmi:id="_aSHDoFJNEeiyW7NaN4qWdw" value="&quot;reply&quot;"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aSHDoVJNEeiyW7NaN4qWdw" name="SEND_SUFFIX" isLeaf="true" isStatic="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  <defaultValue xmi:type="uml:LiteralString" xmi:id="_aSHDolJNEeiyW7NaN4qWdw" value="&quot;-send\n&quot;"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aSHDo1JNEeiyW7NaN4qWdw" name="REPLY_SUFFIX" isLeaf="true" isStatic="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  <defaultValue xmi:type="uml:LiteralString" xmi:id="_aSHDpFJNEeiyW7NaN4qWdw" value="&quot;-reply\n&quot;"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aSHDpVJNEeiyW7NaN4qWdw" name="TIMEOUT" visibility="private" isLeaf="true" isStatic="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  <defaultValue xmi:type="uml:LiteralString" xmi:id="_aSHqsFJNEeiyW7NaN4qWdw" value="5000"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aSHqsVJNEeiyW7NaN4qWdw" name="in" visibility="private" type="_aILrkVJNEeiyW7NaN4qWdw" association="_aYqXkVJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aSHqs1JNEeiyW7NaN4qWdw" name="socket" type="_aIPV8VJNEeiyW7NaN4qWdw" isReadOnly="true" association="_aY3L4VJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aSIRwFJNEeiyW7NaN4qWdw" name="out" visibility="private" type="_aIMSoVJNEeiyW7NaN4qWdw" association="_aY_HsFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aSIRwlJNEeiyW7NaN4qWdw" name="xmlTransformer" visibility="private" isLeaf="true" type="_aIRyMVJNEeiyW7NaN4qWdw" isReadOnly="true" association="_aZF1YVJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aSI40VJNEeiyW7NaN4qWdw" name="thread" visibility="private" type="_ZClVcFJNEeiyW7NaN4qWdw" association="_aZNKIVJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aSI401JNEeiyW7NaN4qWdw" name="messageHandler" type="_ZAlKUFJNEeiyW7NaN4qWdw" association="_aW6rIFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aSJf4FJNEeiyW7NaN4qWdw" name="name" visibility="private">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aSJf4lJNEeiyW7NaN4qWdw" name="logResult" visibility="private" isLeaf="true" type="_aIU1gVJNEeiyW7NaN4qWdw" isReadOnly="true" association="_aZUe4VJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aSKG8VJNEeiyW7NaN4qWdw" name="logWriter" visibility="private" isLeaf="true" type="_aINgwVJNEeiyW7NaN4qWdw" isReadOnly="true" association="_aZbzoFJNEeiyW7NaN4qWdw"/>
                <interfaceRealization xmi:id="_aNYUoFJNEeiyW7NaN4qWdw" client="_Y8LLcFJNEeiyW7NaN4qWdw" supplier="_aILEgVJNEeiyW7NaN4qWdw" contract="_aILEgVJNEeiyW7NaN4qWdw"/>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU-xcFJNEeiyW7NaN4qWdw" name="Connection" specification="_Y8OOwFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU-xcVJNEeiyW7NaN4qWdw" name="name">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aU-xclJNEeiyW7NaN4qWdw" type="_Y8LLcFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>this.in = null;&#xD;
     this.socket = null;&#xD;
     this.out = null;&#xD;
     Transformer myTransformer = null;&#xD;
     try {&#xD;
         TransformerFactory factory = TransformerFactory.newInstance();&#xD;
         myTransformer = factory.newTransformer();&#xD;
         myTransformer.setOutputProperty(OutputKeys.OMIT_XML_DECLARATION,&#xD;
                                         &quot;yes&quot;);&#xD;
     } catch (TransformerException e) {&#xD;
         logger.log(Level.WARNING, &quot;Failed to install transformer!&quot;, e);&#xD;
     }&#xD;
     this.xmlTransformer = myTransformer;&#xD;
     this.thread = null;&#xD;
     this.messageHandler = null;&#xD;
     this.name = name;&#xD;
     if (FreeColDebugger.isInDebugMode(FreeColDebugger.DebugMode.COMMS)) {&#xD;
         this.logWriter = new BufferedWriter(new OutputStreamWriter(System.err));&#xD;
         this.logResult = new StreamResult(this.logWriter);&#xD;
     } else {&#xD;
         this.logWriter = null;&#xD;
         this.logResult = null;&#xD;
     }&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU_YgFJNEeiyW7NaN4qWdw" name="Connection" specification="_aIZG8FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU_YgVJNEeiyW7NaN4qWdw" name="host">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aU_YglJNEeiyW7NaN4qWdw" name="port">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aU_Yg1JNEeiyW7NaN4qWdw" name="messageHandler" type="_ZAlKUFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU_YhFJNEeiyW7NaN4qWdw" name="name">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aU_YhVJNEeiyW7NaN4qWdw" type="_Y8LLcFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>this(createSocket(host, port), messageHandler, name);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU_YhlJNEeiyW7NaN4qWdw" name="Connection" specification="_aNaJ0FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU_Yh1JNEeiyW7NaN4qWdw" name="socket" type="_aIPV8VJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU_YiFJNEeiyW7NaN4qWdw" name="messageHandler" type="_ZAlKUFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aU_YiVJNEeiyW7NaN4qWdw" name="name">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aU_YilJNEeiyW7NaN4qWdw" type="_Y8LLcFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>this(name);&#xD;
&#xD;
     this.socket = socket;&#xD;
     this.in = socket.getInputStream();&#xD;
     this.out = socket.getOutputStream();&#xD;
     this.thread = new ReceivingThread(this, in, name);&#xD;
     this.messageHandler = messageHandler;&#xD;
     this.name = name;&#xD;
&#xD;
     thread.start();&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU_Yi1JNEeiyW7NaN4qWdw" name="createSocket" specification="_Y8QrAFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU_YjFJNEeiyW7NaN4qWdw" name="host">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aU_YjVJNEeiyW7NaN4qWdw" name="port">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aU_YjlJNEeiyW7NaN4qWdw" type="_aIPV8VJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>Socket socket = new Socket();&#xD;
     SocketAddress addr = new InetSocketAddress(host, port);&#xD;
     socket.connect(addr, TIMEOUT);&#xD;
     return socket;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU__kFJNEeiyW7NaN4qWdw" name="isAlive" specification="_Y8R5IFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU__kVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return this.socket != null;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU__klJNEeiyW7NaN4qWdw" name="getName" specification="_Y8SgMFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU__k1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return name;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU__lFJNEeiyW7NaN4qWdw" name="getOutputStream" specification="_Y8SgMlJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aU__lVJNEeiyW7NaN4qWdw" type="_aIMSoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return this.out;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU__llJNEeiyW7NaN4qWdw" name="closeOutputStream" specification="_Y8THQlJNEeiyW7NaN4qWdw">
                  <language>java</language>
                  <body>if (this.out != null) {&#xD;
         try {&#xD;
             this.out.close();&#xD;
         } catch (IOException ioe) {&#xD;
             logger.log(Level.WARNING, &quot;Error closing output&quot;, ioe);&#xD;
         } finally {&#xD;
             this.out = null;&#xD;
         }&#xD;
     }&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU__l1JNEeiyW7NaN4qWdw" name="close" specification="_Y8TuUVJNEeiyW7NaN4qWdw">
                  <language>java</language>
                  <body>try {&#xD;
         send(DOMMessage.createMessage(DISCONNECT_TAG));&#xD;
     } catch (IOException ioe) {&#xD;
         logger.fine(&quot;Error disconnecting &quot; + this.name&#xD;
             + &quot;: &quot; + ioe.getMessage());&#xD;
     } finally {&#xD;
         reallyClose();&#xD;
     }&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aU__mFJNEeiyW7NaN4qWdw" name="reallyClose" specification="_Y8U8clJNEeiyW7NaN4qWdw">
                  <language>java</language>
                  <body>if (this.thread != null) thread.askToStop();&#xD;
&#xD;
     closeOutputStream();&#xD;
     if (this.in != null) {&#xD;
         try {&#xD;
             this.in.close();&#xD;
         } catch (IOException ioe) {&#xD;
             logger.log(Level.WARNING, &quot;Error closing input&quot;, ioe);&#xD;
         } finally {&#xD;
             this.in = null;&#xD;
         }&#xD;
     }&#xD;
     if (this.socket != null) {&#xD;
         try {&#xD;
             this.socket.close();&#xD;
         } catch (IOException ioe) {&#xD;
             logger.log(Level.WARNING, &quot;Error closing socket&quot;, ioe);&#xD;
         } finally {&#xD;
             this.socket = null;&#xD;
         }&#xD;
     }&#xD;
&#xD;
     logger.fine(&quot;Connection really closed for &quot; + this.name);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVAmoFJNEeiyW7NaN4qWdw" name="log" specification="_aNbX8FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVAmoVJNEeiyW7NaN4qWdw" name="e" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVAmolJNEeiyW7NaN4qWdw" name="send">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>log(new DOMSource(e), send);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVAmo1JNEeiyW7NaN4qWdw" name="log" specification="_aNb_AFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVAmpFJNEeiyW7NaN4qWdw" name="source" type="_aIUOcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVAmpVJNEeiyW7NaN4qWdw" name="send">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>if (this.logResult != null) {&#xD;
         try {&#xD;
             this.logWriter.write(name, 0, name.length());&#xD;
             if (send) {&#xD;
                 this.logWriter.write(SEND_SUFFIX, 0, SEND_SUFFIX.length());&#xD;
             } else {&#xD;
                 this.logWriter.write(REPLY_SUFFIX, 0, REPLY_SUFFIX.length());&#xD;
             }&#xD;
             this.xmlTransformer.transform(source, this.logResult);&#xD;
             this.logWriter.write('\n');&#xD;
             this.logWriter.flush();&#xD;
         } catch (IOException|TransformerException e) {&#xD;
             ; // Ignore logging failure&#xD;
         }&#xD;
     }&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVAmplJNEeiyW7NaN4qWdw" name="sendInternal" specification="_aNcmEFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVAmp1JNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <language>java</language>
                  <body>OutputStream os = getOutputStream();&#xD;
     if (os != null) {&#xD;
         DOMSource source = new DOMSource(element);&#xD;
         try {&#xD;
             xmlTransformer.transform(source, new StreamResult(os));&#xD;
         } catch (TransformerException te) {&#xD;
             logger.log(Level.WARNING, &quot;Failed to transform&quot;, te);&#xD;
         }&#xD;
         os.write('\n');&#xD;
         os.flush();&#xD;
         log(source, true);&#xD;
     }&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVAmqFJNEeiyW7NaN4qWdw" name="askInternal" specification="_aNcmElJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVAmqVJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVAmqlJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>int networkReplyId = thread.getNextNetworkReplyId();&#xD;
     String tag = element.getTagName();&#xD;
&#xD;
     if (Thread.currentThread() == thread) {&#xD;
         throw new IOException(&quot;wait(ReceivingThread) for: &quot; + tag);&#xD;
     }&#xD;
&#xD;
     Element question = element.getOwnerDocument()&#xD;
         .createElement(QUESTION_TAG);&#xD;
     question.setAttribute(NETWORK_REPLY_ID_TAG,&#xD;
                           Integer.toString(networkReplyId));&#xD;
     question.appendChild(element);&#xD;
&#xD;
     NetworkReplyObject nro = thread.waitForNetworkReply(networkReplyId);&#xD;
     sendInternal(question);&#xD;
     DOMMessage response = (DOMMessage)nro.getResponse();&#xD;
     Element reply = (response == null) ? null&#xD;
         : response.getDocument().getDocumentElement();&#xD;
     log(reply, false);&#xD;
&#xD;
     Element child = (reply==null) ? null : (Element)reply.getFirstChild();&#xD;
     return child;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVBNsFJNEeiyW7NaN4qWdw" name="send" specification="_aNdNIVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVBNsVJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <language>java</language>
                  <body>sendInternal(element);&#xD;
     logger.fine(&quot;Send: &quot; + element.getTagName());&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVBNslJNEeiyW7NaN4qWdw" name="sendAndWait" specification="_aNd0MFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVBNs1JNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <language>java</language>
                  <body>askInternal(element);&#xD;
     logger.fine(&quot;SendAndWait: &quot; + element.getTagName());&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVBNtFJNEeiyW7NaN4qWdw" name="ask" specification="_aNebQVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVBNtVJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVBNtlJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>Element reply = askInternal(element);&#xD;
     logger.fine(&quot;Ask: &quot; + element.getTagName()&#xD;
         + &quot;, reply: &quot; + ((reply == null) ? &quot;null&quot; : reply.getTagName()));&#xD;
     return reply;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVB0wFJNEeiyW7NaN4qWdw" name="handleAndSendReply" specification="_aNfCUFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVB0wVJNEeiyW7NaN4qWdw" name="in" type="_aIJ2YFJNEeiyW7NaN4qWdw">
                    <eAnnotations xmi:id="_aVB0wlJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                      <details xmi:id="_aVB0w1JNEeiyW7NaN4qWdw" key="final"/>
                    </eAnnotations>
                  </ownedParameter>
                  <language>java</language>
                  <body>in.mark(200); // Peek at the reply identifier and tag.&#xD;
&#xD;
     // Extract the reply id and check if this is a question.&#xD;
     final String networkReplyId;&#xD;
     final boolean question;&#xD;
     FreeColXMLReader xr = null;&#xD;
     try {&#xD;
         xr = new FreeColXMLReader(in);&#xD;
         xr.nextTag();&#xD;
         question = QUESTION_TAG.equals(xr.getLocalName());&#xD;
         networkReplyId = xr.getAttribute(NETWORK_REPLY_ID_TAG,&#xD;
                                          (String)null);&#xD;
&#xD;
     } catch (XMLStreamException xse) {&#xD;
         logger.log(Level.WARNING, &quot;XML stream failure&quot;, xse);&#xD;
         return;&#xD;
     } &#xD;
&#xD;
     // Reset and build a message.&#xD;
     final DOMMessage msg;&#xD;
     in.reset();&#xD;
     try {&#xD;
         msg = new DOMMessage(in);&#xD;
     } catch (SAXException e) {&#xD;
         logger.log(Level.WARNING, &quot;Unable to read message.&quot;, e);&#xD;
         return;&#xD;
     } finally {&#xD;
         if (xr != null) xr.close();&#xD;
     }&#xD;
&#xD;
     // Process the message in its own thread.&#xD;
     final Connection conn = this;&#xD;
     Thread t = new Thread(msg.getType()) {&#xD;
             @Override&#xD;
             public void run() {&#xD;
                 Element element = msg.getDocument().getDocumentElement();&#xD;
                 Element reply;&#xD;
                 try {&#xD;
                     if (question) {&#xD;
                         reply = (Element)element.getFirstChild();&#xD;
                         reply = conn.handle(reply);&#xD;
                         if (reply == null) {&#xD;
                             reply = DOMMessage.createMessage(REPLY_TAG,&#xD;
                                 NETWORK_REPLY_ID_TAG, networkReplyId);&#xD;
                         } else {&#xD;
                             Element header = reply.getOwnerDocument()&#xD;
                                 .createElement(REPLY_TAG);&#xD;
                             header.setAttribute(NETWORK_REPLY_ID_TAG,&#xD;
                                                 networkReplyId);&#xD;
                             header.appendChild(reply);&#xD;
                             reply = header;&#xD;
                         }&#xD;
                     } else {&#xD;
                         reply = conn.handle(element);&#xD;
                     }&#xD;
                     if (reply != null) conn.send(reply);&#xD;
                 } catch (Exception e) {&#xD;
                     logger.log(Level.WARNING, &quot;Handler failed: &quot;&#xD;
                         + element, e);&#xD;
                 }&#xD;
             }&#xD;
         };&#xD;
     t.setName(name + &quot;-MessageHandler-&quot; + t.getName());&#xD;
     t.start();&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVCb0FJNEeiyW7NaN4qWdw" name="handle" specification="_aNfpYFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVCb0VJNEeiyW7NaN4qWdw" name="request" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVCb0lJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return messageHandler.handle(this, request);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVCb01JNEeiyW7NaN4qWdw" name="toString" specification="_Y8X_wFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVCb1FJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;[Connection &quot; + name + &quot; (&quot; + socket + &quot;)]&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_Y8OOwFJNEeiyW7NaN4qWdw" name="Connection" visibility="protected" method="_aU-xcFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_Y8O10VJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_Y8O10lJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aW7SMVJNEeiyW7NaN4qWdw">
                    <body>Trivial constructor.&#xD;
     *&#xD;
     * @param name The name of the connection.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y8O10FJNEeiyW7NaN4qWdw" name="name">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Y8O101JNEeiyW7NaN4qWdw" type="_Y8LLcFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y8QrAFJNEeiyW7NaN4qWdw" name="createSocket" visibility="private" isStatic="true" method="_aU_Yi1JNEeiyW7NaN4qWdw" raisedException="_aH-QMFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW75QlJNEeiyW7NaN4qWdw">
                    <body>Creates a socket to communication with a given host, port pair.&#xD;
     *&#xD;
     * @param host The host to connect to.&#xD;
     * @param port The port to connect to.&#xD;
     * @exception IOException on failure to create/connect the socket.&#xD;
     * @return A new socket.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y8QrAVJNEeiyW7NaN4qWdw" name="host">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Y8QrAlJNEeiyW7NaN4qWdw" name="port">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aNaw4FJNEeiyW7NaN4qWdw" type="_aIPV8VJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y8R5IFJNEeiyW7NaN4qWdw" name="isAlive" method="_aU__kFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW75Q1JNEeiyW7NaN4qWdw">
                    <body>Is this connection alive?&#xD;
     *&#xD;
     * @return True if the connection is alive.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y8R5IVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_Y8SgMFJNEeiyW7NaN4qWdw" name="getName" method="_aU__klJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW75RFJNEeiyW7NaN4qWdw">
                    <body>Gets the connection name.&#xD;
     *&#xD;
     * @return The connection name.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y8SgMVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_Y8SgMlJNEeiyW7NaN4qWdw" name="getOutputStream" visibility="private" method="_aU__lFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_Y8THQFJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_Y8THQVJNEeiyW7NaN4qWdw" key="synchronized"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aW75RVJNEeiyW7NaN4qWdw">
                    <body>Get the output stream.&#xD;
     *&#xD;
     * @return The output stream.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNaw4VJNEeiyW7NaN4qWdw" type="_aIMSoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y8THQlJNEeiyW7NaN4qWdw" name="closeOutputStream" visibility="private" method="_aU__llJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_Y8THQ1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_Y8TuUFJNEeiyW7NaN4qWdw" key="synchronized"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aW75RlJNEeiyW7NaN4qWdw">
                    <body>Close and clear the output stream.</body>
                  </ownedComment>
                </ownedOperation>
                <ownedOperation xmi:id="_Y8TuUVJNEeiyW7NaN4qWdw" name="close" method="_aU__l1JNEeiyW7NaN4qWdw"/>
                <ownedOperation xmi:id="_Y8U8clJNEeiyW7NaN4qWdw" name="reallyClose" method="_aU__mFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW75R1JNEeiyW7NaN4qWdw">
                    <body>Really closes this connection.</body>
                  </ownedComment>
                </ownedOperation>
                <ownedOperation xmi:id="_Y8X_wFJNEeiyW7NaN4qWdw" name="toString" method="_aVCb01JNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Y8X_wVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aIZG8FJNEeiyW7NaN4qWdw" name="Connection" method="_aU_YgFJNEeiyW7NaN4qWdw" raisedException="_aH-QMFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aIZuAFJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aIZuAVJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aW75QFJNEeiyW7NaN4qWdw">
                    <body>Sets up a new socket with specified host and port and uses&#xD;
     * {@link #Connection(Socket, MessageHandler, String)}.&#xD;
     *&#xD;
     * @param host The host to connect to.&#xD;
     * @param port The port to connect to.&#xD;
     * @param messageHandler The MessageHandler to call for each message&#xD;
     *     received.&#xD;
     * @exception IOException</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aIZG8VJNEeiyW7NaN4qWdw" name="host">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aIZG8lJNEeiyW7NaN4qWdw" name="port">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aIZG81JNEeiyW7NaN4qWdw" name="messageHandler" type="_ZAlKUFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aIZG9FJNEeiyW7NaN4qWdw" name="name">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aIZuAlJNEeiyW7NaN4qWdw" type="_Y8LLcFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aNaJ0FJNEeiyW7NaN4qWdw" name="Connection" method="_aU_YhlJNEeiyW7NaN4qWdw" raisedException="_aH-QMFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aNaJ1FJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aNaJ1VJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aW75QVJNEeiyW7NaN4qWdw">
                    <body>Creates a new &lt;code>Connection&lt;/code> with the specified&#xD;
     * &lt;code>Socket&lt;/code> and {@link MessageHandler}.&#xD;
     *&#xD;
     * @param socket The socket to the client.&#xD;
     * @param messageHandler The MessageHandler to call for each message&#xD;
     *     received.&#xD;
     * @exception IOException</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNaJ0VJNEeiyW7NaN4qWdw" name="socket" type="_aIPV8VJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNaJ0lJNEeiyW7NaN4qWdw" name="messageHandler" type="_ZAlKUFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNaJ01JNEeiyW7NaN4qWdw" name="name">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aNaJ1lJNEeiyW7NaN4qWdw" type="_Y8LLcFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aNbX8FJNEeiyW7NaN4qWdw" name="log" visibility="protected" method="_aVAmoFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW8gUFJNEeiyW7NaN4qWdw">
                    <body>Log transfer of an element.&#xD;
     *&#xD;
     * @param e The &lt;code>Element&lt;/code> to log.&#xD;
     * @param send True if sending (else replying).</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNbX8VJNEeiyW7NaN4qWdw" name="e" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNbX8lJNEeiyW7NaN4qWdw" name="send">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aNb_AFJNEeiyW7NaN4qWdw" name="log" visibility="protected" method="_aVAmo1JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW8gUVJNEeiyW7NaN4qWdw">
                    <body>Log transfer of a DOMSource.&#xD;
     *&#xD;
     * @param source The &lt;code>DOMSource&lt;/code> to log.&#xD;
     * @param send True if sending (else replying).</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNb_AVJNEeiyW7NaN4qWdw" name="source" type="_aIUOcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNb_AlJNEeiyW7NaN4qWdw" name="send">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aNcmEFJNEeiyW7NaN4qWdw" name="sendInternal" visibility="private" method="_aVAmplJNEeiyW7NaN4qWdw" raisedException="_aH-QMFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW8gUlJNEeiyW7NaN4qWdw">
                    <body>Low level routine to send a message over this Connection.&#xD;
     *&#xD;
     * @param element The &lt;code>Element&lt;/code> (root element in a&#xD;
     *     DOM-parsed XML tree) that holds all the information&#xD;
     * @exception IOException If an error occur while sending the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNcmEVJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aNcmElJNEeiyW7NaN4qWdw" name="askInternal" visibility="private" method="_aVAmqFJNEeiyW7NaN4qWdw" raisedException="_aH-QMFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW8gU1JNEeiyW7NaN4qWdw">
                    <body>Low level routine to sends a message and return the reply.&#xD;
     *&#xD;
     * @param element The question for the other peer.&#xD;
     * @return The reply from the other peer.&#xD;
     * @exception IOException if an error occur while sending the message.&#xD;
     * @see #sendInternal(Element)</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNcmE1JNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNdNIFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aNdNIVJNEeiyW7NaN4qWdw" name="send" method="_aVBNsFJNEeiyW7NaN4qWdw" raisedException="_aH-QMFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW8gVFJNEeiyW7NaN4qWdw">
                    <body>Main public routine to send a message over this connection.&#xD;
     *&#xD;
     * @param element The &lt;code>Element&lt;/code> (root element in a&#xD;
     *     DOM-parsed XML tree) that holds all the information&#xD;
     * @exception IOException If an error occur while sending the message.&#xD;
     * @see #sendAndWait(Element)&#xD;
     * @see #ask(Element)</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNdNIlJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aNd0MFJNEeiyW7NaN4qWdw" name="sendAndWait" method="_aVBNslJNEeiyW7NaN4qWdw" raisedException="_aH-QMFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW8gVVJNEeiyW7NaN4qWdw">
                    <body>Sends the given message over this connection and waits for&#xD;
     * confirmation of reception before returning.&#xD;
     *&#xD;
     * @param element The element (root element in a DOM-parsed XML&#xD;
     *     tree) that holds all the information&#xD;
     * @exception IOException If an error occur while sending the message.&#xD;
     * @see #send(Element)&#xD;
     * @see #ask(Element)</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNebQFJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aNebQVJNEeiyW7NaN4qWdw" name="ask" method="_aVBNtFJNEeiyW7NaN4qWdw" raisedException="_aH-QMFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW8gVlJNEeiyW7NaN4qWdw">
                    <body>Sends a message to the other peer and returns the reply.&#xD;
     *&#xD;
     * @param element The question for the peer.&#xD;
     * @return The reply from the peer.&#xD;
     * @exception IOException if an error occur while sending the message.&#xD;
     * @see #send(Element)&#xD;
     * @see #sendAndWait(Element)</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNebQlJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNebQ1JNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aNfCUFJNEeiyW7NaN4qWdw" name="handleAndSendReply" method="_aVB0wFJNEeiyW7NaN4qWdw" raisedException="_aH-QMFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW8gV1JNEeiyW7NaN4qWdw">
                    <body>Handles a message using the registered &lt;code>MessageHandler&lt;/code>.&#xD;
     *&#xD;
     * @param in The stream containing the message.&#xD;
     * @exception IOException if the streaming fails.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNfCUVJNEeiyW7NaN4qWdw" name="in" type="_aIJ2YFJNEeiyW7NaN4qWdw">
                    <eAnnotations xmi:id="_aNfCUlJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                      <details xmi:id="_aNfCU1JNEeiyW7NaN4qWdw" key="final"/>
                    </eAnnotations>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aNfpYFJNEeiyW7NaN4qWdw" name="handle" method="_aVCb0FJNEeiyW7NaN4qWdw" raisedException="_aIAFYVJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW8gWFJNEeiyW7NaN4qWdw">
                    <body>Handle a request.&#xD;
     *&#xD;
     * @param request The request &lt;code>Element&lt;/code> to handle.&#xD;
     * @return The reply from the message handler.&#xD;
     * @exception FreeColException if there is trouble with the response.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNfpYVJNEeiyW7NaN4qWdw" name="request" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNfpYlJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_Y8nQUFJNEeiyW7NaN4qWdw" name="CurrentPlayerNetworkRequestHandler" isAbstract="true">
                <ownedComment xmi:id="_aW9HYFJNEeiyW7NaN4qWdw">
                  <body>A network request handler for the current player will automatically&#xD;
return an error (&amp;quot;not your turn&amp;quot;) if called by a&#xD;
connection other than that of the currently active player. If no&#xD;
game is active or if the player is unknown the same error is&#xD;
returned.</body>
                </ownedComment>
                <generalization xmi:id="_aNoMQFJNEeiyW7NaN4qWdw" general="_aIhCwFJNEeiyW7NaN4qWdw"/>
                <interfaceRealization xmi:id="_aIiQ4FJNEeiyW7NaN4qWdw" client="_Y8nQUFJNEeiyW7NaN4qWdw" supplier="_ZBd7IFJNEeiyW7NaN4qWdw" contract="_ZBd7IFJNEeiyW7NaN4qWdw"/>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVDC4FJNEeiyW7NaN4qWdw" name="CurrentPlayerNetworkRequestHandler" specification="_aNjTwFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVDC4VJNEeiyW7NaN4qWdw" name="freeColServer" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVDC4lJNEeiyW7NaN4qWdw" type="_Y8nQUFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(freeColServer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVDC41JNEeiyW7NaN4qWdw" name="isCurrentPlayer" specification="_aNj60lJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVDC5FJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVDC5VJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>Game game = getGame();&#xD;
     return (player == null || game == null) ? false&#xD;
         : player.equals(game.getCurrentPlayer());&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVDC5lJNEeiyW7NaN4qWdw" name="handle" specification="_aNlI8FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVDC51JNEeiyW7NaN4qWdw" name="conn" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVDC6FJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVDC6VJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>ServerPlayer player = getFreeColServer().getPlayer(conn);&#xD;
     if (!isCurrentPlayer(player)) {&#xD;
         return DOMMessage.clientError(&quot;Received message: &quot;&#xD;
             + element.getTagName()&#xD;
             + &quot; out of turn from player: &quot; + player.getNation());&#xD;
     }&#xD;
     return handle(player, conn, element);&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_aNjTwFJNEeiyW7NaN4qWdw" name="CurrentPlayerNetworkRequestHandler" method="_aVDC4FJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aNjTwlJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aNj60FJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedParameter xmi:id="_aNjTwVJNEeiyW7NaN4qWdw" name="freeColServer" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNj60VJNEeiyW7NaN4qWdw" type="_Y8nQUFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aNj60lJNEeiyW7NaN4qWdw" name="isCurrentPlayer" visibility="private" method="_aVDC41JNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aNkh4FJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNkh4VJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aNlI8FJNEeiyW7NaN4qWdw" name="handle" isLeaf="true" method="_aVDC5lJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aNlI8VJNEeiyW7NaN4qWdw" name="conn" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNlI8lJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNlI81JNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aNm-IFJNEeiyW7NaN4qWdw" name="handle" visibility="protected" isAbstract="true">
                  <ownedParameter xmi:id="_aNnlMFJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNnlMVJNEeiyW7NaN4qWdw" name="conn" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNnlMlJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNnlM1JNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_Y8rhwFJNEeiyW7NaN4qWdw" name="DOMMessage">
                <ownedComment xmi:id="_aW9HYVJNEeiyW7NaN4qWdw">
                  <body>Class for parsing raw message data into an XML-tree and for creating new&#xD;
XML-trees.</body>
                </ownedComment>
                <ownedAttribute xmi:id="_aSLVEFJNEeiyW7NaN4qWdw" name="logger" visibility="protected" isLeaf="true" isStatic="true" type="_aH_eUVJNEeiyW7NaN4qWdw" isReadOnly="true" association="_aZjIYFJNEeiyW7NaN4qWdw">
                  <defaultValue xmi:type="uml:LiteralString" xmi:id="_aSLVEVJNEeiyW7NaN4qWdw" value="Logger.getLogger(DOMMessage.class.getName())"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aSL8IFJNEeiyW7NaN4qWdw" name="FREECOL_PROTOCOL_VERSION" visibility="private" isLeaf="true" isStatic="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  <defaultValue xmi:type="uml:LiteralString" xmi:id="_aSL8IVJNEeiyW7NaN4qWdw" value="&quot;0.1.6&quot;"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aSL8IlJNEeiyW7NaN4qWdw" name="INVALID_MESSAGE" visibility="private" isLeaf="true" isStatic="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  <defaultValue xmi:type="uml:LiteralString" xmi:id="_aSL8I1JNEeiyW7NaN4qWdw" value="&quot;invalid&quot;"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aSL8JFJNEeiyW7NaN4qWdw" name="document" visibility="protected" type="_aIqzwVJNEeiyW7NaN4qWdw" association="_aZrrQVJNEeiyW7NaN4qWdw"/>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVDp8FJNEeiyW7NaN4qWdw" name="DOMMessage" specification="_Y8tW8FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVDp8VJNEeiyW7NaN4qWdw" name="tag">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aVDp8lJNEeiyW7NaN4qWdw" type="_Y8rhwFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>this.document = createNewDocument();&#xD;
     this.document.appendChild(this.document.createElement(tag));&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVDp81JNEeiyW7NaN4qWdw" name="DOMMessage" specification="_aNozUFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVDp9FJNEeiyW7NaN4qWdw" name="inputStream" type="_aILrkVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVDp9VJNEeiyW7NaN4qWdw" type="_Y8rhwFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>this(new InputSource(inputStream));&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVDp9lJNEeiyW7NaN4qWdw" name="DOMMessage" specification="_aNqogFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVDp91JNEeiyW7NaN4qWdw" name="inputSource" type="_aIso8VJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVDp-FJNEeiyW7NaN4qWdw" type="_Y8rhwFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();&#xD;
     Document tempDocument = null;&#xD;
     boolean dumpMsgOnError = true;&#xD;
     if (dumpMsgOnError) {&#xD;
         inputSource.setByteStream(new BufferedInputStream(inputSource.getByteStream()));&#xD;
&#xD;
         inputSource.getByteStream().mark(1000000);&#xD;
     }&#xD;
&#xD;
     try {&#xD;
         DocumentBuilder builder = factory.newDocumentBuilder();&#xD;
         tempDocument = builder.parse(inputSource);&#xD;
     } catch (ParserConfigurationException pce) {&#xD;
         // Parser with specified options can't be built&#xD;
         logger.log(Level.WARNING, &quot;Parser error&quot;, pce);&#xD;
     } catch (IOException|SAXException ex) {&#xD;
         throw ex;&#xD;
     } catch (ArrayIndexOutOfBoundsException e) {&#xD;
         // Xerces throws ArrayIndexOutOfBoundsException when it barfs on&#xD;
         // some FreeCol messages. I'd like to see the messages upon which&#xD;
         // it barfs&#xD;
         if (dumpMsgOnError) {&#xD;
             ByteArrayOutputStream baos = new ByteArrayOutputStream();&#xD;
             inputSource.getByteStream().reset();&#xD;
             while (true) {&#xD;
                 int i = inputSource.getByteStream().read();&#xD;
                 if (-1 == i) {&#xD;
                     break;&#xD;
                 }&#xD;
                 baos.write(i);&#xD;
             }&#xD;
             logger.severe(baos.toString(&quot;UTF-8&quot;));&#xD;
         }&#xD;
         throw e;&#xD;
     }&#xD;
&#xD;
     document = tempDocument;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVERAFJNEeiyW7NaN4qWdw" name="DOMMessage" specification="_aNr2oFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVERAVJNEeiyW7NaN4qWdw" name="document" type="_aIqzwVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVERAlJNEeiyW7NaN4qWdw" type="_Y8rhwFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>this.document = document;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVERA1JNEeiyW7NaN4qWdw" name="createMessage" specification="_aNsdsFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVERBFJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVERBVJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVERBlJNEeiyW7NaN4qWdw" type="_Y8rhwFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>if (element == null) return null;&#xD;
     String tag = element.getTagName();&#xD;
     tag = &quot;net.sf.freecol.common.networking.&quot;&#xD;
         + tag.substring(0, 1).toUpperCase() + tag.substring(1)&#xD;
         + &quot;Message&quot;;&#xD;
     Class[] types = { Game.class, Element.class };&#xD;
     Object[] params = { game, element };&#xD;
     DOMMessage message;&#xD;
     try {&#xD;
         message = (DOMMessage)Introspector.instantiate(tag, types, params);&#xD;
     } catch (IllegalArgumentException e) {&#xD;
         logger.log(Level.WARNING, &quot;Instantiation fail&quot;, e);&#xD;
         message = null;&#xD;
     }&#xD;
     return message;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVERB1JNEeiyW7NaN4qWdw" name="getDocument" specification="_Y8vzMFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVERCFJNEeiyW7NaN4qWdw" type="_aIqzwVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return document;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVERCVJNEeiyW7NaN4qWdw" name="getType" specification="_Y8waQFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVERClJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return (document != null &amp;&amp; document.getDocumentElement() != null)&#xD;
         ? document.getDocumentElement().getTagName()&#xD;
         : INVALID_MESSAGE;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVERC1JNEeiyW7NaN4qWdw" name="isType" specification="_Y8xBUFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVE4EFJNEeiyW7NaN4qWdw" name="type">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aVE4EVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return getType().equals(type);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVE4ElJNEeiyW7NaN4qWdw" name="getAttribute" specification="_Y8xoYlJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVE4E1JNEeiyW7NaN4qWdw" name="key">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aVE4FFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return document.getDocumentElement().getAttribute(key);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVE4FVJNEeiyW7NaN4qWdw" name="setAttribute" specification="_Y8y2gFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVE4FlJNEeiyW7NaN4qWdw" name="key">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aVE4F1JNEeiyW7NaN4qWdw" name="value">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>document.getDocumentElement().setAttribute(key, value);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVE4GFJNEeiyW7NaN4qWdw" name="setAttribute" specification="_Y80EoFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVE4GVJNEeiyW7NaN4qWdw" name="key">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aVE4GlJNEeiyW7NaN4qWdw" name="value">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>setAttribute(key, Integer.toString(value));&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVE4G1JNEeiyW7NaN4qWdw" name="hasAttribute" specification="_Y80rsFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVE4HFJNEeiyW7NaN4qWdw" name="attribute">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aVE4HVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return document.getDocumentElement().hasAttribute(attribute);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVFfIFJNEeiyW7NaN4qWdw" name="insertAsRoot" specification="_aNtr0FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVFfIVJNEeiyW7NaN4qWdw" name="newRoot" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <language>java</language>
                  <body>Element oldRoot = document.getDocumentElement();&#xD;
&#xD;
     if (oldRoot != null) {&#xD;
         document.removeChild(oldRoot);&#xD;
         newRoot.appendChild(oldRoot);&#xD;
     }&#xD;
&#xD;
     document.appendChild(newRoot);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVFfIlJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_Y81SwFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVFfI1JNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return null; // do nothing&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVFfJFJNEeiyW7NaN4qWdw" name="getFreeColProtocolVersion" specification="_Y81SwVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVFfJVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return FREECOL_PROTOCOL_VERSION;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVFfJlJNEeiyW7NaN4qWdw" name="createNewDocument" specification="_Y83H8FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVFfJ1JNEeiyW7NaN4qWdw" type="_aIqzwVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>try {&#xD;
         DocumentBuilderFactory factory&#xD;
             = DocumentBuilderFactory.newInstance();&#xD;
         return factory.newDocumentBuilder().newDocument();&#xD;
     } catch (ParserConfigurationException pce) {&#xD;
         // Parser with specified options can't be built&#xD;
         logger.log(Level.WARNING, &quot;Parser failure&quot;, pce);&#xD;
     }&#xD;
     return null;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVFfKFJNEeiyW7NaN4qWdw" name="createNewRootElement" specification="_Y83vAFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVFfKVJNEeiyW7NaN4qWdw" name="tagName">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aVFfKlJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return createNewDocument().createElement(tagName);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVGGMFJNEeiyW7NaN4qWdw" name="createMessage" specification="_Y8-csFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVGGMVJNEeiyW7NaN4qWdw" name="tagName">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aVGGMlJNEeiyW7NaN4qWdw" name="attributes">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    <upperValue xmi:type="uml:LiteralUnlimitedNatural" xmi:id="_aVGGM1JNEeiyW7NaN4qWdw" value="*"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aVGGNFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>Element root = createNewRootElement(tagName);&#xD;
     String[] all = attributes;&#xD;
     for (int i = 0; i &lt; all.length; i += 2) {&#xD;
         root.setAttribute(all[i], all[i+1]);&#xD;
     }&#xD;
     return root;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVGGNVJNEeiyW7NaN4qWdw" name="collapseElements" specification="_aNu58VJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVGGNlJNEeiyW7NaN4qWdw" name="elements" type="_aHo5AFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVGGN1JNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>switch (elements.size()) {&#xD;
     case 0:&#xD;
         return null;&#xD;
     case 1:&#xD;
         return elements.get(0);&#xD;
     default:&#xD;
         break;&#xD;
     }&#xD;
     Element first = elements.remove(0);&#xD;
     Document doc = first.getOwnerDocument();&#xD;
     Element result = doc.createElement(&quot;multiple&quot;);&#xD;
     result.appendChild(first);&#xD;
     for (Element e : elements) {&#xD;
         result.appendChild(doc.importNode(e, true));&#xD;
     }&#xD;
     return result;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVGGOFJNEeiyW7NaN4qWdw" name="createError" specification="_Y9A48FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVGGOVJNEeiyW7NaN4qWdw" name="messageID">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aVGGOlJNEeiyW7NaN4qWdw" name="message">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aVGGO1JNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>Element errorElement = createMessage(&quot;error&quot;);&#xD;
     if (messageID != null &amp;&amp; !messageID.isEmpty()) {&#xD;
         errorElement.setAttribute(&quot;messageID&quot;, messageID);&#xD;
     }&#xD;
     if (message != null &amp;&amp; !message.isEmpty()) {&#xD;
         errorElement.setAttribute(&quot;message&quot;, message);&#xD;
     }&#xD;
     return errorElement;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVGtQFJNEeiyW7NaN4qWdw" name="createError" specification="_aNwvIVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVGtQVJNEeiyW7NaN4qWdw" name="xw" type="_aIploFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVGtQlJNEeiyW7NaN4qWdw" name="messageID">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aVGtQ1JNEeiyW7NaN4qWdw" name="message">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>try {&#xD;
         xw.writeStartElement(&quot;error&quot;);&#xD;
&#xD;
         if (messageID != null &amp;&amp; !messageID.isEmpty()) {&#xD;
             xw.writeAttribute(&quot;messageID&quot;, messageID);&#xD;
         }&#xD;
&#xD;
         if (message != null &amp;&amp; !message.isEmpty()) {&#xD;
             xw.writeAttribute(&quot;message&quot;, message);&#xD;
         }&#xD;
         xw.writeEndElement();&#xD;
     } catch (XMLStreamException e) {&#xD;
         logger.log(Level.WARNING, &quot;Could not send error message.&quot;, e);&#xD;
     }&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVGtRFJNEeiyW7NaN4qWdw" name="clientError" specification="_Y9CHEFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVGtRVJNEeiyW7NaN4qWdw" name="message">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aVGtRlJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>logger.warning(message);&#xD;
     if (FreeColDebugger.isInDebugMode(FreeColDebugger.DebugMode.COMMS)) {&#xD;
         Thread.dumpStack();&#xD;
     }&#xD;
     return createMessage(&quot;error&quot;,&#xD;
         &quot;messageID&quot;, &quot;server.reject&quot;,&#xD;
         &quot;message&quot;, message);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVGtR1JNEeiyW7NaN4qWdw" name="getChildElement" specification="_aNx9QFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVGtSFJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVGtSVJNEeiyW7NaN4qWdw" name="tagName">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aVGtSlJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>NodeList n = element.getChildNodes();&#xD;
     for (int i = 0; i &lt; n.getLength(); i++) {&#xD;
         if (n.item(i) instanceof Element&#xD;
             &amp;&amp; ((Element)n.item(i)).getTagName().equals(tagName)) {&#xD;
             return (Element)n.item(i);&#xD;
         }&#xD;
     }&#xD;
     return null;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVGtS1JNEeiyW7NaN4qWdw" name="elementToString" specification="_aNykUFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVGtTFJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVGtTVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>try {&#xD;
         TransformerFactory factory = TransformerFactory.newInstance();&#xD;
         Transformer xt = factory.newTransformer();&#xD;
         StringWriter sw = new StringWriter();&#xD;
         xt.transform(new DOMSource(element), new StreamResult(sw));&#xD;
         String result = sw.toString();&#xD;
&#xD;
         // Drop the &lt;?xml...?> part if present to keep logging concise.&#xD;
         if (result.startsWith(&quot;&lt;?xml&quot;)) {&#xD;
             final String xmlEnd = &quot;?>&quot;;&#xD;
             int index = result.indexOf(xmlEnd);&#xD;
             if (index > 0) {&#xD;
                 result = result.substring(index + xmlEnd.length());&#xD;
             }&#xD;
         }&#xD;
         return result;&#xD;
     } catch (TransformerException e) {&#xD;
         logger.log(Level.WARNING, &quot;TransformerException&quot;, e);&#xD;
     }&#xD;
     return null;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVHUUFJNEeiyW7NaN4qWdw" name="toString" specification="_Y9D8QFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVHUUVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return document.getDocumentElement().toString();&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_Y8tW8FJNEeiyW7NaN4qWdw" name="DOMMessage" visibility="protected" method="_aVDp8FJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_Y8t-AVJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_Y8t-AlJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aW9HYlJNEeiyW7NaN4qWdw">
                    <body>Protected constructor for the benefit of the subclasses.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y8t-AFJNEeiyW7NaN4qWdw" name="tag">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Y8t-A1JNEeiyW7NaN4qWdw" type="_Y8rhwFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y8vzMFJNEeiyW7NaN4qWdw" name="getDocument" method="_aVERB1JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW9uclJNEeiyW7NaN4qWdw">
                    <body>Gets the &lt;code>Document&lt;/code> holding the message data.&#xD;
     *&#xD;
     * @return The &lt;code>Document&lt;/code> holding the message data.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNtEwVJNEeiyW7NaN4qWdw" type="_aIqzwVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y8waQFJNEeiyW7NaN4qWdw" name="getType" method="_aVERCVJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW9uc1JNEeiyW7NaN4qWdw">
                    <body>Gets the type of this DOMMessage.&#xD;
     *&#xD;
     * @return The type of this DOMMessage.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y8waQVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_Y8xBUFJNEeiyW7NaN4qWdw" name="isType" method="_aVERC1JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW9udFJNEeiyW7NaN4qWdw">
                    <body>Checks if this message is of a given type.&#xD;
     *&#xD;
     * @param type The type you wish to test against.&#xD;
     * @return &lt;code>true&lt;/code> if the type of this message equals the given&#xD;
     *         type and &lt;code>false&lt;/code> otherwise.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y8xoYFJNEeiyW7NaN4qWdw" name="type">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Y8xoYVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_Y8xoYlJNEeiyW7NaN4qWdw" name="getAttribute" method="_aVE4ElJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW9udVJNEeiyW7NaN4qWdw">
                    <body>Gets an attribute from the root element.&#xD;
     *&#xD;
     * @param key The key of the attribute.&#xD;
     * @return The value of the attribute with the given key.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y8yPcFJNEeiyW7NaN4qWdw" name="key">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Y8yPcVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_Y8y2gFJNEeiyW7NaN4qWdw" name="setAttribute" method="_aVE4FVJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW9udlJNEeiyW7NaN4qWdw">
                    <body>Sets an attribute on the root element.&#xD;
     *&#xD;
     * @param key The key of the attribute.&#xD;
     * @param value The value of the attribute.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y8y2gVJNEeiyW7NaN4qWdw" name="key">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Y8y2glJNEeiyW7NaN4qWdw" name="value">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_Y80EoFJNEeiyW7NaN4qWdw" name="setAttribute" method="_aVE4GFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW9ud1JNEeiyW7NaN4qWdw">
                    <body>Sets an attribute on the root element.&#xD;
     *&#xD;
     * @param key The key of the attribute.&#xD;
     * @param value The value of the attribute.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y80EoVJNEeiyW7NaN4qWdw" name="key">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Y80EolJNEeiyW7NaN4qWdw" name="value">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_Y80rsFJNEeiyW7NaN4qWdw" name="hasAttribute" method="_aVE4G1JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW9ueFJNEeiyW7NaN4qWdw">
                    <body>Checks if an attribute is set on the root element.&#xD;
     *&#xD;
     * @param attribute The attribute in which to verify the existence of.&#xD;
     * @return &lt;code>true&lt;/code> if the root element has the given attribute.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y80rsVJNEeiyW7NaN4qWdw" name="attribute">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Y80rslJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_Y81SwFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aVFfIlJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW-VgFJNEeiyW7NaN4qWdw">
                    <body>Dummy serialization stub.&#xD;
     * Must be overridden by subclasses.&#xD;
     *&#xD;
     * @return Null.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNuS4FJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y81SwVJNEeiyW7NaN4qWdw" name="getFreeColProtocolVersion" isStatic="true" method="_aVFfJFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW-VgVJNEeiyW7NaN4qWdw">
                    <body>Gets the current version of the FreeCol protocol.&#xD;
     *&#xD;
     * @return The version of the FreeCol protocol.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y82g4FJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_Y83H8FJNEeiyW7NaN4qWdw" name="createNewDocument" isStatic="true" method="_aVFfJlJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW-VglJNEeiyW7NaN4qWdw">
                    <body>Creates and returns a new XML-document.&#xD;
     *&#xD;
     * @return the new XML-document.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNuS4VJNEeiyW7NaN4qWdw" type="_aIqzwVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y83vAFJNEeiyW7NaN4qWdw" name="createNewRootElement" isStatic="true" method="_aVFfKFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW-Vg1JNEeiyW7NaN4qWdw">
                    <body>Creates a new root element. This is done by creating a new document and&#xD;
     * using this document to create the root element.&#xD;
     *&#xD;
     * @param tagName The tag name of the root element beeing created,&#xD;
     * @return the new root element.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y83vAVJNEeiyW7NaN4qWdw" name="tagName">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aNuS4lJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y8-csFJNEeiyW7NaN4qWdw" name="createMessage" isStatic="true" method="_aVGGMFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Y8-csVJNEeiyW7NaN4qWdw" name="tagName">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Y8-cslJNEeiyW7NaN4qWdw" name="attributes">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    <upperValue xmi:type="uml:LiteralUnlimitedNatural" xmi:id="_Y8_q0VJNEeiyW7NaN4qWdw" value="*"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aNu58FJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y9A48FJNEeiyW7NaN4qWdw" name="createError" isStatic="true" method="_aVGGOFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW-VhVJNEeiyW7NaN4qWdw">
                    <body>Creates an error message.&#xD;
     *&#xD;
     * @param messageID Identifies the &quot;i18n&quot;-keyname. Not specified in the&#xD;
     *            message if &lt;i>null&lt;/i>.&#xD;
     * @param message The error in plain text. Not specified in the message if&#xD;
     *            &lt;i>null&lt;/i>.&#xD;
     * @return The root &lt;code>Element&lt;/code> of the error message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y9A48VJNEeiyW7NaN4qWdw" name="messageID">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Y9A48lJNEeiyW7NaN4qWdw" name="message">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aNwvIFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y9CHEFJNEeiyW7NaN4qWdw" name="clientError" isStatic="true" method="_aVGtRFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW-Vh1JNEeiyW7NaN4qWdw">
                    <body>Creates an error message in response to bad client data.&#xD;
     *&#xD;
     * @param message The error in plain text.&#xD;
     * @return The root &lt;code>Element&lt;/code> of the error message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y9CHEVJNEeiyW7NaN4qWdw" name="message">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aNxWMFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y9D8QFJNEeiyW7NaN4qWdw" name="toString" method="_aVHUUFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Y9D8QVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aNozUFJNEeiyW7NaN4qWdw" name="DOMMessage" method="_aVDp81JNEeiyW7NaN4qWdw" raisedException="_aIXRwFJNEeiyW7NaN4qWdw _aH-QMFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aNpaYFJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aNpaYVJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aW9HY1JNEeiyW7NaN4qWdw">
                    <body>Constructs a new DOMMessage with data from the given InputStream. The&#xD;
     * constructor to use if this is an INCOMING message.&#xD;
     *&#xD;
     * @param inputStream The &lt;code>InputStream&lt;/code> to get the XML-data&#xD;
     *            from.&#xD;
     * @exception IOException if thrown by the &lt;code>InputStream&lt;/code>.&#xD;
     * @exception SAXException if thrown during parsing.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNozUVJNEeiyW7NaN4qWdw" name="inputStream" type="_aILrkVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNpaYlJNEeiyW7NaN4qWdw" type="_Y8rhwFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aNqogFJNEeiyW7NaN4qWdw" name="DOMMessage" visibility="private" method="_aVDp9lJNEeiyW7NaN4qWdw" raisedException="_aIXRwFJNEeiyW7NaN4qWdw _aH-QMFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aNrPkVJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aNrPklJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aW9HZFJNEeiyW7NaN4qWdw">
                    <body>Constructs a new DOMMessage with data from the given InputSource. The&#xD;
     * constructor to use if this is an INCOMING message.&#xD;
     *&#xD;
     * @param inputSource The &lt;code>InputSource&lt;/code> to get the XML-data&#xD;
     *            from.&#xD;
     * @exception IOException if thrown by the &lt;code>InputSource&lt;/code>.&#xD;
     * @exception SAXException if thrown during parsing.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNrPkFJNEeiyW7NaN4qWdw" name="inputSource" type="_aIso8VJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNrPk1JNEeiyW7NaN4qWdw" type="_Y8rhwFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aNr2oFJNEeiyW7NaN4qWdw" name="DOMMessage" method="_aVERAFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aNr2olJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aNr2o1JNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aW9ucFJNEeiyW7NaN4qWdw">
                    <body>Constructs a new DOMMessage with data from the given XML-document.&#xD;
     *&#xD;
     * @param document The document representing an XML-message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNr2oVJNEeiyW7NaN4qWdw" name="document" type="_aIqzwVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNr2pFJNEeiyW7NaN4qWdw" type="_Y8rhwFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aNsdsFJNEeiyW7NaN4qWdw" name="createMessage" isStatic="true" method="_aVERA1JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW9ucVJNEeiyW7NaN4qWdw">
                    <body>Create a DOMMessage from an element.&#xD;
     *&#xD;
     * FIXME: make this into a constructor?&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> to create the message in.&#xD;
     * @param element The &lt;code>Element&lt;/code> to create the message from.&#xD;
     * @return The message created, or null on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNsdsVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNsdslJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNtEwFJNEeiyW7NaN4qWdw" type="_Y8rhwFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aNtr0FJNEeiyW7NaN4qWdw" name="insertAsRoot" method="_aVFfIFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW9ueVJNEeiyW7NaN4qWdw">
                    <body>Inserts an element as a new root element to the existing&#xD;
     * element of this message.&#xD;
     *&#xD;
     * @param newRoot The new root &lt;code>Element&lt;/code>.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNtr0VJNEeiyW7NaN4qWdw" name="newRoot" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aNu58VJNEeiyW7NaN4qWdw" name="collapseElements" isStatic="true" method="_aVGGNVJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW-VhFJNEeiyW7NaN4qWdw">
                    <body>Collapses a list of elements into a &quot;multiple&quot; element&#xD;
     * with the original elements added as child nodes.&#xD;
     *&#xD;
     * @param elements A list of &lt;code>Element&lt;/code>s to collapse.&#xD;
     * @return A new &quot;multiple&quot; element, or the singleton element of the list,&#xD;
     *     or null if the list is empty.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNvhAFJNEeiyW7NaN4qWdw" name="elements" type="_aHo5AFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNvhAVJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aNwvIVJNEeiyW7NaN4qWdw" name="createError" isStatic="true" method="_aVGtQFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW-VhlJNEeiyW7NaN4qWdw">
                    <body>Creates an error message.&#xD;
     *&#xD;
     * @param xw The &lt;code>FreeColXMLWriter&lt;/code> to write to.&#xD;
     * @param messageID Identifies the &quot;i18n&quot;-keyname. Not specified in the&#xD;
     *            message if &lt;i>null&lt;/i>.&#xD;
     * @param message The error in plain text. Not specified in the message if&#xD;
     *            &lt;i>null&lt;/i>.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNwvIlJNEeiyW7NaN4qWdw" name="xw" type="_aIploFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNwvI1JNEeiyW7NaN4qWdw" name="messageID">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aNwvJFJNEeiyW7NaN4qWdw" name="message">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aNx9QFJNEeiyW7NaN4qWdw" name="getChildElement" isStatic="true" method="_aVGtR1JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW-ViFJNEeiyW7NaN4qWdw">
                    <body>Convenience method to find the first child element with the&#xD;
     * specified tagname.&#xD;
     *&#xD;
     * @param element The &lt;code>Element&lt;/code> to search for the child&#xD;
     *     element in.&#xD;
     * @param tagName The tag name of the child element to be found.&#xD;
     * @return The first child element with the given name.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNx9QVJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNx9QlJNEeiyW7NaN4qWdw" name="tagName">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aNx9Q1JNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aNykUFJNEeiyW7NaN4qWdw" name="elementToString" isStatic="true" method="_aVGtS1JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW-ViVJNEeiyW7NaN4qWdw">
                    <body>Convert an element to a string.&#xD;
     *&#xD;
     * @param element The &lt;code>Element&lt;/code> to convert.&#xD;
     * @return The &lt;code>String&lt;/code> representation of an element.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNykUVJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNykUlJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_Y9NtQFJNEeiyW7NaN4qWdw" name="DeclareIndependenceMessage">
                <ownedComment xmi:id="_aW-8kFJNEeiyW7NaN4qWdw">
                  <body>The message sent when a player declares independence.</body>
                </ownedComment>
                <generalization xmi:id="_aI3oEFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aSNKQFJNEeiyW7NaN4qWdw" name="nationName" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aSNxUVJNEeiyW7NaN4qWdw" name="countryName" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVHUUlJNEeiyW7NaN4qWdw" name="DeclareIndependenceMessage" specification="_Y9OUUFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVHUU1JNEeiyW7NaN4qWdw" name="nationName">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aVHUVFJNEeiyW7NaN4qWdw" name="countryName">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aVHUVVJNEeiyW7NaN4qWdw" type="_Y9NtQFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.nationName = nationName;&#xD;
     this.countryName = countryName;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVH7YFJNEeiyW7NaN4qWdw" name="DeclareIndependenceMessage" specification="_aNzycFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVH7YVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVH7YlJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVH7Y1JNEeiyW7NaN4qWdw" type="_Y9NtQFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.nationName = element.getAttribute(&quot;nationName&quot;);&#xD;
     this.countryName = element.getAttribute(&quot;countryName&quot;);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVH7ZFJNEeiyW7NaN4qWdw" name="handle" specification="_aN0ZgVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVH7ZVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVH7ZlJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVH7Z1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVH7aFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
&#xD;
     if (nationName == null || nationName.isEmpty()&#xD;
         || countryName == null || countryName.isEmpty()) {&#xD;
         return DOMMessage.clientError(&quot;Empty nation or country name.&quot;);&#xD;
     }&#xD;
     StringTemplate problem = player.checkDeclareIndependence();&#xD;
     if (problem != null) {&#xD;
         return DOMMessage.clientError(&quot;Declaration blocked&quot;);&#xD;
     }&#xD;
&#xD;
     // Declare.&#xD;
     return server.getInGameController()&#xD;
         .declareIndependence(serverPlayer, nationName, countryName);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVH7aVJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_Y9QJgFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVH7alJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return createMessage(getXMLElementTagName(),&#xD;
         &quot;nationName&quot;, nationName,&#xD;
         &quot;countryName&quot;, countryName);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVIicFJNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_Y9QwklJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVIicVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;declareIndependence&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_Y9OUUFJNEeiyW7NaN4qWdw" name="DeclareIndependenceMessage" method="_aVHUUlJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_Y9O7YlJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_Y9O7Y1JNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aW-8kVJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>DeclareIndependenceMessage&lt;/code> with the&#xD;
     * supplied name.&#xD;
     *&#xD;
     * @param nationName The new name for the rebelling nation.&#xD;
     * @param countryName The new name for the rebelling country.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y9O7YFJNEeiyW7NaN4qWdw" name="nationName">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Y9O7YVJNEeiyW7NaN4qWdw" name="countryName">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Y9O7ZFJNEeiyW7NaN4qWdw" type="_Y9NtQFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y9QJgFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aVH7aVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aN1AkFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y9QwklJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aVIicFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW-8lFJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;declareIndependence&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y9RXoFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aNzycFJNEeiyW7NaN4qWdw" name="DeclareIndependenceMessage" method="_aVH7YFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aNzyc1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aNzydFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aW-8klJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>DeclareIndependenceMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aNzycVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aNzyclJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aN0ZgFJNEeiyW7NaN4qWdw" type="_Y9NtQFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aN0ZgVJNEeiyW7NaN4qWdw" name="handle" method="_aVH7ZFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW-8k1JNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;declareIndependence&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param player The &lt;code>Player&lt;/code> the message applies to.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> the message is from.&#xD;
     *&#xD;
     * @return An update &lt;code>Element&lt;/code> describing the REF and the&#xD;
     *         rebel player, or an error &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aN0ZglJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aN0Zg1JNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aN0ZhFJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aN0ZhVJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_Y9Tz4FJNEeiyW7NaN4qWdw" name="DeclineMoundsMessage">
                <ownedComment xmi:id="_aW-8lVJNEeiyW7NaN4qWdw">
                  <body>The message sent when declining to investigate strange mounds.</body>
                </ownedComment>
                <generalization xmi:id="_aI7ScFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aSOYYFJNEeiyW7NaN4qWdw" name="unitId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aSOYYlJNEeiyW7NaN4qWdw" name="directionString" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVIiclJNEeiyW7NaN4qWdw" name="DeclineMoundsMessage" specification="_aN1noFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVIic1JNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVIidFJNEeiyW7NaN4qWdw" name="direction" type="_aG4EAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVIidVJNEeiyW7NaN4qWdw" type="_Y9Tz4FJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = unit.getId();&#xD;
     this.directionString = String.valueOf(direction);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVIidlJNEeiyW7NaN4qWdw" name="DeclineMoundsMessage" specification="_aN2OsFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVIid1JNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVIieFJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVIieVJNEeiyW7NaN4qWdw" type="_Y9Tz4FJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = element.getAttribute(&quot;unit&quot;);&#xD;
     this.directionString = element.getAttribute(&quot;direction&quot;);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVJJgFJNEeiyW7NaN4qWdw" name="handle" specification="_aN21wVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVJJgVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVJJglJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVJJg1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVJJhFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
&#xD;
     Unit unit;&#xD;
     try {&#xD;
         unit = player.getOurFreeColGameObject(unitId, Unit.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     Tile tile;&#xD;
     try {&#xD;
         tile = unit.getNeighbourTile(directionString);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     LostCityRumour rumour = tile.getLostCityRumour();&#xD;
     if (rumour == null&#xD;
         || rumour.getType() != LostCityRumour.RumourType.MOUNDS) {&#xD;
         return DOMMessage.clientError(&quot;No mounds rumour on tile: &quot;&#xD;
             + tile.getId());&#xD;
     }&#xD;
&#xD;
     // Clear the mounds.&#xD;
     return server.getInGameController()&#xD;
         .declineMounds(serverPlayer, tile);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVJJhVJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_Y9VpEFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVJJhlJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return createMessage(getXMLElementTagName(),&#xD;
         &quot;unit&quot;, unitId,&#xD;
         &quot;direction&quot;, directionString);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVJJh1JNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_Y9W3MFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVJJiFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;declineMounds&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_Y9VpEFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aVJJhVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aN3c0VJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y9W3MFJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aVJJh1JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW_joFJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;declineMounds&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y9W3MVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aN1noFJNEeiyW7NaN4qWdw" name="DeclineMoundsMessage" method="_aVIiclJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aN1no1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aN1npFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aW-8llJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>DeclineMoundsMessage&lt;/code> with the&#xD;
     * supplied unit and direction.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is exploring.&#xD;
     * @param direction The &lt;code>Direction&lt;/code> the unit is looking.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aN1noVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aN1nolJNEeiyW7NaN4qWdw" name="direction" type="_aG4EAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aN1npVJNEeiyW7NaN4qWdw" type="_Y9Tz4FJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aN2OsFJNEeiyW7NaN4qWdw" name="DeclineMoundsMessage" method="_aVIidlJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aN2Os1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aN2OtFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aW-8l1JNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>DeclineMoundsMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aN2OsVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aN2OslJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aN21wFJNEeiyW7NaN4qWdw" type="_Y9Tz4FJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aN21wVJNEeiyW7NaN4qWdw" name="handle" method="_aVJJgFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW-8mFJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;declineMounds&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param player The &lt;code>Player&lt;/code> that sent the message.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     * @return An &lt;code>Element&lt;/code> to update the originating&#xD;
     *     player with the result of the demand.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aN21wlJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aN21w1JNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aN21xFJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aN3c0FJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_Y9Z6gFJNEeiyW7NaN4qWdw" name="DeliverGiftMessage">
                <ownedComment xmi:id="_aW_joVJNEeiyW7NaN4qWdw">
                  <body>The message sent when delivering a gift to a Settlement.</body>
                </ownedComment>
                <generalization xmi:id="_aI9usFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aSPmgFJNEeiyW7NaN4qWdw" name="unitId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aSPmglJNEeiyW7NaN4qWdw" name="settlementId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aSQNkVJNEeiyW7NaN4qWdw" name="goods" visibility="private" isLeaf="true" type="_aHJw0FJNEeiyW7NaN4qWdw" isReadOnly="true" association="_aZznEVJNEeiyW7NaN4qWdw"/>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVJwkFJNEeiyW7NaN4qWdw" name="DeliverGiftMessage" specification="_aN4q8FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVJwkVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVJwklJNEeiyW7NaN4qWdw" name="settlement" type="_aHKX4VJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVJwk1JNEeiyW7NaN4qWdw" name="goods" type="_aHJw0FJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVJwlFJNEeiyW7NaN4qWdw" type="_Y9Z6gFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = unit.getId();&#xD;
     this.settlementId = settlement.getId();&#xD;
     this.goods = goods;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVJwlVJNEeiyW7NaN4qWdw" name="DeliverGiftMessage" specification="_aN5SAFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVJwllJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVJwl1JNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVJwmFJNEeiyW7NaN4qWdw" type="_Y9Z6gFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = element.getAttribute(&quot;unit&quot;);&#xD;
     this.settlementId = element.getAttribute(&quot;settlement&quot;);&#xD;
     this.goods = new Goods(game,&#xD;
         DOMMessage.getChildElement(element, Goods.getXMLElementTagName()));&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVJwmVJNEeiyW7NaN4qWdw" name="getUnit" specification="_Y9bvsFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVJwmlJNEeiyW7NaN4qWdw" type="_aG5SIVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return goods.getGame().getFreeColGameObject(unitId, Unit.class);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVJwm1JNEeiyW7NaN4qWdw" name="getSettlement" specification="_Y9cWwFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVJwnFJNEeiyW7NaN4qWdw" type="_aHKX4VJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return goods.getGame().getFreeColGameObject(settlementId,&#xD;
                                                 Settlement.class);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVJwnVJNEeiyW7NaN4qWdw" name="getGoods" specification="_Y9cWwVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVJwnlJNEeiyW7NaN4qWdw" type="_aHJw0FJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return goods;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVKXoFJNEeiyW7NaN4qWdw" name="handle" specification="_aN6gIFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVKXoVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVKXolJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVKXo1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVKXpFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
&#xD;
     Unit unit;&#xD;
     try {&#xD;
         unit = player.getOurFreeColGameObject(unitId, Unit.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     Settlement settlement;&#xD;
     try {&#xD;
         settlement = unit.getAdjacentSettlementSafely(settlementId);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     // Make sure we are trying to deliver something that is there&#xD;
     if (goods.getLocation() != unit) {&#xD;
         return DOMMessage.clientError(&quot;Gift &quot; + goods.getId()&#xD;
             + &quot; is not with unit &quot; + unitId);&#xD;
     }&#xD;
&#xD;
     // Proceed to deliver.&#xD;
     return server.getInGameController()&#xD;
         .deliverGiftToSettlement(serverPlayer, unit, settlement, goods);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVKXpVJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_Y9dk4FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVKXplJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>Element result = createMessage(getXMLElementTagName(),&#xD;
         &quot;unit&quot;, unitId,&#xD;
         &quot;settlement&quot;, settlementId);&#xD;
     result.appendChild(goods.toXMLElement(result.getOwnerDocument()));&#xD;
     return result;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVKXp1JNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_Y9ezAFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVKXqFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;deliverGift&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_Y9bvsFJNEeiyW7NaN4qWdw" name="getUnit" method="_aVJwmVJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW_jpFJNEeiyW7NaN4qWdw">
                    <body>Get the &lt;code>Unit&lt;/code> which is delivering the gift.  This&#xD;
     * is a helper routine to be called in-client as it blindly trusts&#xD;
     * its field.&#xD;
     *&#xD;
     * @return The &lt;code>Unit&lt;/code>, or null if none.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aN55EFJNEeiyW7NaN4qWdw" type="_aG5SIVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y9cWwFJNEeiyW7NaN4qWdw" name="getSettlement" method="_aVJwm1JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW_jpVJNEeiyW7NaN4qWdw">
                    <body>Get the &lt;code>Settlement&lt;/code> which is receiving the gift.&#xD;
     * This is a helper routine to be called in-client as it blindly trusts&#xD;
     * its field.&#xD;
     *&#xD;
     * @return The &lt;code>Settlement&lt;/code>, or null if none.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aN55EVJNEeiyW7NaN4qWdw" type="_aHKX4VJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y9cWwVJNEeiyW7NaN4qWdw" name="getGoods" method="_aVJwnVJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW_jplJNEeiyW7NaN4qWdw">
                    <body>Get the &lt;code>Goods&lt;/code> delivered as a gift.  This is a&#xD;
     * helper routine to be called in-client as it blindly trusts its&#xD;
     * field.&#xD;
     *&#xD;
     * @return The &lt;code>Goods&lt;/code>, or null if none.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aN55ElJNEeiyW7NaN4qWdw" type="_aHJw0FJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y9dk4FJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aVKXpVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aN7HMFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y9ezAFJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aVKXp1JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW_jqFJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;deliverGift&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y9ezAVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aN4q8FJNEeiyW7NaN4qWdw" name="DeliverGiftMessage" method="_aVJwkFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aN4q9FJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aN4q9VJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aW_jolJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>DeliverGiftMessage&lt;/code>.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is trading.&#xD;
     * @param settlement The &lt;code>Settlement&lt;/code> that is trading.&#xD;
     * @param goods The &lt;code>Goods&lt;/code> to deliverGift.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aN4q8VJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aN4q8lJNEeiyW7NaN4qWdw" name="settlement" type="_aHKX4VJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aN4q81JNEeiyW7NaN4qWdw" name="goods" type="_aHJw0FJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aN4q9lJNEeiyW7NaN4qWdw" type="_Y9Z6gFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aN5SAFJNEeiyW7NaN4qWdw" name="DeliverGiftMessage" method="_aVJwlVJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aN5SA1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aN5SBFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aW_jo1JNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>DeliverGiftMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aN5SAVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aN5SAlJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aN5SBVJNEeiyW7NaN4qWdw" type="_Y9Z6gFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aN6gIFJNEeiyW7NaN4qWdw" name="handle" method="_aVKXoFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aW_jp1JNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;deliverGift&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param player The &lt;code>Player&lt;/code> the message applies to.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     * @return An update containing the unit and settlement, or an&#xD;
     *     error &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aN6gIVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aN6gIlJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aN6gI1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aN6gJFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_Y9jEcFJNEeiyW7NaN4qWdw" name="DemandTributeMessage">
                <ownedComment xmi:id="_aW_jqVJNEeiyW7NaN4qWdw">
                  <body>The message sent when demanding tribute from a native settlement.</body>
                </ownedComment>
                <generalization xmi:id="_aJAyAFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aSQ0oFJNEeiyW7NaN4qWdw" name="unitId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aSQ0olJNEeiyW7NaN4qWdw" name="directionString" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVK-sFJNEeiyW7NaN4qWdw" name="DemandTributeMessage" specification="_aN7uQFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVK-sVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVK-slJNEeiyW7NaN4qWdw" name="direction" type="_aG4EAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVK-s1JNEeiyW7NaN4qWdw" type="_Y9jEcFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = unit.getId();&#xD;
     this.directionString = String.valueOf(direction);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVK-tFJNEeiyW7NaN4qWdw" name="DemandTributeMessage" specification="_aN8VUFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVK-tVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVK-tlJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVK-t1JNEeiyW7NaN4qWdw" type="_Y9jEcFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = element.getAttribute(&quot;unit&quot;);&#xD;
     this.directionString = element.getAttribute(&quot;direction&quot;);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVK-uFJNEeiyW7NaN4qWdw" name="handle" specification="_aN88YFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVK-uVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVK-ulJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVK-u1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVK-vFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
&#xD;
     Unit unit;&#xD;
     try {&#xD;
         unit = player.getOurFreeColGameObject(unitId, Unit.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
     if (unit.isArmed()&#xD;
         || unit.hasAbility(Ability.DEMAND_TRIBUTE)) {&#xD;
         ; // ok&#xD;
     } else {&#xD;
         return DOMMessage.clientError(&quot;Unit is neither armed&quot;&#xD;
             + &quot; nor able to demand tribute: &quot; + unitId);&#xD;
     }&#xD;
&#xD;
     Tile tile;&#xD;
     try {&#xD;
         tile = unit.getNeighbourTile(directionString);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     ServerIndianSettlement settlement&#xD;
         = (ServerIndianSettlement)tile.getIndianSettlement();&#xD;
     if (settlement == null) {&#xD;
         return DOMMessage.clientError(&quot;There is native settlement at: &quot;&#xD;
             + tile.getId());&#xD;
     }&#xD;
&#xD;
     MoveType type = unit.getMoveType(tile);&#xD;
     if (type != MoveType.ATTACK_SETTLEMENT&#xD;
         &amp;&amp; type != MoveType.ENTER_INDIAN_SETTLEMENT_WITH_SCOUT) {&#xD;
         return DOMMessage.clientError(&quot;Unable to demand tribute at: &quot;&#xD;
             + settlement.getName() + &quot;: &quot; + type.whyIllegal());&#xD;
     }&#xD;
&#xD;
     // Do the demand&#xD;
     return server.getInGameController()&#xD;
         .demandTribute(serverPlayer, unit, settlement);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVK-vVJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_Y9k5oFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVK-vlJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return createMessage(getXMLElementTagName(),&#xD;
         &quot;unit&quot;, unitId,&#xD;
         &quot;direction&quot;, directionString);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVLlwFJNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_Y9mu0FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVLlwVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;demandTribute&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_Y9k5oFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aVK-vVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aN9jcFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y9mu0FJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aVLlwFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXAKs1JNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;demandTribute&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y9mu0VJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aN7uQFJNEeiyW7NaN4qWdw" name="DemandTributeMessage" method="_aVK-sFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aN7uQ1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aN7uRFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXAKsFJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>DemandTributeMessage&lt;/code> with the&#xD;
     * supplied unit and direction.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is demanding.&#xD;
     * @param direction The &lt;code>Direction&lt;/code> the unit is looking.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aN7uQVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aN7uQlJNEeiyW7NaN4qWdw" name="direction" type="_aG4EAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aN7uRVJNEeiyW7NaN4qWdw" type="_Y9jEcFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aN8VUFJNEeiyW7NaN4qWdw" name="DemandTributeMessage" method="_aVK-tFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aN8VU1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aN8VVFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXAKsVJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>DemandTributeMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aN8VUVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aN8VUlJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aN8VVVJNEeiyW7NaN4qWdw" type="_Y9jEcFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aN88YFJNEeiyW7NaN4qWdw" name="handle" method="_aVK-uFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXAKslJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;demandTribute&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param player The &lt;code>Player&lt;/code> that sent the message.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     * @return An &lt;code>Element&lt;/code> to update the originating&#xD;
     *     player with the result of the demand.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aN88YVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aN88YlJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aN88Y1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aN88ZFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_Y9rnUFJNEeiyW7NaN4qWdw" name="DiplomacyMessage">
                <ownedComment xmi:id="_aXAKtFJNEeiyW7NaN4qWdw">
                  <body>The message sent when executing a diplomatic trade.</body>
                </ownedComment>
                <generalization xmi:id="_aJGRkFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aSRbsVJNEeiyW7NaN4qWdw" name="ourId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aSSCwVJNEeiyW7NaN4qWdw" name="otherId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aSSp0VJNEeiyW7NaN4qWdw" name="agreement" type="_aJCnMFJNEeiyW7NaN4qWdw" association="_aZ_NQVJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aSe3EVJNEeiyW7NaN4qWdw" name="extraUnit" type="_aG5SIVJNEeiyW7NaN4qWdw" isReadOnly="true" association="_aaGiAVJNEeiyW7NaN4qWdw"/>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVLlwlJNEeiyW7NaN4qWdw" name="DiplomacyMessage" specification="_aN-KgFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVLlw1JNEeiyW7NaN4qWdw" name="our" type="_aH3igFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVLlxFJNEeiyW7NaN4qWdw" name="other" type="_aH3igFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVLlxVJNEeiyW7NaN4qWdw" name="agreement" type="_aJCnMFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVLlxlJNEeiyW7NaN4qWdw" type="_Y9rnUFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.ourId = our.getId();&#xD;
     this.otherId = other.getId();&#xD;
     this.agreement = agreement;&#xD;
     this.extraUnit = null;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVMM0FJNEeiyW7NaN4qWdw" name="DiplomacyMessage" specification="_aN_YoFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVMM0VJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVMM0lJNEeiyW7NaN4qWdw" name="otherUnit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVMM01JNEeiyW7NaN4qWdw" name="agreement" type="_aJCnMFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVMM1FJNEeiyW7NaN4qWdw" type="_Y9rnUFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>this((FreeColGameObject)unit, (FreeColGameObject)otherUnit, agreement);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVMM1VJNEeiyW7NaN4qWdw" name="DiplomacyMessage" specification="_aN__sFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVMM1lJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVMM11JNEeiyW7NaN4qWdw" name="colony" type="_aGwvQFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVMM2FJNEeiyW7NaN4qWdw" name="agreement" type="_aJCnMFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVMM2VJNEeiyW7NaN4qWdw" type="_Y9rnUFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>this((FreeColGameObject)unit, (FreeColGameObject)colony, agreement);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVMM2lJNEeiyW7NaN4qWdw" name="DiplomacyMessage" specification="_aOAmwFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVMM21JNEeiyW7NaN4qWdw" name="colony" type="_aGwvQFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVMM3FJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVMM3VJNEeiyW7NaN4qWdw" name="agreement" type="_aJCnMFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVMM3lJNEeiyW7NaN4qWdw" type="_Y9rnUFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>this((FreeColGameObject)colony, (FreeColGameObject)unit, agreement);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVMz4FJNEeiyW7NaN4qWdw" name="DiplomacyMessage" specification="_aOBN0VJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVMz4VJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVMz4lJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVMz41JNEeiyW7NaN4qWdw" type="_Y9rnUFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.ourId = element.getAttribute(&quot;ourId&quot;);&#xD;
     this.otherId = element.getAttribute(&quot;otherId&quot;);&#xD;
     &#xD;
     NodeList nodes = element.getChildNodes();&#xD;
     this.agreement = (nodes.getLength() &lt; 1) ? null&#xD;
         : new DiplomaticTrade(game, (Element)nodes.item(0));&#xD;
     if (nodes.getLength() &lt; 2) {&#xD;
         this.extraUnit = null;&#xD;
     } else {&#xD;
         Element ue = (Element)nodes.item(1);&#xD;
         String id = FreeColObject.readId(ue);&#xD;
         this.extraUnit = game.getFreeColGameObject(id, Unit.class);&#xD;
         if (this.extraUnit == null) this.extraUnit = new Unit(game, ue);&#xD;
     }&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVMz5FJNEeiyW7NaN4qWdw" name="getOurFCGO" specification="_aOB04VJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVMz5VJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVMz5lJNEeiyW7NaN4qWdw" type="_aH3igFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return game.getFreeColGameObject(this.ourId);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVMz51JNEeiyW7NaN4qWdw" name="getOtherFCGO" specification="_aOCb8VJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVMz6FJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVMz6VJNEeiyW7NaN4qWdw" type="_aH3igFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return game.getFreeColGameObject(this.otherId);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVNa8FJNEeiyW7NaN4qWdw" name="handle" specification="_aODDAVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVNa8VJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVNa8lJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVNa81JNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
     final Game game = serverPlayer.getGame();&#xD;
&#xD;
     if (this.agreement == null) {&#xD;
         return DOMMessage.clientError(&quot;Null diplomatic agreement.&quot;);&#xD;
     }&#xD;
&#xD;
     Unit ourUnit = null;&#xD;
     Colony ourColony = null;&#xD;
     FreeColGameObject our = getOurFCGO(game);&#xD;
     if (our == null) {&#xD;
         return DOMMessage.clientError(&quot;Missing our object: &quot; + ourId);&#xD;
     } if (our instanceof Unit) {&#xD;
         ourUnit = (Unit)our;&#xD;
         if (!serverPlayer.owns(ourUnit)) {&#xD;
             return DOMMessage.clientError(&quot;Not our unit: &quot; + ourId);&#xD;
         } else if (!ourUnit.hasTile()) {&#xD;
             return DOMMessage.clientError(&quot;Our unit is not on the map: &quot;&#xD;
                 + ourId);&#xD;
         }&#xD;
     } else if (our instanceof Colony) {&#xD;
         ourColony = (Colony)our;&#xD;
         if (!serverPlayer.owns(ourColony)) {&#xD;
             return DOMMessage.clientError(&quot;Not our settlement: &quot; + ourId);&#xD;
         }&#xD;
     } else {&#xD;
         return DOMMessage.clientError(&quot;Our object is bogus: &quot; + our);&#xD;
     }&#xD;
&#xD;
     Unit otherUnit = null;&#xD;
     Colony otherColony = null;&#xD;
     Player otherPlayer = null;&#xD;
     FreeColGameObject other = getOtherFCGO(game);&#xD;
     if (other == null) {&#xD;
         return DOMMessage.clientError(&quot;Missing other object: &quot; + otherId);&#xD;
     } if (other instanceof Unit) {&#xD;
         otherUnit = (Unit)other;&#xD;
         if (serverPlayer.owns(otherUnit)) {&#xD;
             return DOMMessage.clientError(&quot;Contacting our unit? &quot; + otherId);&#xD;
         } else if (!otherUnit.hasTile()) {&#xD;
             return DOMMessage.clientError(&quot;Other unit is not on the map: &quot;&#xD;
                 + otherId);&#xD;
         } else if (ourUnit != null&#xD;
             &amp;&amp; !ourUnit.getTile().isAdjacent(otherUnit.getTile())) {&#xD;
             return DOMMessage.clientError(&quot;Our unit &quot; + ourId&#xD;
                 + &quot; is not adjacent to other unit &quot; + otherId);&#xD;
         } else if (ourColony != null&#xD;
             &amp;&amp; !ourColony.getTile().isAdjacent(otherUnit.getTile())) {&#xD;
             return DOMMessage.clientError(&quot;Our colony &quot; + ourId&#xD;
                 + &quot; is not adjacent to other unit &quot; + otherId);&#xD;
         }&#xD;
         otherPlayer = otherUnit.getOwner();&#xD;
     } else if (other instanceof Colony) {&#xD;
         otherColony = (Colony)other;&#xD;
         if (serverPlayer.owns(otherColony)) {&#xD;
             return DOMMessage.clientError(&quot;Contacting our colony? &quot; + otherId);&#xD;
         } else if (ourUnit != null&#xD;
             &amp;&amp; !ourUnit.getTile().isAdjacent(otherColony.getTile())) {&#xD;
             return DOMMessage.clientError(&quot;Our unit &quot; + ourId&#xD;
                 + &quot; is not adjacent to other colony &quot; + otherId);&#xD;
         } else if (ourColony != null&#xD;
             &amp;&amp; !ourColony.getTile().isAdjacent(otherColony.getTile())) {&#xD;
             return DOMMessage.clientError(&quot;Our colony &quot; + ourId&#xD;
                 + &quot; is not adjacent to other colony &quot; + otherId);&#xD;
         }&#xD;
         otherPlayer = otherColony.getOwner();&#xD;
     } else {&#xD;
         return DOMMessage.clientError(&quot;Other object is bogus: &quot; + other);&#xD;
     }&#xD;
     if (ourUnit == null &amp;&amp; otherUnit == null) {&#xD;
         return DOMMessage.clientError(&quot;Both units null&quot;);&#xD;
     }&#xD;
&#xD;
     Player senderPlayer = agreement.getSender();&#xD;
     Player recipientPlayer = agreement.getRecipient();&#xD;
     Player refPlayer = serverPlayer.getREFPlayer();&#xD;
     if (senderPlayer == null) {&#xD;
         return DOMMessage.clientError(&quot;Null sender in agreement.&quot;);&#xD;
     } else if (recipientPlayer == null) {&#xD;
         return DOMMessage.clientError(&quot;Null recipient in agreement.&quot;);&#xD;
     } else if (senderPlayer != (Player)serverPlayer) {&#xD;
         return DOMMessage.clientError(&quot;Sender is not our player: &quot;&#xD;
             + senderPlayer.getId());&#xD;
     } else if (recipientPlayer != otherPlayer) {&#xD;
         return DOMMessage.clientError(&quot;Recipient is not other player: &quot;&#xD;
             + recipientPlayer.getId());&#xD;
     } else if (senderPlayer == refPlayer || recipientPlayer == refPlayer) {&#xD;
         return DOMMessage.clientError(&quot;The REF does not negotiate: &quot;&#xD;
             + refPlayer.getId());&#xD;
     }&#xD;
&#xD;
     final InGameController igc = server.getInGameController();&#xD;
     switch (agreement.getContext()) {&#xD;
     case CONTACT:&#xD;
         return (ourColony != null)&#xD;
             ? igc.europeanFirstContact(serverPlayer, ourColony, otherUnit,&#xD;
                                        agreement)&#xD;
             : (otherUnit != null)&#xD;
             ? igc.europeanFirstContact(serverPlayer, ourUnit, otherUnit,&#xD;
                                        agreement)&#xD;
             : igc.europeanFirstContact(serverPlayer, ourUnit, otherColony,&#xD;
                                        agreement);&#xD;
     case DIPLOMATIC:&#xD;
         return (ourUnit != null) &#xD;
             ? ((!ourUnit.hasAbility(Ability.NEGOTIATE))&#xD;
                 ? DOMMessage.clientError(&quot;Unit lacks ability&quot;&#xD;
                     + &quot; to negotiate: &quot; + ourUnit)&#xD;
                 : (otherColony == null)&#xD;
                 ? DOMMessage.clientError(&quot;Null other settlement&quot;)&#xD;
                 : igc.diplomacy(serverPlayer, ourUnit, otherColony,&#xD;
                                 agreement))&#xD;
             : ((!otherUnit.hasAbility(Ability.NEGOTIATE))&#xD;
                 ? DOMMessage.clientError(&quot;Unit lacks ability&quot;&#xD;
                     + &quot; to negotiate: &quot; + otherUnit)&#xD;
                 : igc.diplomacy(serverPlayer, ourColony, otherUnit,&#xD;
                                 agreement));&#xD;
     case TRADE:&#xD;
         return (ourUnit != null)&#xD;
             ? ((!ourUnit.isCarrier())&#xD;
                 ? DOMMessage.clientError(&quot;Unit is not a carrier: &quot;&#xD;
                     + ourUnit)&#xD;
                 : (!serverPlayer.hasAbility(Ability.TRADE_WITH_FOREIGN_COLONIES))&#xD;
                 ? DOMMessage.clientError(&quot;Player lacks ability&quot;&#xD;
                     + &quot; to trade with other Europeans: &quot; + serverPlayer)&#xD;
                 : (otherColony == null)&#xD;
                 ? DOMMessage.clientError(&quot;Null other settlement&quot;)&#xD;
                 : igc.diplomacy(serverPlayer, ourUnit, otherColony,&#xD;
                                 agreement))&#xD;
             : ((!otherUnit.isCarrier())&#xD;
                 ? DOMMessage.clientError(&quot;Unit is not a carrier: &quot;&#xD;
                     + otherUnit)&#xD;
                 : (!otherPlayer.hasAbility(Ability.TRADE_WITH_FOREIGN_COLONIES))&#xD;
                 ? DOMMessage.clientError(&quot;Player lacks ability&quot;&#xD;
                     + &quot; to trade with other Europeans: &quot; + otherPlayer)&#xD;
                 : igc.diplomacy(serverPlayer, ourColony, otherUnit,&#xD;
                                 agreement));&#xD;
     case TRIBUTE:&#xD;
         return (ourUnit != null)&#xD;
             ? ((!ourUnit.isOffensiveUnit() || ourUnit.isNaval())&#xD;
                 ? DOMMessage.clientError(&quot;Unit is not an offensive&quot;&#xD;
                     + &quot; land unit: &quot; + ourUnit)&#xD;
                 : (otherColony == null)&#xD;
                 ? DOMMessage.clientError(&quot;Null other settlement&quot;)&#xD;
                 : igc.diplomacy(serverPlayer, ourUnit, otherColony,&#xD;
                                 agreement))&#xD;
             : ((!otherUnit.isOffensiveUnit() || otherUnit.isNaval())&#xD;
                 ? DOMMessage.clientError(&quot;Unit is not an offensive&quot;&#xD;
                     + &quot; land unit: &quot; + otherUnit)&#xD;
                 : igc.diplomacy(serverPlayer, ourColony, otherUnit,&#xD;
                                 agreement));&#xD;
     default:&#xD;
         break;&#xD;
     }&#xD;
     return DOMMessage.clientError(&quot;Invalid diplomacy for &quot;&#xD;
         + agreement.getContext());&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVNa9FJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_Y9wf0FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVNa9VJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>Element result = createMessage(getXMLElementTagName(),&#xD;
         &quot;ourId&quot;, ourId,&#xD;
         &quot;otherId&quot;, otherId);&#xD;
     Document doc = result.getOwnerDocument();&#xD;
     result.appendChild(agreement.toXMLElement(doc));&#xD;
     if (extraUnit != null) result.appendChild(extraUnit.toXMLElement(doc));&#xD;
     return result;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVNa9lJNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_Y9xt8FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVNa91JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;diplomacy&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_Y9wf0FJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aVNa9FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aODqElJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y9xt8FJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aVNa9lJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXAxxVJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;diplomacy&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y9xt8VJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aN-KgFJNEeiyW7NaN4qWdw" name="DiplomacyMessage" method="_aVLlwlJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aN-xkVJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aN-xklJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXAKtVJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>DiplomacyMessage&lt;/code>.&#xD;
     *&#xD;
     * @param our Our &lt;code>FreeColGameObject&lt;/code> that is negotiating.&#xD;
     * @param other The other &lt;code>FreeColGameObject&lt;/code> to negotiate with.&#xD;
     * @param agreement The &lt;code>DiplomaticTrade&lt;/code> to make.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aN-KgVJNEeiyW7NaN4qWdw" name="our" type="_aH3igFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aN-KglJNEeiyW7NaN4qWdw" name="other" type="_aH3igFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aN-xkFJNEeiyW7NaN4qWdw" name="agreement" type="_aJCnMFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aN-xk1JNEeiyW7NaN4qWdw" type="_Y9rnUFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aN_YoFJNEeiyW7NaN4qWdw" name="DiplomacyMessage" method="_aVMM0FJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aN_YpFJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aN_YpVJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXAKtlJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>DiplomacyMessage&lt;/code>.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is negotiating.&#xD;
     * @param otherUnit The other &lt;code>Unit&lt;/code> to negotiate with.&#xD;
     * @param agreement The &lt;code>DiplomaticTrade&lt;/code> to make.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aN_YoVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aN_YolJNEeiyW7NaN4qWdw" name="otherUnit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aN_Yo1JNEeiyW7NaN4qWdw" name="agreement" type="_aJCnMFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aN_YplJNEeiyW7NaN4qWdw" type="_Y9rnUFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aN__sFJNEeiyW7NaN4qWdw" name="DiplomacyMessage" method="_aVMM1VJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aN__tFJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aN__tVJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXAKt1JNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>DiplomacyMessage&lt;/code>.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is negotiating.&#xD;
     * @param colony The &lt;code>Colony&lt;/code> to negotiate with.&#xD;
     * @param agreement The &lt;code>DiplomaticTrade&lt;/code> to make.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aN__sVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aN__slJNEeiyW7NaN4qWdw" name="colony" type="_aGwvQFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aN__s1JNEeiyW7NaN4qWdw" name="agreement" type="_aJCnMFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aN__tlJNEeiyW7NaN4qWdw" type="_Y9rnUFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aOAmwFJNEeiyW7NaN4qWdw" name="DiplomacyMessage" method="_aVMM2lJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aOAmxFJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aOAmxVJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXAxwFJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>DiplomacyMessage&lt;/code>.&#xD;
     *&#xD;
     * @param colony The &lt;code>Colony&lt;/code> that is negotiating.&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that to negotiate with.&#xD;
     * @param agreement The &lt;code>DiplomaticTrade&lt;/code> to make.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aOAmwVJNEeiyW7NaN4qWdw" name="colony" type="_aGwvQFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOAmwlJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOAmw1JNEeiyW7NaN4qWdw" name="agreement" type="_aJCnMFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOBN0FJNEeiyW7NaN4qWdw" type="_Y9rnUFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aOBN0VJNEeiyW7NaN4qWdw" name="DiplomacyMessage" method="_aVMz4FJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aOBN1FJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aOBN1VJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXAxwVJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>DiplomacyMessage&lt;/code> from a&#xD;
     * supplied element.  The unit is supplied in case it was hidden in&#xD;
     * some way, such as aboard a ship.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aOBN0lJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOBN01JNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOB04FJNEeiyW7NaN4qWdw" type="_Y9rnUFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aOB04VJNEeiyW7NaN4qWdw" name="getOurFCGO" method="_aVMz5FJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXAxwlJNEeiyW7NaN4qWdw">
                    <body>Get our FCGO.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> to extract the FCGO from.&#xD;
     * @return Our &lt;code>FreeColGameObject&lt;/code>.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aOB04lJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOCb8FJNEeiyW7NaN4qWdw" type="_aH3igFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aOCb8VJNEeiyW7NaN4qWdw" name="getOtherFCGO" method="_aVMz51JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXAxw1JNEeiyW7NaN4qWdw">
                    <body>Get the other FCGO.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> to extract the FCGO from.&#xD;
     * @return The other &lt;code>FreeColGameObject&lt;/code>.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aOCb8lJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aODDAFJNEeiyW7NaN4qWdw" type="_aH3igFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aODDAVJNEeiyW7NaN4qWdw" name="handle" method="_aVNa8FJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXAxxFJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;diplomacy&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> that handles the message.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> the message is from.&#xD;
     * @return An &lt;code>Element&lt;/code> describing the trade with either&#xD;
     *         &quot;accept&quot; or &quot;reject&quot; status, null on trade failure,&#xD;
     *         or an error &lt;code>Element&lt;/code> on outright error.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aODDAlJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aODqEFJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aODqEVJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_Y98tEFJNEeiyW7NaN4qWdw" name="DisbandUnitMessage">
                <ownedComment xmi:id="_aXAxxlJNEeiyW7NaN4qWdw">
                  <body>The message sent when disbanding a unit.</body>
                </ownedComment>
                <generalization xmi:id="_aJKjAFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aSgFMFJNEeiyW7NaN4qWdw" name="unitId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVOCAFJNEeiyW7NaN4qWdw" name="DisbandUnitMessage" specification="_aOERIFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVOCAVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVOCAlJNEeiyW7NaN4qWdw" type="_Y98tEFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = unit.getId();&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVOCA1JNEeiyW7NaN4qWdw" name="DisbandUnitMessage" specification="_aOFfQFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVOCBFJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVOCBVJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVOCBlJNEeiyW7NaN4qWdw" type="_Y98tEFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = element.getAttribute(&quot;unit&quot;);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVOCB1JNEeiyW7NaN4qWdw" name="handle" specification="_aOGGUFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVOCCFJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVOCCVJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVOCClJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVOCC1JNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
&#xD;
     Unit unit;&#xD;
     try {&#xD;
         unit = player.getOurFreeColGameObject(unitId, Unit.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     // Try to clear.&#xD;
     return server.getInGameController()&#xD;
         .disbandUnit(serverPlayer, unit);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVOpEFJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_Y9_JUFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVOpEVJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return createMessage(getXMLElementTagName(),&#xD;
         &quot;unit&quot;, unitId);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVOpElJNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_Y-DawFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVOpE1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;disbandUnit&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_Y9_JUFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aVOpEFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aOGtYFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y-DawFJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aVOpElJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXBY0VJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;disbandUnit&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y-GeEFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aOERIFJNEeiyW7NaN4qWdw" name="DisbandUnitMessage" method="_aVOCAFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aOE4MVJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aOE4MlJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXAxx1JNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>DisbandUnitMessage&lt;/code> with the&#xD;
     * supplied unit.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> to clear.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aOE4MFJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOE4M1JNEeiyW7NaN4qWdw" type="_Y98tEFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aOFfQFJNEeiyW7NaN4qWdw" name="DisbandUnitMessage" method="_aVOCA1JNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aOFfQ1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aOFfRFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXAxyFJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>DisbandUnitMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aOFfQVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOFfQlJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOFfRVJNEeiyW7NaN4qWdw" type="_Y98tEFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aOGGUFJNEeiyW7NaN4qWdw" name="handle" method="_aVOCB1JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXBY0FJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;disbandUnit&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param player The &lt;code>Player&lt;/code> the message applies to.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     * @return An update containing the cleared unit, or an error&#xD;
     *     &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aOGGUVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOGGUlJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOGGU1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOGGVFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_Y-I6UFJNEeiyW7NaN4qWdw" name="DisembarkMessage">
                <ownedComment xmi:id="_aXBY0lJNEeiyW7NaN4qWdw">
                  <body>The message sent when disembarking.</body>
                </ownedComment>
                <generalization xmi:id="_aJM_QFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aShTUFJNEeiyW7NaN4qWdw" name="unitId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVOpFFJNEeiyW7NaN4qWdw" name="DisembarkMessage" specification="_aOGtYVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVOpFVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVOpFlJNEeiyW7NaN4qWdw" type="_Y-I6UFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = unit.getId();&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVPQIFJNEeiyW7NaN4qWdw" name="DisembarkMessage" specification="_aOHUdFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVPQIVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVPQIlJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVPQI1JNEeiyW7NaN4qWdw" type="_Y-I6UFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = element.getAttribute(&quot;unit&quot;);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVPQJFJNEeiyW7NaN4qWdw" name="handle" specification="_aOIikFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVPQJVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVPQJlJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVPQJ1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVPQKFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
&#xD;
     ServerUnit unit;&#xD;
     try {&#xD;
         unit = player.getOurFreeColGameObject(unitId, ServerUnit.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     // Do the disembark.&#xD;
     return server.getInGameController()&#xD;
         .disembarkUnit(serverPlayer, unit);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVPQKVJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_Y-KvgFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVPQKlJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return createMessage(getXMLElementTagName(),&#xD;
         &quot;unit&quot;, unitId);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVP3MFJNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_Y-L9oFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVP3MVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;disembark&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_Y-KvgFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aVPQKVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aOJJoFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y-L9oFJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aVP3MFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXBY1lJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;disembark&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y-L9oVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aOGtYVJNEeiyW7NaN4qWdw" name="DisembarkMessage" method="_aVOpFFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aOHUcVJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aOHUclJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXBY01JNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>DisembarkMessage&lt;/code> with the&#xD;
     * supplied name.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is disembarking.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aOHUcFJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOHUc1JNEeiyW7NaN4qWdw" type="_Y-I6UFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aOHUdFJNEeiyW7NaN4qWdw" name="DisembarkMessage" method="_aVPQIFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aOH7glJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aOH7g1JNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXBY1FJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>DisembarkMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aOH7gFJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOH7gVJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOH7hFJNEeiyW7NaN4qWdw" type="_Y-I6UFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aOIikFJNEeiyW7NaN4qWdw" name="handle" method="_aVPQJFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXBY1VJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;disembark&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param player The &lt;code>Player&lt;/code> the message applies to.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     * @return An update containing the disembarked unit, or an error&#xD;
     *     &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aOIikVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOIiklJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOIik1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOIilFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_Y-PA8FJNEeiyW7NaN4qWdw" name="EmbarkMessage">
                <ownedComment xmi:id="_aXBY11JNEeiyW7NaN4qWdw">
                  <body>The message sent when embarking.</body>
                </ownedComment>
                <generalization xmi:id="_aJQCkFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aSh6YFJNEeiyW7NaN4qWdw" name="unitId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aSjIgFJNEeiyW7NaN4qWdw" name="carrierId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aSjIglJNEeiyW7NaN4qWdw" name="directionString" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVP3MlJNEeiyW7NaN4qWdw" name="EmbarkMessage" specification="_aOJwsFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVP3M1JNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVP3NFJNEeiyW7NaN4qWdw" name="carrier" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVP3NVJNEeiyW7NaN4qWdw" name="direction" type="_aG4EAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVP3NlJNEeiyW7NaN4qWdw" type="_Y-PA8FJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = unit.getId();&#xD;
     this.carrierId = carrier.getId();&#xD;
     this.directionString = (direction == null) ? null&#xD;
         : String.valueOf(direction);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVQeQFJNEeiyW7NaN4qWdw" name="EmbarkMessage" specification="_aOKXwFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVQeQVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVQeQlJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVQeQ1JNEeiyW7NaN4qWdw" type="_Y-PA8FJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = element.getAttribute(&quot;unit&quot;);&#xD;
     this.carrierId = element.getAttribute(&quot;carrier&quot;);&#xD;
     this.directionString = (!element.hasAttribute(&quot;direction&quot;)) ? null&#xD;
         : element.getAttribute(&quot;direction&quot;);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVQeRFJNEeiyW7NaN4qWdw" name="handle" specification="_aOK-0FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVQeRVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVQeRlJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVQeR1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVQeSFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
&#xD;
     ServerUnit unit;&#xD;
     try {&#xD;
         unit = player.getOurFreeColGameObject(unitId, ServerUnit.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     Unit carrier;&#xD;
     try {&#xD;
         carrier = player.getOurFreeColGameObject(carrierId, Unit.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     Location sourceLocation = unit.getLocation();&#xD;
     if (directionString == null) {&#xD;
         // Locations must be the same, or the source is also a&#xD;
         // carrier in the same location as the carrier, or they&#xD;
         // must be on the same tile.&#xD;
         if (!carrier.isAtLocation(sourceLocation)) {&#xD;
             return DOMMessage.clientError(&quot;Unit &quot; + unitId&#xD;
                 + &quot; at &quot; + sourceLocation.getId()&#xD;
                 + &quot; and carrier &quot; + carrierId&#xD;
                 + &quot; at &quot; + carrier.getLocation().getId()&#xD;
                 + &quot; are not co-located.&quot;);&#xD;
         }&#xD;
     } else {&#xD;
         // Units have to be on the map and have moves left if a&#xD;
         // move is involved.&#xD;
         if (unit.getMovesLeft() &lt;= 0) {&#xD;
             return DOMMessage.clientError(&quot;Unit has no moves left: &quot;&#xD;
                 + unitId);&#xD;
         }&#xD;
&#xD;
         Tile destinationTile = null;&#xD;
         try {&#xD;
             destinationTile = unit.getNeighbourTile(directionString);&#xD;
         } catch (Exception e) {&#xD;
             return DOMMessage.clientError(e.getMessage());&#xD;
         }&#xD;
         if (carrier.getTile() != destinationTile) {&#xD;
             return DOMMessage.clientError(&quot;Carrier: &quot; + carrierId&#xD;
                 + &quot; is not at destination tile: &quot; + destinationTile);&#xD;
         }&#xD;
     }&#xD;
&#xD;
     // Proceed to embark&#xD;
     return server.getInGameController()&#xD;
         .embarkUnit(serverPlayer, unit, carrier);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVQeSVJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_Y-Q2IFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVQeSlJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>Element result = createMessage(getXMLElementTagName(),&#xD;
         &quot;unit&quot;, unitId,&#xD;
         &quot;carrier&quot;, carrierId);&#xD;
     if (directionString != null) {&#xD;
         result.setAttribute(&quot;direction&quot;, directionString);&#xD;
     }&#xD;
     return result;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVRFUFJNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_Y-SEQlJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVRFUVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;embark&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_Y-Q2IFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aVQeSVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aOLl4VJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y-SEQlJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aVRFUFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXB_4VJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;embark&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y-SrUFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aOJwsFJNEeiyW7NaN4qWdw" name="EmbarkMessage" method="_aVP3MlJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aOJwtFJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aOJwtVJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXBY2FJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>EmbarkMessage&lt;/code> with the&#xD;
     * supplied unit, carrier and optional direction.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> to embark.&#xD;
     * @param carrier The carrier &lt;code>Unit&lt;/code> to embark on.&#xD;
     * @param direction An option direction to embark in.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aOJwsVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOJwslJNEeiyW7NaN4qWdw" name="carrier" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOJws1JNEeiyW7NaN4qWdw" name="direction" type="_aG4EAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOJwtlJNEeiyW7NaN4qWdw" type="_Y-PA8FJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aOKXwFJNEeiyW7NaN4qWdw" name="EmbarkMessage" method="_aVQeQFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aOKXw1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aOKXxFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXBY2VJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>EmbarkMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aOKXwVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOKXwlJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOKXxVJNEeiyW7NaN4qWdw" type="_Y-PA8FJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aOK-0FJNEeiyW7NaN4qWdw" name="handle" method="_aVQeRFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXB_4FJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;embark&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param player The &lt;code>Player&lt;/code> the message applies to.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     * @return An update containing the embarked unit, or an error&#xD;
     *     &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aOK-0VJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOK-0lJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOK-01JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOLl4FJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_Y-VuoFJNEeiyW7NaN4qWdw" name="EmigrateUnitMessage">
                <ownedComment xmi:id="_aXB_4lJNEeiyW7NaN4qWdw">
                  <body>The message sent when a unit is to emigrate.</body>
                </ownedComment>
                <generalization xmi:id="_aJTs8FJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aSkWoFJNEeiyW7NaN4qWdw" name="slotString" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVRFUlJNEeiyW7NaN4qWdw" name="EmigrateUnitMessage" specification="_Y-W8wFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVRFU1JNEeiyW7NaN4qWdw" name="slot">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aVRFVFJNEeiyW7NaN4qWdw" type="_Y-VuoFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.slotString = Integer.toString(slot);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVRFVVJNEeiyW7NaN4qWdw" name="EmigrateUnitMessage" specification="_aOMM8FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVRFVlJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVRFV1JNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVRFWFJNEeiyW7NaN4qWdw" type="_Y-VuoFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.slotString = element.getAttribute(&quot;slot&quot;);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVRsYFJNEeiyW7NaN4qWdw" name="handle" specification="_aOM0AlJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVRsYVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVRsYlJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVRsY1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVRsZFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
&#xD;
     Europe europe = player.getEurope();&#xD;
     if (europe == null) {&#xD;
         return DOMMessage.clientError(&quot;No Europe to migrate from.&quot;);&#xD;
     }&#xD;
     int slot;&#xD;
     try {&#xD;
         slot = Integer.parseInt(slotString);&#xD;
     } catch (NumberFormatException e) {&#xD;
         return DOMMessage.clientError(&quot;Bad slot: &quot; + slotString);&#xD;
     }&#xD;
     if (!MigrationType.validMigrantSlot(slot)) {&#xD;
         return DOMMessage.clientError(&quot;Invalid slot for recruitment: &quot;&#xD;
             + slot);&#xD;
     }&#xD;
         &#xD;
     MigrationType type;&#xD;
     if (serverPlayer.getRemainingEmigrants() > 0) {&#xD;
         if (MigrationType.unspecificMigrantSlot(slot)) {&#xD;
             return DOMMessage.clientError(&quot;Specific slot expected for FoY migration.&quot;);&#xD;
         }&#xD;
         type = MigrationType.FOUNTAIN;&#xD;
     } else if (player.checkEmigrate()) {&#xD;
         if (MigrationType.specificMigrantSlot(slot)&#xD;
             &amp;&amp; !player.hasAbility(Ability.SELECT_RECRUIT)) {&#xD;
             return DOMMessage.clientError(&quot;selectRecruit ability absent.&quot;);&#xD;
         }&#xD;
         type = MigrationType.NORMAL;&#xD;
     } else {&#xD;
         if (!player.checkGold(europe.getRecruitPrice())) {&#xD;
             return DOMMessage.clientError(&quot;No migrants available at cost &quot;&#xD;
                 + europe.getRecruitPrice()&#xD;
                 + &quot; for player with &quot; + player.getGold() + &quot; gold.&quot;);&#xD;
         }&#xD;
         type = MigrationType.RECRUIT;&#xD;
     }&#xD;
&#xD;
     // Proceed to emigrate.&#xD;
     return server.getInGameController()&#xD;
         .emigrate(serverPlayer, slot, type);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVRsZVJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_Y-Yx8FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVRsZlJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return createMessage(getXMLElementTagName(),&#xD;
         &quot;slot&quot;, slotString);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVRsZ1JNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_Y-aAEFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVRsaFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;emigrateUnit&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_Y-W8wFJNEeiyW7NaN4qWdw" name="EmigrateUnitMessage" method="_aVRFUlJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_Y-W8wlJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_Y-Xj0FJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXB_41JNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>EmigrateUnitMessage&lt;/code> with the supplied slot.&#xD;
     *&#xD;
     * @param slot The slot to select the migrant from.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y-W8wVJNEeiyW7NaN4qWdw" name="slot">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Y-Xj0VJNEeiyW7NaN4qWdw" type="_Y-VuoFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y-Yx8FJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aVRsZVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aONbE1JNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y-aAEFJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aVRsZ1JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXB_5lJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;emigrateUnit&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y-aAEVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aOMM8FJNEeiyW7NaN4qWdw" name="EmigrateUnitMessage" method="_aVRFVVJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aOMM81JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aOM0AFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXB_5FJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>EmigrateUnitMessage&lt;/code> from a supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aOMM8VJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOMM8lJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOM0AVJNEeiyW7NaN4qWdw" type="_Y-VuoFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aOM0AlJNEeiyW7NaN4qWdw" name="handle" method="_aVRsYFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXB_5VJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;emigrateUnit&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param player The &lt;code>Player&lt;/code> the message applies to.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating the change,&#xD;
     *         or an error &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aOM0A1JNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aONbEFJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aONbEVJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aONbElJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_Y-ccUFJNEeiyW7NaN4qWdw" name="EquipForRoleMessage">
                <ownedComment xmi:id="_aXB_51JNEeiyW7NaN4qWdw">
                  <body>The message sent to equip a unit for a particular role.</body>
                </ownedComment>
                <generalization xmi:id="_aJWJMFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aSk9sFJNEeiyW7NaN4qWdw" name="unitId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aSlkwFJNEeiyW7NaN4qWdw" name="roleId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aSlkwlJNEeiyW7NaN4qWdw" name="roleCount" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVSTcFJNEeiyW7NaN4qWdw" name="EquipForRoleMessage" specification="_aOOCIFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVSTcVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVSTclJNEeiyW7NaN4qWdw" name="role" type="_aJU7EFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVSTc1JNEeiyW7NaN4qWdw" name="roleCount">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aVSTdFJNEeiyW7NaN4qWdw" type="_Y-ccUFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = unit.getId();&#xD;
     this.roleId = role.getId();&#xD;
     this.roleCount = String.valueOf(roleCount);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVSTdVJNEeiyW7NaN4qWdw" name="EquipForRoleMessage" specification="_aOPQQFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVSTdlJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVSTd1JNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVSTeFJNEeiyW7NaN4qWdw" type="_Y-ccUFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = element.getAttribute(&quot;unit&quot;);&#xD;
     this.roleId = element.getAttribute(&quot;role&quot;);&#xD;
     this.roleCount = element.getAttribute(&quot;count&quot;);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVS6gFJNEeiyW7NaN4qWdw" name="handle" specification="_aOP3UFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVS6gVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVS6glJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVS6g1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVS6hFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
     final Game game = server.getGame();&#xD;
&#xD;
     Unit unit;&#xD;
     try {&#xD;
         unit = player.getOurFreeColGameObject(unitId, Unit.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
     if (unit.isInEurope()) {&#xD;
         ; // Always OK&#xD;
     } else if (!unit.hasTile()) {&#xD;
         return DOMMessage.clientError(&quot;Unit is not on the map: &quot;&#xD;
             + unitId);&#xD;
     } else if (unit.getSettlement() == null) {&#xD;
         return DOMMessage.clientError(&quot;Unit is not in a settlement: &quot;&#xD;
             + unitId);&#xD;
     }&#xD;
&#xD;
     Role role = game.getSpecification().getRole(roleId);&#xD;
     if (role == null) {&#xD;
         return DOMMessage.clientError(&quot;Not a role: &quot; + roleId);&#xD;
     }&#xD;
     int count;&#xD;
     try {&#xD;
         count = Integer.parseInt(roleCount);&#xD;
     } catch (NumberFormatException nfe) {&#xD;
         return DOMMessage.clientError(&quot;Role count is not an integer: &quot; +&#xD;
             roleCount);&#xD;
     }&#xD;
     if (count &lt; 0 || count > role.getMaximumCount()) {&#xD;
         return DOMMessage.clientError(&quot;Invalid role count: &quot; + roleCount);&#xD;
     }&#xD;
&#xD;
     // Proceed to equip.&#xD;
     return server.getInGameController()&#xD;
         .equipForRole(serverPlayer, unit, role, count); &#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVS6hVJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_Y-eRgFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVS6hlJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return createMessage(getXMLElementTagName(),&#xD;
         &quot;unit&quot;, unitId,&#xD;
         &quot;role&quot;, roleId,&#xD;
         &quot;count&quot;, roleCount);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVS6h1JNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_Y-ffolJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVS6iFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;equipForRole&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_Y-eRgFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aVS6hVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aOQeYFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y-ffolJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aVS6h1JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXCm8VJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;equipForRole&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y-gGsFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aOOCIFJNEeiyW7NaN4qWdw" name="EquipForRoleMessage" method="_aVSTcFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aOOpMlJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aOOpM1JNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXB_6FJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>EquipForRoleMessage&lt;/code> for the supplied&#xD;
     * Unit and Role.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> to equip.&#xD;
     * @param role The &lt;code>Role&lt;/code> to equip for.&#xD;
     * @param roleCount The role count.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aOOCIVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOOpMFJNEeiyW7NaN4qWdw" name="role" type="_aJU7EFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOOpMVJNEeiyW7NaN4qWdw" name="roleCount">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aOOpNFJNEeiyW7NaN4qWdw" type="_Y-ccUFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aOPQQFJNEeiyW7NaN4qWdw" name="EquipForRoleMessage" method="_aVSTdVJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aOPQQ1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aOPQRFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXB_6VJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>EquipForRoleMessage&lt;/code> from a supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aOPQQVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOPQQlJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOPQRVJNEeiyW7NaN4qWdw" type="_Y-ccUFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aOP3UFJNEeiyW7NaN4qWdw" name="handle" method="_aVS6gFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXCm8FJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;equipForRole&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param player The &lt;code>Player&lt;/code> the message applies to.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message received on.&#xD;
     * @return An update encapsulating the equipForRole location change&#xD;
     *     or an error &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aOP3UVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOP3UlJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOP3U1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOP3VFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_Y-jxEFJNEeiyW7NaN4qWdw" name="FirstContactMessage">
                <ownedComment xmi:id="_aXCm8lJNEeiyW7NaN4qWdw">
                  <body>The message sent when making first contact between players.</body>
                </ownedComment>
                <generalization xmi:id="_aJYlcFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aSmy4FJNEeiyW7NaN4qWdw" name="playerId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aSmy4lJNEeiyW7NaN4qWdw" name="otherId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aSv80VJNEeiyW7NaN4qWdw" name="tileId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aSwj4VJNEeiyW7NaN4qWdw" name="settlementCount" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aSxK8VJNEeiyW7NaN4qWdw" name="result">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVThlVJNEeiyW7NaN4qWdw" name="FirstContactMessage" specification="_aORFcFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVThllJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVThl1JNEeiyW7NaN4qWdw" name="other" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVUIoFJNEeiyW7NaN4qWdw" name="tile" type="_aG4rEVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVUIoVJNEeiyW7NaN4qWdw" type="_Y-jxEFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.playerId = player.getId();&#xD;
     this.otherId = other.getId();&#xD;
     this.tileId = (tile == null) ? null : tile.getId();&#xD;
     this.settlementCount = (other.isEuropean()) ? null&#xD;
         : Integer.toString(other.getNumberOfSettlements());&#xD;
     this.result = null;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVUIolJNEeiyW7NaN4qWdw" name="FirstContactMessage" specification="_aORshFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVUIo1JNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVUIpFJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVUIpVJNEeiyW7NaN4qWdw" type="_Y-jxEFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.playerId = element.getAttribute(&quot;player&quot;);&#xD;
     this.otherId = element.getAttribute(&quot;other&quot;);&#xD;
     this.tileId = (!element.hasAttribute(&quot;tile&quot;)) ? null&#xD;
         : element.getAttribute(&quot;tile&quot;);&#xD;
     this.settlementCount = (!element.hasAttribute(&quot;camps&quot;)) ? null&#xD;
         : element.getAttribute(&quot;camps&quot;);&#xD;
     this.result = (!element.hasAttribute(&quot;result&quot;)) ? null&#xD;
         : element.getAttribute(&quot;result&quot;);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVUIplJNEeiyW7NaN4qWdw" name="getPlayer" specification="_aOS6oFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVUIp1JNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVUIqFJNEeiyW7NaN4qWdw" type="_aGykcVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return game.getFreeColGameObject(playerId, Player.class);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVUvsFJNEeiyW7NaN4qWdw" name="getOtherPlayer" specification="_aOS6o1JNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVUvsVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVUvslJNEeiyW7NaN4qWdw" type="_aGykcVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return game.getFreeColGameObject(otherId, Player.class);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVUvs1JNEeiyW7NaN4qWdw" name="getTile" specification="_aOThslJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVUvtFJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVUvtVJNEeiyW7NaN4qWdw" type="_aG4rEVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return game.getFreeColGameObject(tileId, Tile.class);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVUvtlJNEeiyW7NaN4qWdw" name="getSettlementCount" specification="_Y-mNUFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVUvt1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>try {&#xD;
         return Integer.parseInt(settlementCount);&#xD;
     } catch (NumberFormatException nfe) {}&#xD;
     return -1;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVUvuFJNEeiyW7NaN4qWdw" name="handle" specification="_aOUIwVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVUvuVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVUvulJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVUvu1JNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
     final Game game = serverPlayer.getGame();&#xD;
&#xD;
     Player first = getPlayer(game);&#xD;
     if (first == null) {&#xD;
         return DOMMessage.clientError(&quot;Invalid player: &quot; + playerId);&#xD;
     } else if (serverPlayer.getId().equals(playerId)) {&#xD;
         ; // OK&#xD;
     } else {&#xD;
         return DOMMessage.clientError(&quot;Not our player: &quot; + playerId);&#xD;
     }&#xD;
&#xD;
     ServerPlayer otherPlayer = (ServerPlayer)getOtherPlayer(game);&#xD;
     if (otherPlayer == null) {&#xD;
         return DOMMessage.clientError(&quot;Invalid other player: &quot; + otherId);&#xD;
     } else if (otherPlayer == serverPlayer) {&#xD;
         return DOMMessage.clientError(&quot;First contact with self!?!&quot;);&#xD;
     }&#xD;
&#xD;
     // Proceed to contact.&#xD;
     return server.getInGameController()&#xD;
         .nativeFirstContact(serverPlayer, otherPlayer,&#xD;
                             getTile(game), getResult());&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVVWwFJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_Y-nbcFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVVWwVJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>Element element = createMessage(getXMLElementTagName(),&#xD;
         &quot;player&quot;, this.playerId,&#xD;
         &quot;other&quot;, this.otherId);&#xD;
     if (this.tileId != null) {&#xD;
         element.setAttribute(&quot;tile&quot;, this.tileId);&#xD;
     }&#xD;
     if (this.settlementCount != null) {&#xD;
         element.setAttribute(&quot;camps&quot;, this.settlementCount);&#xD;
     }&#xD;
     if (this.result != null) {&#xD;
         element.setAttribute(&quot;result&quot;, this.result);&#xD;
     }&#xD;
     return element;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVVWwlJNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_Y-opkFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVVWw1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;firstContact&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_Y-mNUFJNEeiyW7NaN4qWdw" name="getSettlementCount" method="_aVUvtlJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Y-m0YFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_Y-nbcFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aVVWwFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aOUv0FJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y-opkFJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aVVWwlJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXDOAFJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;firstContact&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y-opkVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aORFcFJNEeiyW7NaN4qWdw" name="FirstContactMessage" method="_aVThlVJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aORsgVJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aORsglJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXCm81JNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>FirstContactMessage&lt;/code>.&#xD;
     *&#xD;
     * @param player The &lt;code>Player&lt;/code> making contact.&#xD;
     * @param other The &lt;code>Player&lt;/code> being contacted.&#xD;
     * @param tile An optional &lt;code>Tile&lt;/code> to offer.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aORFcVJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aORFclJNEeiyW7NaN4qWdw" name="other" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aORsgFJNEeiyW7NaN4qWdw" name="tile" type="_aG4rEVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aORsg1JNEeiyW7NaN4qWdw" type="_Y-jxEFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aORshFJNEeiyW7NaN4qWdw" name="FirstContactMessage" method="_aVUIolJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aOSTklJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aOSTk1JNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXCm9FJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>FirstContactMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aOSTkFJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOSTkVJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOSTlFJNEeiyW7NaN4qWdw" type="_Y-jxEFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aOS6oFJNEeiyW7NaN4qWdw" name="getPlayer" method="_aVUIplJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aOS6oVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOS6olJNEeiyW7NaN4qWdw" type="_aGykcVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aOS6o1JNEeiyW7NaN4qWdw" name="getOtherPlayer" method="_aVUvsFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aOThsFJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOThsVJNEeiyW7NaN4qWdw" type="_aGykcVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aOThslJNEeiyW7NaN4qWdw" name="getTile" method="_aVUvs1JNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aOThs1JNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOUIwFJNEeiyW7NaN4qWdw" type="_aG4rEVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aOUIwVJNEeiyW7NaN4qWdw" name="handle" method="_aVUvuFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXCm9VJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;firstContact&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     * @return An update containing the firstContactd unit, or an error&#xD;
     *     &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aOUIwlJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOUIw1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOUIxFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_Y-wlYFJNEeiyW7NaN4qWdw" name="GetNationSummaryMessage">
                <ownedComment xmi:id="_aXDOAVJNEeiyW7NaN4qWdw">
                  <body>The message sent when summarizing a nation.</body>
                </ownedComment>
                <generalization xmi:id="_aJcP0FJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aS0OQFJNEeiyW7NaN4qWdw" name="playerId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aS01UFJNEeiyW7NaN4qWdw" name="summary" visibility="private" type="_aJbBsFJNEeiyW7NaN4qWdw" association="_aaN2wVJNEeiyW7NaN4qWdw"/>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVVWxFJNEeiyW7NaN4qWdw" name="GetNationSummaryMessage" specification="_aOVW4FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVVWxVJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVVWxlJNEeiyW7NaN4qWdw" type="_Y-wlYFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     playerId = player.getId();&#xD;
     summary = null;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVV90FJNEeiyW7NaN4qWdw" name="GetNationSummaryMessage" specification="_aOV99FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVV90VJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVV90lJNEeiyW7NaN4qWdw" type="_Y-wlYFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     playerId = element.getAttribute(&quot;player&quot;);&#xD;
     NodeList nodes = element.getChildNodes();&#xD;
     summary = (nodes == null || nodes.getLength() != 1) ? null&#xD;
         : new NationSummary((Element) nodes.item(0));&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVV901JNEeiyW7NaN4qWdw" name="getNationSummary" specification="_Y-xzgFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVV91FJNEeiyW7NaN4qWdw" type="_aJbBsFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return summary;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVWk4FJNEeiyW7NaN4qWdw" name="handle" specification="_aOWlBFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVWk4VJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVWk4lJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVWk41JNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
     final Game game = serverPlayer.getGame();&#xD;
&#xD;
     Player player = game.getFreeColGameObject(playerId, Player.class);&#xD;
     if (player == null) {&#xD;
         return DOMMessage.clientError(&quot;Not a player: &quot; + playerId);&#xD;
     } else if (player.isIndian() &amp;&amp; !serverPlayer.hasContacted(player)) {&#xD;
         return null;&#xD;
     }&#xD;
&#xD;
     // Proceed to get the summary.&#xD;
     summary = server.getInGameController()&#xD;
         .getNationSummary(serverPlayer, player);&#xD;
     return toXMLElement();&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVWk5FJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_Y-yakFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVWk5VJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>Element result = createMessage(getXMLElementTagName(),&#xD;
         &quot;player&quot;, playerId);&#xD;
     if (summary != null) {&#xD;
         result.appendChild(summary.toXMLElement(result.getOwnerDocument()));&#xD;
     }&#xD;
     return result;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVWk5lJNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_Y-zoslJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVWk51JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;getNationSummary&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_Y-xzgFJNEeiyW7NaN4qWdw" name="getNationSummary" method="_aVV901JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXDOBFJNEeiyW7NaN4qWdw">
                    <body>Client side helper to get the summary.&#xD;
     *&#xD;
     * @return The summary.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aOWlA1JNEeiyW7NaN4qWdw" type="_aJbBsFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y-yakFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aVWk5FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aOXME1JNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y-zoslJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aVWk5lJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXDOBlJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;getNationSummary&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y-0PwFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aOVW4FJNEeiyW7NaN4qWdw" name="GetNationSummaryMessage" method="_aVVWxFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aOV98VJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aOV98lJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXDOAlJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>GetNationSummaryMessage&lt;/code> for the&#xD;
     * specified player.&#xD;
     *&#xD;
     * @param player The &lt;code>Player&lt;/code> to summarize.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aOV98FJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOV981JNEeiyW7NaN4qWdw" type="_Y-wlYFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aOV99FJNEeiyW7NaN4qWdw" name="GetNationSummaryMessage" method="_aVV90FJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aOWlAFJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aOWlAVJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXDOA1JNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>GetNationSummaryMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aOV99VJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOWlAlJNEeiyW7NaN4qWdw" type="_Y-wlYFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aOWlBFJNEeiyW7NaN4qWdw" name="handle" method="_aVWk4FJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXDOBVJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;getNationSummary&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     *&#xD;
     * @return An update containing the nation summaries, or an error&#xD;
     *     &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aOXMEFJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOXMEVJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOXMElJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_Y-3TEFJNEeiyW7NaN4qWdw" name="GetTransactionMessage">
                <ownedComment xmi:id="_aXD1EFJNEeiyW7NaN4qWdw">
                  <body>The message sent to initiate a transaction.</body>
                </ownedComment>
                <generalization xmi:id="_aJeFAFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aS2DcFJNEeiyW7NaN4qWdw" name="unitId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aS3RkFJNEeiyW7NaN4qWdw" name="settlementId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVXL8FJNEeiyW7NaN4qWdw" name="GetTransactionMessage" specification="_aOXzIFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVXL8VJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVXL8lJNEeiyW7NaN4qWdw" name="settlement" type="_aHKX4VJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVXL81JNEeiyW7NaN4qWdw" type="_Y-3TEFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = unit.getId();&#xD;
     this.settlementId = settlement.getId();&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVXL9FJNEeiyW7NaN4qWdw" name="GetTransactionMessage" specification="_aOYaM1JNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVXL9VJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVXL9lJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVXL91JNEeiyW7NaN4qWdw" type="_Y-3TEFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = element.getAttribute(&quot;unit&quot;);&#xD;
     this.settlementId = element.getAttribute(&quot;settlement&quot;);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVXL-FJNEeiyW7NaN4qWdw" name="handle" specification="_aOZoUFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVXL-VJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVXL-lJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVXL-1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVXL_FJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
&#xD;
     Unit unit;&#xD;
     try {&#xD;
         unit = player.getOurFreeColGameObject(unitId, Unit.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     Settlement settlement;&#xD;
     try {&#xD;
         settlement = unit.getAdjacentSettlementSafely(settlementId);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     return server.getInGameController()&#xD;
         .getTransaction(serverPlayer, unit, settlement);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVXzAFJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_Y-5vUFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVXzAVJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return createMessage(getXMLElementTagName(),&#xD;
         &quot;unit&quot;, unitId,&#xD;
         &quot;settlement&quot;, settlementId);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVXzAlJNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_Y-69cFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVXzA1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;getTransaction&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_Y-5vUFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aVXzAFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aOZoVVJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y-69cFJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aVXzAlJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXD1FFJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;getTransaction&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y-69cVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aOXzIFJNEeiyW7NaN4qWdw" name="GetTransactionMessage" method="_aVXL8FJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aOYaMFJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aOYaMVJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXD1EVJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>GetTransactionMessage&lt;/code> with the&#xD;
     * supplied unit and settlement.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> performing the transaction.&#xD;
     * @param settlement The &lt;code>Settlement&lt;/code> where the&#xD;
     *        transaction occurs.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aOXzIVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOXzIlJNEeiyW7NaN4qWdw" name="settlement" type="_aHKX4VJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOYaMlJNEeiyW7NaN4qWdw" type="_Y-3TEFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aOYaM1JNEeiyW7NaN4qWdw" name="GetTransactionMessage" method="_aVXL9FJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aOZBQVJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aOZBQlJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXD1ElJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>GetTransactionMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aOYaNFJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOZBQFJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOZBQ1JNEeiyW7NaN4qWdw" type="_Y-3TEFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aOZoUFJNEeiyW7NaN4qWdw" name="handle" method="_aVXL-FJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXD1E1JNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;getTransaction&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param player The &lt;code>Player&lt;/code> the message applies to.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     * @return A reply encapsulating the possibilities for this&#xD;
     *     transaction, or an error &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aOZoUVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOZoUlJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOZoU1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOZoVFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_Y_AdAFJNEeiyW7NaN4qWdw" name="GoodsForSaleMessage">
                <ownedComment xmi:id="_aXD1FVJNEeiyW7NaN4qWdw">
                  <body>The message sent when querying a settlement for what it has for sale.</body>
                </ownedComment>
                <generalization xmi:id="_aJf6MFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aS4fsFJNEeiyW7NaN4qWdw" name="unitId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aS5GwFJNEeiyW7NaN4qWdw" name="settlementId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aS5t0VJNEeiyW7NaN4qWdw" name="sellGoods" visibility="private" isLeaf="true" type="_aHJw0FJNEeiyW7NaN4qWdw" isOrdered="true" isReadOnly="true" association="_aaVLgFJNEeiyW7NaN4qWdw">
                  <upperValue xmi:type="uml:LiteralUnlimitedNatural" xmi:id="_aS5t0lJNEeiyW7NaN4qWdw" value="*"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVYaEFJNEeiyW7NaN4qWdw" name="GoodsForSaleMessage" specification="_aOa2cFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVYaEVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVYaElJNEeiyW7NaN4qWdw" name="settlement" type="_aHKX4VJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVYaE1JNEeiyW7NaN4qWdw" name="sellGoods" type="_aHo5AFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVYaFFJNEeiyW7NaN4qWdw" type="_Y_AdAFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = unit.getId();&#xD;
     this.settlementId = settlement.getId();&#xD;
     this.sellGoods = sellGoods;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVYaFVJNEeiyW7NaN4qWdw" name="GoodsForSaleMessage" specification="_aOcEkVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVYaFlJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVYaF1JNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVYaGFJNEeiyW7NaN4qWdw" type="_Y_AdAFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = element.getAttribute(&quot;unit&quot;);&#xD;
     this.settlementId = element.getAttribute(&quot;settlement&quot;);&#xD;
     this.sellGoods = new ArrayList&lt;>();&#xD;
     NodeList children = element.getChildNodes();&#xD;
     for (int i = 0; i &lt; children.getLength(); i++) {&#xD;
         this.sellGoods.add(new Goods(game, (Element) children.item(i)));&#xD;
     }&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVYaGVJNEeiyW7NaN4qWdw" name="getGoods" specification="_Y_DgUFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVYaGlJNEeiyW7NaN4qWdw" type="_aHJw0FJNEeiyW7NaN4qWdw" isOrdered="true" direction="return">
                    <upperValue xmi:type="uml:LiteralUnlimitedNatural" xmi:id="_aVYaG1JNEeiyW7NaN4qWdw" value="*"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return this.sellGoods;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVZBIFJNEeiyW7NaN4qWdw" name="handle" specification="_aOdSsFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVZBIVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVZBIlJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVZBI1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVZBJFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
&#xD;
     Unit unit;&#xD;
     try {&#xD;
         unit = player.getOurFreeColGameObject(unitId, Unit.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     IndianSettlement settlement;&#xD;
     try {&#xD;
         settlement = unit.getAdjacentIndianSettlementSafely(settlementId);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     // Try to collect the goods for sale.&#xD;
     return server.getInGameController()&#xD;
         .getGoodsForSale(serverPlayer, unit, settlement);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVZBJVJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_Y_EucFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVZBJlJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>Element result = createMessage(getXMLElementTagName(),&#xD;
         &quot;unit&quot;, unitId,&#xD;
         &quot;settlement&quot;, settlementId);&#xD;
     if (sellGoods != null) {&#xD;
         for (Goods goods : sellGoods) {&#xD;
             result.appendChild(goods.toXMLElement(result.getOwnerDocument()));&#xD;
         }&#xD;
     }&#xD;
     return result;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVZBJ1JNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_Y_GjolJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVZBKFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;goodsForSale&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_Y_DgUFJNEeiyW7NaN4qWdw" name="getGoods" method="_aVYaGVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Y_DgUVJNEeiyW7NaN4qWdw" type="_aHJw0FJNEeiyW7NaN4qWdw" isOrdered="true" direction="return">
                    <upperValue xmi:type="uml:LiteralUnlimitedNatural" xmi:id="_Y_EHYFJNEeiyW7NaN4qWdw" value="*"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_Y_EucFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aVZBJVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aOd5wFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y_GjolJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aVZBJ1JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXEcIVJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;goodsForSale&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y_HKsFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aOa2cFJNEeiyW7NaN4qWdw" name="GoodsForSaleMessage" method="_aVYaEFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aOa2dFJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aObdgFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXD1FlJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>GoodsForSaleMessage&lt;/code> with the&#xD;
     * supplied name.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is trading.&#xD;
     * @param settlement The &lt;code>Settlement&lt;/code> that is trading.&#xD;
     * @param sellGoods A list of &lt;code>Goods&lt;/code> to be sold.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aOa2cVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOa2clJNEeiyW7NaN4qWdw" name="settlement" type="_aHKX4VJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOa2c1JNEeiyW7NaN4qWdw" name="sellGoods" type="_aHo5AFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aObdgVJNEeiyW7NaN4qWdw" type="_Y_AdAFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aOcEkVJNEeiyW7NaN4qWdw" name="GoodsForSaleMessage" method="_aVYaFVJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aOcrolJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aOcro1JNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXD1F1JNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>GoodsForSaleMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aOcroFJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOcroVJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOcrpFJNEeiyW7NaN4qWdw" type="_Y_AdAFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aOdSsFJNEeiyW7NaN4qWdw" name="handle" method="_aVZBIFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXEcIFJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;goodsForSale&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param player The &lt;code>Player&lt;/code> the message applies to.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     * @return This &lt;code>GoodsForSaleMessage&lt;/code> with the goods&#xD;
     *     for sale attached as children or an error&#xD;
     *     &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aOdSsVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOdSslJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOdSs1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOdStFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_Y_MqQFJNEeiyW7NaN4qWdw" name="InciteMessage">
                <ownedComment xmi:id="_aXEcIlJNEeiyW7NaN4qWdw">
                  <body>The message sent when inciting a native settlement.</body>
                </ownedComment>
                <generalization xmi:id="_aJiWcFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aS7jAFJNEeiyW7NaN4qWdw" name="unitId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aS8KEVJNEeiyW7NaN4qWdw" name="directionString" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aS8xIVJNEeiyW7NaN4qWdw" name="enemyId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aS9YMVJNEeiyW7NaN4qWdw" name="goldString" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVZoMFJNEeiyW7NaN4qWdw" name="InciteMessage" specification="_aOeg0FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVZoMVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVZoMlJNEeiyW7NaN4qWdw" name="direction" type="_aG4EAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVZoM1JNEeiyW7NaN4qWdw" name="enemy" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVZoNFJNEeiyW7NaN4qWdw" name="gold">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aVZoNVJNEeiyW7NaN4qWdw" type="_Y_MqQFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = unit.getId();&#xD;
     this.directionString = String.valueOf(direction);&#xD;
     this.enemyId = enemy.getId();&#xD;
     this.goldString = Integer.toString(gold);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVZoNlJNEeiyW7NaN4qWdw" name="InciteMessage" specification="_aOfH41JNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVZoN1JNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVZoOFJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVZoOVJNEeiyW7NaN4qWdw" type="_Y_MqQFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = element.getAttribute(&quot;unitId&quot;);&#xD;
     this.directionString = element.getAttribute(&quot;direction&quot;);&#xD;
     this.enemyId = element.getAttribute(&quot;enemyId&quot;);&#xD;
     this.goldString = element.getAttribute(&quot;gold&quot;);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVaPQFJNEeiyW7NaN4qWdw" name="handle" specification="_aOfu9VJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVaPQVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVaPQlJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVaPQ1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVaPRFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
     final Game game = server.getGame();&#xD;
&#xD;
     Unit unit;&#xD;
     try {&#xD;
         unit = player.getOurFreeColGameObject(unitId, Unit.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     Tile tile;&#xD;
     try {&#xD;
         tile = unit.getNeighbourTile(directionString);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     ServerIndianSettlement is&#xD;
         = (ServerIndianSettlement)tile.getIndianSettlement();&#xD;
     if (is == null) {&#xD;
         return DOMMessage.clientError(&quot;There is no native settlement at: &quot;&#xD;
             + tile.getId());&#xD;
     }&#xD;
&#xD;
     MoveType type;&#xD;
     ServerPlayer enemy = game.getFreeColGameObject(enemyId,&#xD;
         ServerPlayer.class);&#xD;
     if (enemy == null) {&#xD;
         return DOMMessage.clientError(&quot;Not a player: &quot; + enemyId);&#xD;
     } else if (enemy == player) {&#xD;
         return DOMMessage.clientError(&quot;Inciting against oneself!&quot;);&#xD;
     } else if (!enemy.isEuropean()) {&#xD;
         return DOMMessage.clientError(&quot;Inciting against non-European!&quot;);&#xD;
     } else if ((type = unit.getMoveType(is.getTile()))&#xD;
         != MoveType.ENTER_INDIAN_SETTLEMENT_WITH_MISSIONARY) {&#xD;
         return DOMMessage.clientError(&quot;Unable to enter &quot;&#xD;
             + is.getName() + &quot;: &quot; + type.whyIllegal());&#xD;
     }&#xD;
&#xD;
     int gold;&#xD;
     try {&#xD;
         gold = Integer.parseInt(goldString);&#xD;
     } catch (NumberFormatException e) {&#xD;
         return DOMMessage.clientError(&quot;Bad gold: &quot; + goldString);&#xD;
     }&#xD;
&#xD;
     // Valid, proceed to incite.&#xD;
     return server.getInGameController()&#xD;
         .incite(serverPlayer, unit, is, enemy, gold);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVaPRVJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_Y_PGgFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVaPRlJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return createMessage(getXMLElementTagName(),&#xD;
         &quot;unitId&quot;, unitId,&#xD;
         &quot;direction&quot;, directionString,&#xD;
         &quot;enemyId&quot;, enemyId,&#xD;
         &quot;gold&quot;, goldString);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVaPR1JNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_Y_Q7sFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVaPSFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;incite&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_Y_PGgFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aVaPRVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aOiLMFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y_Q7sFJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aVaPR1JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXEcJlJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;incite&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y_Q7sVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aOeg0FJNEeiyW7NaN4qWdw" name="InciteMessage" method="_aVZoMFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aOfH4FJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aOfH4VJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXEcI1JNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>InciteMessage&lt;/code> with the&#xD;
     * supplied name.&#xD;
     *&#xD;
     * @param unit The inciting &lt;code>Unit&lt;/code>.&#xD;
     * @param direction The &lt;code>Direction&lt;/code> to the settlement.&#xD;
     * @param enemy The enemy &lt;code>Player&lt;/code>.&#xD;
     * @param gold The amount of gold in the bribe (negative for the&#xD;
     *             initial inquiry).</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aOeg0VJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOeg0lJNEeiyW7NaN4qWdw" name="direction" type="_aG4EAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOeg01JNEeiyW7NaN4qWdw" name="enemy" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOeg1FJNEeiyW7NaN4qWdw" name="gold">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aOfH4lJNEeiyW7NaN4qWdw" type="_Y_MqQFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aOfH41JNEeiyW7NaN4qWdw" name="InciteMessage" method="_aVZoNlJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aOfu8lJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aOfu81JNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXEcJFJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>InciteMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aOfu8FJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOfu8VJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOfu9FJNEeiyW7NaN4qWdw" type="_Y_MqQFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aOfu9VJNEeiyW7NaN4qWdw" name="handle" method="_aVaPQFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXEcJVJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;incite&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param player The &lt;code>Player&lt;/code> the message applies to.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     * @return An element containing the result of the incite, or an&#xD;
     *     error &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aOgWAFJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOgWAVJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOgWAlJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOgWA1JNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_Y_V0MFJNEeiyW7NaN4qWdw" name="IndianDemandMessage">
                <ownedComment xmi:id="_aXEcJ1JNEeiyW7NaN4qWdw">
                  <body>The message sent to resolve natives making demands of a colony.</body>
                </ownedComment>
                <generalization xmi:id="_aJkysFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aS-mUFJNEeiyW7NaN4qWdw" name="unitId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aS_NYFJNEeiyW7NaN4qWdw" name="colonyId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aS_0cFJNEeiyW7NaN4qWdw" name="typeId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aS_0clJNEeiyW7NaN4qWdw" name="amount" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aTBCkFJNEeiyW7NaN4qWdw" name="result">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVa2VFJNEeiyW7NaN4qWdw" name="IndianDemandMessage" specification="_aOkAYFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVa2VVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVa2VlJNEeiyW7NaN4qWdw" name="colony" type="_aGwvQFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVa2V1JNEeiyW7NaN4qWdw" name="type" type="_aHcEsFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVa2WFJNEeiyW7NaN4qWdw" name="amount">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aVa2WVJNEeiyW7NaN4qWdw" type="_Y_V0MFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = unit.getId();&#xD;
     this.colonyId = colony.getId();&#xD;
     this.typeId = (type == null) ? null : type.getId();&#xD;
     this.amount = Integer.toString(amount);&#xD;
     this.result = null;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVbdYFJNEeiyW7NaN4qWdw" name="IndianDemandMessage" specification="_aOknc1JNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVbdYVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVbdYlJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVbdY1JNEeiyW7NaN4qWdw" type="_Y_V0MFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = element.getAttribute(&quot;unit&quot;);&#xD;
     this.colonyId = element.getAttribute(&quot;colony&quot;);&#xD;
     this.typeId = (!element.hasAttribute(&quot;type&quot;)) ? null&#xD;
         : element.getAttribute(&quot;type&quot;);&#xD;
     this.amount = element.getAttribute(&quot;amount&quot;);&#xD;
     this.result = element.getAttribute(&quot;result&quot;);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVbdZFJNEeiyW7NaN4qWdw" name="getUnit" specification="_aOl1kFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVbdZVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVbdZlJNEeiyW7NaN4qWdw" type="_aG5SIVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return game.getFreeColGameObject(unitId, Unit.class);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVbdZ1JNEeiyW7NaN4qWdw" name="getColony" specification="_aOmcoFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVbdaFJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVbdaVJNEeiyW7NaN4qWdw" type="_aGwvQFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return game.getFreeColGameObject(colonyId, Colony.class);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVcEcFJNEeiyW7NaN4qWdw" name="getType" specification="_aOnDsFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVcEcVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVcEclJNEeiyW7NaN4qWdw" type="_aHcEsFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return (typeId == null) ? null&#xD;
         : game.getSpecification().getGoodsType(typeId);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVcEc1JNEeiyW7NaN4qWdw" name="getAmount" specification="_Y_ZekFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVcEdFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>try {&#xD;
         return Integer.parseInt(amount);&#xD;
     } catch (NumberFormatException nfe) {}&#xD;
     return -1;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVcEdVJNEeiyW7NaN4qWdw" name="handle" specification="_aOoR0FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVcEdlJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVcEd1JNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVcEeFJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVcEeVJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
     final Game game = player.getGame();&#xD;
&#xD;
     Unit unit;&#xD;
     try {&#xD;
         if (result == null) { // Initial demand&#xD;
             unit = player.getOurFreeColGameObject(unitId, Unit.class);&#xD;
             if (unit.getMovesLeft() &lt;= 0) {&#xD;
                 return DOMMessage.clientError(&quot;Unit has no moves left: &quot;&#xD;
                     + unitId);&#xD;
             }&#xD;
         } else { // Reply from colony&#xD;
             unit = game.getFreeColGameObject(unitId, Unit.class);&#xD;
             if (unit == null) {&#xD;
                 return DOMMessage.clientError(&quot;Not a unit: &quot; + unitId);&#xD;
             }&#xD;
         }&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     Colony colony;&#xD;
     try {&#xD;
         Settlement settlement&#xD;
             = unit.getAdjacentSettlementSafely(colonyId);&#xD;
         if (!(settlement instanceof Colony)) {&#xD;
             return DOMMessage.clientError(&quot;Not a colony: &quot; + colonyId);&#xD;
         }&#xD;
         colony = (Colony)settlement;&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     if (getAmount() &lt;= 0) {&#xD;
         return DOMMessage.clientError(&quot;Bad amount: &quot; + amount);&#xD;
     }&#xD;
&#xD;
     // Proceed to demand.&#xD;
     return server.getInGameController()&#xD;
         .indianDemand(serverPlayer, unit, colony,&#xD;
                       getType(game), getAmount());&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVcEelJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_Y_aFoVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVcEe1JNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>Element ret = createMessage(getXMLElementTagName(),&#xD;
         &quot;unit&quot;, unitId,&#xD;
         &quot;colony&quot;, colonyId,&#xD;
         &quot;amount&quot;, amount);&#xD;
     if (typeId != null) ret.setAttribute(&quot;type&quot;, typeId);&#xD;
     if (result != null) ret.setAttribute(&quot;result&quot;, result);&#xD;
     return ret;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVcrgFJNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_Y_bTwlJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVcrgVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;indianDemand&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_Y_ZekFJNEeiyW7NaN4qWdw" name="getAmount" method="_aVcEc1JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXFDNVJNEeiyW7NaN4qWdw">
                    <body>Client-side convenience function to get the gold in this message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y_aFoFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_Y_aFoVJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aVcEelJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aOo44FJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y_bTwlJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aVcrgFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXFDN1JNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;indianDemand&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y_bTw1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aOkAYFJNEeiyW7NaN4qWdw" name="IndianDemandMessage" method="_aVa2VFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aOkncFJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aOkncVJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXFDMFJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>IndianDemandMessage&lt;/code> with the&#xD;
     * supplied unit, colony and demands.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is demanding.&#xD;
     * @param colony The &lt;code>Colony&lt;/code> being demanded of.&#xD;
     * @param type The &lt;code>GoodsType&lt;/code> being demanded.&#xD;
     * @param amount The amount of goods being demanded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aOkAYVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOkAYlJNEeiyW7NaN4qWdw" name="colony" type="_aGwvQFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOkAY1JNEeiyW7NaN4qWdw" name="type" type="_aHcEsFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOkAZFJNEeiyW7NaN4qWdw" name="amount">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aOknclJNEeiyW7NaN4qWdw" type="_Y_V0MFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aOknc1JNEeiyW7NaN4qWdw" name="IndianDemandMessage" method="_aVbdYFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aOlOgVJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aOlOglJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXFDMVJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>IndianDemandMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aOkndFJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOlOgFJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOlOg1JNEeiyW7NaN4qWdw" type="_Y_V0MFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aOl1kFJNEeiyW7NaN4qWdw" name="getUnit" method="_aVbdZFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXFDMlJNEeiyW7NaN4qWdw">
                    <body>Client-side convenience function to get the unit in this message.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> to look for the unit in.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aOl1kVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOl1klJNEeiyW7NaN4qWdw" type="_aG5SIVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aOmcoFJNEeiyW7NaN4qWdw" name="getColony" method="_aVbdZ1JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXFDM1JNEeiyW7NaN4qWdw">
                    <body>Client-side convenience function to get the colony in this message.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> to look for the colony in.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aOmcoVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOmcolJNEeiyW7NaN4qWdw" type="_aGwvQFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aOnDsFJNEeiyW7NaN4qWdw" name="getType" method="_aVcEcFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXFDNFJNEeiyW7NaN4qWdw">
                    <body>Client-side convenience function to get the goods type in this message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aOnDsVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOnqwFJNEeiyW7NaN4qWdw" type="_aHcEsFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aOoR0FJNEeiyW7NaN4qWdw" name="handle" method="_aVcEdVJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXFDNlJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;indianDemand&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param player The &lt;code>Player&lt;/code> the message applies to.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     * @return An update containing the indianDemandd unit, or an&#xD;
     *     error &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aOoR0VJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOoR0lJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOoR01JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOoR1FJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_Y_iBcFJNEeiyW7NaN4qWdw" name="JoinColonyMessage">
                <ownedComment xmi:id="_aXFqQFJNEeiyW7NaN4qWdw">
                  <body>The message sent when a unit joins a colony.</body>
                </ownedComment>
                <generalization xmi:id="_aJn2AFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aTC3wFJNEeiyW7NaN4qWdw" name="colonyId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aTDe0VJNEeiyW7NaN4qWdw" name="builderId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVcrglJNEeiyW7NaN4qWdw" name="JoinColonyMessage" specification="_aOqHAFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVcrg1JNEeiyW7NaN4qWdw" name="colony" type="_aGwvQFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVcrhFJNEeiyW7NaN4qWdw" name="builder" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVcrhVJNEeiyW7NaN4qWdw" type="_Y_iBcFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.colonyId = colony.getId();&#xD;
     this.builderId = builder.getId();&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVdSkFJNEeiyW7NaN4qWdw" name="JoinColonyMessage" specification="_aOrVIFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVdSkVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVdSklJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVdSk1JNEeiyW7NaN4qWdw" type="_Y_iBcFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.colonyId = element.getAttribute(&quot;colony&quot;);&#xD;
     this.builderId = element.getAttribute(&quot;unit&quot;);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVdSlFJNEeiyW7NaN4qWdw" name="handle" specification="_aOsjQFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVdSlVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVdSllJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVdSl1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVdSmFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
&#xD;
     Unit unit;&#xD;
     try {&#xD;
         unit = player.getOurFreeColGameObject(builderId, Unit.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     Colony colony;&#xD;
     try {&#xD;
         colony = player.getOurFreeColGameObject(colonyId, Colony.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     // Try to buy.&#xD;
     return server.getInGameController()&#xD;
         .joinColony(serverPlayer, unit, colony);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVdSmVJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_Y_j2oFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVdSmlJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return createMessage(getXMLElementTagName(),&#xD;
         &quot;colony&quot;, colonyId,&#xD;
         &quot;unit&quot;, builderId);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVd5oFJNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_Y_lEwVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVd5oVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;joinColony&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_Y_j2oFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aVdSmVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aOtKUFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y_lEwVJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aVd5oFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXFqRFJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;joinColony&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y_lEwlJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aOqHAFJNEeiyW7NaN4qWdw" name="JoinColonyMessage" method="_aVcrglJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aOqHA1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aOqHBFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXFqQVJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>JoinColonyMessage&lt;/code> with the supplied name&#xD;
     * and building unit.&#xD;
     *&#xD;
     * @param colony a &lt;code>Colony&lt;/code> value&#xD;
     * @param builder The &lt;code>Unit&lt;/code> to do the building.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aOqHAVJNEeiyW7NaN4qWdw" name="colony" type="_aGwvQFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOqHAlJNEeiyW7NaN4qWdw" name="builder" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOqHBVJNEeiyW7NaN4qWdw" type="_Y_iBcFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aOrVIFJNEeiyW7NaN4qWdw" name="JoinColonyMessage" method="_aVdSkFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aOrVI1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aOrVJFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXFqQlJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>JoinColonyMessage&lt;/code> from a supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aOrVIVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOrVIlJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOr8MFJNEeiyW7NaN4qWdw" type="_Y_iBcFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aOsjQFJNEeiyW7NaN4qWdw" name="handle" method="_aVdSlFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXFqQ1JNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;joinColony&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the request.&#xD;
     * @param player The &lt;code>Player&lt;/code> building the colony.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> the message is from.&#xD;
     * @return An update &lt;code>Element&lt;/code> defining the new colony&#xD;
     *     and updating its surrounding tiles, or an error&#xD;
     *     &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aOsjQVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOsjQlJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOsjQ1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOsjRFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_Y_pWMFJNEeiyW7NaN4qWdw" name="LearnSkillMessage">
                <ownedComment xmi:id="_aXFqRVJNEeiyW7NaN4qWdw">
                  <body>The message sent when learning for the skill taught at a settlement.</body>
                </ownedComment>
                <generalization xmi:id="_aJqSQFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aTEs8FJNEeiyW7NaN4qWdw" name="unitId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aTFUAFJNEeiyW7NaN4qWdw" name="directionString" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVd5olJNEeiyW7NaN4qWdw" name="LearnSkillMessage" specification="_aOtxYFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVd5o1JNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVd5pFJNEeiyW7NaN4qWdw" name="direction" type="_aG4EAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVd5pVJNEeiyW7NaN4qWdw" type="_Y_pWMFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = unit.getId();&#xD;
     this.directionString = String.valueOf(direction);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVd5plJNEeiyW7NaN4qWdw" name="LearnSkillMessage" specification="_aOu_gFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVd5p1JNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVd5qFJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVd5qVJNEeiyW7NaN4qWdw" type="_Y_pWMFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = element.getAttribute(&quot;unitId&quot;);&#xD;
     this.directionString = element.getAttribute(&quot;direction&quot;);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVegsFJNEeiyW7NaN4qWdw" name="handle" specification="_aOvmkFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVegsVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVegslJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVegs1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVegtFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
&#xD;
     Unit unit;&#xD;
     try {&#xD;
         unit = player.getOurFreeColGameObject(unitId, Unit.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     Tile tile;&#xD;
     try {&#xD;
         tile = unit.getNeighbourTile(directionString);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     IndianSettlement is = tile.getIndianSettlement();&#xD;
     if (is == null) {&#xD;
         return DOMMessage.clientError(&quot;There is no native settlement at: &quot;&#xD;
             + tile.getId());&#xD;
     }&#xD;
&#xD;
     // Do not use getMoveType (checking moves left) as the&#xD;
     // preceding AskLearnSkill transaction will have already&#xD;
     // zeroed the moves.&#xD;
     // Consider using a transaction, so that declining restores the moves?&#xD;
     MoveType type = unit.getSimpleMoveType(is.getTile());&#xD;
     if (type != MoveType.ENTER_INDIAN_SETTLEMENT_WITH_FREE_COLONIST) {&#xD;
         return DOMMessage.clientError(&quot;Unable to enter &quot;&#xD;
             + is.getName() + &quot;: &quot; + type.whyIllegal());&#xD;
     }&#xD;
&#xD;
     // Learn the skill if possible.&#xD;
     return server.getInGameController()&#xD;
         .learnFromIndianSettlement(serverPlayer, unit, is);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVegtVJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_Y_rycFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVegtlJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return createMessage(getXMLElementTagName(),&#xD;
         &quot;unitId&quot;, unitId,&#xD;
         &quot;direction&quot;, directionString);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVegt1JNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_Y_tAkVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVeguFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;learnSkill&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_Y_rycFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aVegtVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aOwNolJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y_tAkVJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aVegt1JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXGRUVJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;learnSkill&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y_tnoFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aOtxYFJNEeiyW7NaN4qWdw" name="LearnSkillMessage" method="_aVd5olJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aOuYcFJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aOuYcVJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXFqRlJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>LearnSkillMessage&lt;/code> with the&#xD;
     * supplied unit and direction.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is learning.&#xD;
     * @param direction The &lt;code>Direction&lt;/code> the unit is looking.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aOtxYVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOtxYlJNEeiyW7NaN4qWdw" name="direction" type="_aG4EAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOuYclJNEeiyW7NaN4qWdw" type="_Y_pWMFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aOu_gFJNEeiyW7NaN4qWdw" name="LearnSkillMessage" method="_aVd5plJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aOu_g1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aOu_hFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXFqR1JNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>LearnSkillMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aOu_gVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOu_glJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOu_hVJNEeiyW7NaN4qWdw" type="_Y_pWMFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aOvmkFJNEeiyW7NaN4qWdw" name="handle" method="_aVegsFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXGRUFJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;learnSkill&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param player The &lt;code>Player&lt;/code> the message applies to.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     * @return An &lt;code>Element&lt;/code> to update the originating&#xD;
     *     player with the result of the query.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aOvmkVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOvmklJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOwNoFJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOwNoVJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_Y_xSAFJNEeiyW7NaN4qWdw" name="LoadGoodsMessage">
                <ownedComment xmi:id="_aXGRUlJNEeiyW7NaN4qWdw">
                  <body>The message sent when loading goods.</body>
                </ownedComment>
                <generalization xmi:id="_aJsugFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aTF7EFJNEeiyW7NaN4qWdw" name="locationId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aTF7ElJNEeiyW7NaN4qWdw" name="goodsTypeId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aTGiIVJNEeiyW7NaN4qWdw" name="amountString" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aTHJMVJNEeiyW7NaN4qWdw" name="carrierId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVfHwFJNEeiyW7NaN4qWdw" name="LoadGoodsMessage" specification="_aOw0sFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVfHwVJNEeiyW7NaN4qWdw" name="loc" type="_aJO0cFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVfHwlJNEeiyW7NaN4qWdw" name="type" type="_aHcEsFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVfHw1JNEeiyW7NaN4qWdw" name="amount">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aVfHxFJNEeiyW7NaN4qWdw" name="carrier" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVfHxVJNEeiyW7NaN4qWdw" type="_Y_xSAFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.locationId = loc.getId();&#xD;
     this.goodsTypeId = type.getId();&#xD;
     this.amountString = Integer.toString(amount);&#xD;
     this.carrierId = carrier.getId();&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVfHxlJNEeiyW7NaN4qWdw" name="LoadGoodsMessage" specification="_aOyC0FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVfHx1JNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVfHyFJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVfHyVJNEeiyW7NaN4qWdw" type="_Y_xSAFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.locationId = element.getAttribute(&quot;location&quot;);&#xD;
     this.goodsTypeId = element.getAttribute(&quot;type&quot;);&#xD;
     this.amountString = element.getAttribute(&quot;amount&quot;);&#xD;
     this.carrierId = element.getAttribute(&quot;carrier&quot;);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVfu0FJNEeiyW7NaN4qWdw" name="handle" specification="_aOyp4FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVfu0VJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVfu0lJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVfu01JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVfu1FJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
&#xD;
     FreeColGameObject fcgo = player.getGame()&#xD;
         .getFreeColGameObject(locationId);&#xD;
     if (fcgo == null || !(fcgo instanceof Location)) {&#xD;
         return DOMMessage.clientError(&quot;Not a location: &quot; + locationId);&#xD;
     }&#xD;
&#xD;
     Unit carrier;&#xD;
     try {&#xD;
         carrier = player.getOurFreeColGameObject(carrierId, Unit.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
     if (!carrier.canCarryGoods()) {&#xD;
         return DOMMessage.clientError(&quot;Not a goods carrier: &quot; + carrierId);&#xD;
     } else if (carrier.getTradeLocation() == null) {&#xD;
         return DOMMessage.clientError(&quot;Not at a trade location: &quot; + carrierId);&#xD;
     }&#xD;
&#xD;
     GoodsType type = server.getSpecification().getGoodsType(goodsTypeId);&#xD;
     if (type == null) {&#xD;
         return DOMMessage.clientError(&quot;Not a goods type: &quot; + goodsTypeId);&#xD;
     }&#xD;
&#xD;
     int amount;&#xD;
     try {&#xD;
         amount = Integer.parseInt(amountString);&#xD;
     } catch (NumberFormatException e) {&#xD;
         return DOMMessage.clientError(&quot;Bad amount: &quot; + amountString);&#xD;
     }&#xD;
     if (amount &lt;= 0) {&#xD;
         return DOMMessage.clientError(&quot;Amount must be positive: &quot;&#xD;
             + amountString);&#xD;
     }&#xD;
&#xD;
     // Load the goods&#xD;
     return server.getInGameController()&#xD;
         .loadGoods(serverPlayer, (Location)fcgo, type, amount, carrier);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVfu1VJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_Y_0VUFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVfu1lJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return createMessage(getXMLElementTagName(),&#xD;
         &quot;location&quot;, locationId,&#xD;
         &quot;type&quot;, goodsTypeId,&#xD;
         &quot;amount&quot;, amountString,&#xD;
         &quot;carrier&quot;, carrierId);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVfu11JNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_Y_1jclJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVfu2FJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;loadGoods&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_Y_0VUFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aVfu1VJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aOzQ8FJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Y_1jclJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aVfu11JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXGRVlJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;loadGoods&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Y_1jc1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aOw0sFJNEeiyW7NaN4qWdw" name="LoadGoodsMessage" method="_aVfHwFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aOxbxFJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aOxbxVJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXGRU1JNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>LoadGoodsMessage&lt;/code>.&#xD;
     *&#xD;
     * @param loc The &lt;code>Location&lt;/code> of the goods.&#xD;
     * @param type The &lt;code>GoodsType&lt;/code> to load.&#xD;
     * @param amount The amount of goods to load.&#xD;
     * @param carrier The &lt;code>Unit&lt;/code> to load the goods onto.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aOxbwFJNEeiyW7NaN4qWdw" name="loc" type="_aJO0cFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOxbwVJNEeiyW7NaN4qWdw" name="type" type="_aHcEsFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOxbwlJNEeiyW7NaN4qWdw" name="amount">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aOxbw1JNEeiyW7NaN4qWdw" name="carrier" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOxbxlJNEeiyW7NaN4qWdw" type="_Y_xSAFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aOyC0FJNEeiyW7NaN4qWdw" name="LoadGoodsMessage" method="_aVfHxlJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aOyC01JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aOyC1FJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXGRVFJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>LoadGoodsMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aOyC0VJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOyC0lJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOyC1VJNEeiyW7NaN4qWdw" type="_Y_xSAFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aOyp4FJNEeiyW7NaN4qWdw" name="handle" method="_aVfu0FJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXGRVVJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;loadGoods&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param player The &lt;code>Player&lt;/code> the message applies to.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     * @return An update containing the carrier, or an error&#xD;
     *     &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aOyp4VJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOyp4lJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOyp41JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aOyp5FJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_Y_504FJNEeiyW7NaN4qWdw" name="LoginMessage">
                <ownedComment xmi:id="_aXGRV1JNEeiyW7NaN4qWdw">
                  <body>The message sent when logging in.</body>
                </ownedComment>
                <generalization xmi:id="_aJw_8FJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aTHwQFJNEeiyW7NaN4qWdw" name="player" visibility="private" isLeaf="true" type="_aGykcVJNEeiyW7NaN4qWdw" isReadOnly="true" association="_aab5MVJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aTIXUFJNEeiyW7NaN4qWdw" name="userName" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aTI-YFJNEeiyW7NaN4qWdw" name="version" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aTI-YlJNEeiyW7NaN4qWdw" name="admin" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aTJlcVJNEeiyW7NaN4qWdw" name="startGame" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aTJlc1JNEeiyW7NaN4qWdw" name="singlePlayer" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aTKMgVJNEeiyW7NaN4qWdw" name="currentPlayer" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aTKzkVJNEeiyW7NaN4qWdw" name="activeUnitId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aTLaoFJNEeiyW7NaN4qWdw" name="game" visibility="private" isLeaf="true" type="_aGx9YFJNEeiyW7NaN4qWdw" isReadOnly="true" association="_aajN8VJNEeiyW7NaN4qWdw"/>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVgV4lJNEeiyW7NaN4qWdw" name="LoginMessage" specification="_aO0fEFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVgV41JNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVgV5FJNEeiyW7NaN4qWdw" name="userName">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aVgV5VJNEeiyW7NaN4qWdw" name="version">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aVgV5lJNEeiyW7NaN4qWdw" name="startGame">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aVgV51JNEeiyW7NaN4qWdw" name="singlePlayer">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aVgV6FJNEeiyW7NaN4qWdw" name="currentPlayer">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aVgV6VJNEeiyW7NaN4qWdw" name="activeUnit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVgV6lJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVgV61JNEeiyW7NaN4qWdw" type="_Y_504FJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.player = player;&#xD;
     this.userName = userName;&#xD;
     this.version = version;&#xD;
     this.admin = player.isAdmin();&#xD;
     this.startGame = startGame;&#xD;
     this.singlePlayer = singlePlayer;&#xD;
     this.currentPlayer = currentPlayer;&#xD;
     this.activeUnitId = (activeUnit == null) ? null : activeUnit.getId();&#xD;
     this.game = game;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVg88FJNEeiyW7NaN4qWdw" name="LoginMessage" specification="_aO1tMFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVg88VJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVg88lJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVg881JNEeiyW7NaN4qWdw" type="_Y_504FJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     String str;&#xD;
     this.player = null; // Should not be used on client side&#xD;
     this.userName = element.getAttribute(&quot;userName&quot;);&#xD;
     this.version = element.getAttribute(&quot;version&quot;);&#xD;
     str = element.getAttribute(&quot;admin&quot;);&#xD;
     this.admin = Boolean.parseBoolean(str);&#xD;
     str = element.getAttribute(&quot;startGame&quot;);&#xD;
     this.startGame = Boolean.parseBoolean(str);&#xD;
     str = element.getAttribute(&quot;singlePlayer&quot;);&#xD;
     this.singlePlayer = Boolean.parseBoolean(str);&#xD;
     str = element.getAttribute(&quot;currentPlayer&quot;);&#xD;
     this.currentPlayer = Boolean.parseBoolean(str);&#xD;
     this.activeUnitId = element.getAttribute(&quot;activeUnit&quot;);&#xD;
     NodeList children = element.getChildNodes();&#xD;
     this.game = (children.getLength() != 1) ? null&#xD;
         : new Game((Element)children.item(0), this.userName);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVg89FJNEeiyW7NaN4qWdw" name="getVersion" specification="_ZABJoFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVg89VJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return version;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVhkAFJNEeiyW7NaN4qWdw" name="isAdmin" specification="_ZABwsFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVhkAVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return admin;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVhkAlJNEeiyW7NaN4qWdw" name="getStartGame" specification="_ZABwslJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVhkA1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return startGame;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVhkBFJNEeiyW7NaN4qWdw" name="isSinglePlayer" specification="_ZACXwVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVhkBVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return singlePlayer;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVhkBlJNEeiyW7NaN4qWdw" name="isCurrentPlayer" specification="_ZAC-0FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVhkB1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return currentPlayer;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVhkCFJNEeiyW7NaN4qWdw" name="getActiveUnit" specification="_ZAC-0lJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVhkCVJNEeiyW7NaN4qWdw" type="_aG5SIVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return (activeUnitId == null) ? null&#xD;
         : game.getFreeColGameObject(activeUnitId, Unit.class);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aViLEFJNEeiyW7NaN4qWdw" name="getGame" specification="_ZADl4FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aViLEVJNEeiyW7NaN4qWdw" type="_aGx9YFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return game;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aViLElJNEeiyW7NaN4qWdw" name="handle" specification="_aO2UQlJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aViLE1JNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aViLFFJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aViLFVJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aViLFlJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return null;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aViLF1JNEeiyW7NaN4qWdw" name="toXMLElement" specification="_ZAE0AFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aViLGFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>Element result = createMessage(getXMLElementTagName(),&#xD;
         &quot;userName&quot;, userName,&#xD;
         &quot;version&quot;, version,&#xD;
         &quot;admin&quot;, Boolean.toString(admin),&#xD;
         &quot;startGame&quot;, Boolean.toString(startGame),&#xD;
         &quot;singlePlayer&quot;, Boolean.toString(singlePlayer),&#xD;
         &quot;currentPlayer&quot;, Boolean.toString(currentPlayer),&#xD;
         &quot;activeUnit&quot;, activeUnitId);&#xD;
     result.appendChild(game.toXMLElement(result.getOwnerDocument(), &#xD;
                                          player));&#xD;
     return result;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aViLGVJNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_ZAGCIFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aViLGlJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;login&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_ZABJoFJNEeiyW7NaN4qWdw" name="getVersion" method="_aVg89FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_ZABJoVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_ZABwsFJNEeiyW7NaN4qWdw" name="isAdmin" method="_aVhkAFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_ZABwsVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_ZABwslJNEeiyW7NaN4qWdw" name="getStartGame" method="_aVhkAlJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_ZACXwFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_ZACXwVJNEeiyW7NaN4qWdw" name="isSinglePlayer" method="_aVhkBFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_ZACXwlJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_ZAC-0FJNEeiyW7NaN4qWdw" name="isCurrentPlayer" method="_aVhkBlJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_ZAC-0VJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_ZAC-0lJNEeiyW7NaN4qWdw" name="getActiveUnit" method="_aVhkCFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aO2UQFJNEeiyW7NaN4qWdw" type="_aG5SIVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_ZADl4FJNEeiyW7NaN4qWdw" name="getGame" method="_aViLEFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aO2UQVJNEeiyW7NaN4qWdw" type="_aGx9YFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_ZAE0AFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aViLF1JNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aO27VFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_ZAGCIFJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aViLGVJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXG4Y1JNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;login&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZAGCIVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aO0fEFJNEeiyW7NaN4qWdw" name="LoginMessage" method="_aVgV4lJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aO1GIlJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aO1GI1JNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXG4YFJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>LoginMessage&lt;/code> with the supplied name&#xD;
     * and version.&#xD;
     *&#xD;
     * @param player The &lt;code>Player&lt;/code> that is logging in.&#xD;
     * @param userName The name of the user logging in.&#xD;
     * @param version The version of FreeCol at the client.&#xD;
     * @param startGame Whether to start the game.&#xD;
     * @param singlePlayer True in single player games.&#xD;
     * @param currentPlayer True if this player is the current player.&#xD;
     * @param activeUnit The current active &lt;code>Unit&lt;/code>, or null.&#xD;
     * @param game The entire game.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aO0fEVJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aO0fElJNEeiyW7NaN4qWdw" name="userName">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aO0fE1JNEeiyW7NaN4qWdw" name="version">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aO0fFFJNEeiyW7NaN4qWdw" name="startGame">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aO0fFVJNEeiyW7NaN4qWdw" name="singlePlayer">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aO0fFlJNEeiyW7NaN4qWdw" name="currentPlayer">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aO1GIFJNEeiyW7NaN4qWdw" name="activeUnit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aO1GIVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aO1GJFJNEeiyW7NaN4qWdw" type="_Y_504FJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aO1tMFJNEeiyW7NaN4qWdw" name="LoginMessage" method="_aVg88FJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aO1tM1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aO1tNFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXG4YVJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>LoginMessage&lt;/code> from a supplied element.&#xD;
     *&#xD;
     * @param game A &lt;code>Game&lt;/code> (not used).&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aO1tMVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aO1tMlJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aO1tNVJNEeiyW7NaN4qWdw" type="_Y_504FJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aO2UQlJNEeiyW7NaN4qWdw" name="handle" method="_aViLElJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXG4YlJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;login&quot;-message.&#xD;
     * This is actually done in PreGameController.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param player The &lt;code>Player&lt;/code> the message applies to.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     *&#xD;
     * @return Null.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aO27UFJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aO27UVJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aO27UlJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aO27U1JNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_ZAMIwFJNEeiyW7NaN4qWdw" name="LootCargoMessage">
                <ownedComment xmi:id="_aXG4ZFJNEeiyW7NaN4qWdw">
                  <body>The message sent when looting cargo.</body>
                </ownedComment>
                <generalization xmi:id="_aJ0qUFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aTMBsFJNEeiyW7NaN4qWdw" name="winnerId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aTMowVJNEeiyW7NaN4qWdw" name="loserId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aTNP0FJNEeiyW7NaN4qWdw" name="goods" isLeaf="true" type="_aHJw0FJNEeiyW7NaN4qWdw" isOrdered="true" isReadOnly="true" association="_aaqisVJNEeiyW7NaN4qWdw">
                  <upperValue xmi:type="uml:LiteralUnlimitedNatural" xmi:id="_aTNP0lJNEeiyW7NaN4qWdw" value="*"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVjZMFJNEeiyW7NaN4qWdw" name="LootCargoMessage" specification="_aO4wgFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVjZMVJNEeiyW7NaN4qWdw" name="winner" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVjZMlJNEeiyW7NaN4qWdw" name="loserId">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aVjZM1JNEeiyW7NaN4qWdw" name="goods" type="_aHo5AFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVjZNFJNEeiyW7NaN4qWdw" type="_ZAMIwFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.winnerId = winner.getId();&#xD;
     this.loserId = loserId;&#xD;
     this.goods = (goods == null) ? null : new ArrayList&lt;>(goods);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVjZNVJNEeiyW7NaN4qWdw" name="LootCargoMessage" specification="_aO5-oFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVjZNlJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVjZN1JNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVjZOFJNEeiyW7NaN4qWdw" type="_ZAMIwFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.winnerId = element.getAttribute(&quot;winner&quot;);&#xD;
     this.loserId = element.getAttribute(&quot;loser&quot;);&#xD;
     NodeList children = element.getChildNodes();&#xD;
     if (children.getLength() == 0) {&#xD;
         this.goods = null;&#xD;
     } else {&#xD;
         this.goods = new ArrayList&lt;>();&#xD;
         for (int i = 0; i &lt; children.getLength(); i++) {&#xD;
             this.goods.add(new Goods(game, (Element) children.item(i)));&#xD;
         }&#xD;
     }&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVjZOVJNEeiyW7NaN4qWdw" name="getUnit" specification="_aO7MwVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVjZOlJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVjZO1JNEeiyW7NaN4qWdw" type="_aG5SIVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return game.getFreeColGameObject(winnerId, Unit.class);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVjZPFJNEeiyW7NaN4qWdw" name="getDefenderId" specification="_ZAOlAFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVjZPVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return loserId;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVkAQFJNEeiyW7NaN4qWdw" name="handle" specification="_aO7z0VJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVkAQVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVkAQlJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVkAQ1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVkARFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
     final Game game = server.getGame();&#xD;
&#xD;
     Unit winner;&#xD;
     try {&#xD;
         winner = getUnit(game);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
     // Do not check loserId, as it might have sunk.  It is enough&#xD;
     // that the attacker knows it.  Similarly the server is better&#xD;
     // placed to check the goods validity.&#xD;
&#xD;
     // Try to loot.&#xD;
     return server.getInGameController()&#xD;
         .lootCargo(serverPlayer, winner, loserId, goods);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVkARVJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_ZAPzIFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVkARlJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>Element result = createMessage(getXMLElementTagName(),&#xD;
         &quot;winner&quot;, winnerId,&#xD;
         &quot;loser&quot;, loserId);&#xD;
     if (goods != null) {&#xD;
         for (Goods g : goods) {&#xD;
             result.appendChild(g.toXMLElement(result.getOwnerDocument()));&#xD;
         }&#xD;
     }&#xD;
     return result;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVkAR1JNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_ZARBQFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVkASFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;lootCargo&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_ZAOlAFJNEeiyW7NaN4qWdw" name="getDefenderId" method="_aVjZPFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXHfcFJNEeiyW7NaN4qWdw">
                    <body>Public accessor to help the client in game controller.&#xD;
     *&#xD;
     * @return The defender Object Identifier.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZAPMEFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_ZAPzIFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aVkARVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aO8a4lJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_ZARBQFJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aVkAR1JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXHfclJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;lootCargo&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZARBQVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aO4wgFJNEeiyW7NaN4qWdw" name="LootCargoMessage" method="_aVjZMFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aO4whFJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aO4whVJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXG4ZVJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>LootCargoMessage&lt;/code>.&#xD;
     *&#xD;
     * @param winner The &lt;code>Unit&lt;/code> that is looting.&#xD;
     * @param loserId The identifier of the &lt;code>Unit&lt;/code> that is looted.&#xD;
     * @param goods The &lt;code>AbstractGoods&lt;/code> to loot.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aO4wgVJNEeiyW7NaN4qWdw" name="winner" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aO4wglJNEeiyW7NaN4qWdw" name="loserId">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aO4wg1JNEeiyW7NaN4qWdw" name="goods" type="_aHo5AFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aO4whlJNEeiyW7NaN4qWdw" type="_ZAMIwFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aO5-oFJNEeiyW7NaN4qWdw" name="LootCargoMessage" method="_aVjZNVJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aO5-o1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aO5-pFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXG4ZlJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>LootCargoMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aO5-oVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aO5-olJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aO5-pVJNEeiyW7NaN4qWdw" type="_ZAMIwFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aO7MwVJNEeiyW7NaN4qWdw" name="getUnit" method="_aVjZOVJNEeiyW7NaN4qWdw" raisedException="_aO6lsVJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXG4Z1JNEeiyW7NaN4qWdw">
                    <body>Public accessor to help the client in game controller.&#xD;
     *&#xD;
     * @return The winner unit.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aO7MwlJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aO7z0FJNEeiyW7NaN4qWdw" type="_aG5SIVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aO7z0VJNEeiyW7NaN4qWdw" name="handle" method="_aVkAQFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXHfcVJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;lootCargo&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param player The &lt;code>Player&lt;/code> the message applies to.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating the looting.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aO7z0lJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aO7z01JNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aO8a4FJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aO8a4VJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_ZAWg0FJNEeiyW7NaN4qWdw" name="Message">
                <ownedComment xmi:id="_aXHfc1JNEeiyW7NaN4qWdw">
                  <body>Class for parsing raw message data into an XML-tree and for creating new&#xD;
XML-trees.</body>
                </ownedComment>
                <ownedAttribute xmi:id="_aTOd8FJNEeiyW7NaN4qWdw" name="logger" visibility="protected" isLeaf="true" isStatic="true" type="_aH_eUVJNEeiyW7NaN4qWdw" isReadOnly="true" association="_aazsoVJNEeiyW7NaN4qWdw">
                  <defaultValue xmi:type="uml:LiteralString" xmi:id="_aTOd8VJNEeiyW7NaN4qWdw" value="Logger.getLogger(Message.class.getName())"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aTOd8lJNEeiyW7NaN4qWdw" name="FREECOL_PROTOCOL_VERSION" visibility="private" isLeaf="true" isStatic="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  <defaultValue xmi:type="uml:LiteralString" xmi:id="_aTOd81JNEeiyW7NaN4qWdw" value="&quot;0.1.6&quot;"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aTPFAFJNEeiyW7NaN4qWdw" name="INVALID_MESSAGE" visibility="private" isLeaf="true" isStatic="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  <defaultValue xmi:type="uml:LiteralString" xmi:id="_aTPFAVJNEeiyW7NaN4qWdw" value="&quot;invalid&quot;"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aTPFAlJNEeiyW7NaN4qWdw" name="document" visibility="protected" type="_aIqzwVJNEeiyW7NaN4qWdw" association="_aa7ocVJNEeiyW7NaN4qWdw"/>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVknUFJNEeiyW7NaN4qWdw" name="Message" specification="_ZAXu8FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVknUVJNEeiyW7NaN4qWdw" type="_ZAWg0FJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>// empty constructor&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVknUlJNEeiyW7NaN4qWdw" name="Message" specification="_ZAY9EFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVknU1JNEeiyW7NaN4qWdw" name="msg">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aVknVFJNEeiyW7NaN4qWdw" type="_ZAWg0FJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>this(new InputSource(new StringReader(msg)));&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVlOYFJNEeiyW7NaN4qWdw" name="Message" specification="_aO9pAFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVlOYVJNEeiyW7NaN4qWdw" name="inputStream" type="_aILrkVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVlOYlJNEeiyW7NaN4qWdw" type="_ZAWg0FJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>this(new InputSource(inputStream));&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVlOY1JNEeiyW7NaN4qWdw" name="Message" specification="_aO-QEFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVlOZFJNEeiyW7NaN4qWdw" name="inputSource" type="_aIso8VJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVlOZVJNEeiyW7NaN4qWdw" type="_ZAWg0FJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();&#xD;
     Document tempDocument = null;&#xD;
     boolean dumpMsgOnError&#xD;
         = FreeColDebugger.isInDebugMode(FreeColDebugger.DebugMode.COMMS);&#xD;
     if (dumpMsgOnError) {&#xD;
         inputSource.setByteStream(new BufferedInputStream(inputSource.getByteStream()));&#xD;
&#xD;
         inputSource.getByteStream().mark(1000000);&#xD;
     }&#xD;
&#xD;
     try {&#xD;
         DocumentBuilder builder = factory.newDocumentBuilder();&#xD;
         tempDocument = builder.parse(inputSource);&#xD;
     } catch (ParserConfigurationException pce) {&#xD;
         // Parser with specified options can't be built&#xD;
         logger.log(Level.WARNING, &quot;Parser error&quot;, pce);&#xD;
     } catch (IOException|SAXException ex) {&#xD;
         throw ex;&#xD;
     } catch (ArrayIndexOutOfBoundsException e) {&#xD;
         // Xerces throws ArrayIndexOutOfBoundsException when it barfs on&#xD;
         // some FreeCol messages. I'd like to see the messages upon which&#xD;
         // it barfs&#xD;
         if (dumpMsgOnError) {&#xD;
             ByteArrayOutputStream baos = new ByteArrayOutputStream();&#xD;
             inputSource.getByteStream().reset();&#xD;
             while (true) {&#xD;
                 int i = inputSource.getByteStream().read();&#xD;
                 if (-1 == i) {&#xD;
                     break;&#xD;
                 }&#xD;
                 baos.write(i);&#xD;
             }&#xD;
             logger.severe(baos.toString(&quot;UTF-8&quot;));&#xD;
         }&#xD;
         throw e;&#xD;
     }&#xD;
     document = tempDocument;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVlOZlJNEeiyW7NaN4qWdw" name="Message" specification="_aO-3I1JNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVlOZ1JNEeiyW7NaN4qWdw" name="document" type="_aIqzwVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVlOaFJNEeiyW7NaN4qWdw" type="_ZAWg0FJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>this.document = document;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVlOaVJNEeiyW7NaN4qWdw" name="getDocument" specification="_ZAayQFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVlOalJNEeiyW7NaN4qWdw" type="_aIqzwVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return document;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVl1cFJNEeiyW7NaN4qWdw" name="getType" specification="_ZAbZUFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVl1cVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return (document != null &amp;&amp; document.getDocumentElement() != null)&#xD;
         ? document.getDocumentElement().getTagName()&#xD;
         : INVALID_MESSAGE;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVl1clJNEeiyW7NaN4qWdw" name="isType" specification="_ZAcAYFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVl1c1JNEeiyW7NaN4qWdw" name="type">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aVl1dFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return getType().equals(type);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVl1dVJNEeiyW7NaN4qWdw" name="getAttribute" specification="_ZAcncFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVl1dlJNEeiyW7NaN4qWdw" name="key">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aVl1d1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return document.getDocumentElement().getAttribute(key);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVl1eFJNEeiyW7NaN4qWdw" name="hasAttribute" specification="_ZAdOgFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVl1eVJNEeiyW7NaN4qWdw" name="attribute">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aVl1elJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return document.getDocumentElement().hasAttribute(attribute);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVmcgFJNEeiyW7NaN4qWdw" name="setAttribute" specification="_ZAd1kFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVmcgVJNEeiyW7NaN4qWdw" name="key">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aVmcglJNEeiyW7NaN4qWdw" name="value">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>document.getDocumentElement().setAttribute(key, value);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVmcg1JNEeiyW7NaN4qWdw" name="setAttribute" specification="_ZAecoFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVmchFJNEeiyW7NaN4qWdw" name="key">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aVmchVJNEeiyW7NaN4qWdw" name="value">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>setAttribute(key, Integer.toString(value));&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVmchlJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_ZAfDsFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVmch1JNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return null; // do nothing&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVmciFJNEeiyW7NaN4qWdw" name="toString" specification="_ZAfDsVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVmciVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return document.getDocumentElement().toString();&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVnDkFJNEeiyW7NaN4qWdw" name="getFreeColProtocolVersion" specification="_ZAgR0lJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVnDkVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return FREECOL_PROTOCOL_VERSION;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_ZAXu8FJNEeiyW7NaN4qWdw" name="Message" visibility="protected" method="_aVknUFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_ZAXu8VJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_ZAYWAFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedParameter xmi:id="_ZAYWAVJNEeiyW7NaN4qWdw" type="_ZAWg0FJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_ZAY9EFJNEeiyW7NaN4qWdw" name="Message" method="_aVknUlJNEeiyW7NaN4qWdw" raisedException="_aIXRwFJNEeiyW7NaN4qWdw _aH-QMFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_ZAY9ElJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_ZAY9E1JNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXHfdFJNEeiyW7NaN4qWdw">
                    <body>Constructs a new Message with data from the given String. The&#xD;
     * constructor to use if this is an INCOMING message.&#xD;
     * &#xD;
     * @param msg The raw message data.&#xD;
     * @exception IOException should not be thrown.&#xD;
     * @exception SAXException if thrown during parsing.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZAY9EVJNEeiyW7NaN4qWdw" name="msg">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_ZAY9FFJNEeiyW7NaN4qWdw" type="_ZAWg0FJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_ZAayQFJNEeiyW7NaN4qWdw" name="getDocument" method="_aVlOaVJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXHfeFJNEeiyW7NaN4qWdw">
                    <body>Gets the &lt;code>Document&lt;/code> holding the message data.&#xD;
     * &#xD;
     * @return The &lt;code>Document&lt;/code> holding the message data.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aO_eNFJNEeiyW7NaN4qWdw" type="_aIqzwVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_ZAbZUFJNEeiyW7NaN4qWdw" name="getType" method="_aVl1cFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXIGgFJNEeiyW7NaN4qWdw">
                    <body>Gets the type of this Message.&#xD;
     * &#xD;
     * @return The type of this Message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZAbZUVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_ZAcAYFJNEeiyW7NaN4qWdw" name="isType" method="_aVl1clJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXIGgVJNEeiyW7NaN4qWdw">
                    <body>Checks if this message is of a given type.&#xD;
     * &#xD;
     * @param type The type you wish to test against.&#xD;
     * @return True if the type of this message equals the given type.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZAcAYVJNEeiyW7NaN4qWdw" name="type">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_ZAcAYlJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_ZAcncFJNEeiyW7NaN4qWdw" name="getAttribute" method="_aVl1dVJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXIGglJNEeiyW7NaN4qWdw">
                    <body>Gets an attribute from the root element.&#xD;
     * &#xD;
     * @param key The key of the attribute.&#xD;
     * @return The value of the attribute with the given key.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZAcncVJNEeiyW7NaN4qWdw" name="key">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_ZAcnclJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_ZAdOgFJNEeiyW7NaN4qWdw" name="hasAttribute" method="_aVl1eFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXIGg1JNEeiyW7NaN4qWdw">
                    <body>Checks if an attribute is set on the root element.&#xD;
     * &#xD;
     * @param attribute The attribute in which to verify the existence of.&#xD;
     * @return &lt;code>true&lt;/code> if the root element has the given attribute.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZAdOgVJNEeiyW7NaN4qWdw" name="attribute">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_ZAdOglJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_ZAd1kFJNEeiyW7NaN4qWdw" name="setAttribute" method="_aVmcgFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXIGhFJNEeiyW7NaN4qWdw">
                    <body>Sets an attribute on the root element.&#xD;
     * &#xD;
     * @param key The key of the attribute.&#xD;
     * @param value The value of the attribute.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZAd1kVJNEeiyW7NaN4qWdw" name="key">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_ZAd1klJNEeiyW7NaN4qWdw" name="value">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_ZAecoFJNEeiyW7NaN4qWdw" name="setAttribute" method="_aVmcg1JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXIGhVJNEeiyW7NaN4qWdw">
                    <body>Sets an attribute on the root element.&#xD;
     * &#xD;
     * @param key The key of the attribute.&#xD;
     * @param value The value of the attribute.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZAecoVJNEeiyW7NaN4qWdw" name="key">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_ZAecolJNEeiyW7NaN4qWdw" name="value">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_ZAfDsFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aVmchlJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXIGhlJNEeiyW7NaN4qWdw">
                    <body>Dummy serialization stub.&#xD;
     * Must be overridden by subclasses.&#xD;
     *&#xD;
     * @return Null.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aPAFQFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_ZAfDsVJNEeiyW7NaN4qWdw" name="toString" method="_aVmciFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_ZAfqwFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_ZAgR0lJNEeiyW7NaN4qWdw" name="getFreeColProtocolVersion" isStatic="true" method="_aVnDkFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXIGh1JNEeiyW7NaN4qWdw">
                    <body>Gets the current version of the FreeCol protocol.&#xD;
     * &#xD;
     * @return The version of the FreeCol protocol.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZAgR01JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aO9pAFJNEeiyW7NaN4qWdw" name="Message" method="_aVlOYFJNEeiyW7NaN4qWdw" raisedException="_aIXRwFJNEeiyW7NaN4qWdw _aH-QMFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aO9pAlJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aO9pA1JNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXHfdVJNEeiyW7NaN4qWdw">
                    <body>Constructs a new Message with data from the given InputStream. The&#xD;
     * constructor to use if this is an INCOMING message.&#xD;
     * &#xD;
     * @param inputStream The &lt;code>InputStream&lt;/code> to get the XML-data&#xD;
     *            from.&#xD;
     * @exception IOException if thrown by the &lt;code>InputStream&lt;/code>.&#xD;
     * @exception SAXException if thrown during parsing.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aO9pAVJNEeiyW7NaN4qWdw" name="inputStream" type="_aILrkVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aO9pBFJNEeiyW7NaN4qWdw" type="_ZAWg0FJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aO-QEFJNEeiyW7NaN4qWdw" name="Message" visibility="private" method="_aVlOY1JNEeiyW7NaN4qWdw" raisedException="_aIXRwFJNEeiyW7NaN4qWdw _aH-QMFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aO-3IFJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aO-3IVJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXHfdlJNEeiyW7NaN4qWdw">
                    <body>Constructs a new Message with data from the given InputSource. The&#xD;
     * constructor to use if this is an INCOMING message.&#xD;
     * &#xD;
     * @param inputSource The &lt;code>InputSource&lt;/code> to get the XML-data&#xD;
     *            from.&#xD;
     * @exception IOException if thrown by the &lt;code>InputSource&lt;/code>.&#xD;
     * @exception SAXException if thrown during parsing.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aO-QEVJNEeiyW7NaN4qWdw" name="inputSource" type="_aIso8VJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aO-3IlJNEeiyW7NaN4qWdw" type="_ZAWg0FJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aO-3I1JNEeiyW7NaN4qWdw" name="Message" method="_aVlOZlJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aO_eMVJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aO_eMlJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXHfd1JNEeiyW7NaN4qWdw">
                    <body>Constructs a new Message with data from the given XML-document.&#xD;
     * &#xD;
     * @param document The document representing an XML-message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aO_eMFJNEeiyW7NaN4qWdw" name="document" type="_aIqzwVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aO_eM1JNEeiyW7NaN4qWdw" type="_ZAWg0FJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Interface" xmi:id="_ZAlKUFJNEeiyW7NaN4qWdw" name="MessageHandler">
                <ownedComment xmi:id="_aXIGiFJNEeiyW7NaN4qWdw">
                  <body>Handles complete incoming messages.</body>
                </ownedComment>
                <ownedOperation xmi:id="_aPAsUFJNEeiyW7NaN4qWdw" name="handle" raisedException="_aIAFYVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aPAsUVJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPAsUlJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPBTYFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_ZAmYcFJNEeiyW7NaN4qWdw" name="MissionaryMessage">
                <ownedComment xmi:id="_aXIGiVJNEeiyW7NaN4qWdw">
                  <body>The message sent when a missionary establishes/denounces a mission.</body>
                </ownedComment>
                <generalization xmi:id="_aJ_CYFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aTPsEFJNEeiyW7NaN4qWdw" name="unitId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aTQTIVJNEeiyW7NaN4qWdw" name="directionString" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aTQ6MVJNEeiyW7NaN4qWdw" name="denounce" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVnDklJNEeiyW7NaN4qWdw" name="MissionaryMessage" specification="_aPBTYVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVnDk1JNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVnDlFJNEeiyW7NaN4qWdw" name="direction" type="_aG4EAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVnDlVJNEeiyW7NaN4qWdw" name="denounce">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aVnDllJNEeiyW7NaN4qWdw" type="_ZAmYcFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = unit.getId();&#xD;
     this.directionString = String.valueOf(direction);&#xD;
     this.denounce = denounce;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVnqoFJNEeiyW7NaN4qWdw" name="MissionaryMessage" specification="_aPB6dVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVnqoVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVnqolJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVnqo1JNEeiyW7NaN4qWdw" type="_ZAmYcFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = element.getAttribute(&quot;unitId&quot;);&#xD;
     this.directionString = element.getAttribute(&quot;direction&quot;);&#xD;
     this.denounce = Boolean.parseBoolean(element.getAttribute(&quot;denounce&quot;));&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVnqpFJNEeiyW7NaN4qWdw" name="handle" specification="_aPDIkFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVnqpVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVnqplJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVnqp1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVnqqFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
&#xD;
     Unit unit;&#xD;
     try {&#xD;
         unit = player.getOurFreeColGameObject(unitId, Unit.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     Tile tile;&#xD;
     try {&#xD;
         tile = unit.getNeighbourTile(directionString);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     ServerIndianSettlement is&#xD;
         = (ServerIndianSettlement)tile.getIndianSettlement();&#xD;
     if (is == null) {&#xD;
         return DOMMessage.clientError(&quot;There is no native settlement at: &quot;&#xD;
             + tile.getId());&#xD;
     }&#xD;
&#xD;
     Unit missionary = is.getMissionary();&#xD;
     if (denounce) {&#xD;
         if (missionary == null) {&#xD;
             return DOMMessage.clientError(&quot;Denouncing an empty mission at: &quot;&#xD;
                 + is.getId());&#xD;
         } else if (missionary.getOwner() == player) {&#xD;
             return DOMMessage.clientError(&quot;Denouncing our own missionary at: &quot;&#xD;
                 + is.getId());&#xD;
         } else if (!unit.hasAbility(Ability.DENOUNCE_HERESY)) {&#xD;
             return DOMMessage.clientError(&quot;Unit lacks denouncement ability: &quot;&#xD;
                 + unitId);&#xD;
         }&#xD;
     } else {&#xD;
         if (missionary != null) {&#xD;
             return DOMMessage.clientError(&quot;Establishing extra mission at: &quot;&#xD;
                 + is.getId());&#xD;
         } else if (!unit.hasAbility(Ability.ESTABLISH_MISSION)) {&#xD;
             return DOMMessage.clientError(&quot;Unit lacks establish mission ability: &quot;&#xD;
                 + unitId);&#xD;
         }&#xD;
     }&#xD;
&#xD;
     MoveType type = unit.getMoveType(is.getTile());&#xD;
     if (type != MoveType.ENTER_INDIAN_SETTLEMENT_WITH_MISSIONARY) {&#xD;
         return DOMMessage.clientError(&quot;Unable to enter &quot; + is.getName()&#xD;
             + &quot;: &quot; + type.whyIllegal());&#xD;
     }&#xD;
&#xD;
     // Valid, proceed to denounce/establish.&#xD;
     return (denounce)&#xD;
         ? server.getInGameController()&#xD;
             .denounceMission(serverPlayer, unit, is)&#xD;
         : server.getInGameController()&#xD;
             .establishMission(serverPlayer, unit, is);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVnqqVJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_ZAo0sFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVnqqlJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return createMessage(getXMLElementTagName(),&#xD;
         &quot;unitId&quot;, unitId,&#xD;
         &quot;direction&quot;, directionString,&#xD;
         &quot;denounce&quot;, Boolean.toString(denounce));&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVoRsFJNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_ZAqC0FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVoRsVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;missionary&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_ZAo0sFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aVnqqVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aPDvoFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_ZAqC0FJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aVoRsFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXItk1JNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;missionary&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZAqC0VJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aPBTYVJNEeiyW7NaN4qWdw" name="MissionaryMessage" method="_aVnDklJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aPB6clJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aPB6c1JNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXItkFJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>MissionaryMessage&lt;/code> with the&#xD;
     * supplied name.&#xD;
     *&#xD;
     * @param unit The missionary &lt;code>Unit&lt;/code>.&#xD;
     * @param direction The &lt;code>Direction&lt;/code> to the settlement.&#xD;
     * @param denounce True if this is a denunciation.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aPBTYlJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPB6cFJNEeiyW7NaN4qWdw" name="direction" type="_aG4EAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPB6cVJNEeiyW7NaN4qWdw" name="denounce">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aPB6dFJNEeiyW7NaN4qWdw" type="_ZAmYcFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aPB6dVJNEeiyW7NaN4qWdw" name="MissionaryMessage" method="_aVnqoFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aPChglJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aPChg1JNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXItkVJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>MissionaryMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aPChgFJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPChgVJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPChhFJNEeiyW7NaN4qWdw" type="_ZAmYcFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aPDIkFJNEeiyW7NaN4qWdw" name="handle" method="_aVnqpFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXItklJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;missionary&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param player The &lt;code>Player&lt;/code> the message applies to.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     * @return An element containing the result of the mission&#xD;
     *     operation, or an error &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aPDIkVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPDIklJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPDIk1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPDIlFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_ZAttMFJNEeiyW7NaN4qWdw" name="MonarchActionMessage">
                <ownedComment xmi:id="_aXItlFJNEeiyW7NaN4qWdw">
                  <body>The message sent when doing a monarch action.</body>
                </ownedComment>
                <generalization xmi:id="_aKCFsVJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aTRhQFJNEeiyW7NaN4qWdw" name="action" visibility="private" isLeaf="true" type="_aKA3kFJNEeiyW7NaN4qWdw" isReadOnly="true"/>
                <ownedAttribute xmi:id="_aTSIUFJNEeiyW7NaN4qWdw" name="template" visibility="private" isLeaf="true" type="_aI1y4FJNEeiyW7NaN4qWdw" isReadOnly="true" association="_abCWIVJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aTSIUlJNEeiyW7NaN4qWdw" name="monarchKey" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aTSvYVJNEeiyW7NaN4qWdw" name="tax">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aTT9gFJNEeiyW7NaN4qWdw" name="resultString" visibility="private">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVo4wlJNEeiyW7NaN4qWdw" name="MonarchActionMessage" specification="_aPEWsFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVo4w1JNEeiyW7NaN4qWdw" name="action" type="_aKA3kFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVo4xFJNEeiyW7NaN4qWdw" name="template" type="_aI1y4FJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVo4xVJNEeiyW7NaN4qWdw" name="monarchKey">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aVo4xlJNEeiyW7NaN4qWdw" type="_ZAttMFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.action = action;&#xD;
     this.template = template;&#xD;
     this.monarchKey = monarchKey;&#xD;
     this.tax = null;&#xD;
     this.resultString = null;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVo4x1JNEeiyW7NaN4qWdw" name="MonarchActionMessage" specification="_aPFk0FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVo4yFJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVo4yVJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVo4ylJNEeiyW7NaN4qWdw" type="_ZAttMFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.action = Enum.valueOf(MonarchAction.class,&#xD;
                                element.getAttribute(&quot;action&quot;));&#xD;
     this.monarchKey = element.getAttribute(&quot;monarch&quot;);&#xD;
     this.tax = element.getAttribute(&quot;tax&quot;);&#xD;
     this.resultString = element.getAttribute(&quot;result&quot;);&#xD;
     NodeList children = element.getChildNodes();&#xD;
     if (children.getLength() == 1) {&#xD;
         this.template = StringTemplate.label(&quot; &quot;);&#xD;
         this.template.readFromXMLElement((Element) children.item(0));&#xD;
     } else {&#xD;
         this.template = null;&#xD;
     }&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVo4y1JNEeiyW7NaN4qWdw" name="getAction" specification="_ZAviYFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVo4zFJNEeiyW7NaN4qWdw" type="_aKA3kFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return action;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVpf0FJNEeiyW7NaN4qWdw" name="getTemplate" specification="_ZAwJcFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVpf0VJNEeiyW7NaN4qWdw" type="_aI1y4FJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return template;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVpf0lJNEeiyW7NaN4qWdw" name="getMonarchKey" specification="_ZAwwgFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVpf01JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return this.monarchKey;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVpf1FJNEeiyW7NaN4qWdw" name="getResult" specification="_ZAwwglJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVpf1VJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return Boolean.parseBoolean(resultString);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVpf1lJNEeiyW7NaN4qWdw" name="setResult" specification="_ZAxXkFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVpf11JNEeiyW7NaN4qWdw" name="accept">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aVpf2FJNEeiyW7NaN4qWdw" type="_ZAttMFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>this.resultString = Boolean.toString(accept);&#xD;
     return this;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVqG4FJNEeiyW7NaN4qWdw" name="handle" specification="_aPGL4lJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVqG4VJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVqG4lJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVqG41JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVqG5FJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
&#xD;
     // Try to resolve the action.&#xD;
     return server.getInGameController()&#xD;
         .monarchAction(serverPlayer, action, getResult());&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVqG5VJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_ZAx-oFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVqG5lJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>Element result = createMessage(getXMLElementTagName(),&#xD;
         &quot;action&quot;, action.toString(),&#xD;
         &quot;monarch&quot;, monarchKey);&#xD;
     if (tax != null) result.setAttribute(&quot;tax&quot;, tax);&#xD;
     if (resultString != null) result.setAttribute(&quot;result&quot;, resultString);&#xD;
     if (template != null) {&#xD;
         result.appendChild(template.toXMLElement(result.getOwnerDocument()));&#xD;
     }&#xD;
     return result;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVqG51JNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_ZAzMwVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVqG6FJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;monarchAction&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_ZAviYFJNEeiyW7NaN4qWdw" name="getAction" method="_aVo4y1JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXItl1JNEeiyW7NaN4qWdw">
                    <body>Gets the monarch action type of this message.&#xD;
     *&#xD;
     * @return The monarch action type.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aPGL4FJNEeiyW7NaN4qWdw" type="_aKA3kFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_ZAwJcFJNEeiyW7NaN4qWdw" name="getTemplate" method="_aVpf0FJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXItmFJNEeiyW7NaN4qWdw">
                    <body>Gets the template of this message.&#xD;
     *&#xD;
     * @return The template.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aPGL4VJNEeiyW7NaN4qWdw" type="_aI1y4FJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_ZAwwgFJNEeiyW7NaN4qWdw" name="getMonarchKey" method="_aVpf0lJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXJUoFJNEeiyW7NaN4qWdw">
                    <body>Gets the monarch key.&#xD;
     *&#xD;
     * @return The monarch key.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZAwwgVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_ZAwwglJNEeiyW7NaN4qWdw" name="getResult" method="_aVpf1FJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXJUoVJNEeiyW7NaN4qWdw">
                    <body>Gets the result.&#xD;
     *&#xD;
     * @return The result.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZAwwg1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_ZAxXkFJNEeiyW7NaN4qWdw" name="setResult" method="_aVpf1lJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXJUolJNEeiyW7NaN4qWdw">
                    <body>Sets the result.&#xD;
     *&#xD;
     * @param accept The new result.&#xD;
     * @return This message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZAxXkVJNEeiyW7NaN4qWdw" name="accept">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aKCFsFJNEeiyW7NaN4qWdw" type="_ZAttMFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_ZAx-oFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aVqG5VJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aPGy81JNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_ZAzMwVJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aVqG51JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXJUpFJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;monarchAction&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZAzMwlJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aPEWsFJNEeiyW7NaN4qWdw" name="MonarchActionMessage" method="_aVo4wlJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aPE9wlJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aPE9w1JNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXItlVJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>MonarchActionMessage&lt;/code> with the given action.&#xD;
     *&#xD;
     * @param action The &lt;code>MonarchAction&lt;/code> to do.&#xD;
     * @param template A &lt;code>StringTemplate&lt;/code> describing the action.&#xD;
     * @param monarchKey The resource key for the monarch image.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aPEWsVJNEeiyW7NaN4qWdw" name="action" type="_aKA3kFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPE9wFJNEeiyW7NaN4qWdw" name="template" type="_aI1y4FJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPE9wVJNEeiyW7NaN4qWdw" name="monarchKey">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aPE9xFJNEeiyW7NaN4qWdw" type="_ZAttMFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aPFk0FJNEeiyW7NaN4qWdw" name="MonarchActionMessage" method="_aVo4x1JNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aPFk01JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aPFk1FJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXItllJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>MonarchActionMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aPFk0VJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPFk0lJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPFk1VJNEeiyW7NaN4qWdw" type="_ZAttMFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aPGL4lJNEeiyW7NaN4qWdw" name="handle" method="_aVqG4FJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXJUo1JNEeiyW7NaN4qWdw">
                    <body>Handles a &quot;monarchAction&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param player The &lt;code>Player&lt;/code> the message applies to.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     *&#xD;
     * @return Null.  This should not be called.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aPGL41JNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPGy8FJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPGy8VJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPGy8lJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_ZA4sUFJNEeiyW7NaN4qWdw" name="MoveMessage">
                <ownedComment xmi:id="_aXJUpVJNEeiyW7NaN4qWdw">
                  <body>The message sent when moving a unit.</body>
                </ownedComment>
                <generalization xmi:id="_aKFJAFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aTUkkFJNEeiyW7NaN4qWdw" name="unitId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aTVLoVJNEeiyW7NaN4qWdw" name="directionString" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVqt8FJNEeiyW7NaN4qWdw" name="MoveMessage" specification="_aPIBEFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVqt8VJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVqt8lJNEeiyW7NaN4qWdw" name="direction" type="_aG4EAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVqt81JNEeiyW7NaN4qWdw" type="_ZA4sUFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = unit.getId();&#xD;
     this.directionString = String.valueOf(direction);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVqt9FJNEeiyW7NaN4qWdw" name="MoveMessage" specification="_aPIoIFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVqt9VJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVqt9lJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVqt91JNEeiyW7NaN4qWdw" type="_ZA4sUFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = element.getAttribute(&quot;unit&quot;);&#xD;
     this.directionString = element.getAttribute(&quot;direction&quot;);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVrVAFJNEeiyW7NaN4qWdw" name="handle" specification="_aPJPMFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVrVAVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVrVAlJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVrVA1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVrVBFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
&#xD;
     ServerUnit unit;&#xD;
     try {&#xD;
         unit = player.getOurFreeColGameObject(unitId, ServerUnit.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     Tile tile;&#xD;
     try {&#xD;
         tile = unit.getNeighbourTile(directionString);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     MoveType moveType = unit.getMoveType(tile);&#xD;
     if (!moveType.isProgress()) {&#xD;
         return DOMMessage.clientError(&quot;Illegal move for: &quot; + unitId&#xD;
             + &quot; type: &quot; + moveType&#xD;
             + &quot; from: &quot; + unit.getLocation().getId()&#xD;
             + &quot; to: &quot; + tile.getId());&#xD;
     }&#xD;
&#xD;
     // Proceed to move.&#xD;
     return server.getInGameController()&#xD;
         .move(serverPlayer, unit, tile);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVrVBVJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_ZA8WsFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVrVBlJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return createMessage(getXMLElementTagName(),&#xD;
         &quot;unit&quot;, this.unitId,&#xD;
         &quot;direction&quot;, this.directionString);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVr8EFJNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_ZBAoIFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVr8EVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;move&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_ZA8WsFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aVrVBVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aPJ2QVJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_ZBAoIFJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aVr8EFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXJ7sFJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;move&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZBBPMFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aPIBEFJNEeiyW7NaN4qWdw" name="MoveMessage" method="_aVqt8FJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aPIBE1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aPIBFFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXJUplJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>MoveMessage&lt;/code> for the supplied unit and&#xD;
     * direction.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> to move.&#xD;
     * @param direction The &lt;code>Direction&lt;/code> to move in.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aPIBEVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPIBElJNEeiyW7NaN4qWdw" name="direction" type="_aG4EAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPIBFVJNEeiyW7NaN4qWdw" type="_ZA4sUFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aPIoIFJNEeiyW7NaN4qWdw" name="MoveMessage" method="_aVqt9FJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aPIoI1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aPIoJFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXJUp1JNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>MoveMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aPIoIVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPIoIlJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPIoJVJNEeiyW7NaN4qWdw" type="_ZA4sUFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aPJPMFJNEeiyW7NaN4qWdw" name="handle" method="_aVrVAFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXJUqFJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;move&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param player The &lt;code>Player&lt;/code> the message applies to.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     * @return An update containing the moved unit, or an error&#xD;
     *     &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aPJPMVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPJPMlJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPJPM1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPJ2QFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_ZBGHsFJNEeiyW7NaN4qWdw" name="MoveToMessage">
                <ownedComment xmi:id="_aXJ7sVJNEeiyW7NaN4qWdw">
                  <body>The message sent when moving a unit across the high seas.</body>
                </ownedComment>
                <generalization xmi:id="_aKGXIFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aTVysFJNEeiyW7NaN4qWdw" name="unitId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aTWZwVJNEeiyW7NaN4qWdw" name="destinationId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVsjIFJNEeiyW7NaN4qWdw" name="MoveToMessage" specification="_aPKdUFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVsjIVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVsjIlJNEeiyW7NaN4qWdw" name="destination" type="_aJO0cFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVsjI1JNEeiyW7NaN4qWdw" type="_ZBGHsFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = unit.getId();&#xD;
     this.destinationId = destination.getId();&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVtKMFJNEeiyW7NaN4qWdw" name="MoveToMessage" specification="_aPLEY1JNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVtKMVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVtKMlJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVtKM1JNEeiyW7NaN4qWdw" type="_ZBGHsFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = element.getAttribute(&quot;unit&quot;);&#xD;
     this.destinationId = element.getAttribute(&quot;destination&quot;);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVuYUFJNEeiyW7NaN4qWdw" name="handle" specification="_aPMSgFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVuYUVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVuYUlJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVuYU1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVuYVFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
     final Game game = player.getGame();&#xD;
&#xD;
     Unit unit;&#xD;
     try {&#xD;
         unit = player.getOurFreeColGameObject(unitId, Unit.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     Location destination = game.findFreeColLocation(destinationId);&#xD;
     if (destination == null) {&#xD;
         return DOMMessage.clientError(&quot;Not a location: &quot; + destinationId);&#xD;
     }&#xD;
&#xD;
     // Proceed to move.&#xD;
     return server.getInGameController()&#xD;
         .moveTo(serverPlayer, unit, destination);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVuYVVJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_ZBODgFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVuYVlJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return DOMMessage.createMessage(getXMLElementTagName(),&#xD;
         &quot;unit&quot;, unitId,&#xD;
         &quot;destination&quot;, destinationId);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVuYV1JNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_ZBQfwFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVuYWFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;moveTo&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_ZBODgFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aVuYVVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aPM5kFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_ZBQfwFJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aVuYV1JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXJ7tVJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;moveTo&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZBRG0FJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aPKdUFJNEeiyW7NaN4qWdw" name="MoveToMessage" method="_aVsjIFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aPLEYFJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aPLEYVJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXJ7slJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>MoveToMessage&lt;/code> for the supplied unit&#xD;
     * and destination.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> to move.&#xD;
     * @param destination The &lt;code>Location&lt;/code> to move to.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aPKdUVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPKdUlJNEeiyW7NaN4qWdw" name="destination" type="_aJO0cFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPLEYlJNEeiyW7NaN4qWdw" type="_ZBGHsFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aPLEY1JNEeiyW7NaN4qWdw" name="MoveToMessage" method="_aVtKMFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aPLrcVJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aPLrclJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXJ7s1JNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>MoveToMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aPLEZFJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPLrcFJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPLrc1JNEeiyW7NaN4qWdw" type="_ZBGHsFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aPMSgFJNEeiyW7NaN4qWdw" name="handle" method="_aVuYUFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXJ7tFJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;moveTo&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param player The &lt;code>Player&lt;/code> the message applies to.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     * @return An update containing the moved unit, or an error&#xD;
     *     &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aPMSgVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPMSglJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPMSg1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPMShFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Interface" xmi:id="_ZBUxMFJNEeiyW7NaN4qWdw" name="NetworkConstants">
                <ownedComment xmi:id="_aXJ7tlJNEeiyW7NaN4qWdw">
                  <body>Contains the network constants. These constants are used by the&#xD;
controllers and input handlers when they are communicating.</body>
                </ownedComment>
                <ownedAttribute xmi:id="_ZBV_UFJNEeiyW7NaN4qWdw" name="STEAL_LAND" isLeaf="true" isStatic="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  <defaultValue xmi:type="uml:LiteralString" xmi:id="_ZBV_UVJNEeiyW7NaN4qWdw" value="-1"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_ZBWmYFJNEeiyW7NaN4qWdw" name="NO_TRADE_GOODS" isLeaf="true" isStatic="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  <defaultValue xmi:type="uml:LiteralString" xmi:id="_ZBWmYVJNEeiyW7NaN4qWdw" value="0"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aXJ7t1JNEeiyW7NaN4qWdw" name="NO_TRADE">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  <defaultValue xmi:type="uml:LiteralString" xmi:id="_aXKiwlJNEeiyW7NaN4qWdw" value="-1"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aXKiw1JNEeiyW7NaN4qWdw" name="NO_TRADE_HAGGLE">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  <defaultValue xmi:type="uml:LiteralString" xmi:id="_aXLJ0lJNEeiyW7NaN4qWdw" value="-2"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aXLJ01JNEeiyW7NaN4qWdw" name="NO_TRADE_HOSTILE">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  <defaultValue xmi:type="uml:LiteralString" xmi:id="_aXLw4VJNEeiyW7NaN4qWdw" value="-3"/>
                </ownedAttribute>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_ZBYbkFJNEeiyW7NaN4qWdw" name="NetworkReplyObject">
                <ownedComment xmi:id="_aXLw4lJNEeiyW7NaN4qWdw">
                  <body>Class for storing a network response.  If the response has not been&#xD;
set when {@link #getResponse} has been called, this method will&#xD;
block until {@link #setResponse} is called.</body>
                </ownedComment>
                <ownedAttribute xmi:id="_aTXA0FJNEeiyW7NaN4qWdw" name="response" type="_aPNgoFJNEeiyW7NaN4qWdw" association="_abJD0VJNEeiyW7NaN4qWdw">
                  <defaultValue xmi:type="uml:LiteralString" xmi:id="_aTXn4VJNEeiyW7NaN4qWdw" value="null"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aTY2AFJNEeiyW7NaN4qWdw" name="responseGiven" visibility="private">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  <defaultValue xmi:type="uml:LiteralString" xmi:id="_aTY2AVJNEeiyW7NaN4qWdw" value="false"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aTY2A1JNEeiyW7NaN4qWdw" name="networkReplyId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVvmclJNEeiyW7NaN4qWdw" name="NetworkReplyObject" specification="_ZBZpsFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVvmc1JNEeiyW7NaN4qWdw" name="networkReplyId">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aVvmdFJNEeiyW7NaN4qWdw" type="_ZBYbkFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>this.networkReplyId = networkReplyId;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVvmdVJNEeiyW7NaN4qWdw" name="getNetworkReplyId" specification="_ZBaQw1JNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVvmdlJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return networkReplyId;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVwNgFJNEeiyW7NaN4qWdw" name="interrupt" specification="_ZBbe4FJNEeiyW7NaN4qWdw">
                  <language>java</language>
                  <body>responseGiven = true;&#xD;
     notify();&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_ZBZpsFJNEeiyW7NaN4qWdw" name="NetworkReplyObject" method="_aVvmclJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_ZBaQwFJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_ZBaQwVJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXMX8FJNEeiyW7NaN4qWdw">
                    <body>The constructor.&#xD;
     *&#xD;
     * @param networkReplyId The unique identifier for the network message&#xD;
     *                       this object will store.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZBZpsVJNEeiyW7NaN4qWdw" name="networkReplyId">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_ZBaQwlJNEeiyW7NaN4qWdw" type="_ZBYbkFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_ZBaQw1JNEeiyW7NaN4qWdw" name="getNetworkReplyId" method="_aVvmdVJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXMX8VJNEeiyW7NaN4qWdw">
                    <body>Gets the unique identifier for the network message this&#xD;
     * object will store.&#xD;
     *&#xD;
     * @return the unique identifier.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZBa30FJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_ZBbe4FJNEeiyW7NaN4qWdw" name="interrupt" method="_aVwNgFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_ZBbe4VJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_ZBbe4lJNEeiyW7NaN4qWdw" key="synchronized"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXMX8lJNEeiyW7NaN4qWdw">
                    <body>Interrupts any thread waiting for a response.</body>
                  </ownedComment>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Interface" xmi:id="_ZBd7IFJNEeiyW7NaN4qWdw" name="NetworkRequestHandler">
                <ownedComment xmi:id="_aXMX81JNEeiyW7NaN4qWdw">
                  <body>A network request handler knows how to handle in a given request type.</body>
                </ownedComment>
                <ownedOperation xmi:id="_aPOuwFJNEeiyW7NaN4qWdw" name="handle">
                  <ownedParameter xmi:id="_aPOuwVJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPOuwlJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPOuw1JNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_ZBfwUFJNEeiyW7NaN4qWdw" name="NewLandNameMessage">
                <ownedComment xmi:id="_aXMX9FJNEeiyW7NaN4qWdw">
                  <body>The message sent when naming a new land.</body>
                </ownedComment>
                <generalization xmi:id="_aKJacFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aTarMFJNEeiyW7NaN4qWdw" name="unitId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aTbSQFJNEeiyW7NaN4qWdw" name="newLandName" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVw0kVJNEeiyW7NaN4qWdw" name="NewLandNameMessage" specification="_aPPV0FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVw0klJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVw0k1JNEeiyW7NaN4qWdw" name="newLandName">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aVw0lFJNEeiyW7NaN4qWdw" type="_ZBfwUFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = unit.getId();&#xD;
     this.newLandName = newLandName;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVw0lVJNEeiyW7NaN4qWdw" name="NewLandNameMessage" specification="_aPP84lJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVw0llJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVw0l1JNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVw0mFJNEeiyW7NaN4qWdw" type="_ZBfwUFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = element.getAttribute(&quot;unit&quot;);&#xD;
     this.newLandName = element.getAttribute(&quot;newLandName&quot;);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVxboFJNEeiyW7NaN4qWdw" name="getUnit" specification="_aPQj8VJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVxboVJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVxbolJNEeiyW7NaN4qWdw" type="_aG5SIVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return player.getOurFreeColGameObject(unitId, Unit.class);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVxbo1JNEeiyW7NaN4qWdw" name="handle" specification="_aPRLAFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVxbpFJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVxbpVJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVxbplJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVxbp1JNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
&#xD;
     Unit unit;&#xD;
     try {&#xD;
         unit = getUnit(player);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     Tile tile = unit.getTile();&#xD;
     if (tile == null) {&#xD;
         return DOMMessage.clientError(&quot;Unit is not on the map: &quot; + unitId);&#xD;
     } else if (!tile.isLand()) {&#xD;
         return DOMMessage.clientError(&quot;Unit is not in the new world: &quot;&#xD;
             + unitId);&#xD;
     }&#xD;
&#xD;
     if (newLandName == null || newLandName.isEmpty()) {&#xD;
         return DOMMessage.clientError(&quot;Empty new land name&quot;);&#xD;
     }&#xD;
&#xD;
     // Set name.&#xD;
     return server.getInGameController()&#xD;
         .setNewLandName(serverPlayer, unit, newLandName);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVyCsFJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_ZBiMkFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVyCsVJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return createMessage(getXMLElementTagName(),&#xD;
         &quot;unit&quot;, unitId,&#xD;
         &quot;newLandName&quot;, newLandName);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVyCslJNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_ZBjasFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVyCs1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;newLandName&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_ZBiMkFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aVyCsFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aPRyEFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_ZBjasFJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aVyCslJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXM_AVJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;newLandName&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZBjasVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aPPV0FJNEeiyW7NaN4qWdw" name="NewLandNameMessage" method="_aVw0kVJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aPPV01JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aPP84FJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXMX9VJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>NewLandNameMessage&lt;/code> with the&#xD;
     * supplied name.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that has come ashore.&#xD;
     * @param newLandName The new land name.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aPPV0VJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPPV0lJNEeiyW7NaN4qWdw" name="newLandName">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aPP84VJNEeiyW7NaN4qWdw" type="_ZBfwUFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aPP84lJNEeiyW7NaN4qWdw" name="NewLandNameMessage" method="_aVw0lVJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aPP85VJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aPP85lJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXMX9lJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>NewLandNameMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aPP841JNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPP85FJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPQj8FJNEeiyW7NaN4qWdw" type="_ZBfwUFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aPQj8VJNEeiyW7NaN4qWdw" name="getUnit" method="_aVxboFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXMX91JNEeiyW7NaN4qWdw">
                    <body>Public accessor for the unit.&#xD;
     *&#xD;
     * @param player The &lt;code>Player&lt;/code> who owns the unit.&#xD;
     * @return The &lt;code>Unit&lt;/code> of this message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aPQj8lJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPQj81JNEeiyW7NaN4qWdw" type="_aG5SIVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aPRLAFJNEeiyW7NaN4qWdw" name="handle" method="_aVxbo1JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXM_AFJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;newLandName&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param player The &lt;code>Player&lt;/code> the message applies to.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     * @return An update setting the new land name, or an error&#xD;
     *     &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aPRLAVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPRLAlJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPRLA1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPRLBFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_ZBoTMFJNEeiyW7NaN4qWdw" name="NewRegionNameMessage">
                <ownedComment xmi:id="_aXM_AlJNEeiyW7NaN4qWdw">
                  <body>The message sent when naming a new region.</body>
                </ownedComment>
                <generalization xmi:id="_aKNE0FJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aTcgYFJNEeiyW7NaN4qWdw" name="regionId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aTdHcFJNEeiyW7NaN4qWdw" name="tileId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aTdHclJNEeiyW7NaN4qWdw" name="unitId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aTdugVJNEeiyW7NaN4qWdw" name="newRegionName" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVypwFJNEeiyW7NaN4qWdw" name="NewRegionNameMessage" specification="_aPSZIFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVypwVJNEeiyW7NaN4qWdw" name="region" type="_aKLPoFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVypwlJNEeiyW7NaN4qWdw" name="tile" type="_aG4rEVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVypw1JNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVypxFJNEeiyW7NaN4qWdw" name="newRegionName">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aVypxVJNEeiyW7NaN4qWdw" type="_ZBoTMFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.regionId = region.getId();&#xD;
     this.tileId = tile.getId();&#xD;
     this.unitId = unit.getId();&#xD;
     this.newRegionName = newRegionName;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVzQ0FJNEeiyW7NaN4qWdw" name="NewRegionNameMessage" specification="_aPTAM1JNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVzQ0VJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVzQ0lJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVzQ01JNEeiyW7NaN4qWdw" type="_ZBoTMFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.regionId = element.getAttribute(&quot;region&quot;);&#xD;
     this.tileId = element.getAttribute(&quot;tile&quot;);&#xD;
     this.unitId = element.getAttribute(&quot;unit&quot;);&#xD;
     this.newRegionName = element.getAttribute(&quot;newRegionName&quot;);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVzQ1FJNEeiyW7NaN4qWdw" name="getRegion" specification="_aPTnRFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVzQ1VJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVzQ1lJNEeiyW7NaN4qWdw" type="_aKLPoFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return game.getFreeColGameObject(regionId, Region.class);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVzQ11JNEeiyW7NaN4qWdw" name="getTile" specification="_aPUOUVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVzQ2FJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVzQ2VJNEeiyW7NaN4qWdw" type="_aG4rEVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return game.getFreeColGameObject(tileId, Tile.class);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVz34FJNEeiyW7NaN4qWdw" name="getUnit" specification="_aPU1YFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVz34VJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aVz34lJNEeiyW7NaN4qWdw" type="_aG5SIVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return player.getOurFreeColGameObject(unitId, Unit.class);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aVz341JNEeiyW7NaN4qWdw" name="getNewRegionName" specification="_ZBrWgFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aVz35FJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return newRegionName;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aV0e8FJNEeiyW7NaN4qWdw" name="handle" specification="_aPVccFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aV0e8VJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aV0e8lJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aV0e81JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aV0e9FJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
     final Game game = server.getGame();&#xD;
&#xD;
     Tile tile = getTile(game);&#xD;
     if (!serverPlayer.hasExplored(tile)) {&#xD;
         return DOMMessage.clientError(&quot;Can not claim discovery in unexplored tile: &quot; + tileId);&#xD;
     }&#xD;
&#xD;
     Unit unit;&#xD;
     try {&#xD;
         unit = getUnit(player);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     Region region = tile.getDiscoverableRegion();&#xD;
     if (region == null) {&#xD;
         return DOMMessage.clientError(&quot;No discoverable region in: &quot;&#xD;
             + tileId);&#xD;
     }&#xD;
     if (!region.getId().equals(regionId)) {&#xD;
         return DOMMessage.clientError(&quot;Region mismatch, &quot; + region.getId()&#xD;
             + &quot; != &quot; + regionId);&#xD;
     }&#xD;
     &#xD;
     // Do the discovery&#xD;
     return server.getInGameController()&#xD;
         .setNewRegionName(serverPlayer, unit, region, newRegionName);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aV1GAFJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_ZBskoFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aV1GAVJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return createMessage(getXMLElementTagName(),&#xD;
         &quot;region&quot;, regionId,&#xD;
         &quot;tile&quot;, tileId,&#xD;
         &quot;unit&quot;, unitId,&#xD;
         &quot;newRegionName&quot;, newRegionName);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aV1GAlJNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_ZBtywVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aV1GA1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;newRegionName&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_ZBrWgFJNEeiyW7NaN4qWdw" name="getNewRegionName" method="_aVz341JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXM_CFJNEeiyW7NaN4qWdw">
                    <body>Public accessor for the new region name.&#xD;
     *&#xD;
     * @return The new region name of this message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZBr9kFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_ZBskoFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aV1GAFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aPWDgFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_ZBtywVJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aV1GAlJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXNmEFJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;newRegionName&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZBuZ0FJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aPSZIFJNEeiyW7NaN4qWdw" name="NewRegionNameMessage" method="_aVypwFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aPTAMFJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aPTAMVJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXM_A1JNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>NewRegionNameMessage&lt;/code> with the&#xD;
     * supplied name.&#xD;
     *&#xD;
     * @param region The &lt;code>Region&lt;/code> being discovered.&#xD;
     * @param tile The &lt;code>Tile&lt;/code> where the region is discovered.&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that discovers the region.&#xD;
     * @param newRegionName The default new region name.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aPSZIVJNEeiyW7NaN4qWdw" name="region" type="_aKLPoFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPSZIlJNEeiyW7NaN4qWdw" name="tile" type="_aG4rEVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPSZI1JNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPSZJFJNEeiyW7NaN4qWdw" name="newRegionName">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aPTAMlJNEeiyW7NaN4qWdw" type="_ZBoTMFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aPTAM1JNEeiyW7NaN4qWdw" name="NewRegionNameMessage" method="_aVzQ0FJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aPTnQVJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aPTnQlJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXM_BFJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>NewRegionNameMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aPTANFJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPTnQFJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPTnQ1JNEeiyW7NaN4qWdw" type="_ZBoTMFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aPTnRFJNEeiyW7NaN4qWdw" name="getRegion" method="_aVzQ1FJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXM_BVJNEeiyW7NaN4qWdw">
                    <body>Public accessor for the region.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> to look for a region in.&#xD;
     * @return The region of this message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aPTnRVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPUOUFJNEeiyW7NaN4qWdw" type="_aKLPoFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aPUOUVJNEeiyW7NaN4qWdw" name="getTile" method="_aVzQ11JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXM_BlJNEeiyW7NaN4qWdw">
                    <body>Public accessor for the tile.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> to look for a tile in.&#xD;
     * @return The tile of this message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aPUOUlJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPUOU1JNEeiyW7NaN4qWdw" type="_aG4rEVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aPU1YFJNEeiyW7NaN4qWdw" name="getUnit" method="_aVz34FJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXM_B1JNEeiyW7NaN4qWdw">
                    <body>Public accessor for the unit.&#xD;
     *&#xD;
     * @param player The &lt;code>Player&lt;/code> who owns the unit.&#xD;
     * @return The &lt;code>Unit&lt;/code> of this message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aPU1YVJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPU1YlJNEeiyW7NaN4qWdw" type="_aG5SIVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aPVccFJNEeiyW7NaN4qWdw" name="handle" method="_aV0e8FJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXM_CVJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;newRegionName&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param player The &lt;code>Player&lt;/code> the message applies to.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     *&#xD;
     * @return Null.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aPVccVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPVcclJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPVcc1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPVcdFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_ZBz5YFJNEeiyW7NaN4qWdw" name="PayArrearsMessage">
                <ownedComment xmi:id="_aXNmEVJNEeiyW7NaN4qWdw">
                  <body>The message sent when paying tax arrears.</body>
                </ownedComment>
                <generalization xmi:id="_aKPhEFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aTe8oFJNEeiyW7NaN4qWdw" name="goodsTypeId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aV1tEFJNEeiyW7NaN4qWdw" name="PayArrearsMessage" specification="_aPWqkFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aV1tEVJNEeiyW7NaN4qWdw" name="type" type="_aHcEsFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aV1tElJNEeiyW7NaN4qWdw" type="_ZBz5YFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.goodsTypeId = type.getId();&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aV2UIFJNEeiyW7NaN4qWdw" name="PayArrearsMessage" specification="_aPXRoFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aV2UIVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aV2UIlJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aV2UI1JNEeiyW7NaN4qWdw" type="_ZBz5YFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.goodsTypeId = element.getAttribute(&quot;goodsType&quot;);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aV2UJFJNEeiyW7NaN4qWdw" name="handle" specification="_aPX4sFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aV2UJVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aV2UJlJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aV2UJ1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aV2UKFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
     GoodsType goodsType = server.getSpecification()&#xD;
         .getGoodsType(goodsTypeId);&#xD;
&#xD;
     // Proceed to pay.&#xD;
     return server.getInGameController()&#xD;
         .payArrears(serverPlayer, goodsType);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aV27MFJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_ZB1ukFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aV27MVJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return createMessage(getXMLElementTagName(),&#xD;
         &quot;goodsType&quot;, goodsTypeId);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aV27MlJNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_ZB28slJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aV27M1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;payArrears&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_ZB1ukFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aV27MFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aPYfwFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_ZB28slJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aV27MlJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXNmFVJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;payArrears&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZB3jwFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aPWqkFJNEeiyW7NaN4qWdw" name="PayArrearsMessage" method="_aV1tEFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aPWqklJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aPWqk1JNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXNmElJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>PayArrearsMessage&lt;/code> with the&#xD;
     * supplied goods type.&#xD;
     *&#xD;
     * @param type The &lt;code>GoodsType&lt;/code> to pay arrears for.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aPWqkVJNEeiyW7NaN4qWdw" name="type" type="_aHcEsFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPWqlFJNEeiyW7NaN4qWdw" type="_ZBz5YFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aPXRoFJNEeiyW7NaN4qWdw" name="PayArrearsMessage" method="_aV2UIFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aPXRo1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aPXRpFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXNmE1JNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>PayArrearsMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aPXRoVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPXRolJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPXRpVJNEeiyW7NaN4qWdw" type="_ZBz5YFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aPX4sFJNEeiyW7NaN4qWdw" name="handle" method="_aV2UJFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXNmFFJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;payArrears&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param player The &lt;code>Player&lt;/code> the message applies to.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     *&#xD;
     * @return An update containing the payArrearsd unit,&#xD;
     *         or an error &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aPX4sVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPX4slJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPX4s1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPX4tFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_ZB6nEFJNEeiyW7NaN4qWdw" name="PayForBuildingMessage">
                <ownedComment xmi:id="_aXNmFlJNEeiyW7NaN4qWdw">
                  <body>The message sent when paying for a building.</body>
                </ownedComment>
                <generalization xmi:id="_aKRWQFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aTfjsFJNEeiyW7NaN4qWdw" name="colonyId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aV3iQFJNEeiyW7NaN4qWdw" name="PayForBuildingMessage" specification="_aPYfwVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aV3iQVJNEeiyW7NaN4qWdw" name="colony" type="_aGwvQFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aV3iQlJNEeiyW7NaN4qWdw" type="_ZB6nEFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.colonyId = colony.getId();&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aV3iQ1JNEeiyW7NaN4qWdw" name="PayForBuildingMessage" specification="_aPZG0lJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aV3iRFJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aV3iRVJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aV3iRlJNEeiyW7NaN4qWdw" type="_ZB6nEFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.colonyId = element.getAttribute(&quot;colony&quot;);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aV4JUFJNEeiyW7NaN4qWdw" name="handle" specification="_aPZt5VJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aV4JUVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aV4JUlJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aV4JU1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aV4JVFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
&#xD;
     Colony colony;&#xD;
     try {&#xD;
         colony = player.getOurFreeColGameObject(colonyId, Colony.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     // Proceed to pay.&#xD;
     return server.getInGameController()&#xD;
         .payForBuilding(serverPlayer, colony);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aV4wYFJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_ZB8cQFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aV4wYVJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return createMessage(getXMLElementTagName(),&#xD;
         &quot;colony&quot;, colonyId);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aV4wYlJNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_ZB9qYFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aV4wY1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;payForBuilding&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_ZB8cQFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aV4wYFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aPaU9FJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_ZB9qYFJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aV4wYlJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXONIVJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;payForBuilding&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZB9qYVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aPYfwVJNEeiyW7NaN4qWdw" name="PayForBuildingMessage" method="_aV3iQFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aPYfw1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aPZG0FJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXNmF1JNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>PayForBuildingMessage&lt;/code> with the&#xD;
     * supplied colony.&#xD;
     *&#xD;
     * @param colony The &lt;code>Colony&lt;/code> that is building.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aPYfwlJNEeiyW7NaN4qWdw" name="colony" type="_aGwvQFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPZG0VJNEeiyW7NaN4qWdw" type="_ZB6nEFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aPZG0lJNEeiyW7NaN4qWdw" name="PayForBuildingMessage" method="_aV3iQ1JNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aPZt4lJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aPZt41JNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXNmGFJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>PayForBuildingMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aPZt4FJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPZt4VJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPZt5FJNEeiyW7NaN4qWdw" type="_ZB6nEFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aPZt5VJNEeiyW7NaN4qWdw" name="handle" method="_aV4JUFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXONIFJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;payForBuilding&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param player The &lt;code>Player&lt;/code> the message applies to.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     *&#xD;
     * @return An update containing the payForBuildingd unit,&#xD;
     *         or an error &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aPaU8FJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPaU8VJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPaU8lJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPaU81JNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_ZCAtsFJNEeiyW7NaN4qWdw" name="PutOutsideColonyMessage">
                <ownedComment xmi:id="_aXONIlJNEeiyW7NaN4qWdw">
                  <body>The message sent when putting a unit outside a colony.</body>
                </ownedComment>
                <generalization xmi:id="_aKTLcFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aTgKwFJNEeiyW7NaN4qWdw" name="unitId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aV5XcFJNEeiyW7NaN4qWdw" name="PutOutsideColonyMessage" specification="_aPa8AFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aV5XcVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aV5XclJNEeiyW7NaN4qWdw" type="_ZCAtsFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     unitId = unit.getId();&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aV5Xc1JNEeiyW7NaN4qWdw" name="PutOutsideColonyMessage" specification="_aPbjEFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aV5XdFJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aV5XdVJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aV5XdlJNEeiyW7NaN4qWdw" type="_ZCAtsFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     unitId = element.getAttribute(&quot;unit&quot;);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aV5-gFJNEeiyW7NaN4qWdw" name="handle" specification="_aPcKIFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aV5-gVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aV5-glJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aV5-g1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aV5-hFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
&#xD;
     Unit unit;&#xD;
     try {&#xD;
         unit = player.getOurFreeColGameObject(unitId, Unit.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
     if (!unit.hasTile()) {&#xD;
         return DOMMessage.clientError(&quot;Unit is not on the map: &quot; + unitId);&#xD;
     } else if (unit.getColony() == null) {&#xD;
         return DOMMessage.clientError(&quot;Unit is not in a colony: &quot;&#xD;
             + unitId);&#xD;
     }&#xD;
&#xD;
     // Proceed to put outside.&#xD;
     return server.getInGameController()&#xD;
         .putOutsideColony(serverPlayer, unit);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aV5-hVJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_ZCE_IFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aV5-hlJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return createMessage(getXMLElementTagName(),&#xD;
         &quot;unit&quot;, unitId);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aV6lkFJNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_ZCHbYFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aV6lkVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;putOutsideColony&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_ZCE_IFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aV5-hVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aPcxMFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_ZCHbYFJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aV6lkFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXONJlJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;putOutsideColony&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZCHbYVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aPa8AFJNEeiyW7NaN4qWdw" name="PutOutsideColonyMessage" method="_aV5XcFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aPa8AlJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aPa8A1JNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXONI1JNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>PutOutsideColonyMessage&lt;/code> with the&#xD;
     * supplied unit.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> to put outside.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aPa8AVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPa8BFJNEeiyW7NaN4qWdw" type="_ZCAtsFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aPbjEFJNEeiyW7NaN4qWdw" name="PutOutsideColonyMessage" method="_aV5Xc1JNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aPbjE1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aPbjFFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXONJFJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>PutOutsideColonyMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aPbjEVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPbjElJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPbjFVJNEeiyW7NaN4qWdw" type="_ZCAtsFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aPcKIFJNEeiyW7NaN4qWdw" name="handle" method="_aV5-gFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXONJVJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;putOutsideColony&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param player The &lt;code>Player&lt;/code> the message applies to.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     * @return An update encapsulating the change, or an error&#xD;
     *     &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aPcKIVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPcKIlJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPcKI1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPcKJFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_ZCLs0FJNEeiyW7NaN4qWdw" name="RearrangeColonyMessage">
                <ownedComment xmi:id="_aXONJ1JNEeiyW7NaN4qWdw">
                  <body>The message sent when the client requests rearrangeing of a colony.</body>
                </ownedComment>
                <generalization xmi:id="_aKXc4FJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aTj1IFJNEeiyW7NaN4qWdw" name="roleComparator" isLeaf="true" isStatic="true" type="_aKTygFJNEeiyW7NaN4qWdw" isReadOnly="true" association="_abqBMVJNEeiyW7NaN4qWdw">
                  <defaultValue xmi:type="uml:LiteralString" xmi:id="_aTrJ4VJNEeiyW7NaN4qWdw" value="new Comparator&lt;UnitChange>() {&#xD;&#xA;            @Override&#xD;&#xA;            public int compare(UnitChange uc1, UnitChange uc2) {&#xD;&#xA;                int cmp = uc1.role.compareTo(uc2.role);&#xD;&#xA;                if (cmp == 0) cmp = uc1.roleCount - uc2.roleCount;&#xD;&#xA;                return cmp;&#xD;&#xA;            }&#xD;&#xA;        }"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aTrJ4lJNEeiyW7NaN4qWdw" name="colonyId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aTrw8VJNEeiyW7NaN4qWdw" name="unitChanges" visibility="private" type="_ZCNiAFJNEeiyW7NaN4qWdw" isOrdered="true" association="_ab1AUFJNEeiyW7NaN4qWdw">
                  <upperValue xmi:type="uml:LiteralUnlimitedNatural" xmi:id="_aTrw8lJNEeiyW7NaN4qWdw" value="*"/>
                  <defaultValue xmi:type="uml:LiteralString" xmi:id="_aTsYAFJNEeiyW7NaN4qWdw" value="null"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aV-P8FJNEeiyW7NaN4qWdw" name="RearrangeColonyMessage" specification="_aPi30FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aV-P8VJNEeiyW7NaN4qWdw" name="colony" type="_aGwvQFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aV-P8lJNEeiyW7NaN4qWdw" type="_ZCLs0FJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.colonyId = colony.getId();&#xD;
     this.unitChanges = new ArrayList&lt;>();&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aV-P81JNEeiyW7NaN4qWdw" name="RearrangeColonyMessage" specification="_aPje4FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aV-P9FJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aV-P9VJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aV-P9lJNEeiyW7NaN4qWdw" type="_ZCLs0FJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.colonyId = element.getAttribute(&quot;colony&quot;);&#xD;
     int n;&#xD;
     try {&#xD;
         n = Integer.parseInt(element.getAttribute(FreeColObject.ARRAY_SIZE_TAG));&#xD;
     } catch (NumberFormatException nfe) {&#xD;
         n = 0;&#xD;
     }&#xD;
     this.unitChanges = new ArrayList&lt;>();&#xD;
     for (int i = 0; i &lt; n; i++) {&#xD;
         unitChanges.add(new UnitChange().readFromElement(game, element, i));&#xD;
     }&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aV-P91JNEeiyW7NaN4qWdw" name="isEmpty" specification="_ZCZvQFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aV-P-FJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return unitChanges == null || unitChanges.isEmpty();&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aV-3AFJNEeiyW7NaN4qWdw" name="addChange" specification="_aPkF8FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aV-3AVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aV-3AlJNEeiyW7NaN4qWdw" name="loc" type="_aJO0cFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aV-3A1JNEeiyW7NaN4qWdw" name="work" type="_aHcEsFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aV-3BFJNEeiyW7NaN4qWdw" name="role" type="_aJU7EFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aV-3BVJNEeiyW7NaN4qWdw" name="roleCount">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>unitChanges.add(new UnitChange(unit, loc, work, role, roleCount));&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aV_eEFJNEeiyW7NaN4qWdw" name="handle" specification="_aPktAFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aV_eEVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aV_eElJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aV_eE1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aV_eFFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
&#xD;
     Colony colony;&#xD;
     try {&#xD;
         colony = player.getOurFreeColGameObject(colonyId, Colony.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     if (unitChanges.isEmpty()) {&#xD;
         return DOMMessage.clientError(&quot;Empty rearrangement list.&quot;);&#xD;
     }&#xD;
     int i = 0;&#xD;
     for (UnitChange uc : unitChanges) {&#xD;
         if (uc.unit == null) {&#xD;
             return DOMMessage.clientError(&quot;Invalid unit &quot; + i);&#xD;
         }&#xD;
         if (uc.loc == null) {&#xD;
             return DOMMessage.clientError(&quot;Invalid location &quot; + i);&#xD;
         }&#xD;
         if (uc.role == null) {&#xD;
             return DOMMessage.clientError(&quot;Invalid role &quot; + i);&#xD;
         }&#xD;
         if (uc.roleCount &lt; 0) {&#xD;
             return DOMMessage.clientError(&quot;Invalid role count &quot; + i);&#xD;
         }&#xD;
     }&#xD;
&#xD;
     // Rearrange can proceed.&#xD;
     return server.getInGameController()&#xD;
         .rearrangeColony(serverPlayer, colony, unitChanges);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aV_eFVJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_ZCa9YFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aV_eFlJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>Element result = createMessage(getXMLElementTagName(),&#xD;
         &quot;colony&quot;, colonyId,&#xD;
         FreeColObject.ARRAY_SIZE_TAG, Integer.toString(unitChanges.size()));&#xD;
     int i = 0;&#xD;
     for (UnitChange uc : unitChanges) {&#xD;
         uc.writeToElement(result, i);&#xD;
         i++;&#xD;
     }&#xD;
     return result;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aV_eF1JNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_ZCcLgFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aV_eGFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;rearrangeColony&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_ZCZvQFJNEeiyW7NaN4qWdw" name="isEmpty" method="_aV-P91JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXO0MlJNEeiyW7NaN4qWdw">
                    <body>Are there no changes present?&#xD;
     *&#xD;
     * @return True if no changes have been added.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZCZvQVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_ZCa9YFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aV_eFVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aPl7IFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_ZCcLgFJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aV_eF1JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXO0NVJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;rearrangeColony&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZCcLgVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aPi30FJNEeiyW7NaN4qWdw" name="RearrangeColonyMessage" method="_aV-P8FJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aPi30lJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aPi301JNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXO0MFJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>RearrangeColonyMessage&lt;/code> with the&#xD;
     * supplied colony.  Add changes with addChange().&#xD;
     *&#xD;
     * @param colony The &lt;code>Colony&lt;/code> that is rearranging.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aPi30VJNEeiyW7NaN4qWdw" name="colony" type="_aGwvQFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPi31FJNEeiyW7NaN4qWdw" type="_ZCLs0FJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aPje4FJNEeiyW7NaN4qWdw" name="RearrangeColonyMessage" method="_aV-P81JNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aPje41JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aPje5FJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXO0MVJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>RearrangeColonyMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aPje4VJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPje4lJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPje5VJNEeiyW7NaN4qWdw" type="_ZCLs0FJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aPkF8FJNEeiyW7NaN4qWdw" name="addChange" method="_aV-3AFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXO0M1JNEeiyW7NaN4qWdw">
                    <body>Add a change to this message.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is to change.&#xD;
     * @param loc The destination &lt;code>Location&lt;/code> for the unit.&#xD;
     * @param work The &lt;code>GoodsType&lt;/code> to produce (may be null).&#xD;
     * @param role The unit &lt;code>Role&lt;/code>.&#xD;
     * @param roleCount The role count.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aPkF8VJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPkF8lJNEeiyW7NaN4qWdw" name="loc" type="_aJO0cFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPkF81JNEeiyW7NaN4qWdw" name="work" type="_aHcEsFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPkF9FJNEeiyW7NaN4qWdw" name="role" type="_aJU7EFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPkF9VJNEeiyW7NaN4qWdw" name="roleCount">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aPktAFJNEeiyW7NaN4qWdw" name="handle" method="_aV_eEFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXO0NFJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;rearrangeColony&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the request.&#xD;
     * @param player The &lt;code>Player&lt;/code> rearrangeing the colony.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> the message is from.&#xD;
     * @return An update &lt;code>Element&lt;/code> with the rearranged colony,&#xD;
     *     or an error &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aPlUEFJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPlUEVJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPlUElJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPlUE1JNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <nestedClassifier xmi:type="uml:Class" xmi:id="_ZCNiAFJNEeiyW7NaN4qWdw" name="UnitChange">
                  <eAnnotations xmi:id="_ZCNiAVJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_ZCNiAlJNEeiyW7NaN4qWdw" key="static"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXONKFJNEeiyW7NaN4qWdw">
                    <body>Container for the unit change information.</body>
                  </ownedComment>
                  <ownedAttribute xmi:id="_aTgx0VJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw" association="_abPxgVJNEeiyW7NaN4qWdw"/>
                  <ownedAttribute xmi:id="_aThY4VJNEeiyW7NaN4qWdw" name="loc" type="_aJO0cFJNEeiyW7NaN4qWdw" association="_abV4IFJNEeiyW7NaN4qWdw"/>
                  <ownedAttribute xmi:id="_aTh_8VJNEeiyW7NaN4qWdw" name="work" type="_aHcEsFJNEeiyW7NaN4qWdw" association="_abawoVJNEeiyW7NaN4qWdw"/>
                  <ownedAttribute xmi:id="_aTinAFJNEeiyW7NaN4qWdw" name="role" type="_aJU7EFJNEeiyW7NaN4qWdw" association="_abiFYFJNEeiyW7NaN4qWdw"/>
                  <ownedAttribute xmi:id="_aTinAlJNEeiyW7NaN4qWdw" name="roleCount">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedAttribute>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aV7MoFJNEeiyW7NaN4qWdw" name="UnitChange" specification="_aPemYFJNEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_aV7MoVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_aV7MolJNEeiyW7NaN4qWdw" name="loc" type="_aJO0cFJNEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_aV7Mo1JNEeiyW7NaN4qWdw" name="work" type="_aHcEsFJNEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_aV7MpFJNEeiyW7NaN4qWdw" name="role" type="_aJU7EFJNEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_aV7MpVJNEeiyW7NaN4qWdw" name="roleCount">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_aV7MplJNEeiyW7NaN4qWdw" type="_ZCNiAFJNEeiyW7NaN4qWdw" direction="return"/>
                    <language>java</language>
                    <body>this.unit = unit;&#xD;
         this.loc = loc;&#xD;
         this.work = work;&#xD;
         this.role = role;&#xD;
         this.roleCount = roleCount;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aV7Mp1JNEeiyW7NaN4qWdw" name="UnitChange" specification="_aPfNclJNEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_aV7MqFJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_aV7MqVJNEeiyW7NaN4qWdw" name="unitId">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_aV7MqlJNEeiyW7NaN4qWdw" name="locId">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_aV7Mq1JNEeiyW7NaN4qWdw" name="workId">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_aV7MrFJNEeiyW7NaN4qWdw" name="roleId">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_aV7MrVJNEeiyW7NaN4qWdw" name="roleCount">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_aV7MrlJNEeiyW7NaN4qWdw" type="_ZCNiAFJNEeiyW7NaN4qWdw" direction="return"/>
                    <language>java</language>
                    <body>init(game, unitId, locId, workId, roleId, roleCount);&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aV7zsFJNEeiyW7NaN4qWdw" name="init" specification="_aPgbkFJNEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_aV7zsVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_aV7zslJNEeiyW7NaN4qWdw" name="unitId">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_aV7zs1JNEeiyW7NaN4qWdw" name="locId">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_aV7ztFJNEeiyW7NaN4qWdw" name="workId">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_aV7ztVJNEeiyW7NaN4qWdw" name="roleId">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_aV7ztlJNEeiyW7NaN4qWdw" name="roleCount">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>this.unit = game.getFreeColGameObject(unitId, Unit.class);&#xD;
         this.loc = game.findFreeColLocation(locId);&#xD;
         this.work = (workId == null || workId.isEmpty()) ? null&#xD;
             : game.getSpecification().getGoodsType(workId);&#xD;
         this.role = game.getSpecification().getRole(roleId);&#xD;
         try {&#xD;
             this.roleCount = Integer.parseInt(roleCount);&#xD;
         } catch (NumberFormatException nfe) {&#xD;
             this.roleCount = 0;&#xD;
         }&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aV8awFJNEeiyW7NaN4qWdw" name="writeToElement" specification="_aPhCoFJNEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_aV8awVJNEeiyW7NaN4qWdw" name="e" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_aV8awlJNEeiyW7NaN4qWdw" name="i">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>e.setAttribute(unitKey(i), this.unit.getId());&#xD;
         e.setAttribute(locKey(i), this.loc.getId());&#xD;
         if (this.work != null) {&#xD;
             e.setAttribute(workKey(i), this.work.getId());&#xD;
         }&#xD;
         e.setAttribute(roleKey(i), this.role.toString());&#xD;
         e.setAttribute(roleCountKey(i), String.valueOf(this.roleCount));&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aV8aw1JNEeiyW7NaN4qWdw" name="readFromElement" specification="_aPhpsFJNEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_aV8axFJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_aV8axVJNEeiyW7NaN4qWdw" name="e" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_aV8axlJNEeiyW7NaN4qWdw" name="i">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_aV8ax1JNEeiyW7NaN4qWdw" type="_ZCNiAFJNEeiyW7NaN4qWdw" direction="return"/>
                    <language>java</language>
                    <body>init(game,&#xD;
             e.getAttribute(unitKey(i)),&#xD;
             e.getAttribute(locKey(i)),&#xD;
             e.getAttribute(workKey(i)),&#xD;
             e.getAttribute(roleKey(i)),&#xD;
             e.getAttribute(roleCountKey(i)));&#xD;
         return this;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aV9B0FJNEeiyW7NaN4qWdw" name="unitKey" specification="_ZCRzcFJNEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_aV9B0VJNEeiyW7NaN4qWdw" name="i">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_aV9B0lJNEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>return &quot;x&quot; + i + &quot;unit&quot;;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aV9B01JNEeiyW7NaN4qWdw" name="locKey" specification="_ZCTBkFJNEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_aV9B1FJNEeiyW7NaN4qWdw" name="i">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_aV9B1VJNEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>return &quot;x&quot; + i + &quot;loc&quot;;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aV9o4FJNEeiyW7NaN4qWdw" name="workKey" specification="_ZCTooFJNEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_aV9o4VJNEeiyW7NaN4qWdw" name="i">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_aV9o4lJNEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>return &quot;x&quot; + i + &quot;work&quot;;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aV9o41JNEeiyW7NaN4qWdw" name="roleKey" specification="_ZCUPsFJNEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_aV9o5FJNEeiyW7NaN4qWdw" name="i">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_aV9o5VJNEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>return &quot;x&quot; + i + &quot;role&quot;;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aV9o5lJNEeiyW7NaN4qWdw" name="roleCountKey" specification="_ZCU2wFJNEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_aV9o51JNEeiyW7NaN4qWdw" name="i">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_aV9o6FJNEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>return &quot;x&quot; + i + &quot;count&quot;;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aV9o6VJNEeiyW7NaN4qWdw" name="toString" specification="_ZCU2w1JNEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_aV9o6lJNEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>return &quot;[UnitChange &quot; + unit.getId() + &quot; at &quot; + loc.getId()&#xD;
             + &quot; &quot; + role.getRoleSuffix() + &quot;.&quot; + roleCount&#xD;
             + ((work == null) ? &quot;&quot; : &quot; work &quot; + work.getId()) + &quot;]&quot;;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedOperation xmi:id="_ZCOJEFJNEeiyW7NaN4qWdw" name="UnitChange">
                    <eAnnotations xmi:id="_ZCOwIFJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                      <details xmi:id="_ZCOwIVJNEeiyW7NaN4qWdw" key="create"/>
                    </eAnnotations>
                    <ownedParameter xmi:id="_ZCOwI1JNEeiyW7NaN4qWdw" type="_ZCNiAFJNEeiyW7NaN4qWdw" direction="return"/>
                  </ownedOperation>
                  <ownedOperation xmi:id="_ZCRzcFJNEeiyW7NaN4qWdw" name="unitKey" method="_aV9B0FJNEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_ZCSagFJNEeiyW7NaN4qWdw" name="i">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_ZCSagVJNEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_ZCTBkFJNEeiyW7NaN4qWdw" name="locKey" method="_aV9B01JNEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_ZCTBkVJNEeiyW7NaN4qWdw" name="i">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_ZCTBklJNEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_ZCTooFJNEeiyW7NaN4qWdw" name="workKey" method="_aV9o4FJNEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_ZCTooVJNEeiyW7NaN4qWdw" name="i">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_ZCToolJNEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_ZCUPsFJNEeiyW7NaN4qWdw" name="roleKey" method="_aV9o41JNEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_ZCUPsVJNEeiyW7NaN4qWdw" name="i">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_ZCUPslJNEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_ZCU2wFJNEeiyW7NaN4qWdw" name="roleCountKey" method="_aV9o5lJNEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_ZCU2wVJNEeiyW7NaN4qWdw" name="i">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_ZCU2wlJNEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_ZCU2w1JNEeiyW7NaN4qWdw" name="toString" method="_aV9o6VJNEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_ZCVd0FJNEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_aPemYFJNEeiyW7NaN4qWdw" name="UnitChange" method="_aV7MoFJNEeiyW7NaN4qWdw">
                    <eAnnotations xmi:id="_aPemZlJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                      <details xmi:id="_aPfNcFJNEeiyW7NaN4qWdw" key="create"/>
                    </eAnnotations>
                    <ownedParameter xmi:id="_aPemYVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_aPemYlJNEeiyW7NaN4qWdw" name="loc" type="_aJO0cFJNEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_aPemY1JNEeiyW7NaN4qWdw" name="work" type="_aHcEsFJNEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_aPemZFJNEeiyW7NaN4qWdw" name="role" type="_aJU7EFJNEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_aPemZVJNEeiyW7NaN4qWdw" name="roleCount">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_aPfNcVJNEeiyW7NaN4qWdw" type="_ZCNiAFJNEeiyW7NaN4qWdw" direction="return"/>
                  </ownedOperation>
                  <ownedOperation xmi:id="_aPfNclJNEeiyW7NaN4qWdw" name="UnitChange" method="_aV7Mp1JNEeiyW7NaN4qWdw">
                    <eAnnotations xmi:id="_aPf0hlJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                      <details xmi:id="_aPf0h1JNEeiyW7NaN4qWdw" key="create"/>
                    </eAnnotations>
                    <ownedParameter xmi:id="_aPf0gFJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_aPf0gVJNEeiyW7NaN4qWdw" name="unitId">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_aPf0glJNEeiyW7NaN4qWdw" name="locId">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_aPf0g1JNEeiyW7NaN4qWdw" name="workId">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_aPf0hFJNEeiyW7NaN4qWdw" name="roleId">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_aPf0hVJNEeiyW7NaN4qWdw" name="roleCount">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_aPf0iFJNEeiyW7NaN4qWdw" type="_ZCNiAFJNEeiyW7NaN4qWdw" direction="return"/>
                  </ownedOperation>
                  <ownedOperation xmi:id="_aPgbkFJNEeiyW7NaN4qWdw" name="init" isLeaf="true" method="_aV7zsFJNEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_aPgbkVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_aPgbklJNEeiyW7NaN4qWdw" name="unitId">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_aPgbk1JNEeiyW7NaN4qWdw" name="locId">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_aPgblFJNEeiyW7NaN4qWdw" name="workId">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_aPgblVJNEeiyW7NaN4qWdw" name="roleId">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_aPgbllJNEeiyW7NaN4qWdw" name="roleCount">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_aPhCoFJNEeiyW7NaN4qWdw" name="writeToElement" method="_aV8awFJNEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_aPhCoVJNEeiyW7NaN4qWdw" name="e" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_aPhColJNEeiyW7NaN4qWdw" name="i">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_aPhpsFJNEeiyW7NaN4qWdw" name="readFromElement" method="_aV8aw1JNEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_aPhpsVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_aPhpslJNEeiyW7NaN4qWdw" name="e" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_aPhps1JNEeiyW7NaN4qWdw" name="i">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_aPhptFJNEeiyW7NaN4qWdw" type="_ZCNiAFJNEeiyW7NaN4qWdw" direction="return"/>
                  </ownedOperation>
                </nestedClassifier>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_ZClVcFJNEeiyW7NaN4qWdw" name="ReceivingThread" visibility="package" isLeaf="true">
                <ownedComment xmi:id="_aXO0NlJNEeiyW7NaN4qWdw">
                  <body>The thread that checks for incoming messages.</body>
                </ownedComment>
                <generalization xmi:id="_aPso0FJNEeiyW7NaN4qWdw" general="_aPnJQFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aTtmIFJNEeiyW7NaN4qWdw" name="logger" visibility="private" isLeaf="true" isStatic="true" type="_aH_eUVJNEeiyW7NaN4qWdw" isReadOnly="true" association="_ab88IVJNEeiyW7NaN4qWdw">
                  <defaultValue xmi:type="uml:LiteralString" xmi:id="_aTtmIVJNEeiyW7NaN4qWdw" value="Logger.getLogger(ReceivingThread.class.getName())"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aT0T0FJNEeiyW7NaN4qWdw" name="MAXIMUM_RETRIES" visibility="private" isLeaf="true" isStatic="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  <defaultValue xmi:type="uml:LiteralString" xmi:id="_aT064FJNEeiyW7NaN4qWdw" value="5"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aT2JAFJNEeiyW7NaN4qWdw" name="waitingThreads" visibility="private" isLeaf="true" type="_ZBYbkFJNEeiyW7NaN4qWdw" isReadOnly="true" association="_acKXgFJNEeiyW7NaN4qWdw">
                  <qualifier xmi:id="_aT5MUFJNEeiyW7NaN4qWdw">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </qualifier>
                  <defaultValue xmi:type="uml:LiteralString" xmi:id="_aT2wEFJNEeiyW7NaN4qWdw" value="Collections.synchronizedMap(new HashMap&lt;Integer, NetworkReplyObject>())"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aT5MUVJNEeiyW7NaN4qWdw" name="in" visibility="private" isLeaf="true" type="_ZCnKoFJNEeiyW7NaN4qWdw" isReadOnly="true" association="_acQeIFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aT5zYFJNEeiyW7NaN4qWdw" name="connection" visibility="private" isLeaf="true" type="_Y8LLcFJNEeiyW7NaN4qWdw" isReadOnly="true" association="_acXL0VJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aT5zYlJNEeiyW7NaN4qWdw" name="shouldRun" visibility="private">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aT6acVJNEeiyW7NaN4qWdw" name="nextNetworkReplyId" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWBTSFJNEeiyW7NaN4qWdw" name="ReceivingThread" specification="_aPrasFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWBTSVJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWBTSlJNEeiyW7NaN4qWdw" name="in" type="_aILrkVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWBTS1JNEeiyW7NaN4qWdw" name="threadName">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aWBTTFJNEeiyW7NaN4qWdw" type="_ZClVcFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(threadName + &quot;-ReceivingThread-&quot; + connection);&#xD;
&#xD;
     this.in = new FreeColNetworkInputStream(in);&#xD;
     this.connection = connection;&#xD;
     this.shouldRun = true;&#xD;
     this.nextNetworkReplyId = 1;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWB6UFJNEeiyW7NaN4qWdw" name="waitForNetworkReply" specification="_ZCwUkFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWB6UVJNEeiyW7NaN4qWdw" name="networkReplyId">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aWB6UlJNEeiyW7NaN4qWdw" type="_ZBYbkFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>NetworkReplyObject nro = new NetworkReplyObject(networkReplyId);&#xD;
     waitingThreads.put(networkReplyId, nro);&#xD;
     return nro;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWB6U1JNEeiyW7NaN4qWdw" name="shouldRun" specification="_ZCw7oFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWB6VFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return this.shouldRun;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWB6VVJNEeiyW7NaN4qWdw" name="askToStop" specification="_ZCxislJNEeiyW7NaN4qWdw">
                  <language>java</language>
                  <body>if (this.shouldRun) {&#xD;
         this.shouldRun = false;&#xD;
         for (NetworkReplyObject o : this.waitingThreads.values()) {&#xD;
             o.interrupt();&#xD;
         }&#xD;
     }&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWB6VlJNEeiyW7NaN4qWdw" name="disconnect" specification="_ZCyJwFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWB6V1JNEeiyW7NaN4qWdw" name="reason">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>askToStop();&#xD;
     if (connection.getMessageHandler() != null) {&#xD;
         try {&#xD;
             connection.getMessageHandler().handle(connection,&#xD;
                 DOMMessage.createMessage(&quot;disconnect&quot;,&#xD;
                     &quot;reason&quot;, reason));&#xD;
         } catch (FreeColException e) {&#xD;
             logger.log(Level.WARNING, &quot;Rx disconnect&quot;, e);&#xD;
         }&#xD;
     }&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWB6WFJNEeiyW7NaN4qWdw" name="listen" specification="_ZCyJwlJNEeiyW7NaN4qWdw">
                  <language>java</language>
                  <body>in.enable();&#xD;
&#xD;
     final int LOOK_AHEAD = 8192;&#xD;
     BufferedInputStream bis = new BufferedInputStream(in, LOOK_AHEAD);&#xD;
     bis.mark(LOOK_AHEAD);&#xD;
&#xD;
     FreeColXMLReader xr = new FreeColXMLReader(bis);&#xD;
     String tag;&#xD;
     try {&#xD;
         xr.nextTag();&#xD;
         tag = xr.getLocalName();&#xD;
     } catch (XMLStreamException xse) {&#xD;
         // EOS can occur when the other end disconnects&#xD;
         tag = Connection.DISCONNECT_TAG;&#xD;
     }&#xD;
&#xD;
     if (Connection.DISCONNECT_TAG.equals(tag)) {&#xD;
         askToStop();&#xD;
&#xD;
     } else if (Connection.REPLY_TAG.equals(tag)) {&#xD;
         int id = xr.getAttribute(Connection.NETWORK_REPLY_ID_TAG, -1);&#xD;
         NetworkReplyObject nro = waitingThreads.remove(id);&#xD;
         if (nro == null) {&#xD;
             logger.warning(&quot;Could not find networkReplyId: &quot; + id);&#xD;
         } else {&#xD;
             bis.reset();&#xD;
             nro.setResponse(new DOMMessage(bis));&#xD;
         }&#xD;
     &#xD;
     } else {&#xD;
         try {&#xD;
             bis.reset();&#xD;
             connection.handleAndSendReply(bis);&#xD;
         } catch (IOException ioe) {&#xD;
             logger.log(Level.WARNING, &quot;IO error for &quot; + tag, ioe);&#xD;
         }&#xD;
     }&#xD;
&#xD;
     if (xr != null) xr.close();&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWChYFJNEeiyW7NaN4qWdw" name="run" specification="_ZCzX4FJNEeiyW7NaN4qWdw">
                  <language>java</language>
                  <body>int timesFailed = 0;&#xD;
&#xD;
     try {&#xD;
         while (shouldRun()) {&#xD;
             try {&#xD;
                 listen();&#xD;
                 timesFailed = 0;&#xD;
             } catch (SAXException|XMLStreamException e) {&#xD;
                 if (!shouldRun()) break;&#xD;
                 logger.log(Level.WARNING, &quot;XML fail&quot;, e);&#xD;
                 if (++timesFailed > MAXIMUM_RETRIES) {&#xD;
                     disconnect(&quot;Too many failures (XML)&quot;);&#xD;
                 }&#xD;
             } catch (IOException e) {&#xD;
                 if (!shouldRun()) break;&#xD;
                 logger.log(Level.WARNING, &quot;IO fail&quot;, e);&#xD;
                 disconnect(&quot;Unexpected IO failure&quot;);&#xD;
             }&#xD;
         }&#xD;
     } catch (Exception e) {&#xD;
         logger.log(Level.WARNING, &quot;Unexpected exception.&quot;, e);&#xD;
     } finally {&#xD;
         askToStop();&#xD;
     }&#xD;
     // Do not send disconnect again&#xD;
     connection.reallyClose();&#xD;
     logger.info(&quot;Finished: &quot; + getName());&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_ZCwUkFJNEeiyW7NaN4qWdw" name="waitForNetworkReply" method="_aWB6UFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXPbQ1JNEeiyW7NaN4qWdw">
                    <body>Creates and registers a new &lt;code>NetworkReplyObject&lt;/code> with the&#xD;
     * specified object identifier.&#xD;
     * &#xD;
     * @param networkReplyId The identifier of the message the calling&#xD;
     *     thread should wait for.&#xD;
     * @return The &lt;code>NetworkReplyObject&lt;/code> containing the network&#xD;
     *     message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZCwUkVJNEeiyW7NaN4qWdw" name="networkReplyId">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aKeKkFJNEeiyW7NaN4qWdw" type="_ZBYbkFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_ZCw7oFJNEeiyW7NaN4qWdw" name="shouldRun" visibility="private" method="_aWB6U1JNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_ZCw7oVJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_ZCxisFJNEeiyW7NaN4qWdw" key="synchronized"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXPbRFJNEeiyW7NaN4qWdw">
                    <body>Checks if this thread should run.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZCxisVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_ZCxislJNEeiyW7NaN4qWdw" name="askToStop" method="_aWB6VVJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_ZCxis1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_ZCxitFJNEeiyW7NaN4qWdw" key="synchronized"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXPbRVJNEeiyW7NaN4qWdw">
                    <body>Tells this thread that it does not need to do any more work.</body>
                  </ownedComment>
                </ownedOperation>
                <ownedOperation xmi:id="_ZCyJwFJNEeiyW7NaN4qWdw" name="disconnect" visibility="private" method="_aWB6VlJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXPbRlJNEeiyW7NaN4qWdw">
                    <body>Disconnects this thread.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZCyJwVJNEeiyW7NaN4qWdw" name="reason">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_ZCyJwlJNEeiyW7NaN4qWdw" name="listen" visibility="private" method="_aWB6WFJNEeiyW7NaN4qWdw" raisedException="_aH-QMFJNEeiyW7NaN4qWdw _aIXRwFJNEeiyW7NaN4qWdw _aIQkEVJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXPbR1JNEeiyW7NaN4qWdw">
                    <body>Listens to the InputStream and calls the MessageHandler for&#xD;
     * each message received.&#xD;
     * &#xD;
     * @throws IOException If thrown by the {@link FreeColNetworkInputStream}.&#xD;
     * @throws SAXException if a problem occured during parsing.&#xD;
     * @throws XMLStreamException if a problem occured during parsing.</body>
                  </ownedComment>
                </ownedOperation>
                <ownedOperation xmi:id="_ZCzX4FJNEeiyW7NaN4qWdw" name="run" method="_aWChYFJNEeiyW7NaN4qWdw"/>
                <ownedOperation xmi:id="_aPrasFJNEeiyW7NaN4qWdw" name="ReceivingThread" visibility="package" method="_aWBTSFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aPsBwFJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aPsBwVJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXPbQlJNEeiyW7NaN4qWdw">
                    <body>The constructor to use.&#xD;
     * &#xD;
     * @param connection The &lt;code>Connection&lt;/code> this&#xD;
     *            &lt;code>ReceivingThread&lt;/code> belongs to.&#xD;
     * @param in The stream to read from.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aPrasVJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPraslJNEeiyW7NaN4qWdw" name="in" type="_aILrkVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPras1JNEeiyW7NaN4qWdw" name="threadName">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aPsBwlJNEeiyW7NaN4qWdw" type="_ZClVcFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <nestedClassifier xmi:type="uml:Class" xmi:id="_ZCnKoFJNEeiyW7NaN4qWdw" name="FreeColNetworkInputStream" visibility="private">
                  <eAnnotations xmi:id="_ZCnKoVJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_ZCnKolJNEeiyW7NaN4qWdw" key="static"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXO0N1JNEeiyW7NaN4qWdw">
                    <body>Input stream for buffering the data from the network.&#xD;
     * &#xD;
     * This is just a buffered input stream that signals end-of-stream&#xD;
     * when a given token {@link #END_OF_STREAM} is encountered.  In&#xD;
     * order to continue receiving data, the method {@link #enable}&#xD;
     * has to be called.  Calls to &lt;code>close()&lt;/code> have no effect,&#xD;
     * the underlying input stream has to be closed directly.</body>
                  </ownedComment>
                  <generalization xmi:id="_aPqMkFJNEeiyW7NaN4qWdw" general="_aILrkVJNEeiyW7NaN4qWdw"/>
                  <ownedAttribute xmi:id="_aTuNMFJNEeiyW7NaN4qWdw" name="BUFFER_SIZE" visibility="private" isLeaf="true" isStatic="true" isReadOnly="true">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    <defaultValue xmi:type="uml:LiteralString" xmi:id="_aTuNMVJNEeiyW7NaN4qWdw" value="16384"/>
                  </ownedAttribute>
                  <ownedAttribute xmi:id="_aTu0QFJNEeiyW7NaN4qWdw" name="END_OF_STREAM" visibility="private" isLeaf="true" isStatic="true" isReadOnly="true">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#char"/>
                    <defaultValue xmi:type="uml:LiteralString" xmi:id="_aTu0QVJNEeiyW7NaN4qWdw" value="'\n'"/>
                  </ownedAttribute>
                  <ownedAttribute xmi:id="_aTu0QlJNEeiyW7NaN4qWdw" name="in" visibility="private" isLeaf="true" type="_aILrkVJNEeiyW7NaN4qWdw" isReadOnly="true" association="_acDp0VJNEeiyW7NaN4qWdw"/>
                  <ownedAttribute xmi:id="_aTvbUVJNEeiyW7NaN4qWdw" name="buffer" visibility="private" isLeaf="true" isReadOnly="true">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#byte"/>
                    <upperValue xmi:type="uml:LiteralUnlimitedNatural" xmi:id="_aTwCYFJNEeiyW7NaN4qWdw" value="*"/>
                    <defaultValue xmi:type="uml:LiteralString" xmi:id="_aTwpcFJNEeiyW7NaN4qWdw" value="new byte[BUFFER_SIZE]"/>
                  </ownedAttribute>
                  <ownedAttribute xmi:id="_aTxQgFJNEeiyW7NaN4qWdw" name="bStart" visibility="private">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    <defaultValue xmi:type="uml:LiteralString" xmi:id="_aTxQgVJNEeiyW7NaN4qWdw" value="0"/>
                  </ownedAttribute>
                  <ownedAttribute xmi:id="_aTx3kVJNEeiyW7NaN4qWdw" name="bEnd" visibility="private">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    <defaultValue xmi:type="uml:LiteralString" xmi:id="_aTx3klJNEeiyW7NaN4qWdw" value="0"/>
                  </ownedAttribute>
                  <ownedAttribute xmi:id="_aTyeoVJNEeiyW7NaN4qWdw" name="empty" visibility="private">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                    <defaultValue xmi:type="uml:LiteralString" xmi:id="_aTyeolJNEeiyW7NaN4qWdw" value="true"/>
                  </ownedAttribute>
                  <ownedAttribute xmi:id="_aTzFsVJNEeiyW7NaN4qWdw" name="wait" visibility="private">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                    <defaultValue xmi:type="uml:LiteralString" xmi:id="_aTzswFJNEeiyW7NaN4qWdw" value="false"/>
                  </ownedAttribute>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWAsMFJNEeiyW7NaN4qWdw" name="FreeColNetworkInputStream" specification="_aPoXYFJNEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_aWAsMVJNEeiyW7NaN4qWdw" name="in" type="_aILrkVJNEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_aWAsMlJNEeiyW7NaN4qWdw" type="_ZCnKoFJNEeiyW7NaN4qWdw" direction="return"/>
                    <language>java</language>
                    <body>this.in = in;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWAsM1JNEeiyW7NaN4qWdw" name="enable" specification="_ZCo_0FJNEeiyW7NaN4qWdw">
                    <language>java</language>
                    <body>this.wait = false;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWAsNFJNEeiyW7NaN4qWdw" name="fill" specification="_ZCo_0VJNEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_aWAsNVJNEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>if (!this.empty) throw new IllegalStateException(&quot;Not empty.&quot;);&#xD;
&#xD;
         int r;&#xD;
         if (this.bStart &lt; this.bEnd) {&#xD;
             r = this.in.read(buffer, this.bEnd, BUFFER_SIZE - this.bEnd);&#xD;
         } else if (this.bStart == this.bEnd) {&#xD;
             this.bStart = this.bEnd = 0; // Might as well resync.&#xD;
             r = this.in.read(buffer, this.bEnd, BUFFER_SIZE - this.bEnd);&#xD;
         } else {&#xD;
             r = this.in.read(buffer, this.bEnd, this.bStart - this.bEnd);&#xD;
         }&#xD;
         if (r &lt;= 0) return false;&#xD;
&#xD;
         this.empty = false;&#xD;
         this.bEnd += r;&#xD;
         if (this.bEnd >= BUFFER_SIZE) this.bEnd = 0;&#xD;
         return true;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWAsNlJNEeiyW7NaN4qWdw" name="read" specification="_ZCpm4FJNEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_aWAsN1JNEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>if (this.wait) return -1;&#xD;
&#xD;
         if (this.empty &amp;&amp; !fill()) {&#xD;
             this.wait = true;&#xD;
             return -1;&#xD;
         }&#xD;
&#xD;
         int ret = buffer[this.bStart];&#xD;
         this.bStart++;&#xD;
         if (this.bStart >= BUFFER_SIZE) this.bStart = 0;&#xD;
         if (this.bStart == this.bEnd) this.empty = true;&#xD;
&#xD;
         if (ret == END_OF_STREAM) {&#xD;
             this.wait = true;&#xD;
             ret = -1;&#xD;
         }&#xD;
         return ret;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWBTQFJNEeiyW7NaN4qWdw" name="read" specification="_ZCsDIFJNEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_aWBTQVJNEeiyW7NaN4qWdw" name="b">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#byte"/>
                      <upperValue xmi:type="uml:LiteralUnlimitedNatural" xmi:id="_aWBTQlJNEeiyW7NaN4qWdw" value="*"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_aWBTQ1JNEeiyW7NaN4qWdw" name="off">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_aWBTRFJNEeiyW7NaN4qWdw" name="len">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_aWBTRVJNEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>if (this.wait) return -1;&#xD;
&#xD;
         int n = 0;&#xD;
         for (; n &lt; len; n++) {&#xD;
             if (this.empty &amp;&amp; !fill()) {&#xD;
                 this.wait = true;&#xD;
                 break;&#xD;
             }&#xD;
&#xD;
             byte value = buffer[this.bStart];&#xD;
             this.bStart++;&#xD;
             if (this.bStart == BUFFER_SIZE) this.bStart = 0;&#xD;
             if (this.bStart == this.bEnd) this.empty = true;&#xD;
&#xD;
             if (value == END_OF_STREAM) {&#xD;
                 this.wait = true;&#xD;
                 break;&#xD;
             }&#xD;
             b[n + off] = value;&#xD;
         }&#xD;
&#xD;
         return (n &lt;= 0 &amp;&amp; this.wait) ? -1 : n;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedOperation xmi:id="_ZCo_0FJNEeiyW7NaN4qWdw" name="enable" method="_aWAsM1JNEeiyW7NaN4qWdw">
                    <ownedComment xmi:id="_aXPbQFJNEeiyW7NaN4qWdw">
                      <body>Prepares the input stream for a new message.&#xD;
         * Makes the subsequent calls to &lt;code>read&lt;/code> return the data&#xD;
         * instead of &lt;code>-1&lt;/code>.</body>
                    </ownedComment>
                  </ownedOperation>
                  <ownedOperation xmi:id="_ZCo_0VJNEeiyW7NaN4qWdw" name="fill" visibility="private" method="_aWAsNFJNEeiyW7NaN4qWdw" raisedException="_aH-QMFJNEeiyW7NaN4qWdw">
                    <ownedComment xmi:id="_aXPbQVJNEeiyW7NaN4qWdw">
                      <body>Fills the buffer with data.&#xD;
         * &#xD;
         * @return True if a non-zero amount of data was read into the buffer.&#xD;
         * @exception IOException is thrown by the underlying read.&#xD;
         * @exception IllegalStateException if the buffer is not empty.</body>
                    </ownedComment>
                    <ownedParameter xmi:id="_ZCo_0lJNEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_ZCpm4FJNEeiyW7NaN4qWdw" name="read" method="_aWAsNlJNEeiyW7NaN4qWdw" raisedException="_aH-QMFJNEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_ZCpm4VJNEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_ZCsDIFJNEeiyW7NaN4qWdw" name="read" method="_aWBTQFJNEeiyW7NaN4qWdw" raisedException="_aH-QMFJNEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_ZCsDIVJNEeiyW7NaN4qWdw" name="b">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#byte"/>
                      <upperValue xmi:type="uml:LiteralUnlimitedNatural" xmi:id="_ZCsqMVJNEeiyW7NaN4qWdw" value="*"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_ZCsDIlJNEeiyW7NaN4qWdw" name="off">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_ZCsDI1JNEeiyW7NaN4qWdw" name="len">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_ZCsDJFJNEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_aPoXYFJNEeiyW7NaN4qWdw" name="FreeColNetworkInputStream" method="_aWAsMFJNEeiyW7NaN4qWdw">
                    <eAnnotations xmi:id="_aPplgFJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                      <details xmi:id="_aPplgVJNEeiyW7NaN4qWdw" key="create"/>
                    </eAnnotations>
                    <ownedComment xmi:id="_aXO0OFJNEeiyW7NaN4qWdw">
                      <body>Creates a new &lt;code>FreeColNetworkInputStream&lt;/code>.&#xD;
         * &#xD;
         * @param in The input stream in which this object should get the data&#xD;
         *            from.</body>
                    </ownedComment>
                    <ownedParameter xmi:id="_aPoXYVJNEeiyW7NaN4qWdw" name="in" type="_aILrkVJNEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_aPplglJNEeiyW7NaN4qWdw" type="_ZCnKoFJNEeiyW7NaN4qWdw" direction="return"/>
                  </ownedOperation>
                </nestedClassifier>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_ZC7TsFJNEeiyW7NaN4qWdw" name="RenameMessage">
                <ownedComment xmi:id="_aXQCUFJNEeiyW7NaN4qWdw">
                  <body>The message sent when renaming a FreeColGameObject.</body>
                </ownedComment>
                <generalization xmi:id="_aKh08FJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aT8PoFJNEeiyW7NaN4qWdw" name="id" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aT82sVJNEeiyW7NaN4qWdw" name="newName" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWChYVJNEeiyW7NaN4qWdw" name="RenameMessage" specification="_aPueAFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWChYlJNEeiyW7NaN4qWdw" name="object" type="_aH3igFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWChY1JNEeiyW7NaN4qWdw" name="newName">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aWChZFJNEeiyW7NaN4qWdw" type="_ZC7TsFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.id = object.getId();&#xD;
     this.newName = newName;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWDIcFJNEeiyW7NaN4qWdw" name="RenameMessage" specification="_aPvsIFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWDIcVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWDIclJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWDIc1JNEeiyW7NaN4qWdw" type="_ZC7TsFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.id = element.getAttribute(&quot;nameable&quot;);&#xD;
     this.newName = element.getAttribute(&quot;name&quot;);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWDIdFJNEeiyW7NaN4qWdw" name="handle" specification="_aPwTMFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWDIdVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWDIdlJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWDId1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWDIeFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
&#xD;
     FreeColGameObject fcgo;&#xD;
     try {&#xD;
         fcgo = player.getOurFreeColGameObject(id, FreeColGameObject.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
     if (!(fcgo instanceof Nameable)) {&#xD;
         return DOMMessage.clientError(&quot;Not a nameable: &quot; + id);&#xD;
     }&#xD;
&#xD;
     // Proceed to rename.&#xD;
     return server.getInGameController()&#xD;
         .renameObject(serverPlayer, (Nameable)fcgo, newName);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWDvgFJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_ZC9I4FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWDvgVJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return createMessage(getXMLElementTagName(),&#xD;
         &quot;nameable&quot;, id,&#xD;
         &quot;name&quot;, newName);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWDvglJNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_ZC--EFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWDvg1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;rename&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_ZC9I4FJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aWDvgFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aPw6RFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_ZC--EFJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aWDvglJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXQCVFJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;rename&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZC--EVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aPueAFJNEeiyW7NaN4qWdw" name="RenameMessage" method="_aWChYVJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aPvFElJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aPvFE1JNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXQCUVJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>RenameMessage&lt;/code> with the&#xD;
     * supplied name.&#xD;
     *&#xD;
     * @param object The &lt;code>FreeColGameObject&lt;/code> to rename.&#xD;
     * @param newName The new name for the object.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aPvFEFJNEeiyW7NaN4qWdw" name="object" type="_aH3igFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPvFEVJNEeiyW7NaN4qWdw" name="newName">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aPvFFFJNEeiyW7NaN4qWdw" type="_ZC7TsFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aPvsIFJNEeiyW7NaN4qWdw" name="RenameMessage" method="_aWDIcFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aPvsI1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aPvsJFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXQCUlJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>RenameMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aPvsIVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPvsIlJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPvsJVJNEeiyW7NaN4qWdw" type="_ZC7TsFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aPwTMFJNEeiyW7NaN4qWdw" name="handle" method="_aWDIdFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXQCU1JNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;rename&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param player The &lt;code>Player&lt;/code> the message applies to.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     *&#xD;
     * @return An update containing the renamed unit,&#xD;
     *         or an error &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aPw6QFJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPw6QVJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPw6QlJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPw6Q1JNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_ZDIIAFJNEeiyW7NaN4qWdw" name="ScoutIndianSettlementMessage">
                <ownedComment xmi:id="_aXQCVVJNEeiyW7NaN4qWdw">
                  <body>The message sent when scouting a native settlement.</body>
                </ownedComment>
                <generalization xmi:id="_aKjqIFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aT9dwFJNEeiyW7NaN4qWdw" name="unitId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aT-E0VJNEeiyW7NaN4qWdw" name="directionString" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWDvhFJNEeiyW7NaN4qWdw" name="ScoutIndianSettlementMessage" specification="_aPyIYFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWDvhVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWDvhlJNEeiyW7NaN4qWdw" name="direction" type="_aG4EAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWDvh1JNEeiyW7NaN4qWdw" type="_ZDIIAFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = unit.getId();&#xD;
     this.directionString = String.valueOf(direction);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWEWkFJNEeiyW7NaN4qWdw" name="ScoutIndianSettlementMessage" specification="_aPzWgFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWEWkVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWEWklJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWEWk1JNEeiyW7NaN4qWdw" type="_ZDIIAFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = element.getAttribute(&quot;unitId&quot;);&#xD;
     this.directionString = element.getAttribute(&quot;direction&quot;);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWEWlFJNEeiyW7NaN4qWdw" name="handle" specification="_aPz9kFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWEWlVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWEWllJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWEWl1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWEWmFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
&#xD;
     Unit unit;&#xD;
     try {&#xD;
         unit = player.getOurFreeColGameObject(unitId, Unit.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
     if (!unit.hasAbility(Ability.SPEAK_WITH_CHIEF)) {&#xD;
         return DOMMessage.clientError(&quot;Unit lacks ability&quot;&#xD;
             + &quot; to speak to chief: &quot; + unitId);&#xD;
     }&#xD;
&#xD;
     Tile tile;&#xD;
     try {&#xD;
         tile = unit.getNeighbourTile(directionString);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     IndianSettlement is = tile.getIndianSettlement();&#xD;
     if (is == null) {&#xD;
         return DOMMessage.clientError(&quot;There is no native settlement at: &quot;&#xD;
             + tile.getId());&#xD;
     }&#xD;
&#xD;
     MoveType type = unit.getMoveType(is.getTile());&#xD;
     if (type != MoveType.ENTER_INDIAN_SETTLEMENT_WITH_SCOUT) {&#xD;
         return DOMMessage.clientError(&quot;Unable to enter &quot;&#xD;
             + is.getName() + &quot;: &quot; + type.whyIllegal());&#xD;
     }&#xD;
&#xD;
     // Valid request, do the scouting.&#xD;
     return server.getInGameController()&#xD;
         .scoutIndianSettlement(serverPlayer, unit, is);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWEWmVJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_ZDOOoFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWEWmlJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return createMessage(getXMLElementTagName(),&#xD;
         &quot;unitId&quot;, unitId,&#xD;
         &quot;direction&quot;, directionString);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWE9oFJNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_ZDQq4FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWE9oVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;scoutIndianSettlement&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_ZDOOoFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aWEWmVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aP0koFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_ZDQq4FJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aWE9oFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXQpYFJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;scoutIndianSettlement&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZDQq4VJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aPyIYFJNEeiyW7NaN4qWdw" name="ScoutIndianSettlementMessage" method="_aWDvhFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aPyvclJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aPyvc1JNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXQCVlJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>ScoutIndianSettlementMessage&lt;/code> with the&#xD;
     * supplied unit and direction.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is learning.&#xD;
     * @param direction The &lt;code>Direction&lt;/code> the unit is looking.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aPyvcFJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPyvcVJNEeiyW7NaN4qWdw" name="direction" type="_aG4EAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPyvdFJNEeiyW7NaN4qWdw" type="_ZDIIAFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aPzWgFJNEeiyW7NaN4qWdw" name="ScoutIndianSettlementMessage" method="_aWEWkFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aPzWg1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aPzWhFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXQCV1JNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>ScoutIndianSettlementMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aPzWgVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPzWglJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPzWhVJNEeiyW7NaN4qWdw" type="_ZDIIAFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aPz9kFJNEeiyW7NaN4qWdw" name="handle" method="_aWEWlFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXQCWFJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;scoutIndianSettlement&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param player The &lt;code>Player&lt;/code> the message applies to.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     * @return An element containing the result of the scouting&#xD;
     *     action, or an error &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aPz9kVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPz9klJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPz9k1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aPz9lFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_ZDWKcFJNEeiyW7NaN4qWdw" name="ScoutSpeakToChiefMessage">
                <ownedComment xmi:id="_aXQpYVJNEeiyW7NaN4qWdw">
                  <body>The message sent when speaking to a chief.</body>
                </ownedComment>
                <generalization xmi:id="_aKlfUFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aT-r4VJNEeiyW7NaN4qWdw" name="unitId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aT_S8VJNEeiyW7NaN4qWdw" name="directionString" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWE9olJNEeiyW7NaN4qWdw" name="ScoutSpeakToChiefMessage" specification="_aP1LsFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWE9o1JNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWE9pFJNEeiyW7NaN4qWdw" name="direction" type="_aG4EAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWE9pVJNEeiyW7NaN4qWdw" type="_ZDWKcFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = unit.getId();&#xD;
     this.directionString = String.valueOf(direction);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWE9plJNEeiyW7NaN4qWdw" name="ScoutSpeakToChiefMessage" specification="_aP1ywFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWE9p1JNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWE9qFJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWE9qVJNEeiyW7NaN4qWdw" type="_ZDWKcFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = element.getAttribute(&quot;unitId&quot;);&#xD;
     this.directionString = element.getAttribute(&quot;direction&quot;);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWFksFJNEeiyW7NaN4qWdw" name="handle" specification="_aP2Z0FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWFksVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWFkslJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWFks1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWFktFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
&#xD;
     Unit unit;&#xD;
     try {&#xD;
         unit = player.getOurFreeColGameObject(unitId, Unit.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
     if (!unit.hasAbility(Ability.SPEAK_WITH_CHIEF)) {&#xD;
         return DOMMessage.clientError(&quot;Unit lacks ability to speak to chief: &quot;&#xD;
             + unitId);&#xD;
     }&#xD;
&#xD;
     Tile tile;&#xD;
     try {&#xD;
         tile = unit.getNeighbourTile(directionString);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     IndianSettlement is = tile.getIndianSettlement();&#xD;
     if (is == null) {&#xD;
         return DOMMessage.clientError(&quot;There is no native settlement at: &quot;&#xD;
             + tile.getId());&#xD;
     }&#xD;
&#xD;
     MoveType type = unit.getMoveType(is.getTile());&#xD;
     if (type != MoveType.ENTER_INDIAN_SETTLEMENT_WITH_SCOUT) {&#xD;
         return DOMMessage.clientError(&quot;Unable to enter &quot;&#xD;
             + is.getName() + &quot;: &quot; + type.whyIllegal());&#xD;
     }&#xD;
&#xD;
     // Valid request, do the scouting.&#xD;
     return server.getInGameController()&#xD;
         .scoutSpeakToChief(serverPlayer, unit, is);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWFktVJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_ZDYmsFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWFktlJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return createMessage(getXMLElementTagName(),&#xD;
         &quot;unitId&quot;, unitId,&#xD;
         &quot;direction&quot;, directionString);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWFkt1JNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_ZDZNwlJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWFkuFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;scoutSpeakToChief&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_ZDYmsFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aWFktVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aP3A4FJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_ZDZNwlJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aWFkt1JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXQpZVJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;scoutSpeakToChief&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZDZ00FJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aP1LsFJNEeiyW7NaN4qWdw" name="ScoutSpeakToChiefMessage" method="_aWE9olJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aP1Ls1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aP1LtFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXQpYlJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>ScoutSpeakToChiefMessage&lt;/code> with the&#xD;
     * supplied unit and direction.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is learning.&#xD;
     * @param direction The &lt;code>Direction&lt;/code> the unit is looking.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aP1LsVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aP1LslJNEeiyW7NaN4qWdw" name="direction" type="_aG4EAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aP1LtVJNEeiyW7NaN4qWdw" type="_ZDWKcFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aP1ywFJNEeiyW7NaN4qWdw" name="ScoutSpeakToChiefMessage" method="_aWE9plJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aP1yw1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aP1yxFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXQpY1JNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>ScoutSpeakToChiefMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aP1ywVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aP1ywlJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aP1yxVJNEeiyW7NaN4qWdw" type="_ZDWKcFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aP2Z0FJNEeiyW7NaN4qWdw" name="handle" method="_aWFksFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXQpZFJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;scoutSpeakToChief&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param player The &lt;code>Player&lt;/code> the message applies to.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     * @return An element containing the result of the scouting&#xD;
     *     action, or an error &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aP2Z0VJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aP2Z0lJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aP2Z01JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aP2Z1FJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_ZDdfMFJNEeiyW7NaN4qWdw" name="SellMessage">
                <ownedComment xmi:id="_aXQpZlJNEeiyW7NaN4qWdw">
                  <body>The message sent when selling at an IndianSettlement.</body>
                </ownedComment>
                <generalization xmi:id="_aKn7kFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aT_6AVJNEeiyW7NaN4qWdw" name="unitId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aUAhEVJNEeiyW7NaN4qWdw" name="settlementId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aUBIIVJNEeiyW7NaN4qWdw" name="goods" visibility="private" isLeaf="true" type="_aHJw0FJNEeiyW7NaN4qWdw" isReadOnly="true" association="_acd5gVJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aUBvMFJNEeiyW7NaN4qWdw" name="goldString" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWGLwFJNEeiyW7NaN4qWdw" name="SellMessage" specification="_aP3n8FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWGLwVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWGLwlJNEeiyW7NaN4qWdw" name="settlement" type="_aHKX4VJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWGLw1JNEeiyW7NaN4qWdw" name="goods" type="_aHJw0FJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWGLxFJNEeiyW7NaN4qWdw" name="gold">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aWGLxVJNEeiyW7NaN4qWdw" type="_ZDdfMFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = unit.getId();&#xD;
     this.settlementId = settlement.getId();&#xD;
     this.goods = goods;&#xD;
     this.goldString = Integer.toString(gold);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWGLxlJNEeiyW7NaN4qWdw" name="SellMessage" specification="_aP4PAFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWGLx1JNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWGLyFJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWGLyVJNEeiyW7NaN4qWdw" type="_ZDdfMFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = element.getAttribute(&quot;unit&quot;);&#xD;
     this.settlementId = element.getAttribute(&quot;settlement&quot;);&#xD;
     this.goods = new Goods(game,&#xD;
         DOMMessage.getChildElement(element, Goods.getXMLElementTagName()));&#xD;
     this.goldString = element.getAttribute(&quot;gold&quot;);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWGy0FJNEeiyW7NaN4qWdw" name="getGold" specification="_ZDfUYFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWGy0VJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>try {&#xD;
         return Integer.parseInt(goldString);&#xD;
     } catch (NumberFormatException e) {&#xD;
         return -1;&#xD;
     }&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWGy0lJNEeiyW7NaN4qWdw" name="handle" specification="_aP42EFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWGy01JNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWGy1FJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWGy1VJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWGy1lJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
&#xD;
     Unit unit;&#xD;
     try {&#xD;
         unit = player.getOurFreeColGameObject(unitId, Unit.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     ServerIndianSettlement settlement;&#xD;
     try {&#xD;
         settlement = (ServerIndianSettlement)unit.getAdjacentIndianSettlementSafely(settlementId);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     // Make sure we are trying to sell something that is there&#xD;
     if (goods.getLocation() != unit) {&#xD;
         return DOMMessage.clientError(&quot;Goods &quot; + goods.getId()&#xD;
             + &quot; is not with unit &quot; + unitId);&#xD;
     }&#xD;
&#xD;
     int gold = getGold();&#xD;
     if (gold &lt; 0) return DOMMessage.clientError(&quot;Bad gold: &quot; + goldString);&#xD;
&#xD;
     // Proceed to sell&#xD;
     return server.getInGameController()&#xD;
         .sellToSettlement(serverPlayer, unit, settlement, goods, gold);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWGy11JNEeiyW7NaN4qWdw" name="toXMLElement" specification="_ZDf7cFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWGy2FJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>Element result = createMessage(getXMLElementTagName(),&#xD;
         &quot;unit&quot;, unitId,&#xD;
         &quot;settlement&quot;, settlementId,&#xD;
         &quot;gold&quot;, goldString);&#xD;
     result.appendChild(goods.toXMLElement(result.getOwnerDocument()));&#xD;
     return result;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWGy2VJNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_ZDhJklJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWGy2lJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;sell&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_ZDfUYFJNEeiyW7NaN4qWdw" name="getGold" method="_aWGy0FJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXQpaVJNEeiyW7NaN4qWdw">
                    <body>What is the price currently negotiated for this transaction?&#xD;
     *&#xD;
     * @return The current price.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZDfUYVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_ZDf7cFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aWGy11JNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aP5dIVJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_ZDhJklJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aWGy2VJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXRQcFJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;sell&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZDhwoFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aP3n8FJNEeiyW7NaN4qWdw" name="SellMessage" method="_aWGLwFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aP3n9VJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aP3n9lJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXQpZ1JNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>SellMessage&lt;/code>.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is trading.&#xD;
     * @param settlement The &lt;code>Settlement&lt;/code> that is trading.&#xD;
     * @param goods The &lt;code>Goods&lt;/code> to sell.&#xD;
     * @param gold The price of the goods.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aP3n8VJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aP3n8lJNEeiyW7NaN4qWdw" name="settlement" type="_aHKX4VJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aP3n81JNEeiyW7NaN4qWdw" name="goods" type="_aHJw0FJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aP3n9FJNEeiyW7NaN4qWdw" name="gold">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aP3n91JNEeiyW7NaN4qWdw" type="_ZDdfMFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aP4PAFJNEeiyW7NaN4qWdw" name="SellMessage" method="_aWGLxlJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aP4PA1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aP4PBFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXQpaFJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>SellMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aP4PAVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aP4PAlJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aP4PBVJNEeiyW7NaN4qWdw" type="_ZDdfMFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aP42EFJNEeiyW7NaN4qWdw" name="handle" method="_aWGy0lJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXQpalJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;sell&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param player The &lt;code>Player&lt;/code> the message applies to.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     * @return An update as a result of the sale, or an error&#xD;
     *      &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aP42EVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aP42ElJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aP42E1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aP5dIFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_ZDlbAFJNEeiyW7NaN4qWdw" name="SellPropositionMessage">
                <ownedComment xmi:id="_aXRQcVJNEeiyW7NaN4qWdw">
                  <body>The message sent when negotiating a sale at an IndianSettlement.</body>
                </ownedComment>
                <generalization xmi:id="_aKrl8FJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aUCWQFJNEeiyW7NaN4qWdw" name="unitId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aUC9UVJNEeiyW7NaN4qWdw" name="settlementId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aUDkYFJNEeiyW7NaN4qWdw" name="goods" visibility="private" isLeaf="true" type="_aHJw0FJNEeiyW7NaN4qWdw" isReadOnly="true" association="_acnDcVJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aUDkYlJNEeiyW7NaN4qWdw" name="goldString" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWHZ4FJNEeiyW7NaN4qWdw" name="SellPropositionMessage" specification="_aP6EMFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWHZ4VJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWHZ4lJNEeiyW7NaN4qWdw" name="settlement" type="_aHKX4VJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWHZ41JNEeiyW7NaN4qWdw" name="goods" type="_aHJw0FJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWHZ5FJNEeiyW7NaN4qWdw" name="gold">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aWHZ5VJNEeiyW7NaN4qWdw" type="_ZDlbAFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = unit.getId();&#xD;
     this.settlementId = settlement.getId();&#xD;
     this.goods = goods;&#xD;
     this.goldString = Integer.toString(gold);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWHZ5lJNEeiyW7NaN4qWdw" name="SellPropositionMessage" specification="_aP7SUFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWHZ51JNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWHZ6FJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWHZ6VJNEeiyW7NaN4qWdw" type="_ZDlbAFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = element.getAttribute(&quot;unit&quot;);&#xD;
     this.settlementId = element.getAttribute(&quot;settlement&quot;);&#xD;
     this.goldString = element.getAttribute(&quot;gold&quot;);&#xD;
     this.goods = new Goods(game,&#xD;
         DOMMessage.getChildElement(element, Goods.getXMLElementTagName()));&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWHZ6lJNEeiyW7NaN4qWdw" name="getGold" specification="_ZDn3QFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWHZ61JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>try {&#xD;
         return Integer.parseInt(goldString);&#xD;
     } catch (NumberFormatException e) {&#xD;
         return -1;&#xD;
     }&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWIA8FJNEeiyW7NaN4qWdw" name="handle" specification="_aP75YFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWIA8VJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWIA8lJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWIA81JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWIA9FJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
&#xD;
     Unit unit;&#xD;
     try {&#xD;
         unit = player.getOurFreeColGameObject(unitId, Unit.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     IndianSettlement settlement;&#xD;
     try {&#xD;
         settlement = unit.getAdjacentIndianSettlementSafely(settlementId);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     // Make sure we are trying to sell something that is there&#xD;
     if (goods.getLocation() != unit) {&#xD;
         return DOMMessage.clientError(&quot;Goods &quot; + goods.getId()&#xD;
             + &quot; are not with unit &quot; + unitId);&#xD;
     }&#xD;
&#xD;
     // Proceed to price.&#xD;
     return server.getInGameController()&#xD;
         .sellProposition(serverPlayer, unit, settlement, goods, getGold());&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWIA9VJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_ZDoeUFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWIA9lJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>Element result = createMessage(getXMLElementTagName(),&#xD;
         &quot;unit&quot;, unitId,&#xD;
         &quot;settlement&quot;, settlementId,&#xD;
         &quot;gold&quot;, goldString);&#xD;
     result.appendChild(goods.toXMLElement(result.getOwnerDocument()));&#xD;
     return result;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWIA91JNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_ZDpsclJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWIA-FJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;sellProposition&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_ZDn3QFJNEeiyW7NaN4qWdw" name="getGold" method="_aWHZ6lJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXRQdFJNEeiyW7NaN4qWdw">
                    <body>What is the price currently negotiated for this transaction?&#xD;
     *&#xD;
     * @return The current price.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZDn3QVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_ZDoeUFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aWIA9VJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aP8gcFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_ZDpsclJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aWIA91JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXRQdlJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;sellProposition&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZDqTgFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aP6EMFJNEeiyW7NaN4qWdw" name="SellPropositionMessage" method="_aWHZ4FJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aP6rRFJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aP6rRVJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXRQclJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>SellPropositionMessage&lt;/code>.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is trading.&#xD;
     * @param goods The &lt;code>Goods&lt;/code> to sell.&#xD;
     * @param gold The price of the goods (negative if unknown).</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aP6rQFJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aP6rQVJNEeiyW7NaN4qWdw" name="settlement" type="_aHKX4VJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aP6rQlJNEeiyW7NaN4qWdw" name="goods" type="_aHJw0FJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aP6rQ1JNEeiyW7NaN4qWdw" name="gold">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aP6rRlJNEeiyW7NaN4qWdw" type="_ZDlbAFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aP7SUFJNEeiyW7NaN4qWdw" name="SellPropositionMessage" method="_aWHZ5lJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aP7SU1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aP7SVFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXRQc1JNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>SellPropositionMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aP7SUVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aP7SUlJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aP7SVVJNEeiyW7NaN4qWdw" type="_ZDlbAFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aP75YFJNEeiyW7NaN4qWdw" name="handle" method="_aWIA8FJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXRQdVJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;sellProposition&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param player The &lt;code>Player&lt;/code> the message applies to.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     * @return This message with updated gold value, or an error&#xD;
     *     &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aP75YVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aP75YlJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aP75Y1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aP75ZFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_ZDt94FJNEeiyW7NaN4qWdw" name="WorkMessage">
                <ownedComment xmi:id="_aXRQd1JNEeiyW7NaN4qWdw">
                  <body>The message sent to handle changes in work location.</body>
                </ownedComment>
                <generalization xmi:id="_aKwecFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aUEygFJNEeiyW7NaN4qWdw" name="unitId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aUEyglJNEeiyW7NaN4qWdw" name="workLocationId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWIoAFJNEeiyW7NaN4qWdw" name="WorkMessage" specification="_aP9HgFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWIoAVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWIoAlJNEeiyW7NaN4qWdw" name="workLocation" type="_aKupQFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWIoA1JNEeiyW7NaN4qWdw" type="_ZDt94FJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = unit.getId();&#xD;
     this.workLocationId = workLocation.getId();&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWIoBFJNEeiyW7NaN4qWdw" name="WorkMessage" specification="_aP9ukVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWIoBVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWIoBlJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWIoB1JNEeiyW7NaN4qWdw" type="_ZDt94FJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = element.getAttribute(&quot;unit&quot;);&#xD;
     this.workLocationId = element.getAttribute(&quot;workLocation&quot;);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWJPEFJNEeiyW7NaN4qWdw" name="handle" specification="_aP-Vo1JNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWJPEVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWJPElJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWJPE1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWJPFFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
     final Game game = server.getGame();&#xD;
&#xD;
     Unit unit;&#xD;
     try {&#xD;
         unit = player.getOurFreeColGameObject(unitId, Unit.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     if (!unit.hasTile()) {&#xD;
         return DOMMessage.clientError(&quot;Unit is not on the map: &quot;&#xD;
             + unitId);&#xD;
     }&#xD;
&#xD;
     Colony colony = unit.getTile().getColony();&#xD;
     if (colony == null) {&#xD;
         return DOMMessage.clientError(&quot;Unit is not at a colony: &quot;&#xD;
             + unitId);&#xD;
     }&#xD;
&#xD;
     WorkLocation workLocation&#xD;
         = game.getFreeColGameObject(workLocationId, WorkLocation.class);&#xD;
     if (workLocation == null) {&#xD;
         return DOMMessage.clientError(&quot;Not a work location: &quot;&#xD;
             + workLocationId);&#xD;
     } else if (workLocation.getColony() != colony) {&#xD;
         return DOMMessage.clientError(&quot;Work location is not in the colony&quot;&#xD;
             + &quot; where the unit is: &quot; + workLocationId);&#xD;
     } else if (!workLocation.canAdd(unit)) {&#xD;
         return DOMMessage.clientError(&quot;Can not add &quot; + unit&#xD;
             + &quot; to &quot; + workLocation&#xD;
             + &quot;: &quot; + workLocation.getNoAddReason(unit));&#xD;
     }&#xD;
&#xD;
     // Work.&#xD;
     return server.getInGameController()&#xD;
         .work(serverPlayer, unit, workLocation);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWJPFVJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_ZDvzEFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWJPFlJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return createMessage(getXMLElementTagName(),&#xD;
         &quot;unit&quot;, unitId,&#xD;
         &quot;workLocation&quot;, workLocationId);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWJPF1JNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_ZDxBMlJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWJPGFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;work&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_ZDvzEFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aWJPFVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aP-8tFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_ZDxBMlJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aWJPF1JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXR3gVJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;work&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZDxBM1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aP9HgFJNEeiyW7NaN4qWdw" name="WorkMessage" method="_aWIoAFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aP9Hg1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aP9HhFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXRQeFJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>WorkMessage&lt;/code> for the supplied unit and&#xD;
     * work location.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> to change the work location of.&#xD;
     * @param workLocation The &lt;code>WorkLocation&lt;/code> to change to.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aP9HgVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aP9HglJNEeiyW7NaN4qWdw" name="workLocation" type="_aKupQFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aP9ukFJNEeiyW7NaN4qWdw" type="_ZDt94FJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aP9ukVJNEeiyW7NaN4qWdw" name="WorkMessage" method="_aWIoBFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aP-VoFJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aP-VoVJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXRQeVJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>WorkMessage&lt;/code> from a supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aP9uklJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aP9uk1JNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aP-VolJNEeiyW7NaN4qWdw" type="_ZDt94FJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aP-Vo1JNEeiyW7NaN4qWdw" name="handle" method="_aWJPEFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXR3gFJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;work&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param player The &lt;code>Player&lt;/code> the message applies to.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message received on.&#xD;
     * @return An update encapsulating the work location change or an&#xD;
     *     error &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aP-8sFJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aP-8sVJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aP-8slJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aP-8s1JNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_ZD0EgFJNEeiyW7NaN4qWdw" name="SetBuildQueueMessage">
                <ownedComment xmi:id="_aXR3glJNEeiyW7NaN4qWdw">
                  <body>The message sent when setting the build queue.</body>
                </ownedComment>
                <generalization xmi:id="_aK0v4FJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aUGAoFJNEeiyW7NaN4qWdw" name="colonyId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aUGnsFJNEeiyW7NaN4qWdw" name="queue" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  <upperValue xmi:type="uml:LiteralUnlimitedNatural" xmi:id="_aUGnsVJNEeiyW7NaN4qWdw" value="*"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWJ2IFJNEeiyW7NaN4qWdw" name="SetBuildQueueMessage" specification="_aP_jwFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWJ2IVJNEeiyW7NaN4qWdw" name="colony" type="_aGwvQFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWJ2IlJNEeiyW7NaN4qWdw" name="queue" type="_aHo5AFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWJ2I1JNEeiyW7NaN4qWdw" type="_ZD0EgFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.colonyId = colony.getId();&#xD;
     this.queue = new String[queue.size()];&#xD;
     for (int i = 0; i &lt; queue.size(); i++) {&#xD;
         this.queue[i] = queue.get(i).getId();&#xD;
     }&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWJ2JFJNEeiyW7NaN4qWdw" name="SetBuildQueueMessage" specification="_aQBY8FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWJ2JVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWJ2JlJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWJ2J1JNEeiyW7NaN4qWdw" type="_ZD0EgFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.colonyId = element.getAttribute(&quot;colony&quot;);&#xD;
     int size;&#xD;
     try {&#xD;
         size = Integer.parseInt(element.getAttribute(&quot;size&quot;));&#xD;
     } catch (NumberFormatException e) {&#xD;
         size = -1;&#xD;
     }&#xD;
     if (size >= 0) {&#xD;
         this.queue = new String[size];&#xD;
         for (int i = 0; i &lt; size; i++) {&#xD;
             this.queue[i] = element.getAttribute(&quot;x&quot; + Integer.toString(i));&#xD;
         }&#xD;
     } else {&#xD;
         this.queue = null;&#xD;
     }&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWJ2KFJNEeiyW7NaN4qWdw" name="handle" specification="_aQCAAFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWJ2KVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWJ2KlJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWJ2K1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWJ2LFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
     final Game game = server.getGame();&#xD;
     final Specification spec = game.getSpecification();&#xD;
&#xD;
     Colony colony;&#xD;
     try {&#xD;
         colony = player.getOurFreeColGameObject(colonyId, Colony.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     if (queue == null) {&#xD;
         return DOMMessage.clientError(&quot;Empty queue&quot;);&#xD;
     }&#xD;
     List&lt;BuildableType> buildQueue = new ArrayList&lt;>();&#xD;
     for (int i = 0; i &lt; queue.length; i++) {&#xD;
         try {&#xD;
             buildQueue.add(i, spec.getType(queue[i], BuildableType.class));&#xD;
         } catch (Exception cce) {&#xD;
             return DOMMessage.clientError(&quot;Not a buildable type: &quot;&#xD;
                 + queue[i]);&#xD;
         }&#xD;
     }&#xD;
&#xD;
     // Proceed to set the build queue.&#xD;
     return server.getInGameController()&#xD;
         .setBuildQueue(serverPlayer, colony, buildQueue);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWKdMFJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_ZD15sFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWKdMVJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>Element result = createMessage(getXMLElementTagName(),&#xD;
         &quot;colony&quot;, colonyId,&#xD;
         &quot;size&quot;, Integer.toString(queue.length));&#xD;
     for (int i = 0; i &lt; queue.length; i++) {&#xD;
         result.setAttribute(&quot;x&quot; + Integer.toString(i), queue[i]);&#xD;
     }&#xD;
     return result;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWKdMlJNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_ZD3H0FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWKdM1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;setBuildQueue&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_ZD15sFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aWKdMFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aQCnEFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_ZD3H0FJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aWKdMlJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXR3hlJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;setBuildQueue&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZD3H0VJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aP_jwFJNEeiyW7NaN4qWdw" name="SetBuildQueueMessage" method="_aWJ2IFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aQAK0lJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aQAK01JNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXR3g1JNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>SetBuildQueueMessage&lt;/code> for the&#xD;
     * supplied colony and queue.&#xD;
     *&#xD;
     * @param colony The &lt;code>Colony&lt;/code> where the queue is.&#xD;
     * @param queue A list of &lt;code>BuildableType&lt;/code>s to build.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQAK0FJNEeiyW7NaN4qWdw" name="colony" type="_aGwvQFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQAK0VJNEeiyW7NaN4qWdw" name="queue" type="_aHo5AFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQAK1FJNEeiyW7NaN4qWdw" type="_ZD0EgFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aQBY8FJNEeiyW7NaN4qWdw" name="SetBuildQueueMessage" method="_aWJ2JFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aQBY81JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aQBY9FJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXR3hFJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>SetBuildQueueMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQBY8VJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQBY8lJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQBY9VJNEeiyW7NaN4qWdw" type="_ZD0EgFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aQCAAFJNEeiyW7NaN4qWdw" name="handle" method="_aWJ2KFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXR3hVJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;setBuildQueue&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param player The &lt;code>Player&lt;/code> the message applies to.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     *&#xD;
     * @return An update containing the new queue&#xD;
     *         or an error &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQCAAVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQCAAlJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQCAA1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQCABFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_ZD6LIFJNEeiyW7NaN4qWdw" name="SetCurrentStopMessage">
                <ownedComment xmi:id="_aXR3h1JNEeiyW7NaN4qWdw">
                  <body>The message sent updating a unit's current stop.</body>
                </ownedComment>
                <generalization xmi:id="_aK3MIFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aUHOwFJNEeiyW7NaN4qWdw" name="unitId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aUH10VJNEeiyW7NaN4qWdw" name="index" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWKdNFJNEeiyW7NaN4qWdw" name="SetCurrentStopMessage" specification="_aQDOIFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWKdNVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWKdNlJNEeiyW7NaN4qWdw" name="index">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aWKdN1JNEeiyW7NaN4qWdw" type="_ZD6LIFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = unit.getId();&#xD;
     this.index = String.valueOf(index);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWLEQFJNEeiyW7NaN4qWdw" name="SetCurrentStopMessage" specification="_aQD1MFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWLEQVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWLEQlJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWLEQ1JNEeiyW7NaN4qWdw" type="_ZD6LIFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = element.getAttribute(&quot;unit&quot;);&#xD;
     this.index = element.getAttribute(&quot;index&quot;);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWLERFJNEeiyW7NaN4qWdw" name="handle" specification="_aQEcQFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWLERVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWLERlJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWLER1JNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
&#xD;
     ServerUnit serverUnit;&#xD;
     try {&#xD;
         serverUnit = serverPlayer.getOurFreeColGameObject(unitId,&#xD;
             ServerUnit.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
     TradeRoute tr = serverUnit.getTradeRoute();&#xD;
     if (tr == null) {&#xD;
         return DOMMessage.clientError(&quot;Unit has no trade route: &quot;&#xD;
             + unitId);&#xD;
     }&#xD;
&#xD;
     int count;&#xD;
     try {&#xD;
         count = Integer.parseInt(this.index);&#xD;
     } catch (NumberFormatException nfe) {&#xD;
         return DOMMessage.clientError(&quot;Stop index is not an integer: &quot; +&#xD;
             this.index);&#xD;
     }&#xD;
     if (count &lt; 0 || count > tr.getStops().size()) {&#xD;
         return DOMMessage.clientError(&quot;Invalid stop index: &quot; + this.index);&#xD;
     }&#xD;
&#xD;
     // Valid, set.&#xD;
     return server.getInGameController()&#xD;
         .setCurrentStop(serverPlayer, serverUnit, count);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWLESFJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_ZD8AUFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWLESVJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return createMessage(getXMLElementTagName(),&#xD;
         &quot;unit&quot;, unitId,&#xD;
         &quot;index&quot;, index);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWLESlJNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_ZD9OclJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWLES1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;setCurrentStop&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_ZD8AUFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aWLESFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aQFDUVJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_ZD9OclJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aWLESlJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXSeklJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;setCurrentStop&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZD9Oc1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aQDOIFJNEeiyW7NaN4qWdw" name="SetCurrentStopMessage" method="_aWKdNFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aQDOI1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aQDOJFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXR3iFJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>SetCurrentStopMessage&lt;/code> for the&#xD;
     * supplied unit.&#xD;
     *&#xD;
     * @param unit A &lt;code>Unit&lt;/code> whose stop is to be setd.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQDOIVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQDOIlJNEeiyW7NaN4qWdw" name="index">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aQDOJVJNEeiyW7NaN4qWdw" type="_ZD6LIFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aQD1MFJNEeiyW7NaN4qWdw" name="SetCurrentStopMessage" method="_aWLEQFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aQD1M1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aQD1NFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXSekFJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>SetCurrentStopMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQD1MVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQD1MlJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQD1NVJNEeiyW7NaN4qWdw" type="_ZD6LIFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aQEcQFJNEeiyW7NaN4qWdw" name="handle" method="_aWLERFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXSekVJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;setCurrentStop&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> the message is from.&#xD;
     * @return An set containing the unit after updating its&#xD;
     *     current stop, or an error &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQEcQVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQEcQlJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQFDUFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_ZEARwFJNEeiyW7NaN4qWdw" name="SetDestinationMessage">
                <ownedComment xmi:id="_aXSek1JNEeiyW7NaN4qWdw">
                  <body>The message sent when the client requests setting a unit destination.</body>
                </ownedComment>
                <generalization xmi:id="_aK4aQFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aUJD8FJNEeiyW7NaN4qWdw" name="unitId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aUJD8lJNEeiyW7NaN4qWdw" name="destinationId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWLrUFJNEeiyW7NaN4qWdw" name="SetDestinationMessage" specification="_aQFqYFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWLrUVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWLrUlJNEeiyW7NaN4qWdw" name="destination" type="_aJO0cFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWLrU1JNEeiyW7NaN4qWdw" type="_ZEARwFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = unit.getId();&#xD;
     this.destinationId = (destination == null) ? null&#xD;
         : destination.getId();&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWLrVFJNEeiyW7NaN4qWdw" name="SetDestinationMessage" specification="_aQGRcFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWLrVVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWLrVlJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWLrV1JNEeiyW7NaN4qWdw" type="_ZEARwFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = element.getAttribute(&quot;unit&quot;);&#xD;
     this.destinationId = (element.hasAttribute(&quot;destination&quot;))&#xD;
         ? element.getAttribute(&quot;destination&quot;)&#xD;
         : null;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWLrWFJNEeiyW7NaN4qWdw" name="handle" specification="_aQG4hFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWLrWVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWLrWlJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWLrW1JNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
     final Game game = serverPlayer.getGame();&#xD;
&#xD;
     Unit unit;&#xD;
     try {&#xD;
         unit = serverPlayer.getOurFreeColGameObject(unitId, Unit.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     // destination == null is OK.&#xD;
     Location destination = (destinationId == null) ? null&#xD;
         : game.findFreeColLocation(destinationId);&#xD;
&#xD;
     // Set destination&#xD;
     return server.getInGameController()&#xD;
         .setDestination(serverPlayer, unit, destination);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWMSYFJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_ZEFKQFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWMSYVJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>Element result = createMessage(getXMLElementTagName(),&#xD;
         &quot;unit&quot;, unitId);&#xD;
     if (destinationId != null) {&#xD;
         result.setAttribute(&quot;destination&quot;, destinationId);&#xD;
     }&#xD;
     return result;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWMSYlJNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_ZEGYYFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWMSY1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;setDestination&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_ZEFKQFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aWMSYFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aQHfkVJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_ZEGYYFJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aWMSYlJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXSel1JNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;setDestination&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZEG_cFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aQFqYFJNEeiyW7NaN4qWdw" name="SetDestinationMessage" method="_aWLrUFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aQFqY1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aQFqZFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXSelFJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>SetDestinationMessage&lt;/code> with the supplied unit&#xD;
     * and destination.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> whose destination is to be set&#xD;
     * @param destination The destination to set (may be null)</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQFqYVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQFqYlJNEeiyW7NaN4qWdw" name="destination" type="_aJO0cFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQFqZVJNEeiyW7NaN4qWdw" type="_ZEARwFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aQGRcFJNEeiyW7NaN4qWdw" name="SetDestinationMessage" method="_aWLrVFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aQG4gVJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aQG4glJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXSelVJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>SetDestinationMessage&lt;/code> from a supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQGRcVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQG4gFJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQG4g1JNEeiyW7NaN4qWdw" type="_ZEARwFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aQG4hFJNEeiyW7NaN4qWdw" name="handle" method="_aWLrWFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXSellJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;setDestination&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> the message is from.&#xD;
     * @return An update containing the unit with the new destination,&#xD;
     *     or an error &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQG4hVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQG4hlJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQHfkFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_ZEVB4FJNEeiyW7NaN4qWdw" name="SetGoodsLevelsMessage">
                <ownedComment xmi:id="_aXSemFJNEeiyW7NaN4qWdw">
                  <body>The message sent when setting goods levels.</body>
                </ownedComment>
                <generalization xmi:id="_aK7dkFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aUJrAVJNEeiyW7NaN4qWdw" name="colonyId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aUKSEVJNEeiyW7NaN4qWdw" name="data" visibility="private" isLeaf="true" type="_aK6PcFJNEeiyW7NaN4qWdw" isReadOnly="true" association="_acwNYVJNEeiyW7NaN4qWdw"/>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWMSZFJNEeiyW7NaN4qWdw" name="SetGoodsLevelsMessage" specification="_aQIGoFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWMSZVJNEeiyW7NaN4qWdw" name="colony" type="_aGwvQFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWMSZlJNEeiyW7NaN4qWdw" name="data" type="_aK6PcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWMSZ1JNEeiyW7NaN4qWdw" type="_ZEVB4FJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.colonyId = colony.getId();&#xD;
     this.data = data;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWM5cFJNEeiyW7NaN4qWdw" name="SetGoodsLevelsMessage" specification="_aQItsFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWM5cVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWM5clJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWM5c1JNEeiyW7NaN4qWdw" type="_ZEVB4FJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     colonyId = element.getAttribute(&quot;colony&quot;);&#xD;
     data = new ExportData((Element)element.getChildNodes().item(0));&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWM5dFJNEeiyW7NaN4qWdw" name="handle" specification="_aQJUwFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWM5dVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWM5dlJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWM5d1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWM5eFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
&#xD;
     Colony colony;&#xD;
     try {&#xD;
         colony = player.getOurFreeColGameObject(colonyId, Colony.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     // Proceed to set.&#xD;
     return server.getInGameController()&#xD;
         .setGoodsLevels(serverPlayer, colony, data);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWNggFJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_ZEYsQFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWNggVJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>Element result = createMessage(getXMLElementTagName(),&#xD;
         &quot;colony&quot;, colonyId);&#xD;
     result.appendChild(data.toXMLElement(result.getOwnerDocument()));&#xD;
     return result;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWNgglJNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_ZEahcFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWNgg1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;setGoodsLevels&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_ZEYsQFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aWNggFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aQJ70FJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_ZEahcFJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aWNgglJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXTFoFJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;setGoodsLevels&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZEahcVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aQIGoFJNEeiyW7NaN4qWdw" name="SetGoodsLevelsMessage" method="_aWMSZFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aQIGo1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aQIGpFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXSemVJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>SetGoodsLevelsMessage&lt;/code> with the&#xD;
     * supplied colony and data.&#xD;
     *&#xD;
     * @param colony The &lt;code>Colony&lt;/code> where the goods leves are set.&#xD;
     * @param data The new &lt;code>ExportData&lt;/code>.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQIGoVJNEeiyW7NaN4qWdw" name="colony" type="_aGwvQFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQIGolJNEeiyW7NaN4qWdw" name="data" type="_aK6PcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQIGpVJNEeiyW7NaN4qWdw" type="_ZEVB4FJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aQItsFJNEeiyW7NaN4qWdw" name="SetGoodsLevelsMessage" method="_aWM5cFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aQIts1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aQIttFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXSemlJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>SetGoodsLevelsMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQItsVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQItslJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQIttVJNEeiyW7NaN4qWdw" type="_ZEVB4FJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aQJUwFJNEeiyW7NaN4qWdw" name="handle" method="_aWM5dFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXSem1JNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;setGoodsLevels&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param player The &lt;code>Player&lt;/code> the message applies to.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     *&#xD;
     * @return An update &lt;code>Element&lt;/code> updating the colony.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQJUwVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQJUwlJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQJUw1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQJUxFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_ZEdkwFJNEeiyW7NaN4qWdw" name="SetTradeRoutesMessage">
                <ownedComment xmi:id="_aXTFoVJNEeiyW7NaN4qWdw">
                  <body>The message sent when setting the trade routes.</body>
                </ownedComment>
                <generalization xmi:id="_aK950FJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aULgMFJNEeiyW7NaN4qWdw" name="idPrefix" visibility="private" isLeaf="true" isStatic="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  <defaultValue xmi:type="uml:LiteralString" xmi:id="_aULgMVJNEeiyW7NaN4qWdw" value="&quot;shadow-&quot;"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aULgMlJNEeiyW7NaN4qWdw" name="tradeRoutes" visibility="private" isLeaf="true" type="_aG-xsFJNEeiyW7NaN4qWdw" isOrdered="true" isReadOnly="true" association="_ac5-YFJNEeiyW7NaN4qWdw">
                  <upperValue xmi:type="uml:LiteralUnlimitedNatural" xmi:id="_aULgM1JNEeiyW7NaN4qWdw" value="*"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWNghFJNEeiyW7NaN4qWdw" name="SetTradeRoutesMessage" specification="_aQKi4FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWNghVJNEeiyW7NaN4qWdw" name="tradeRoutes" type="_aHo5AFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWNghlJNEeiyW7NaN4qWdw" type="_ZEdkwFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.tradeRoutes = tradeRoutes;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWOHkFJNEeiyW7NaN4qWdw" name="SetTradeRoutesMessage" specification="_aQLxAVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWOHkVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWOHklJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWOHk1JNEeiyW7NaN4qWdw" type="_ZEdkwFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     List&lt;TradeRoute> newRoutes = new ArrayList&lt;>();&#xD;
     NodeList nodes = element.getChildNodes();&#xD;
     for (int i = 0; i &lt; nodes.getLength(); i++) {&#xD;
         TradeRoute route&#xD;
             = tradeRouteFromElement(game, (Element) nodes.item(i));&#xD;
         if (route != null) newRoutes.add(route);&#xD;
     }&#xD;
     this.tradeRoutes = newRoutes;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWOHlFJNEeiyW7NaN4qWdw" name="tradeRouteFromElement" specification="_aQMYEFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWOHlVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWOHllJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWOHl1JNEeiyW7NaN4qWdw" type="_aG-xsFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>String id = FreeColObject.readId(element);&#xD;
     element.setAttribute(FreeColObject.ID_ATTRIBUTE_TAG, idPrefix + id);&#xD;
     try {&#xD;
         return new TradeRoute(game, element);&#xD;
     } catch (Exception e) {&#xD;
         logger.log(Level.WARNING, &quot;Could not build trade route &quot; + id, e);&#xD;
         return null;&#xD;
     }&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWOHmFJNEeiyW7NaN4qWdw" name="getPrefix" specification="_aQM_IVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWOHmVJNEeiyW7NaN4qWdw" name="route" type="_aG-xsFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWOHmlJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return route.getId().substring(0, idPrefix.length());&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWOHm1JNEeiyW7NaN4qWdw" name="removePrefix" specification="_aQNmMFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWOHnFJNEeiyW7NaN4qWdw" name="route" type="_aG-xsFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWOHnVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return route.getId().substring(idPrefix.length());&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWOuoFJNEeiyW7NaN4qWdw" name="hasPrefix" specification="_aQONQFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWOuoVJNEeiyW7NaN4qWdw" name="route" type="_aG-xsFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWOuolJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return idPrefix.equals(getPrefix(route));&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWOuo1JNEeiyW7NaN4qWdw" name="handle" specification="_aQONQ1JNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWOupFJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWOupVJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWOuplJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
     final Game game = server.getGame();&#xD;
&#xD;
     String errors = &quot;&quot;;&#xD;
     for (TradeRoute tradeRoute : tradeRoutes) {&#xD;
         if (tradeRoute.getId() == null || !hasPrefix(tradeRoute)) {&#xD;
             errors += &quot;Bogus route: &quot; + tradeRoute.getId() + &quot;. &quot;;&#xD;
             continue;&#xD;
         }&#xD;
         String id = removePrefix(tradeRoute);&#xD;
         TradeRoute realRoute;&#xD;
         try {&#xD;
             realRoute = serverPlayer.getOurFreeColGameObject(id,&#xD;
                 TradeRoute.class);&#xD;
         } catch (Exception e) {&#xD;
             errors += e.getMessage() + &quot;. &quot;;&#xD;
             continue;&#xD;
         }&#xD;
     }&#xD;
     if (errors != null &amp;&amp; !errors.isEmpty()) return DOMMessage.clientError(errors);&#xD;
     &#xD;
     List&lt;TradeRoute> newRoutes = new ArrayList&lt;>();&#xD;
     for (TradeRoute tradeRoute : tradeRoutes) {&#xD;
         TradeRoute realRoute&#xD;
             = game.getFreeColGameObject(removePrefix(tradeRoute),&#xD;
                                         TradeRoute.class);&#xD;
         realRoute.updateFrom(tradeRoute);&#xD;
         newRoutes.add(realRoute);&#xD;
         tradeRoute.dispose();&#xD;
     }&#xD;
&#xD;
     // Proceed to set trade routes&#xD;
     return server.getInGameController()&#xD;
         .setTradeRoutes(serverPlayer, newRoutes);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWOup1JNEeiyW7NaN4qWdw" name="toXMLElement" specification="_ZEgBAFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWOuqFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>Element result = createMessage(getXMLElementTagName());&#xD;
     for (TradeRoute tradeRoute : tradeRoutes) {&#xD;
         result.appendChild(tradeRoute.toXMLElement(result.getOwnerDocument()));&#xD;
     }&#xD;
     return result;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWOuqVJNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_ZEhPIFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWOuqlJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;setTradeRoutes&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_ZEgBAFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aWOup1JNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aQO0UlJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_ZEhPIFJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aWOuqVJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXTFplJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;setTradeRoutes&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZEhPIVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aQKi4FJNEeiyW7NaN4qWdw" name="SetTradeRoutesMessage" method="_aWNghFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aQKi4lJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aQKi41JNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXTFolJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>SetTradeRoutesMessage&lt;/code> with the&#xD;
     * supplied routes.&#xD;
     *&#xD;
     * @param tradeRoutes A list of &lt;code>TradeRoute&lt;/code>s to set.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQKi4VJNEeiyW7NaN4qWdw" name="tradeRoutes" type="_aHo5AFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQKi5FJNEeiyW7NaN4qWdw" type="_ZEdkwFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aQLxAVJNEeiyW7NaN4qWdw" name="SetTradeRoutesMessage" method="_aWOHkFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aQLxBFJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aQLxBVJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXTFo1JNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>SetTradeRoutesMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQLxAlJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQLxA1JNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQLxBlJNEeiyW7NaN4qWdw" type="_ZEdkwFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aQMYEFJNEeiyW7NaN4qWdw" name="tradeRouteFromElement" isStatic="true" method="_aWOHlFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXTFpFJNEeiyW7NaN4qWdw">
                    <body>Creates a trade route from an element.  Be careful not to allow&#xD;
     * real IDs to surface or the trade route constructor will replace&#xD;
     * the existing game trade route with the one in the element&#xD;
     * before we have finished checking it.&#xD;
     *&#xD;
     * Public routine as updateTradeRoute has the same problem.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> to create in.&#xD;
     * @param element An &lt;code>Element&lt;/code> to read from.&#xD;
     * @return A &lt;code>TradeRoute&lt;/code> on success, null on error.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQMYEVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQMYElJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQM_IFJNEeiyW7NaN4qWdw" type="_aG-xsFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aQM_IVJNEeiyW7NaN4qWdw" name="getPrefix" isStatic="true" method="_aWOHmFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aQM_IlJNEeiyW7NaN4qWdw" name="route" type="_aG-xsFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQM_I1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aQNmMFJNEeiyW7NaN4qWdw" name="removePrefix" isStatic="true" method="_aWOHm1JNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aQNmMVJNEeiyW7NaN4qWdw" name="route" type="_aG-xsFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQNmMlJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aQONQFJNEeiyW7NaN4qWdw" name="hasPrefix" isStatic="true" method="_aWOuoFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aQONQVJNEeiyW7NaN4qWdw" name="route" type="_aG-xsFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQONQlJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aQONQ1JNEeiyW7NaN4qWdw" name="handle" method="_aWOuo1JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXTFpVJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;setTradeRoutes&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     * @return Null, or an error &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQONRFJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQO0UFJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQO0UVJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_ZElgkFJNEeiyW7NaN4qWdw" name="SpySettlementMessage">
                <ownedComment xmi:id="_aXTFp1JNEeiyW7NaN4qWdw">
                  <body>The message sent when spying on a settlement.</body>
                </ownedComment>
                <generalization xmi:id="_aLAWEFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aUMuUFJNEeiyW7NaN4qWdw" name="unitId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aUNVYFJNEeiyW7NaN4qWdw" name="directionString" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWPVsFJNEeiyW7NaN4qWdw" name="SpySettlementMessage" specification="_aQPbYFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWPVsVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWPVslJNEeiyW7NaN4qWdw" name="direction" type="_aG4EAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWPVs1JNEeiyW7NaN4qWdw" type="_ZElgkFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = unit.getId();&#xD;
     this.directionString = String.valueOf(direction);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWPVtFJNEeiyW7NaN4qWdw" name="SpySettlementMessage" specification="_aQQCcVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWPVtVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWPVtlJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWPVt1JNEeiyW7NaN4qWdw" type="_ZElgkFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.unitId = element.getAttribute(&quot;unit&quot;);&#xD;
     this.directionString = element.getAttribute(&quot;direction&quot;);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWP8wFJNEeiyW7NaN4qWdw" name="handle" specification="_aQQpg1JNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWP8wVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWP8wlJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWP8w1JNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
&#xD;
     Unit unit;&#xD;
     try {&#xD;
         unit = serverPlayer.getOurFreeColGameObject(unitId, Unit.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
     if (!unit.hasAbility(Ability.SPY_ON_COLONY)) {&#xD;
         return DOMMessage.clientError(&quot;Unit lacks ability&quot;&#xD;
             + &quot; to spy on colony: &quot; + unitId);&#xD;
     }&#xD;
&#xD;
     Tile tile;&#xD;
     try {&#xD;
         tile = unit.getNeighbourTile(directionString);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     Settlement settlement = tile.getSettlement();&#xD;
     if (settlement == null) {&#xD;
         return DOMMessage.clientError(&quot;There is no settlement at: &quot;&#xD;
             + tile.getId());&#xD;
     }&#xD;
&#xD;
     MoveType type = unit.getMoveType(settlement.getTile());&#xD;
     if (type != MoveType.ENTER_FOREIGN_COLONY_WITH_SCOUT) {&#xD;
         return DOMMessage.clientError(&quot;Unable to enter at: &quot;&#xD;
             + settlement.getName() + &quot;: &quot; + type.whyIllegal());&#xD;
     }&#xD;
&#xD;
     // Spy on the settlement&#xD;
     return server.getInGameController()&#xD;
         .spySettlement(serverPlayer, unit, settlement);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWP8xFJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_ZEnVwFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWP8xVJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return createMessage(getXMLElementTagName(),&#xD;
         &quot;unit&quot;, unitId,&#xD;
         &quot;direction&quot;, directionString);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWP8xlJNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_ZEn80lJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWP8x1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;spySettlement&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_ZEnVwFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aWP8xFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aQRQk1JNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_ZEn80lJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aWP8xlJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXTssFJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;spySettlement&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZEoj4FJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aQPbYFJNEeiyW7NaN4qWdw" name="SpySettlementMessage" method="_aWPVsFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aQPbY1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aQPbZFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXTFqFJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>SpySettlementMessage&lt;/code> with the&#xD;
     * supplied unit and direction.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is spying.&#xD;
     * @param direction The &lt;code>Direction&lt;/code> the unit is looking.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQPbYVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQPbYlJNEeiyW7NaN4qWdw" name="direction" type="_aG4EAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQQCcFJNEeiyW7NaN4qWdw" type="_ZElgkFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aQQCcVJNEeiyW7NaN4qWdw" name="SpySettlementMessage" method="_aWPVtFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aQQpgFJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aQQpgVJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXTFqVJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>SpySettlementMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQQCclJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQQCc1JNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQQpglJNEeiyW7NaN4qWdw" type="_ZElgkFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aQQpg1JNEeiyW7NaN4qWdw" name="handle" method="_aWP8wFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXTFqlJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;spySettlement&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> that is handling&#xD;
     *     the message.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> the message was&#xD;
     *     received on.&#xD;
     * @return An &lt;code>Element&lt;/code> containing a representation of&#xD;
     *     the settlement being spied upon and any units at that&#xD;
     *     position, or an error &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQRQkFJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQRQkVJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQRQklJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_ZErAIFJNEeiyW7NaN4qWdw" name="TrainUnitInEuropeMessage">
                <ownedComment xmi:id="_aXTssVJNEeiyW7NaN4qWdw">
                  <body>The message sent when training a unit in Europe.</body>
                </ownedComment>
                <generalization xmi:id="_aLCyUFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aUN8cFJNEeiyW7NaN4qWdw" name="typeId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWP8yFJNEeiyW7NaN4qWdw" name="TrainUnitInEuropeMessage" specification="_aQR3oFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWP8yVJNEeiyW7NaN4qWdw" name="type" type="_aLBkMFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWP8ylJNEeiyW7NaN4qWdw" type="_ZErAIFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.typeId = type.getId();&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWQj0FJNEeiyW7NaN4qWdw" name="TrainUnitInEuropeMessage" specification="_aQSesFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWQj0VJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWQj0lJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWQj01JNEeiyW7NaN4qWdw" type="_ZErAIFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.typeId = element.getAttribute(&quot;unitType&quot;);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWQj1FJNEeiyW7NaN4qWdw" name="handle" specification="_aQTFwFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWQj1VJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWQj1lJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWQj11JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWQj2FJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
&#xD;
     UnitType type = server.getSpecification().getUnitType(typeId);&#xD;
     if (type == null) {&#xD;
         return DOMMessage.clientError(&quot;Not a unit type: &quot; + typeId);&#xD;
     }&#xD;
&#xD;
     // Proceed to train a unit.&#xD;
     return server.getInGameController()&#xD;
         .trainUnitInEurope(serverPlayer, type);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWQj2VJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_ZEs1UFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWQj2lJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return createMessage(getXMLElementTagName(),&#xD;
         &quot;unitType&quot;, typeId);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWQj21JNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_ZEuDcFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWQj3FJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;trainUnitInEurope&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_ZEs1UFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aWQj2VJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aQTs01JNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_ZEuDcFJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aWQj21JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXTstVJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;trainUnitInEurope&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZEuDcVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aQR3oFJNEeiyW7NaN4qWdw" name="TrainUnitInEuropeMessage" method="_aWP8yFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aQR3olJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aQR3o1JNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXTsslJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>TrainUnitInEuropeMessage&lt;/code> with the&#xD;
     * supplied type.&#xD;
     *&#xD;
     * @param type The &lt;code>UnitType&lt;/code> to train.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQR3oVJNEeiyW7NaN4qWdw" name="type" type="_aLBkMFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQR3pFJNEeiyW7NaN4qWdw" type="_ZErAIFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aQSesFJNEeiyW7NaN4qWdw" name="TrainUnitInEuropeMessage" method="_aWQj0FJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aQSes1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aQSetFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXTss1JNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>TrainUnitInEuropeMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQSesVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQSeslJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQSetVJNEeiyW7NaN4qWdw" type="_ZErAIFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aQTFwFJNEeiyW7NaN4qWdw" name="handle" method="_aWQj1FJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXTstFJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;trainUnitInEurope&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param player The &lt;code>Player&lt;/code> the message applies to.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     *&#xD;
     * @return An update containing the trainUnitInEuroped unit,&#xD;
     *         or an error &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQTFwVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQTs0FJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQTs0VJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQTs0lJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_ZExGwFJNEeiyW7NaN4qWdw" name="TrivialMessage" visibility="package">
                <ownedComment xmi:id="_aXTstlJNEeiyW7NaN4qWdw">
                  <body>A trivial message.  That is, it contains only simple string&#xD;
attributes.</body>
                </ownedComment>
                <generalization xmi:id="_aLEAcFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aUPKkFJNEeiyW7NaN4qWdw" name="tag" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aUPKklJNEeiyW7NaN4qWdw" name="attributes" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  <upperValue xmi:type="uml:LiteralUnlimitedNatural" xmi:id="_aUPxoFJNEeiyW7NaN4qWdw" value="*"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWRK4FJNEeiyW7NaN4qWdw" name="TrivialMessage" specification="_ZEyU4FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWRK4VJNEeiyW7NaN4qWdw" name="tag">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aWRK4lJNEeiyW7NaN4qWdw" name="attributes">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    <upperValue xmi:type="uml:LiteralUnlimitedNatural" xmi:id="_aWRK41JNEeiyW7NaN4qWdw" value="*"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aWRK5FJNEeiyW7NaN4qWdw" type="_ZExGwFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(tag);&#xD;
&#xD;
     this.tag = tag;&#xD;
     this.attributes = attributes;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWRx8FJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_ZEy78lJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWRx8VJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return DOMMessage.createMessage(tag, attributes);&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_ZEyU4FJNEeiyW7NaN4qWdw" name="TrivialMessage" method="_aWRK4FJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_ZEyU41JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_ZEyU5FJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedParameter xmi:id="_ZEyU4VJNEeiyW7NaN4qWdw" name="tag">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_ZEyU4lJNEeiyW7NaN4qWdw" name="attributes">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    <upperValue xmi:type="uml:LiteralUnlimitedNatural" xmi:id="_ZEy78FJNEeiyW7NaN4qWdw" value="*"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_ZEyU5lJNEeiyW7NaN4qWdw" type="_ZExGwFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_ZEy78lJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aWRx8FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aQUT4FJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_ZE0xIFJNEeiyW7NaN4qWdw" name="UnloadGoodsMessage">
                <ownedComment xmi:id="_aXTst1JNEeiyW7NaN4qWdw">
                  <body>The message sent when unloading goods.</body>
                </ownedComment>
                <generalization xmi:id="_aLFOkFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aUQYsFJNEeiyW7NaN4qWdw" name="goodsTypeId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aUQYslJNEeiyW7NaN4qWdw" name="amountString" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aUQ_wVJNEeiyW7NaN4qWdw" name="carrierId" visibility="private" isLeaf="true" isReadOnly="true">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWRx8lJNEeiyW7NaN4qWdw" name="UnloadGoodsMessage" specification="_aQU68FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWRx81JNEeiyW7NaN4qWdw" name="goodsType" type="_aHcEsFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWRx9FJNEeiyW7NaN4qWdw" name="amount">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aWRx9VJNEeiyW7NaN4qWdw" name="carrier" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWRx9lJNEeiyW7NaN4qWdw" type="_ZE0xIFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.goodsTypeId = goodsType.getId();&#xD;
     this.amountString = Integer.toString(amount);&#xD;
     this.carrierId = carrier.getId();&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWRx91JNEeiyW7NaN4qWdw" name="UnloadGoodsMessage" specification="_aQViAFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWRx-FJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWRx-VJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWRx-lJNEeiyW7NaN4qWdw" type="_ZE0xIFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.goodsTypeId = element.getAttribute(&quot;type&quot;);&#xD;
     this.amountString = element.getAttribute(&quot;amount&quot;);&#xD;
     this.carrierId = element.getAttribute(&quot;carrier&quot;);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWSZAFJNEeiyW7NaN4qWdw" name="handle" specification="_aQWJEFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWSZAVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWSZAlJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWSZA1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWSZBFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
&#xD;
     Unit carrier;&#xD;
     try {&#xD;
         carrier = player.getOurFreeColGameObject(carrierId, Unit.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
     if (!carrier.canCarryGoods()) {&#xD;
         return DOMMessage.clientError(&quot;Not a goods carrier: &quot; + carrierId);&#xD;
     }&#xD;
     // Do not check location, carriers can dump goods anywhere&#xD;
&#xD;
     GoodsType type = server.getSpecification().getGoodsType(goodsTypeId);&#xD;
     if (type == null) {&#xD;
         return DOMMessage.clientError(&quot;Not a goods type: &quot; + goodsTypeId);&#xD;
     }&#xD;
&#xD;
     int amount;&#xD;
     try {&#xD;
         amount = Integer.parseInt(amountString);&#xD;
     } catch (NumberFormatException e) {&#xD;
         return DOMMessage.clientError(&quot;Bad amount: &quot; + amountString);&#xD;
     }&#xD;
     if (amount &lt;= 0) {&#xD;
         return DOMMessage.clientError(&quot;Amount must be positive: &quot;&#xD;
                                    + amountString);&#xD;
     }&#xD;
     int present = carrier.getGoodsCount(type);&#xD;
     if (present &lt; amount) {&#xD;
         return DOMMessage.clientError(&quot;Attempt to unload &quot; + amount&#xD;
             + &quot; &quot; + type.getId() + &quot; but only &quot; + present + &quot; present.&quot;);&#xD;
     }&#xD;
&#xD;
     // Try to unload.&#xD;
     return server.getInGameController()&#xD;
         .unloadGoods(serverPlayer, type, amount, carrier);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWSZBVJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_ZE3NYFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWSZBlJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return createMessage(getXMLElementTagName(),&#xD;
         &quot;type&quot;, goodsTypeId,&#xD;
         &quot;amount&quot;, amountString,&#xD;
         &quot;carrier&quot;, carrierId);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWSZB1JNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_ZE30c1JNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWSZCFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;unloadGoods&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_ZE3NYFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aWSZBVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aQWJFVJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_ZE30c1JNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aWSZB1JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXUTwVJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;unloadGoods&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZE4bgFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aQU68FJNEeiyW7NaN4qWdw" name="UnloadGoodsMessage" method="_aWRx8lJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aQU69FJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aQU69VJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXTsuFJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>UnloadGoodsMessage&lt;/code>.&#xD;
     *&#xD;
     * @param goodsType The &lt;code>GoodsType&lt;/code> to unload.&#xD;
     * @param amount The amount of goods to unload.&#xD;
     * @param carrier The &lt;code>Unit&lt;/code> carrying the goods.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQU68VJNEeiyW7NaN4qWdw" name="goodsType" type="_aHcEsFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQU68lJNEeiyW7NaN4qWdw" name="amount">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aQU681JNEeiyW7NaN4qWdw" name="carrier" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQU69lJNEeiyW7NaN4qWdw" type="_ZE0xIFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aQViAFJNEeiyW7NaN4qWdw" name="UnloadGoodsMessage" method="_aWRx91JNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aQViA1JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aQViBFJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXTsuVJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>UnloadGoodsMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQViAVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQViAlJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQViBVJNEeiyW7NaN4qWdw" type="_ZE0xIFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aQWJEFJNEeiyW7NaN4qWdw" name="handle" method="_aWSZAFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXUTwFJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;unloadGoods&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param player The &lt;code>Player&lt;/code> the message applies to.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     * @return An update containing the carrier, or an error&#xD;
     *     &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQWJEVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQWJElJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQWJE1JNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQWJFFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_ZE8F4FJNEeiyW7NaN4qWdw" name="UpdateTradeRouteMessage">
                <ownedComment xmi:id="_aXUTwlJNEeiyW7NaN4qWdw">
                  <body>The message sent when updating a trade route.</body>
                </ownedComment>
                <generalization xmi:id="_aLHDwFJNEeiyW7NaN4qWdw" general="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_aUSN4FJNEeiyW7NaN4qWdw" name="tradeRoute" visibility="private" isLeaf="true" type="_aG-xsFJNEeiyW7NaN4qWdw" isReadOnly="true" association="_adAsEVJNEeiyW7NaN4qWdw"/>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWTAEFJNEeiyW7NaN4qWdw" name="UpdateTradeRouteMessage" specification="_aQWwIFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWTAEVJNEeiyW7NaN4qWdw" name="tradeRoute" type="_aG-xsFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWTAElJNEeiyW7NaN4qWdw" type="_ZE8F4FJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     this.tradeRoute = tradeRoute;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWTAE1JNEeiyW7NaN4qWdw" name="UpdateTradeRouteMessage" specification="_aQXXMVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWTAFFJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWTAFVJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWTAFlJNEeiyW7NaN4qWdw" type="_ZE8F4FJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(getXMLElementTagName());&#xD;
&#xD;
     tradeRoute = (element.getChildNodes().getLength() != 1) ? null&#xD;
         : SetTradeRoutesMessage.tradeRouteFromElement(game,&#xD;
               (Element) element.getChildNodes().item(0));&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWTAF1JNEeiyW7NaN4qWdw" name="handle" specification="_aQX-QFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWTAGFJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWTAGVJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWTAGlJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerPlayer serverPlayer = server.getPlayer(connection);&#xD;
&#xD;
     if (tradeRoute == null || tradeRoute.getId() == null&#xD;
         || !SetTradeRoutesMessage.hasPrefix(tradeRoute)) {&#xD;
         return DOMMessage.clientError(&quot;Bogus route&quot;);&#xD;
     }&#xD;
&#xD;
     String id = SetTradeRoutesMessage.removePrefix(tradeRoute);&#xD;
     TradeRoute realRoute;&#xD;
     try {&#xD;
         realRoute = serverPlayer.getOurFreeColGameObject(id, &#xD;
             TradeRoute.class);&#xD;
     } catch (Exception e) {&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
&#xD;
     realRoute.updateFrom(tradeRoute);&#xD;
     tradeRoute.dispose();&#xD;
     return null;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWTnIFJNEeiyW7NaN4qWdw" name="toXMLElement" specification="_ZE9UAFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWTnIVJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>Element result = createMessage(getXMLElementTagName());&#xD;
     result.appendChild(tradeRoute.toXMLElement(result.getOwnerDocument()));&#xD;
     return result;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWTnIlJNEeiyW7NaN4qWdw" name="getXMLElementTagName" specification="_ZE-iIVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWTnI1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return &quot;updateTradeRoute&quot;;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_ZE9UAFJNEeiyW7NaN4qWdw" name="toXMLElement" method="_aWTnIFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aQX-RFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_ZE-iIVJNEeiyW7NaN4qWdw" name="getXMLElementTagName" isStatic="true" method="_aWTnIlJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXUTxlJNEeiyW7NaN4qWdw">
                    <body>The tag name of the root element representing this object.&#xD;
     *&#xD;
     * @return &quot;updateTradeRoute&quot;.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZE-iIlJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aQWwIFJNEeiyW7NaN4qWdw" name="UpdateTradeRouteMessage" method="_aWTAEFJNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aQWwIlJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aQWwI1JNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXUTw1JNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>UpdateTradeRouteMessage&lt;/code> with the&#xD;
     * supplied trade route.&#xD;
     *&#xD;
     * @param tradeRoute The &lt;code>TradeRoute&lt;/code> to update.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQWwIVJNEeiyW7NaN4qWdw" name="tradeRoute" type="_aG-xsFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQXXMFJNEeiyW7NaN4qWdw" type="_ZE8F4FJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aQXXMVJNEeiyW7NaN4qWdw" name="UpdateTradeRouteMessage" method="_aWTAE1JNEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_aQXXNFJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_aQXXNVJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_aXUTxFJNEeiyW7NaN4qWdw">
                    <body>Create a new &lt;code>UpdateTradeRouteMessage&lt;/code> from a&#xD;
     * supplied element.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> this message belongs to.&#xD;
     * @param element The &lt;code>Element&lt;/code> to use to create the message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQXXMlJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQXXM1JNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQXXNlJNEeiyW7NaN4qWdw" type="_ZE8F4FJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aQX-QFJNEeiyW7NaN4qWdw" name="handle" method="_aWTAF1JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXUTxVJNEeiyW7NaN4qWdw">
                    <body>Handle a &quot;updateTradeRoute&quot;-message.&#xD;
     *&#xD;
     * @param server The &lt;code>FreeColServer&lt;/code> handling the message.&#xD;
     * @param connection The &lt;code>Connection&lt;/code> message was received on.&#xD;
     *&#xD;
     * @return An update containing the updateTradeRouted unit,&#xD;
     *         or an error &lt;code>Element&lt;/code> on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQX-QVJNEeiyW7NaN4qWdw" name="server" type="_aGzLgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQX-QlJNEeiyW7NaN4qWdw" name="connection" type="_Y8LLcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQX-Q1JNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_ZFA-YFJNEeiyW7NaN4qWdw" name="ServerAPI" isAbstract="true">
                <ownedComment xmi:id="_aXUTx1JNEeiyW7NaN4qWdw">
                  <body>The API for client->server messaging.</body>
                </ownedComment>
                <ownedAttribute xmi:id="_aUS08FJNEeiyW7NaN4qWdw" name="logger" visibility="private" isLeaf="true" isStatic="true" type="_aH_eUVJNEeiyW7NaN4qWdw" isReadOnly="true" association="_adIA0VJNEeiyW7NaN4qWdw">
                  <defaultValue xmi:type="uml:LiteralString" xmi:id="_aUS08VJNEeiyW7NaN4qWdw" value="Logger.getLogger(ServerAPI.class.getName())"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_aUTcAFJNEeiyW7NaN4qWdw" name="client" visibility="private" type="_Y7vtoFJNEeiyW7NaN4qWdw" association="_adPVkFJNEeiyW7NaN4qWdw"/>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWTnJFJNEeiyW7NaN4qWdw" name="send" specification="_aQbBklJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWTnJVJNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWTnJlJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>try {&#xD;
         client.send(element);&#xD;
     } catch (IOException e) {&#xD;
         logger.log(Level.WARNING, &quot;Could not send: &quot; + element, e);&#xD;
     }&#xD;
     return false;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWUOMFJNEeiyW7NaN4qWdw" name="send" specification="_aLQNsFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWUOMVJNEeiyW7NaN4qWdw" name="message" type="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWUOMlJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>try {&#xD;
         client.send(message);&#xD;
         return true;&#xD;
     } catch (IOException ioe) {&#xD;
         logger.log(Level.WARNING, &quot;Could not send: &quot; + message.getType(),&#xD;
                    ioe);&#xD;
     }&#xD;
     return false;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWUOM1JNEeiyW7NaN4qWdw" name="sendAndWait" specification="_aLQ0wVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWUONFJNEeiyW7NaN4qWdw" name="message" type="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWUONVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>try {&#xD;
         client.sendAndWait(message);&#xD;
         return true;&#xD;
     } catch (IOException ioe) {&#xD;
         logger.log(Level.WARNING, &quot;Could not send: &quot; + message.getType(),&#xD;
                    ioe);&#xD;
     }&#xD;
     return false;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWUONlJNEeiyW7NaN4qWdw" name="ask" specification="_aLRb0FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWUON1JNEeiyW7NaN4qWdw" name="message" type="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWUOOFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>Element reply = null;&#xD;
     try {&#xD;
         reply = client.ask(message);&#xD;
     } catch (IOException ioe) {&#xD;
         logger.log(Level.WARNING, &quot;Could not ask: &quot; + message.getType(),&#xD;
                    ioe);&#xD;
     }&#xD;
     return reply;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWU1QFJNEeiyW7NaN4qWdw" name="resolve" specification="_aQboolJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWU1QVJNEeiyW7NaN4qWdw" name="request" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <language>java</language>
                  <body>while (request != null) {&#xD;
         try {&#xD;
             request = client.handleReply(client.ask(request));&#xD;
         } catch (IOException ioe) {&#xD;
             logger.warning(&quot;Could not resolve: &quot; + request.getTagName());&#xD;
             break;&#xD;
         }&#xD;
     }&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWU1QlJNEeiyW7NaN4qWdw" name="askExpecting" specification="_aQcPsFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWU1Q1JNEeiyW7NaN4qWdw" name="message" type="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWU1RFJNEeiyW7NaN4qWdw" name="tag">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aWU1RVJNEeiyW7NaN4qWdw" name="results" type="_aKbuUVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWU1RlJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>Element reply = ask(message);&#xD;
     if (reply == null) return null;&#xD;
&#xD;
     if (&quot;error&quot;.equals(reply.getTagName())) {&#xD;
         String messageId = reply.getAttribute(&quot;messageID&quot;);&#xD;
         String messageText = reply.getAttribute(&quot;message&quot;);&#xD;
         if (messageId != null &amp;&amp; messageText != null&#xD;
             &amp;&amp; FreeColDebugger.isInDebugMode(FreeColDebugger.DebugMode.COMMS)) {&#xD;
             // If debugging suppress the bland but i18n compliant&#xD;
             // failure message in favour of the higher detail&#xD;
             // non-i18n text.&#xD;
             reply.removeAttribute(&quot;messageID&quot;);&#xD;
         }&#xD;
         logger.warning(&quot;ServerAPI. &quot; + message.getType() + &quot; error,&quot;&#xD;
             + &quot; messageId: &quot; + messageId&#xD;
             + &quot; message: &quot; + messageText);&#xD;
         client.handleReply(reply);&#xD;
         return null;&#xD;
     }&#xD;
&#xD;
     // Success!&#xD;
     if (tag == null || tag.equals(reply.getTagName())) {&#xD;
         // Do the standard processing.&#xD;
         doClientProcessingFor(reply);&#xD;
         // Look for special attributes&#xD;
         if (results != null) {&#xD;
             if (results.containsKey(&quot;*&quot;)) {&#xD;
                 results.remove(&quot;*&quot;);&#xD;
                 int len = reply.getAttributes().getLength();&#xD;
                 for (int i = 0; i &lt; len; i++) {&#xD;
                     Node n = reply.getAttributes().item(i);&#xD;
                     results.put(n.getNodeName(), n.getNodeValue());&#xD;
                 }&#xD;
             } else {&#xD;
                 for (String k : results.keySet()) {&#xD;
                     if (reply.hasAttribute(k)) {&#xD;
                         results.put(k, reply.getAttribute(k));&#xD;
                     }&#xD;
                 }&#xD;
             }&#xD;
         }&#xD;
         return reply;&#xD;
     }&#xD;
&#xD;
     // Process multiple returns, pick out expected element if present&#xD;
     if (&quot;multiple&quot;.equals(reply.getTagName())) {&#xD;
         List&lt;Element> replies = new ArrayList&lt;>();&#xD;
         NodeList nodes = reply.getChildNodes();&#xD;
         Element result = null;&#xD;
&#xD;
         for (int i = 0; i &lt; nodes.getLength(); i++) {&#xD;
             if (nodes.item(i) instanceof Element&#xD;
                 &amp;&amp; ((Element)nodes.item(i)).getTagName().equals(tag)) {&#xD;
                 result = (Element)nodes.item(i);&#xD;
             } else {&#xD;
                 Element e = client.handleReply((Element)nodes.item(i));&#xD;
                 if (e != null) replies.add(e);&#xD;
             }&#xD;
         }&#xD;
         resolve(DOMMessage.collapseElements(replies));&#xD;
         if (result != null) return result;&#xD;
     }&#xD;
&#xD;
     // Unexpected reply.  Whine and fail.&#xD;
     String complaint = &quot;Received reply with tag &quot; + reply.getTagName()&#xD;
         + &quot; which should have been &quot; + tag&#xD;
         + &quot; to message &quot; + message;&#xD;
     logger.warning(complaint);&#xD;
     doRaiseErrorMessage(complaint);&#xD;
     return null;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWU1R1JNEeiyW7NaN4qWdw" name="askHandling" specification="_aQmnwFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWU1SFJNEeiyW7NaN4qWdw" name="message" type="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWU1SVJNEeiyW7NaN4qWdw" name="tag">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aWU1SlJNEeiyW7NaN4qWdw" name="results" type="_aKbuUVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWU1S1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>Element reply = askExpecting(message, tag, results);&#xD;
     if (reply == null) return false;&#xD;
     resolve(client.handleReply(reply));&#xD;
     return true;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWVcUFJNEeiyW7NaN4qWdw" name="loadMap" specification="_ZFHFAFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWVcUVJNEeiyW7NaN4qWdw" name="queries">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    <upperValue xmi:type="uml:LiteralUnlimitedNatural" xmi:id="_aWVcUlJNEeiyW7NaN4qWdw" value="*"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aWVcU1JNEeiyW7NaN4qWdw" type="_aKbuUVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>HashMap&lt;String, String> result = new HashMap&lt;>();&#xD;
     for (String q : queries) result.put(q, null);&#xD;
     return result;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWVcVFJNEeiyW7NaN4qWdw" name="getHost" specification="_ZFI6MFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWVcVVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return (client == null) ? null : client.getHost();&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWVcVlJNEeiyW7NaN4qWdw" name="getPort" specification="_ZFJhQFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWVcV1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return (client == null) ? -1 : client.getPort();&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWVcWFJNEeiyW7NaN4qWdw" name="getConnection" specification="_ZFJhQlJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWVcWVJNEeiyW7NaN4qWdw" type="_Y8LLcFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return (client == null) ? null : client.getConnection();&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWVcWlJNEeiyW7NaN4qWdw" name="registerMessageHandler" specification="_aLSC4VJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWVcW1JNEeiyW7NaN4qWdw" name="messageHandler" type="_ZAlKUFJNEeiyW7NaN4qWdw"/>
                  <language>java</language>
                  <body>if (client != null) {&#xD;
         client.setMessageHandler(messageHandler);&#xD;
     }&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWWDYFJNEeiyW7NaN4qWdw" name="disconnect" specification="_ZFKIUFJNEeiyW7NaN4qWdw">
                  <language>java</language>
                  <body>if (client != null) {&#xD;
         client.disconnect();&#xD;
         reset();&#xD;
     }&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWWDYVJNEeiyW7NaN4qWdw" name="reset" specification="_ZFKIUVJNEeiyW7NaN4qWdw">
                  <language>java</language>
                  <body>client = null;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWWDYlJNEeiyW7NaN4qWdw" name="connect" specification="_aLSp8FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWWDY1JNEeiyW7NaN4qWdw" name="threadName">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aWWDZFJNEeiyW7NaN4qWdw" name="host">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aWWDZVJNEeiyW7NaN4qWdw" name="port">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aWWDZlJNEeiyW7NaN4qWdw" name="messageHandler" type="_ZAlKUFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWWDZ1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>int tries;&#xD;
     if (port &lt; 0) {&#xD;
         port = FreeCol.getServerPort();&#xD;
         tries = 10;&#xD;
     } else {&#xD;
         tries = 1;&#xD;
     }&#xD;
     for (int i = tries; i > 0; i--) {&#xD;
         try {&#xD;
             client = new Client(host, port, messageHandler, threadName);&#xD;
             if (client != null) break;&#xD;
         } catch (IOException e) {&#xD;
             if (i &lt;= 1) throw e;&#xD;
         }&#xD;
     }&#xD;
     return client != null;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWWDaFJNEeiyW7NaN4qWdw" name="abandonColony" specification="_aQrgQFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWWDaVJNEeiyW7NaN4qWdw" name="colony" type="_aGwvQFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWWDalJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new AbandonColonyMessage(colony),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWWqcFJNEeiyW7NaN4qWdw" name="answerMonarch" specification="_aQujkFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWWqcVJNEeiyW7NaN4qWdw" name="action" type="_aKA3kFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWWqclJNEeiyW7NaN4qWdw" name="accept">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aWWqc1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new MonarchActionMessage(action, null, &quot;&quot;)&#xD;
         .setResult(accept),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWWqdFJNEeiyW7NaN4qWdw" name="askSkill" specification="_aQvxsFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWWqdVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWWqdlJNEeiyW7NaN4qWdw" name="direction" type="_aG4EAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWWqd1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new AskSkillMessage(unit, direction),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWXRgFJNEeiyW7NaN4qWdw" name="assignTeacher" specification="_aQwYwFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWXRgVJNEeiyW7NaN4qWdw" name="student" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWXRglJNEeiyW7NaN4qWdw" name="teacher" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWXRg1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new AssignTeacherMessage(student, teacher),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWXRhFJNEeiyW7NaN4qWdw" name="assignTradeRoute" specification="_aQxm4FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWXRhVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWXRhlJNEeiyW7NaN4qWdw" name="tradeRoute" type="_aG-xsFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWXRh1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new AssignTradeRouteMessage(unit, tradeRoute),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWXRiFJNEeiyW7NaN4qWdw" name="attack" specification="_aQyN8FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWXRiVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWXRilJNEeiyW7NaN4qWdw" name="direction" type="_aG4EAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWXRi1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new AttackMessage(unit, direction),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWX4kFJNEeiyW7NaN4qWdw" name="buildColony" specification="_aQy1AVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWX4kVJNEeiyW7NaN4qWdw" name="name">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aWX4klJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWX4k1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new BuildColonyMessage(name, unit),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWX4lFJNEeiyW7NaN4qWdw" name="buyFromSettlement" specification="_aQ0DIFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWX4lVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWX4llJNEeiyW7NaN4qWdw" name="settlement" type="_aHKX4VJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWX4l1JNEeiyW7NaN4qWdw" name="goods" type="_aHJw0FJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWX4mFJNEeiyW7NaN4qWdw" name="gold">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aWX4mVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new BuyMessage(unit, settlement, goods, gold),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWX4mlJNEeiyW7NaN4qWdw" name="buyProposition" specification="_aQ1RQFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWX4m1JNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWX4nFJNEeiyW7NaN4qWdw" name="settlement" type="_aHKX4VJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWX4nVJNEeiyW7NaN4qWdw" name="goods" type="_aHJw0FJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWX4nlJNEeiyW7NaN4qWdw" name="gold">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aWX4n1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>HashMap&lt;String, String> results = loadMap(&quot;gold&quot;);&#xD;
     if (askHandling(new BuyPropositionMessage(unit, settlement,&#xD;
                 goods, gold), null, results)) {&#xD;
         try {&#xD;
             return Integer.parseInt(results.get(&quot;gold&quot;));&#xD;
         } catch (NumberFormatException e) {}&#xD;
     }&#xD;
     return NetworkConstants.NO_TRADE;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWYfoFJNEeiyW7NaN4qWdw" name="cashInTreasureTrain" specification="_aQ14UVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWYfoVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWYfolJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new CashInTreasureTrainMessage(unit),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWYfo1JNEeiyW7NaN4qWdw" name="changeState" specification="_aQ2fYVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWYfpFJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWYfpVJNEeiyW7NaN4qWdw" name="state" type="_aHUI4FJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWYfplJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new ChangeStateMessage(unit, state),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWYfp1JNEeiyW7NaN4qWdw" name="changeWorkImprovementType" specification="_aQ3tgFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWYfqFJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWYfqVJNEeiyW7NaN4qWdw" name="type" type="_aHYaUVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWYfqlJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new ChangeWorkImprovementTypeMessage(unit, type),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWYfq1JNEeiyW7NaN4qWdw" name="changeWorkType" specification="_aQ4UkFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWYfrFJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWYfrVJNEeiyW7NaN4qWdw" name="workType" type="_aHcEsFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWYfrlJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new ChangeWorkTypeMessage(unit, workType),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWYfr1JNEeiyW7NaN4qWdw" name="chat" specification="_aQ47oFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWYfsFJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWYfsVJNEeiyW7NaN4qWdw" name="chat">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aWYfslJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return send(new ChatMessage(player, chat, false));&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWZGsFJNEeiyW7NaN4qWdw" name="chooseFoundingFather" specification="_aQ5isFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWZGsVJNEeiyW7NaN4qWdw" name="ffs" type="_aHo5AFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWZGslJNEeiyW7NaN4qWdw" name="ff" type="_aHqHIFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWZGs1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return send(new ChooseFoundingFatherMessage(ffs, ff));&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWZGtFJNEeiyW7NaN4qWdw" name="claimTile" specification="_aQ6w0FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWZGtVJNEeiyW7NaN4qWdw" name="tile" type="_aG4rEVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWZGtlJNEeiyW7NaN4qWdw" name="claimant" type="_aH3igFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWZGt1JNEeiyW7NaN4qWdw" name="price">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aWZGuFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new ClaimLandMessage(tile, claimant, price),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWZGuVJNEeiyW7NaN4qWdw" name="clearSpeciality" specification="_aQ6w1VJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWZGulJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWZGu1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new ClearSpecialityMessage(unit),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWZtwFJNEeiyW7NaN4qWdw" name="closeTransactionSession" specification="_aQ7X4lJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWZtwVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWZtwlJNEeiyW7NaN4qWdw" name="settlement" type="_aHKX4VJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWZtw1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new CloseTransactionMessage(unit, settlement),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWZtxFJNEeiyW7NaN4qWdw" name="continuePlaying" specification="_ZFQO8FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWZtxVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return send(new TrivialMessage(&quot;continuePlaying&quot;));        &#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWZtxlJNEeiyW7NaN4qWdw" name="declareIndependence" specification="_ZFQ2AFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWZtx1JNEeiyW7NaN4qWdw" name="nation">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aWZtyFJNEeiyW7NaN4qWdw" name="country">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aWZtyVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new DeclareIndependenceMessage(nation, country),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWZtylJNEeiyW7NaN4qWdw" name="declineMounds" specification="_aQ7-8VJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWZty1JNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWZtzFJNEeiyW7NaN4qWdw" name="direction" type="_aG4EAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWZtzVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new DeclineMoundsMessage(unit, direction),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWZtzlJNEeiyW7NaN4qWdw" name="deliverGiftToSettlement" specification="_aQ8mAVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWZtz1JNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWZt0FJNEeiyW7NaN4qWdw" name="settlement" type="_aHKX4VJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWZt0VJNEeiyW7NaN4qWdw" name="goods" type="_aHJw0FJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWZt0lJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new DeliverGiftMessage(unit, settlement, goods),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWaU0FJNEeiyW7NaN4qWdw" name="demandTribute" specification="_aQ9NElJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWaU0VJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWaU0lJNEeiyW7NaN4qWdw" name="direction" type="_aG4EAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWaU01JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new DemandTributeMessage(unit, direction),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWaU1FJNEeiyW7NaN4qWdw" name="diplomacy" specification="_aQ-bMFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWaU1VJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWaU1lJNEeiyW7NaN4qWdw" name="ourUnit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWaU11JNEeiyW7NaN4qWdw" name="otherColony" type="_aGwvQFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWaU2FJNEeiyW7NaN4qWdw" name="agreement" type="_aJCnMFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWaU2VJNEeiyW7NaN4qWdw" type="_aJCnMFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>Element reply = askExpecting(new DiplomacyMessage(ourUnit, otherColony,&#xD;
                                                       agreement),&#xD;
         null, null);&#xD;
     // Often returns diplomacy, but also just an update on accept or&#xD;
     // null on reject.&#xD;
     if (reply == null) {&#xD;
         return null;&#xD;
     } else if (DiplomacyMessage.getXMLElementTagName().equals(reply.getTagName())) {&#xD;
         return new DiplomacyMessage(game, reply).getAgreement();&#xD;
     } else {&#xD;
         client.handleReply(reply);&#xD;
         return null;&#xD;
     }&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWaU2lJNEeiyW7NaN4qWdw" name="diplomacy" specification="_aQ_CQFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWaU21JNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWaU3FJNEeiyW7NaN4qWdw" name="ourUnit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWaU3VJNEeiyW7NaN4qWdw" name="otherUnit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWaU3lJNEeiyW7NaN4qWdw" name="agreement" type="_aJCnMFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWaU31JNEeiyW7NaN4qWdw" type="_aJCnMFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>Element reply = askExpecting(new DiplomacyMessage(ourUnit, otherUnit,&#xD;
                                                       agreement),&#xD;
         DiplomacyMessage.getXMLElementTagName(), null);&#xD;
     if (reply == null) {&#xD;
         return null;&#xD;
     } else if (DiplomacyMessage.getXMLElementTagName().equals(reply.getTagName())) {&#xD;
         return new DiplomacyMessage(game, reply).getAgreement();&#xD;
     } else {&#xD;
         client.handleReply(reply);&#xD;
         return null;&#xD;
     }&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWa74FJNEeiyW7NaN4qWdw" name="diplomacy" specification="_aRAQYFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWa74VJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWa74lJNEeiyW7NaN4qWdw" name="ourColony" type="_aGwvQFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWa741JNEeiyW7NaN4qWdw" name="otherUnit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWa75FJNEeiyW7NaN4qWdw" name="agreement" type="_aJCnMFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWa75VJNEeiyW7NaN4qWdw" type="_aJCnMFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>Element reply = askExpecting(new DiplomacyMessage(ourColony, otherUnit,&#xD;
                                                       agreement),&#xD;
         DiplomacyMessage.getXMLElementTagName(), null);&#xD;
     if (reply == null) {&#xD;
         return null;&#xD;
     } else if (DiplomacyMessage.getXMLElementTagName().equals(reply.getTagName())) {&#xD;
         return new DiplomacyMessage(game, reply).getAgreement();&#xD;
     } else {&#xD;
         client.handleReply(reply);&#xD;
         return null;&#xD;
     }&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWa75lJNEeiyW7NaN4qWdw" name="disbandUnit" specification="_aRA3cFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWa751JNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWa76FJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new DisbandUnitMessage(unit),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWa76VJNEeiyW7NaN4qWdw" name="disembark" specification="_aRA3c1JNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWa76lJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWa761JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new DisembarkMessage(unit),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWbi8FJNEeiyW7NaN4qWdw" name="embark" specification="_aRBeglJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWbi8VJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWbi8lJNEeiyW7NaN4qWdw" name="carrier" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWbi81JNEeiyW7NaN4qWdw" name="direction" type="_aG4EAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWbi9FJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new EmbarkMessage(unit, carrier, direction),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWbi9VJNEeiyW7NaN4qWdw" name="emigrate" specification="_ZFT5UFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWbi9lJNEeiyW7NaN4qWdw" name="slot">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aWbi91JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new EmigrateUnitMessage(slot),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWbi-FJNEeiyW7NaN4qWdw" name="endTurn" specification="_ZFUgYlJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWbi-VJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new TrivialMessage(&quot;endTurn&quot;),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWbi-lJNEeiyW7NaN4qWdw" name="enterRevengeMode" specification="_ZFVHcVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWbi-1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new TrivialMessage(&quot;enterRevengeMode&quot;),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWbi_FJNEeiyW7NaN4qWdw" name="equipUnitForRole" specification="_aRCFklJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWcKAFJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWcKAVJNEeiyW7NaN4qWdw" name="role" type="_aJU7EFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWcKAlJNEeiyW7NaN4qWdw" name="roleCount">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aWcKA1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new EquipForRoleMessage(unit, role, roleCount),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWcKBFJNEeiyW7NaN4qWdw" name="firstContact" specification="_aRCso1JNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWcKBVJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWcKBlJNEeiyW7NaN4qWdw" name="other" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWcKB1JNEeiyW7NaN4qWdw" name="tile" type="_aG4rEVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWcKCFJNEeiyW7NaN4qWdw" name="result">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aWcKCVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new FirstContactMessage(player, other, tile)&#xD;
             .setResult(result),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWcKClJNEeiyW7NaN4qWdw" name="getGoodsForSaleInSettlement" specification="_aRD6wFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWcKC1JNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWcKDFJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWcKDVJNEeiyW7NaN4qWdw" name="settlement" type="_aHKX4VJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWcKDlJNEeiyW7NaN4qWdw" type="_aHJw0FJNEeiyW7NaN4qWdw" isOrdered="true" direction="return">
                    <upperValue xmi:type="uml:LiteralUnlimitedNatural" xmi:id="_aWcKD1JNEeiyW7NaN4qWdw" value="*"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>GoodsForSaleMessage message&#xD;
         = new GoodsForSaleMessage(unit, settlement, null);&#xD;
     Element reply = askExpecting(message,&#xD;
         GoodsForSaleMessage.getXMLElementTagName(), null);&#xD;
     return (reply == null) ? Collections.&lt;Goods>emptyList()&#xD;
         : new GoodsForSaleMessage(game, reply).getGoods();&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWcKEFJNEeiyW7NaN4qWdw" name="getHighScores" specification="_ZFW8oFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWcKEVJNEeiyW7NaN4qWdw" type="_aLL8QFJNEeiyW7NaN4qWdw" isOrdered="true" direction="return">
                    <upperValue xmi:type="uml:LiteralUnlimitedNatural" xmi:id="_aWcKElJNEeiyW7NaN4qWdw" value="*"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>Element reply = askExpecting(new TrivialMessage(&quot;getHighScores&quot;),&#xD;
         null, null);&#xD;
     if (reply == null) return Collections.&lt;HighScore>emptyList();&#xD;
&#xD;
     List&lt;HighScore> result = new ArrayList&lt;>();&#xD;
     NodeList childElements = reply.getChildNodes();&#xD;
     for (int i = 0; i &lt; childElements.getLength(); i++) {&#xD;
         result.add(new HighScore((Element)childElements.item(i)));&#xD;
     }&#xD;
     return result;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWcxEFJNEeiyW7NaN4qWdw" name="getNationSummary" specification="_aREh0FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWcxEVJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWcxElJNEeiyW7NaN4qWdw" type="_aJbBsFJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>GetNationSummaryMessage message = new GetNationSummaryMessage(player);&#xD;
     Element reply = askExpecting(message,&#xD;
         GetNationSummaryMessage.getXMLElementTagName(), null);&#xD;
     if (reply == null) return null;&#xD;
&#xD;
     return new GetNationSummaryMessage(reply).getNationSummary();&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWcxE1JNEeiyW7NaN4qWdw" name="getNewTradeRoute" specification="_ZFYx0FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWcxFFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new TrivialMessage(&quot;getNewTradeRoute&quot;),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWcxFVJNEeiyW7NaN4qWdw" name="getREFUnits" specification="_ZFZY4VJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWcxFlJNEeiyW7NaN4qWdw" type="_aLKuIVJNEeiyW7NaN4qWdw" isOrdered="true" direction="return">
                    <upperValue xmi:type="uml:LiteralUnlimitedNatural" xmi:id="_aWcxF1JNEeiyW7NaN4qWdw" value="*"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>Element reply = askExpecting(new TrivialMessage(&quot;getREFUnits&quot;),&#xD;
         null, null);&#xD;
     if (reply == null) return Collections.&lt;AbstractUnit>emptyList();&#xD;
&#xD;
     List&lt;AbstractUnit> result = new ArrayList&lt;>();&#xD;
     NodeList childElements = reply.getChildNodes();&#xD;
     for (int index = 0; index &lt; childElements.getLength(); index++) {&#xD;
         AbstractUnit unit = new AbstractUnit();&#xD;
         unit.readFromXMLElement((Element) childElements.item(index));&#xD;
         result.add(unit);&#xD;
     }&#xD;
     return result;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWcxGFJNEeiyW7NaN4qWdw" name="getStatistics" specification="_ZFanAFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWcxGVJNEeiyW7NaN4qWdw" type="_aKcVYVJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>HashMap&lt;String, String> results = loadMap(&quot;*&quot;);&#xD;
     return (askExpecting(new TrivialMessage(&quot;getStatistics&quot;),&#xD;
             &quot;statistics&quot;, results) == null) ? null&#xD;
         : results;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWdYIFJNEeiyW7NaN4qWdw" name="incite" specification="_aRFI4FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWdYIVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWdYIlJNEeiyW7NaN4qWdw" name="direction" type="_aG4EAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWdYI1JNEeiyW7NaN4qWdw" name="enemy" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWdYJFJNEeiyW7NaN4qWdw" name="gold">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aWdYJVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>HashMap&lt;String, String> results = loadMap(&quot;gold&quot;);&#xD;
     if (!askHandling(new InciteMessage(unit, direction, enemy, gold),&#xD;
             null, results)) return -1;&#xD;
     try {&#xD;
         return Integer.parseInt(results.get(&quot;gold&quot;));&#xD;
     } catch (NumberFormatException e) {}&#xD;
     return -1;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWdYJlJNEeiyW7NaN4qWdw" name="joinColony" specification="_aRFv9VJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWdYJ1JNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWdYKFJNEeiyW7NaN4qWdw" name="colony" type="_aGwvQFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWdYKVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new JoinColonyMessage(colony, unit),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWdYKlJNEeiyW7NaN4qWdw" name="learnSkill" specification="_aRGXAFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWdYK1JNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWdYLFJNEeiyW7NaN4qWdw" name="direction" type="_aG4EAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWdYLVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new LearnSkillMessage(unit, direction),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWd_MFJNEeiyW7NaN4qWdw" name="loadGoods" specification="_aRG-EFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWd_MVJNEeiyW7NaN4qWdw" name="loc" type="_aJO0cFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWd_MlJNEeiyW7NaN4qWdw" name="type" type="_aHcEsFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWd_M1JNEeiyW7NaN4qWdw" name="amount">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aWd_NFJNEeiyW7NaN4qWdw" name="carrier" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWd_NVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new LoadGoodsMessage(loc, type, amount, carrier),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWd_NlJNEeiyW7NaN4qWdw" name="login" specification="_ZFdqUFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWd_N1JNEeiyW7NaN4qWdw" name="userName">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aWd_OFJNEeiyW7NaN4qWdw" name="version">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aWd_OVJNEeiyW7NaN4qWdw" type="_Y_504FJNEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>Element reply = askExpecting(new TrivialMessage(&quot;login&quot;,&#xD;
                                                     &quot;userName&quot;, userName,&#xD;
                                                     &quot;version&quot;, version),&#xD;
                                  &quot;login&quot;, null);&#xD;
     return (reply == null) ? null : new LoginMessage(null, reply);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWd_OlJNEeiyW7NaN4qWdw" name="logout" specification="_ZFeRYlJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWd_O1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return sendAndWait(new TrivialMessage(&quot;logout&quot;,&#xD;
             &quot;reason&quot;, &quot;User has quit the client.&quot;));&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWemQFJNEeiyW7NaN4qWdw" name="loot" specification="_aRHlIFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWemQVJNEeiyW7NaN4qWdw" name="winner" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWemQlJNEeiyW7NaN4qWdw" name="defenderId">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aWemQ1JNEeiyW7NaN4qWdw" name="goods" type="_aHo5AFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWemRFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new LootCargoMessage(winner, defenderId, goods),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWemRVJNEeiyW7NaN4qWdw" name="missionary" specification="_aRIMMVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWemRlJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWemR1JNEeiyW7NaN4qWdw" name="direction" type="_aG4EAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWemSFJNEeiyW7NaN4qWdw" name="denounce">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aWemSVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new MissionaryMessage(unit, direction, denounce),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWemSlJNEeiyW7NaN4qWdw" name="move" specification="_aRIzRFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWemS1JNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWemTFJNEeiyW7NaN4qWdw" name="direction" type="_aG4EAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWemTVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new MoveMessage(unit, direction),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWemTlJNEeiyW7NaN4qWdw" name="moveTo" specification="_aRJaUlJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWemT1JNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWemUFJNEeiyW7NaN4qWdw" name="destination" type="_aJO0cFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWemUVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new MoveToMessage(unit, destination),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWfNUFJNEeiyW7NaN4qWdw" name="newLandName" specification="_aRKBYFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWfNUVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWfNUlJNEeiyW7NaN4qWdw" name="name">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aWfNU1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new NewLandNameMessage(unit, name),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWfNVFJNEeiyW7NaN4qWdw" name="newRegionName" specification="_aRKocFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWfNVVJNEeiyW7NaN4qWdw" name="region" type="_aKLPoFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWfNVlJNEeiyW7NaN4qWdw" name="tile" type="_aG4rEVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWfNV1JNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWfNWFJNEeiyW7NaN4qWdw" name="name">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aWfNWVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new NewRegionNameMessage(region, tile, unit, name),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWfNWlJNEeiyW7NaN4qWdw" name="openTransactionSession" specification="_aRLPgFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWfNW1JNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWfNXFJNEeiyW7NaN4qWdw" name="settlement" type="_aHKX4VJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWfNXVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                    <upperValue xmi:type="uml:LiteralUnlimitedNatural" xmi:id="_aWfNXlJNEeiyW7NaN4qWdw" value="*"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>HashMap&lt;String, String> results&#xD;
         = loadMap(&quot;canBuy&quot;, &quot;canSell&quot;, &quot;canGift&quot;);&#xD;
     if (askExpecting(new GetTransactionMessage(unit, settlement),&#xD;
             null, results) == null&#xD;
         || results.get(&quot;canBuy&quot;) == null&#xD;
         || results.get(&quot;canSell&quot;) == null&#xD;
         || results.get(&quot;canGift&quot;) == null) return null;&#xD;
     return new boolean[] {&#xD;
         Boolean.parseBoolean(results.get(&quot;canBuy&quot;)),&#xD;
         Boolean.parseBoolean(results.get(&quot;canSell&quot;)),&#xD;
         Boolean.parseBoolean(results.get(&quot;canGift&quot;))&#xD;
     };&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWf0YFJNEeiyW7NaN4qWdw" name="payArrears" specification="_aRL2kFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWf0YVJNEeiyW7NaN4qWdw" name="type" type="_aHcEsFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWf0YlJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new PayArrearsMessage(type),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWf0Y1JNEeiyW7NaN4qWdw" name="payForBuilding" specification="_aRMdoFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWf0ZFJNEeiyW7NaN4qWdw" name="colony" type="_aGwvQFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWf0ZVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new PayForBuildingMessage(colony),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWf0ZlJNEeiyW7NaN4qWdw" name="putOutsideColony" specification="_aRMdo1JNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWf0Z1JNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWf0aFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new PutOutsideColonyMessage(unit),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWf0aVJNEeiyW7NaN4qWdw" name="rename" specification="_aRNEsVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWf0alJNEeiyW7NaN4qWdw" name="object" type="_aH3igFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWf0a1JNEeiyW7NaN4qWdw" name="name">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aWf0bFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new RenameMessage(object, name),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWgbcFJNEeiyW7NaN4qWdw" name="requestLaunch" specification="_ZFh7wFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWgbcVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return send(new TrivialMessage(&quot;requestLaunch&quot;));    &#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWgbclJNEeiyW7NaN4qWdw" name="retire" specification="_ZFii0VJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWgbc1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new TrivialMessage(&quot;retire&quot;), null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWgbdFJNEeiyW7NaN4qWdw" name="scoutSettlement" specification="_aRNrwlJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWgbdVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWgbdlJNEeiyW7NaN4qWdw" name="direction" type="_aG4EAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWgbd1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>HashMap&lt;String, String> results = loadMap(&quot;settlements&quot;);&#xD;
     return (askHandling(new ScoutIndianSettlementMessage(unit, direction),&#xD;
                         null, results)) ? results.get(&quot;settlements&quot;)&#xD;
         : null;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWhCgFJNEeiyW7NaN4qWdw" name="scoutSpeakToChief" specification="_aROS0lJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWhCgVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWhCglJNEeiyW7NaN4qWdw" name="direction" type="_aG4EAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWhCg1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>HashMap&lt;String, String> results = loadMap(&quot;result&quot;);&#xD;
     return (askHandling(new ScoutSpeakToChiefMessage(unit, direction),&#xD;
             null, results)) ? results.get(&quot;result&quot;)&#xD;
         : null;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWhChFJNEeiyW7NaN4qWdw" name="sellProposition" specification="_aRO54VJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWhChVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWhChlJNEeiyW7NaN4qWdw" name="settlement" type="_aHKX4VJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWhCh1JNEeiyW7NaN4qWdw" name="goods" type="_aHJw0FJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWhCiFJNEeiyW7NaN4qWdw" name="gold">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aWhCiVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>HashMap&lt;String, String> results = loadMap(&quot;gold&quot;);&#xD;
     if (askHandling(new SellPropositionMessage(unit, settlement,&#xD;
                 goods, gold), null, results)) {&#xD;
         try {&#xD;
             return Integer.parseInt(results.get(&quot;gold&quot;));&#xD;
         } catch (NumberFormatException e) {}&#xD;
     }&#xD;
     return NetworkConstants.NO_TRADE;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWhCilJNEeiyW7NaN4qWdw" name="sellToSettlement" specification="_aRPg8FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWhCi1JNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWhCjFJNEeiyW7NaN4qWdw" name="settlement" type="_aHKX4VJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWhCjVJNEeiyW7NaN4qWdw" name="goods" type="_aHJw0FJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWhCjlJNEeiyW7NaN4qWdw" name="gold">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aWhCj1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new SellMessage(unit, settlement, goods, gold),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWhCkFJNEeiyW7NaN4qWdw" name="setAvailable" specification="_aRQIAVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWhpkFJNEeiyW7NaN4qWdw" name="nation" type="_aLMjUFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWhpkVJNEeiyW7NaN4qWdw" name="state" type="_aLNKYVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWhpklJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new TrivialMessage(&quot;setAvailable&quot;,&#xD;
             &quot;nation&quot;, nation.getId(),&#xD;
             &quot;state&quot;, state.toString()),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWhpk1JNEeiyW7NaN4qWdw" name="setBuildQueue" specification="_aRRWIFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWhplFJNEeiyW7NaN4qWdw" name="colony" type="_aGwvQFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWhplVJNEeiyW7NaN4qWdw" name="buildQueue" type="_aHo5AFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWhpllJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new SetBuildQueueMessage(colony, buildQueue),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWhpl1JNEeiyW7NaN4qWdw" name="setColor" specification="_aRSkQFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWhpmFJNEeiyW7NaN4qWdw" name="nation" type="_aLMjUFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWhpmVJNEeiyW7NaN4qWdw" name="color" type="_aLJgAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWhpmlJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new TrivialMessage(&quot;setColor&quot;,&#xD;
             &quot;nation&quot;, nation.getId(),&#xD;
             &quot;color&quot;, Integer.toString(color.getRGB())),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWiQoFJNEeiyW7NaN4qWdw" name="setCurrentStop" specification="_aRTLUFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWiQoVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWiQolJNEeiyW7NaN4qWdw" name="index">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aWiQo1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new SetCurrentStopMessage(unit, index),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWiQpFJNEeiyW7NaN4qWdw" name="setDestination" specification="_aRTyYFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWiQpVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWiQplJNEeiyW7NaN4qWdw" name="destination" type="_aJO0cFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWiQp1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new SetDestinationMessage(unit, destination),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWiQqFJNEeiyW7NaN4qWdw" name="setGoodsLevels" specification="_aRTyZFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWiQqVJNEeiyW7NaN4qWdw" name="colony" type="_aGwvQFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWiQqlJNEeiyW7NaN4qWdw" name="data" type="_aK6PcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWiQq1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new SetGoodsLevelsMessage(colony, data),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWiQrFJNEeiyW7NaN4qWdw" name="setNation" specification="_aRUZc1JNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWiQrVJNEeiyW7NaN4qWdw" name="nation" type="_aLMjUFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWiQrlJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new TrivialMessage(&quot;setNation&quot;,&#xD;
             &quot;value&quot;, nation.getId()),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWi3sFJNEeiyW7NaN4qWdw" name="setNationType" specification="_aRVAgVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWi3sVJNEeiyW7NaN4qWdw" name="nationType" type="_aLNxcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWi3slJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new TrivialMessage(&quot;setNationType&quot;,&#xD;
             &quot;value&quot;, nationType.getId()),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWi3s1JNEeiyW7NaN4qWdw" name="setReady" specification="_ZFlmIFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWi3tFJNEeiyW7NaN4qWdw" name="ready">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aWi3tVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return send(new TrivialMessage(&quot;ready&quot;,&#xD;
             &quot;value&quot;, Boolean.toString(ready)));&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWi3tlJNEeiyW7NaN4qWdw" name="setTradeRoutes" specification="_aRVnkFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWi3t1JNEeiyW7NaN4qWdw" name="routes" type="_aHo5AFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWi3uFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new SetTradeRoutesMessage(routes),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWi3uVJNEeiyW7NaN4qWdw" name="spy" specification="_aRWOoVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWi3ulJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWi3u1JNEeiyW7NaN4qWdw" name="direction" type="_aG4EAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWi3vFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new SpySettlementMessage(unit, direction),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWjewFJNEeiyW7NaN4qWdw" name="startSkipping" specification="_ZFmNMVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWjewVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return send(new TrivialMessage(&quot;endTurn&quot;));&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWjewlJNEeiyW7NaN4qWdw" name="trainUnitInEurope" specification="_aRW1sVJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWjew1JNEeiyW7NaN4qWdw" name="type" type="_aLBkMFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWjexFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new TrainUnitInEuropeMessage(type),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWjexVJNEeiyW7NaN4qWdw" name="unloadGoods" specification="_aRXcwFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWjexlJNEeiyW7NaN4qWdw" name="type" type="_aHcEsFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWjex1JNEeiyW7NaN4qWdw" name="amount">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aWjeyFJNEeiyW7NaN4qWdw" name="carrier" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWjeyVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new UnloadGoodsMessage(type, amount, carrier),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWjeylJNEeiyW7NaN4qWdw" name="updateGameOptions" specification="_aRYD0FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWjey1JNEeiyW7NaN4qWdw" name="gameOptions" type="_aLOYgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWjezFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>Element up = DOMMessage.createMessage(&quot;updateGameOptions&quot;);&#xD;
     up.appendChild(gameOptions.toXMLElement(up.getOwnerDocument()));&#xD;
     return send(up);        &#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWkF0FJNEeiyW7NaN4qWdw" name="updateMapGeneratorOptions" specification="_aRYq4FJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWkF0VJNEeiyW7NaN4qWdw" name="mapOptions" type="_aLOYgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWkF0lJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>Element up = DOMMessage.createMessage(&quot;updateMapGeneratorOptions&quot;);&#xD;
     up.appendChild(mapOptions.toXMLElement(up.getOwnerDocument()));&#xD;
     return send(up);    &#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWkF01JNEeiyW7NaN4qWdw" name="updateTradeRoute" specification="_aRYq41JNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWkF1FJNEeiyW7NaN4qWdw" name="route" type="_aG-xsFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWkF1VJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new UpdateTradeRouteMessage(route),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_aWkF1lJNEeiyW7NaN4qWdw" name="work" specification="_aRZR8lJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_aWkF11JNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWkF2FJNEeiyW7NaN4qWdw" name="workLocation" type="_aKupQFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aWkF2VJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return askHandling(new WorkMessage(unit, workLocation),&#xD;
         null, null);&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_ZFEowFJNEeiyW7NaN4qWdw" name="ServerAPI">
                  <eAnnotations xmi:id="_ZFEowVJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_ZFEowlJNEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedParameter xmi:id="_ZFEoxFJNEeiyW7NaN4qWdw" type="_ZFA-YFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_ZFFP0FJNEeiyW7NaN4qWdw" name="doRaiseErrorMessage" visibility="protected" isAbstract="true">
                  <ownedComment xmi:id="_aXUTyVJNEeiyW7NaN4qWdw">
                    <body>Handle error conditions detected by the client.&#xD;
     *&#xD;
     * @param complaint The error message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZFFP0VJNEeiyW7NaN4qWdw" name="complaint">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_ZFHFAFJNEeiyW7NaN4qWdw" name="loadMap" visibility="private" method="_aWVcUFJNEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_ZFHFAVJNEeiyW7NaN4qWdw" name="queries">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    <upperValue xmi:type="uml:LiteralUnlimitedNatural" xmi:id="_ZFITIlJNEeiyW7NaN4qWdw" value="*"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aQq5MVJNEeiyW7NaN4qWdw" type="_aKbuUVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_ZFI6MFJNEeiyW7NaN4qWdw" name="getHost" method="_aWVcVFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXU611JNEeiyW7NaN4qWdw">
                    <body>Get the host we are connected to.&#xD;
     *&#xD;
     * @return The current host, or null if none.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZFI6MVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_ZFJhQFJNEeiyW7NaN4qWdw" name="getPort" method="_aWVcVlJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXU62FJNEeiyW7NaN4qWdw">
                    <body>Get the port we are connected to.&#xD;
     *&#xD;
     * @return The current port, or negative if none.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZFJhQVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_ZFJhQlJNEeiyW7NaN4qWdw" name="getConnection" method="_aWVcWFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXU62VJNEeiyW7NaN4qWdw">
                    <body>Get the raw connection.&#xD;
     *&#xD;
     * Do not use this.  It exists only for debugging purposes.&#xD;
     *&#xD;
     * @return The server &lt;code>Connection&lt;/code>.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aLSC4FJNEeiyW7NaN4qWdw" type="_Y8LLcFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_ZFKIUFJNEeiyW7NaN4qWdw" name="disconnect" method="_aWWDYFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXVh4VJNEeiyW7NaN4qWdw">
                    <body>Disconnect the client.</body>
                  </ownedComment>
                </ownedOperation>
                <ownedOperation xmi:id="_ZFKIUVJNEeiyW7NaN4qWdw" name="reset" method="_aWWDYVJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXVh4lJNEeiyW7NaN4qWdw">
                    <body>Just forget about the client.&#xD;
     * Only call this if sure it is dead.</body>
                  </ownedComment>
                </ownedOperation>
                <ownedOperation xmi:id="_ZFQO8FJNEeiyW7NaN4qWdw" name="continuePlaying" method="_aWZtxFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXWI-1JNEeiyW7NaN4qWdw">
                    <body>Server query-response to continue with a won game.&#xD;
     *&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZFQO8VJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_ZFQ2AFJNEeiyW7NaN4qWdw" name="declareIndependence" method="_aWZtxlJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXWI_FJNEeiyW7NaN4qWdw">
                    <body>Server query-response for declaring independence.&#xD;
     *&#xD;
     * @param nation The name for the new nation.&#xD;
     * @param country The name for the new country.&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZFQ2AVJNEeiyW7NaN4qWdw" name="nation">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_ZFQ2AlJNEeiyW7NaN4qWdw" name="country">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_ZFRdEFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_ZFT5UFJNEeiyW7NaN4qWdw" name="emigrate" method="_aWbi9VJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXWwCVJNEeiyW7NaN4qWdw">
                    <body>Server query-response for emigration.&#xD;
     *&#xD;
     * @param slot The slot from which the unit migrates, 1-3 selects&#xD;
     *             a specific one, otherwise the server will choose one.&#xD;
     * @return True if the client-server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZFUgYFJNEeiyW7NaN4qWdw" name="slot">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_ZFUgYVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_ZFUgYlJNEeiyW7NaN4qWdw" name="endTurn" method="_aWbi-FJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXWwClJNEeiyW7NaN4qWdw">
                    <body>Server query-response for asking for the turn to end.&#xD;
     *&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZFVHcFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_ZFVHcVJNEeiyW7NaN4qWdw" name="enterRevengeMode" method="_aWbi-lJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXXXEFJNEeiyW7NaN4qWdw">
                    <body>Server query-response for asking to enter revenge mode (post-game).&#xD;
     *&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZFVugFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_ZFW8oFJNEeiyW7NaN4qWdw" name="getHighScores" method="_aWcKEFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXXXFFJNEeiyW7NaN4qWdw">
                    <body>Server query-response for asking for the high scores list.&#xD;
     *&#xD;
     * @return The list of high scores.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZFW8oVJNEeiyW7NaN4qWdw" type="_aLL8QFJNEeiyW7NaN4qWdw" isOrdered="true" direction="return">
                    <upperValue xmi:type="uml:LiteralUnlimitedNatural" xmi:id="_ZFW8olJNEeiyW7NaN4qWdw" value="*"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_ZFYx0FJNEeiyW7NaN4qWdw" name="getNewTradeRoute" method="_aWcxE1JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXXXFlJNEeiyW7NaN4qWdw">
                    <body>Server query-response for creating a new trade route.&#xD;
     *&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZFZY4FJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_ZFZY4VJNEeiyW7NaN4qWdw" name="getREFUnits" method="_aWcxFVJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXXXF1JNEeiyW7NaN4qWdw">
                    <body>Server query-response for asking about a players REF.&#xD;
     *&#xD;
     * @return A list of REF units for the player.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZFZ_8FJNEeiyW7NaN4qWdw" type="_aLKuIVJNEeiyW7NaN4qWdw" isOrdered="true" direction="return">
                    <upperValue xmi:type="uml:LiteralUnlimitedNatural" xmi:id="_ZFZ_8VJNEeiyW7NaN4qWdw" value="*"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_ZFanAFJNEeiyW7NaN4qWdw" name="getStatistics" method="_aWcxGFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXXXGFJNEeiyW7NaN4qWdw">
                    <body>Server query-response for asking for the server statistics.&#xD;
     *&#xD;
     * @return The server statistics.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aLVtQFJNEeiyW7NaN4qWdw" type="_aKcVYVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_ZFdqUFJNEeiyW7NaN4qWdw" name="login" method="_aWd_NlJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXX-IVJNEeiyW7NaN4qWdw">
                    <body>Server query-response for logging in a player (pre-game).&#xD;
     *&#xD;
     * @param userName The user name.&#xD;
     * @param version The client version.&#xD;
     * @return A &lt;code>LoginMessage&lt;/code> on success, or null on error.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZFeRYFJNEeiyW7NaN4qWdw" name="userName">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_ZFeRYVJNEeiyW7NaN4qWdw" name="version">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aLWUUFJNEeiyW7NaN4qWdw" type="_Y_504FJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_ZFeRYlJNEeiyW7NaN4qWdw" name="logout" method="_aWd_OlJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXX-IlJNEeiyW7NaN4qWdw">
                    <body>Server query-response for logging out.&#xD;
     *&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZFe4cFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_ZFh7wFJNEeiyW7NaN4qWdw" name="requestLaunch" method="_aWgbcFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXYlM1JNEeiyW7NaN4qWdw">
                    <body>Server query-response to launch the game (pre-game).&#xD;
     *&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZFii0FJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_ZFii0VJNEeiyW7NaN4qWdw" name="retire" method="_aWgbclJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXYlNFJNEeiyW7NaN4qWdw">
                    <body>Server query-response to retire the player from the game.&#xD;
     *&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZFii0lJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_ZFlmIFJNEeiyW7NaN4qWdw" name="setReady" method="_aWi3s1JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXZMRlJNEeiyW7NaN4qWdw">
                    <body>Server query-response for indicating that this player is ready&#xD;
     * (pre-game).&#xD;
     *&#xD;
     * @param ready The readiness state to signal.&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZFlmIVJNEeiyW7NaN4qWdw" name="ready">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_ZFmNMFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_ZFmNMVJNEeiyW7NaN4qWdw" name="startSkipping" method="_aWjewFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXZMSVJNEeiyW7NaN4qWdw">
                    <body>Server query-response for starting to skip turns.&#xD;
     *&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_ZFm0QFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aLQNsFJNEeiyW7NaN4qWdw" name="send" visibility="private" method="_aWUOMFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXU60VJNEeiyW7NaN4qWdw">
                    <body>Sends a DOMMessage to the server.&#xD;
     *&#xD;
     * @param message The &lt;code>DOMMessage&lt;/code> to send.&#xD;
     * @return True if the send succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aLQNsVJNEeiyW7NaN4qWdw" name="message" type="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aLQ0wFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aLQ0wVJNEeiyW7NaN4qWdw" name="sendAndWait" visibility="private" method="_aWUOM1JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXU60lJNEeiyW7NaN4qWdw">
                    <body>Sends a DOMMessage to the server and waits for a reply.&#xD;
     *&#xD;
     * @param message The &lt;code>DOMMessage&lt;/code> to send.&#xD;
     * @return True if the send succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aLQ0wlJNEeiyW7NaN4qWdw" name="message" type="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aLQ0w1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aLRb0FJNEeiyW7NaN4qWdw" name="ask" visibility="private" method="_aWUONlJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXU601JNEeiyW7NaN4qWdw">
                    <body>Sends a DOMMessage query the server and waits for a reply.&#xD;
     *&#xD;
     * @param message The &lt;code>DOMMessage&lt;/code> to send.&#xD;
     * @return The reply, or null if there was a problem.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aLRb0VJNEeiyW7NaN4qWdw" name="message" type="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQbooVJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aLSC4VJNEeiyW7NaN4qWdw" name="registerMessageHandler" method="_aWVcWlJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXVh4FJNEeiyW7NaN4qWdw">
                    <body>Register a message handler to handle messages from the server.&#xD;
     * Used when switching from pre-game to in-game.&#xD;
     *&#xD;
     * @param messageHandler The new &lt;code>MessageHandler&lt;/code>.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aLSC4lJNEeiyW7NaN4qWdw" name="messageHandler" type="_ZAlKUFJNEeiyW7NaN4qWdw"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aLSp8FJNEeiyW7NaN4qWdw" name="connect" method="_aWWDYlJNEeiyW7NaN4qWdw" raisedException="_aH-QMFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXVh41JNEeiyW7NaN4qWdw">
                    <body>Connects a client to host:port (or more).&#xD;
     *&#xD;
     * @param threadName The name for the thread.&#xD;
     * @param host The name of the machine running the&#xD;
     *     &lt;code>FreeColServer&lt;/code>.&#xD;
     * @param port The port to use when connecting to the host.&#xD;
     * @return True if the connection succeeded.&#xD;
     * @exception IOException on connection failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aLSp8VJNEeiyW7NaN4qWdw" name="threadName">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aLSp8lJNEeiyW7NaN4qWdw" name="host">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aLSp81JNEeiyW7NaN4qWdw" name="port">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aLSp9FJNEeiyW7NaN4qWdw" name="messageHandler" type="_ZAlKUFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aLSp9VJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aQbBkFJNEeiyW7NaN4qWdw" name="doClientProcessingFor" visibility="protected" isAbstract="true">
                  <ownedComment xmi:id="_aXUTyFJNEeiyW7NaN4qWdw">
                    <body>Do local client processing for a reply.&#xD;
     *&#xD;
     * @param reply The reply &lt;code>Element&lt;/code>.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQbBkVJNEeiyW7NaN4qWdw" name="reply" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aQbBklJNEeiyW7NaN4qWdw" name="send" visibility="private" method="_aWTnJFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXU60FJNEeiyW7NaN4qWdw">
                    <body>Sends an Element to the server.&#xD;
     *&#xD;
     * FIXME: remove all uses of this.&#xD;
     *&#xD;
     * @param element The &lt;code>Element&lt;/code> to send.&#xD;
     * @return True if the send succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQbBk1JNEeiyW7NaN4qWdw" name="element" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQbooFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aQboolJNEeiyW7NaN4qWdw" name="resolve" visibility="private" method="_aWU1QFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXU61FJNEeiyW7NaN4qWdw">
                    <body>Loop sending requests and handling replies from the server until&#xD;
     * they reduce to null.&#xD;
     *&#xD;
     * @param request The initial request &lt;code>Element&lt;/code>.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQboo1JNEeiyW7NaN4qWdw" name="request" type="_aG0ZoVJNEeiyW7NaN4qWdw"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aQcPsFJNEeiyW7NaN4qWdw" name="askExpecting" visibility="private" method="_aWU1QlJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXU61VJNEeiyW7NaN4qWdw">
                    <body>Sends the specified message to the server and returns the reply,&#xD;
     * if it has the specified tag.&#xD;
     * Handle &quot;error&quot; replies if they have a messageID or when in debug mode.&#xD;
     * This routine allows code simplification in much of the following&#xD;
     * client-server communication.&#xD;
     *&#xD;
     * In following routines we follow the convention that server I/O&#xD;
     * is confined to the ask&lt;foo>() routine, which typically returns&#xD;
     * true if the server interaction succeeded, which does *not*&#xD;
     * necessarily imply that the actual substance of the request was&#xD;
     * allowed (e.g. a move may result in the death of a unit rather&#xD;
     * than actually moving).&#xD;
     *&#xD;
     * @param message A &lt;code>DOMMessage&lt;/code> to send.&#xD;
     * @param tag The expected tag&#xD;
     * @param results A &lt;code>Map&lt;/code> to store special attribute results in.&#xD;
     * @return The answer from the server if it has the specified tag,&#xD;
     *         otherwise &lt;code>null&lt;/code>.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQcPsVJNEeiyW7NaN4qWdw" name="message" type="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQcPslJNEeiyW7NaN4qWdw" name="tag">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aQcPs1JNEeiyW7NaN4qWdw" name="results" type="_aKbuUVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQcPtFJNEeiyW7NaN4qWdw" type="_aG0ZoVJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aQmnwFJNEeiyW7NaN4qWdw" name="askHandling" visibility="private" method="_aWU1R1JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXU61lJNEeiyW7NaN4qWdw">
                    <body>Extends askExpecting to also handle returns from the server.&#xD;
     *&#xD;
     * @param message A &lt;code>DOMMessage&lt;/code> to send.&#xD;
     * @param tag The expected tag&#xD;
     * @param results A &lt;code>Map&lt;/code> to store special attribute results in.&#xD;
     * @return True if the server interaction succeeded and an element&#xD;
     *     with the expected tag was found in the reply, else false.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQn14FJNEeiyW7NaN4qWdw" name="message" type="_Y8rhwFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQoc8FJNEeiyW7NaN4qWdw" name="tag">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aQoc8VJNEeiyW7NaN4qWdw" name="results" type="_aKbuUVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQpEAFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aQrgQFJNEeiyW7NaN4qWdw" name="abandonColony" method="_aWWDaFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXVh5FJNEeiyW7NaN4qWdw">
                    <body>Server query-response to abandon a colony.&#xD;
     *&#xD;
     * @param colony The &lt;code>Colony&lt;/code> to abandon.&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQrgQVJNEeiyW7NaN4qWdw" name="colony" type="_aGwvQFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQsHUFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aQujkFJNEeiyW7NaN4qWdw" name="answerMonarch" method="_aWWqcFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXVh5VJNEeiyW7NaN4qWdw">
                    <body>Server query-response to respond to a monarch offer.&#xD;
     *&#xD;
     * @param action The monarch action responded to.&#xD;
     * @param accept Accept or reject the offer.&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQujkVJNEeiyW7NaN4qWdw" name="action" type="_aKA3kFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQujklJNEeiyW7NaN4qWdw" name="accept">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aQujk1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aQvxsFJNEeiyW7NaN4qWdw" name="askSkill" method="_aWWqdFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXVh5lJNEeiyW7NaN4qWdw">
                    <body>Server query-response for finding out the skill taught at a settlement.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is asking.&#xD;
     * @param direction The direction to a settlement to ask.&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQvxsVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQvxslJNEeiyW7NaN4qWdw" name="direction" type="_aG4EAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQvxs1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aQwYwFJNEeiyW7NaN4qWdw" name="assignTeacher" method="_aWXRgFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXVh51JNEeiyW7NaN4qWdw">
                    <body>Server query-response for assigning a teacher.&#xD;
     *&#xD;
     * @param student The student &lt;code>Unit&lt;/code>.&#xD;
     * @param teacher The teacher &lt;code>Unit&lt;/code>.&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQwYwVJNEeiyW7NaN4qWdw" name="student" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQwYwlJNEeiyW7NaN4qWdw" name="teacher" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQw_0FJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aQxm4FJNEeiyW7NaN4qWdw" name="assignTradeRoute" method="_aWXRhFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXVh6FJNEeiyW7NaN4qWdw">
                    <body>Server query-response for assigning a trade route to a unit.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> to assign a trade route to.&#xD;
     * @param tradeRoute The &lt;code>TradeRoute&lt;/code> to assign.&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQxm4VJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQxm4lJNEeiyW7NaN4qWdw" name="tradeRoute" type="_aG-xsFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQxm41JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aQyN8FJNEeiyW7NaN4qWdw" name="attack" method="_aWXRiFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXVh6VJNEeiyW7NaN4qWdw">
                    <body>Server query-response for attacking.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> to perform the attack.&#xD;
     * @param direction The direction in which to attack.&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQyN8VJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQyN8lJNEeiyW7NaN4qWdw" name="direction" type="_aG4EAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQy1AFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aQy1AVJNEeiyW7NaN4qWdw" name="buildColony" method="_aWX4kFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXVh6lJNEeiyW7NaN4qWdw">
                    <body>Server query-response for building a colony.&#xD;
     *&#xD;
     * @param name The name for the colony.&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that will build.&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQzcEFJNEeiyW7NaN4qWdw" name="name">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aQzcEVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQzcElJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aQ0DIFJNEeiyW7NaN4qWdw" name="buyFromSettlement" method="_aWX4lFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXWI8FJNEeiyW7NaN4qWdw">
                    <body>Server query-response to buy the given goods from the natives.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is trading.&#xD;
     * @param settlement The &lt;code>Settlement&lt;/code> that is trading.&#xD;
     * @param goods The &lt;code>Goods&lt;/code> to buy.&#xD;
     * @param gold The agreed price.&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQ0DIVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQ0DIlJNEeiyW7NaN4qWdw" name="settlement" type="_aHKX4VJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQ0qMFJNEeiyW7NaN4qWdw" name="goods" type="_aHJw0FJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQ0qMVJNEeiyW7NaN4qWdw" name="gold">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aQ0qMlJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aQ1RQFJNEeiyW7NaN4qWdw" name="buyProposition" method="_aWX4mlJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXWI8VJNEeiyW7NaN4qWdw">
                    <body>Server query-response to ask the natives if a purchase is acceptable.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is trading.&#xD;
     * @param settlement The &lt;code>Settlement&lt;/code> that is trading.&#xD;
     * @param goods The &lt;code>Goods&lt;/code> to trade.&#xD;
     * @param gold The proposed price (including query on negative).&#xD;
     * @return The price of the goods.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQ1RQVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQ1RQlJNEeiyW7NaN4qWdw" name="settlement" type="_aHKX4VJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQ1RQ1JNEeiyW7NaN4qWdw" name="goods" type="_aHJw0FJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQ1RRFJNEeiyW7NaN4qWdw" name="gold">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aQ14UFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aQ14UVJNEeiyW7NaN4qWdw" name="cashInTreasureTrain" method="_aWYfoFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXWI8lJNEeiyW7NaN4qWdw">
                    <body>Server query-response to cash in a treasure train.&#xD;
     *&#xD;
     * @param unit The treasure train &lt;code>Unit&lt;/code> to cash in.&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQ14UlJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQ2fYFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aQ2fYVJNEeiyW7NaN4qWdw" name="changeState" method="_aWYfo1JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXWI81JNEeiyW7NaN4qWdw">
                    <body>Server query-response for changing unit state.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> to change the state of.&#xD;
     * @param state The new &lt;code>UnitState&lt;/code>.&#xD;
     * @return boolean &lt;b>true&lt;/b> if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQ3GcFJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQ3GcVJNEeiyW7NaN4qWdw" name="state" type="_aHUI4FJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQ3GclJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aQ3tgFJNEeiyW7NaN4qWdw" name="changeWorkImprovementType" method="_aWYfp1JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXWI9FJNEeiyW7NaN4qWdw">
                    <body>Server query-response for changing work improvement type.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> to change the work type of.&#xD;
     * @param type The new &lt;code>TileImprovementType&lt;/code> to work on.&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQ3tgVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQ3tglJNEeiyW7NaN4qWdw" name="type" type="_aHYaUVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQ3tg1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aQ4UkFJNEeiyW7NaN4qWdw" name="changeWorkType" method="_aWYfq1JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXWI9VJNEeiyW7NaN4qWdw">
                    <body>Server query-response for changing work type.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> to change the work type of.&#xD;
     * @param workType The new &lt;code>GoodsType&lt;/code> to produce.&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQ4UkVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQ4UklJNEeiyW7NaN4qWdw" name="workType" type="_aHcEsFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQ4Uk1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aQ47oFJNEeiyW7NaN4qWdw" name="chat" method="_aWYfr1JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXWI9lJNEeiyW7NaN4qWdw">
                    <body>Send a chat message (pre and in-game).&#xD;
     *&#xD;
     * @param chat The text of the message.&#xD;
     * @return True if the send succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQ47oVJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQ47olJNEeiyW7NaN4qWdw" name="chat">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aQ47o1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aQ5isFJNEeiyW7NaN4qWdw" name="chooseFoundingFather" method="_aWZGsFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXWI91JNEeiyW7NaN4qWdw">
                    <body>Send a chooseFoundingFather message.&#xD;
     *&#xD;
     * @param ffs A list of &lt;code>FoundingFather&lt;/code>s to choose from.&#xD;
     * @param ff The chosen &lt;code>FoundingFather&lt;/code> (may be null).&#xD;
     * @return True if the send succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQ5isVJNEeiyW7NaN4qWdw" name="ffs" type="_aHo5AFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQ5islJNEeiyW7NaN4qWdw" name="ff" type="_aHqHIFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQ5is1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aQ6w0FJNEeiyW7NaN4qWdw" name="claimTile" method="_aWZGtFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXWI-FJNEeiyW7NaN4qWdw">
                    <body>Server query-response to claim a tile.&#xD;
     *&#xD;
     * @param tile The &lt;code>Tile&lt;/code> to claim.&#xD;
     * @param claimant The &lt;code>Unit&lt;/code> or &lt;code>Settlement&lt;/code> that is&#xD;
     *     claiming the tile.&#xD;
     * @param price The amount to pay.&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQ6w0VJNEeiyW7NaN4qWdw" name="tile" type="_aG4rEVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQ6w0lJNEeiyW7NaN4qWdw" name="claimant" type="_aH3igFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQ6w01JNEeiyW7NaN4qWdw" name="price">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aQ6w1FJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aQ6w1VJNEeiyW7NaN4qWdw" name="clearSpeciality" method="_aWZGuVJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXWI-VJNEeiyW7NaN4qWdw">
                    <body>Server query-response for clearing a unit speciality.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> to operate on.&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQ7X4FJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQ7X4VJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aQ7X4lJNEeiyW7NaN4qWdw" name="closeTransactionSession" method="_aWZtwFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXWI-lJNEeiyW7NaN4qWdw">
                    <body>Server query-response to close a transaction session for a trade.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is trading.&#xD;
     * @param settlement The &lt;code>Settlement&lt;/code> that is trading.&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQ7X41JNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQ7X5FJNEeiyW7NaN4qWdw" name="settlement" type="_aHKX4VJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQ7-8FJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aQ7-8VJNEeiyW7NaN4qWdw" name="declineMounds" method="_aWZtylJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXWwAFJNEeiyW7NaN4qWdw">
                    <body>Server query-response for the special case of deciding to&#xD;
     * explore a rumour but then declining not to investigate the&#xD;
     * strange mounds.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is exploring.&#xD;
     * @param direction The &lt;code>Direction&lt;/code> to move.&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQ7-8lJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQ7-81JNEeiyW7NaN4qWdw" name="direction" type="_aG4EAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQ8mAFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aQ8mAVJNEeiyW7NaN4qWdw" name="deliverGiftToSettlement" method="_aWZtzlJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXWwAVJNEeiyW7NaN4qWdw">
                    <body>Server query-response to give the given goods to the natives.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is trading.&#xD;
     * @param settlement The &lt;code>Settlement&lt;/code> that is trading.&#xD;
     * @param goods The &lt;code>Goods&lt;/code> to give.&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQ8mAlJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQ8mA1JNEeiyW7NaN4qWdw" name="settlement" type="_aHKX4VJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQ9NEFJNEeiyW7NaN4qWdw" name="goods" type="_aHJw0FJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQ9NEVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aQ9NElJNEeiyW7NaN4qWdw" name="demandTribute" method="_aWaU0FJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXWwAlJNEeiyW7NaN4qWdw">
                    <body>Server query-response for demanding a tribute from a native&#xD;
     * settlement.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that demands.&#xD;
     * @param direction The direction to demand in.&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQ9NE1JNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQ90IFJNEeiyW7NaN4qWdw" name="direction" type="_aG4EAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQ90IVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aQ-bMFJNEeiyW7NaN4qWdw" name="diplomacy" method="_aWaU1FJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXWwA1JNEeiyW7NaN4qWdw">
                    <body>Handler server query-response for diplomatic messages.&#xD;
     *&#xD;
     * @param ourUnit Our &lt;code>Unit&lt;/code> conducting the diplomacy.&#xD;
     * @param otherColony The other &lt;code>Colony&lt;/code> to negotiate with.&#xD;
     * @param agreement The &lt;code>DiplomaticTrade&lt;/code> agreement to propose.&#xD;
     * @return The resulting agreement or null if none present.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQ-bMVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQ-bMlJNEeiyW7NaN4qWdw" name="ourUnit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQ-bM1JNEeiyW7NaN4qWdw" name="otherColony" type="_aGwvQFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQ-bNFJNEeiyW7NaN4qWdw" name="agreement" type="_aJCnMFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQ-bNVJNEeiyW7NaN4qWdw" type="_aJCnMFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aQ_CQFJNEeiyW7NaN4qWdw" name="diplomacy" method="_aWaU2lJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXWwBFJNEeiyW7NaN4qWdw">
                    <body>Handler server query-response for diplomatic messages.&#xD;
     *&#xD;
     * @param ourUnit Out &lt;code>Unit&lt;/code> conducting the diplomacy.&#xD;
     * @param otherUnit The other &lt;code>Unit&lt;/code> to negotiate with.&#xD;
     * @param agreement The &lt;code>DiplomaticTrade&lt;/code> agreement to propose.&#xD;
     * @return The resulting agreement or null if none present.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aQ_CQVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQ_CQlJNEeiyW7NaN4qWdw" name="ourUnit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQ_CQ1JNEeiyW7NaN4qWdw" name="otherUnit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQ_CRFJNEeiyW7NaN4qWdw" name="agreement" type="_aJCnMFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aQ_CRVJNEeiyW7NaN4qWdw" type="_aJCnMFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aRAQYFJNEeiyW7NaN4qWdw" name="diplomacy" method="_aWa74FJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXWwBVJNEeiyW7NaN4qWdw">
                    <body>Handler server query-response for diplomatic messages.&#xD;
     *&#xD;
     * @param ourColony Out &lt;code>Colony&lt;/code> conducting the diplomacy.&#xD;
     * @param otherUnit The other &lt;code>Unit&lt;/code> to negotiate with.&#xD;
     * @param agreement The &lt;code>DiplomaticTrade&lt;/code> agreement to propose.&#xD;
     * @return The resulting agreement or null if none present.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aRAQYVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRAQYlJNEeiyW7NaN4qWdw" name="ourColony" type="_aGwvQFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRAQY1JNEeiyW7NaN4qWdw" name="otherUnit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRAQZFJNEeiyW7NaN4qWdw" name="agreement" type="_aJCnMFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRAQZVJNEeiyW7NaN4qWdw" type="_aJCnMFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aRA3cFJNEeiyW7NaN4qWdw" name="disbandUnit" method="_aWa75lJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXWwBlJNEeiyW7NaN4qWdw">
                    <body>Server query-response for disbanding a unit.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> to operate on.&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aRA3cVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRA3clJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aRA3c1JNEeiyW7NaN4qWdw" name="disembark" method="_aWa76VJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXWwB1JNEeiyW7NaN4qWdw">
                    <body>Server query-response for disembarking from a carrier.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is disembarking.&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aRBegFJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRBegVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aRBeglJNEeiyW7NaN4qWdw" name="embark" method="_aWbi8FJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXWwCFJNEeiyW7NaN4qWdw">
                    <body>Server query-response for boarding a carrier.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is boarding.&#xD;
     * @param carrier The carrier &lt;code>Unit&lt;/code>.&#xD;
     * @param direction An optional direction if the unit is boarding from&#xD;
     *        an adjacent tile, or null if from the same tile.&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aRBeg1JNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRBehFJNEeiyW7NaN4qWdw" name="carrier" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRCFkFJNEeiyW7NaN4qWdw" name="direction" type="_aG4EAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRCFkVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aRCFklJNEeiyW7NaN4qWdw" name="equipUnitForRole" method="_aWbi_FJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXXXEVJNEeiyW7NaN4qWdw">
                    <body>Server query-response for equipping a unit for a role.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> to equip.&#xD;
     * @param role The &lt;code>Role&lt;/code> to assume.&#xD;
     * @param roleCount The role count.&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aRCFk1JNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRCsoFJNEeiyW7NaN4qWdw" name="role" type="_aJU7EFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRCsoVJNEeiyW7NaN4qWdw" name="roleCount">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aRCsolJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aRCso1JNEeiyW7NaN4qWdw" name="firstContact" method="_aWcKBFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXXXElJNEeiyW7NaN4qWdw">
                    <body>Server query-response for responding to a first contact message.&#xD;
     *&#xD;
     * @param player The &lt;code>Player&lt;/code> making contact.&#xD;
     * @param other The native &lt;code>Player&lt;/code> being contacted.&#xD;
     * @param tile An optional &lt;code>Tile&lt;/code> to offer the player if&#xD;
     *     they have made a first landing.&#xD;
     * @param result Whether the initial peace treaty was accepted.&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aRDTsFJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRDTsVJNEeiyW7NaN4qWdw" name="other" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRDTslJNEeiyW7NaN4qWdw" name="tile" type="_aG4rEVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRDTs1JNEeiyW7NaN4qWdw" name="result">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aRDTtFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aRD6wFJNEeiyW7NaN4qWdw" name="getGoodsForSaleInSettlement" method="_aWcKClJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXXXE1JNEeiyW7NaN4qWdw">
                    <body>Server query-response to get a list of goods for sale from a settlement.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is trading.&#xD;
     * @param settlement The &lt;code>Settlement&lt;/code> that is trading.&#xD;
     * @return The goods for sale in the settlement,&#xD;
     *     or null if the server interaction failed.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aRD6wVJNEeiyW7NaN4qWdw" name="game" type="_aGx9YFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRD6wlJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRD6w1JNEeiyW7NaN4qWdw" name="settlement" type="_aHKX4VJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRD6xFJNEeiyW7NaN4qWdw" type="_aHJw0FJNEeiyW7NaN4qWdw" isOrdered="true" direction="return">
                    <upperValue xmi:type="uml:LiteralUnlimitedNatural" xmi:id="_aRD6xVJNEeiyW7NaN4qWdw" value="*"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aREh0FJNEeiyW7NaN4qWdw" name="getNationSummary" method="_aWcxEFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXXXFVJNEeiyW7NaN4qWdw">
                    <body>Server query-response for asking for the nation summary of a player.&#xD;
     *&#xD;
     * @param player The &lt;code>Player&lt;/code> to summarize.&#xD;
     * @return A summary of that nation, or null on error.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aREh0VJNEeiyW7NaN4qWdw" name="player" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aREh0lJNEeiyW7NaN4qWdw" type="_aJbBsFJNEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_aRFI4FJNEeiyW7NaN4qWdw" name="incite" method="_aWdYIFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXXXGVJNEeiyW7NaN4qWdw">
                    <body>Server query-response for inciting the natives.&#xD;
     *&#xD;
     * @param unit The missionary &lt;code>Unit&lt;/code>.&#xD;
     * @param direction The direction to a settlement to speak to.&#xD;
     * @param enemy An enemy &lt;code>Player&lt;/code>.&#xD;
     * @param gold The amount of bribe, negative to enquire.&#xD;
     * @return The amount of gold to bribe with if this was an inquiry,&#xD;
     *     zero for failure to incite and >0 for successful incitement,&#xD;
     *     negative if the server interaction failed.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aRFv8FJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRFv8VJNEeiyW7NaN4qWdw" name="direction" type="_aG4EAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRFv8lJNEeiyW7NaN4qWdw" name="enemy" type="_aGykcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRFv81JNEeiyW7NaN4qWdw" name="gold">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aRFv9FJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aRFv9VJNEeiyW7NaN4qWdw" name="joinColony" method="_aWdYJlJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXXXGlJNEeiyW7NaN4qWdw">
                    <body>Server query-response for joining a colony.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that will join.&#xD;
     * @param colony The &lt;code>Colony&lt;/code> to join.&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aRFv9lJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRFv91JNEeiyW7NaN4qWdw" name="colony" type="_aGwvQFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRFv-FJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aRGXAFJNEeiyW7NaN4qWdw" name="learnSkill" method="_aWdYKlJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXXXG1JNEeiyW7NaN4qWdw">
                    <body>Server query-response for learning the skill taught at a settlement.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is asking.&#xD;
     * @param direction The direction to a settlement to ask.&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aRGXAVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRGXAlJNEeiyW7NaN4qWdw" name="direction" type="_aG4EAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRGXA1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aRG-EFJNEeiyW7NaN4qWdw" name="loadGoods" method="_aWd_MFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXX-IFJNEeiyW7NaN4qWdw">
                    <body>Server query-response for loading goods.&#xD;
     *&#xD;
     * @param loc The &lt;code>Location&lt;/code> where the goods are.&#xD;
     * @param type The &lt;code>GoodsType&lt;/code> to load.&#xD;
     * @param amount The amount of goods to load.&#xD;
     * @param carrier The &lt;code>Unit&lt;/code> to load onto.&#xD;
     * @return True if the query-response succeeds.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aRG-EVJNEeiyW7NaN4qWdw" name="loc" type="_aJO0cFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRG-ElJNEeiyW7NaN4qWdw" name="type" type="_aHcEsFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRG-E1JNEeiyW7NaN4qWdw" name="amount">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aRG-FFJNEeiyW7NaN4qWdw" name="carrier" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRG-FVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aRHlIFJNEeiyW7NaN4qWdw" name="loot" method="_aWemQFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXX-I1JNEeiyW7NaN4qWdw">
                    <body>Server query-response for looting.  Handles both an initial query and&#xD;
     * the actual looting.&#xD;
     *&#xD;
     * @param winner The &lt;code>Unit&lt;/code> that is looting.&#xD;
     * @param defenderId The identifier of the defender unit (it may have sunk).&#xD;
     * @param goods A list of &lt;code>Goods&lt;/code>, if empty this is a query&#xD;
     *     as to what is to be looted which is filled into the list,&#xD;
     *     if non-empty, then the list of goods to loot.&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aRHlIVJNEeiyW7NaN4qWdw" name="winner" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRHlIlJNEeiyW7NaN4qWdw" name="defenderId">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aRHlI1JNEeiyW7NaN4qWdw" name="goods" type="_aHo5AFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRHlJFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aRIMMVJNEeiyW7NaN4qWdw" name="missionary" method="_aWemRVJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXX-JFJNEeiyW7NaN4qWdw">
                    <body>Server query-response for establishing/denouncing a mission.&#xD;
     *&#xD;
     * @param unit The missionary &lt;code>Unit&lt;/code>.&#xD;
     * @param direction The direction to a settlement to establish with.&#xD;
     * @param denounce True if this is a denouncement.&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aRIzQFJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRIzQVJNEeiyW7NaN4qWdw" name="direction" type="_aG4EAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRIzQlJNEeiyW7NaN4qWdw" name="denounce">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aRIzQ1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aRIzRFJNEeiyW7NaN4qWdw" name="move" method="_aWemSlJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXX-JVJNEeiyW7NaN4qWdw">
                    <body>Server query-response for moving a unit.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> to move.&#xD;
     * @param direction The direction to move in.&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aRIzRVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRJaUFJNEeiyW7NaN4qWdw" name="direction" type="_aG4EAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRJaUVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aRJaUlJNEeiyW7NaN4qWdw" name="moveTo" method="_aWemTlJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXX-JlJNEeiyW7NaN4qWdw">
                    <body>Server query-response for moving to across the high seas.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> to move.&#xD;
     * @param destination The &lt;code>Location&lt;/code> to move to.&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aRJaU1JNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRJaVFJNEeiyW7NaN4qWdw" name="destination" type="_aJO0cFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRJaVVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aRKBYFJNEeiyW7NaN4qWdw" name="newLandName" method="_aWfNUFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXX-J1JNEeiyW7NaN4qWdw">
                    <body>Server query-response for naming a new land.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that has come ashore.&#xD;
     * @param name The new land name.&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aRKBYVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRKBYlJNEeiyW7NaN4qWdw" name="name">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aRKBY1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aRKocFJNEeiyW7NaN4qWdw" name="newRegionName" method="_aWfNVFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXX-KFJNEeiyW7NaN4qWdw">
                    <body>Server query-response for naming a new region.&#xD;
     *&#xD;
     * @param region The &lt;code>Region&lt;/code> that is being discovered.&#xD;
     * @param tile The &lt;code>Tile&lt;/code> where the region is discovered.&#xD;
     * @param unit The &lt;code>Unit&lt;/code> discovering the region.&#xD;
     * @param name The new region name.&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aRKocVJNEeiyW7NaN4qWdw" name="region" type="_aKLPoFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRKoclJNEeiyW7NaN4qWdw" name="tile" type="_aG4rEVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRKoc1JNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRKodFJNEeiyW7NaN4qWdw" name="name">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aRKodVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aRLPgFJNEeiyW7NaN4qWdw" name="openTransactionSession" method="_aWfNWlJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXX-KVJNEeiyW7NaN4qWdw">
                    <body>Server query-response to get the transaction session for a trade.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is trading.&#xD;
     * @param settlement The &lt;code>Settlement&lt;/code> that is trading.&#xD;
     * @return An array of booleans for the buy/sell/gift status,&#xD;
     *     or null if the server interaction failed.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aRLPgVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRLPglJNEeiyW7NaN4qWdw" name="settlement" type="_aHKX4VJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRLPg1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                    <upperValue xmi:type="uml:LiteralUnlimitedNatural" xmi:id="_aRLPhFJNEeiyW7NaN4qWdw" value="*"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aRL2kFJNEeiyW7NaN4qWdw" name="payArrears" method="_aWf0YFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXX-KlJNEeiyW7NaN4qWdw">
                    <body>Server query-response for tax paying arrears.&#xD;
     *&#xD;
     * @param type The &lt;code>GoodsType&lt;/code> to pay the arrears for.&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aRL2kVJNEeiyW7NaN4qWdw" name="type" type="_aHcEsFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRL2klJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aRMdoFJNEeiyW7NaN4qWdw" name="payForBuilding" method="_aWf0Y1JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXYlMFJNEeiyW7NaN4qWdw">
                    <body>Server query-response for paying for a building.&#xD;
     *&#xD;
     * @param colony The &lt;code>Colony&lt;/code> that is building.&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aRMdoVJNEeiyW7NaN4qWdw" name="colony" type="_aGwvQFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRMdolJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aRMdo1JNEeiyW7NaN4qWdw" name="putOutsideColony" method="_aWf0ZlJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXYlMVJNEeiyW7NaN4qWdw">
                    <body>Server query-response for putting a unit outside a colony.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> to put out.&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aRMdpFJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRNEsFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aRNEsVJNEeiyW7NaN4qWdw" name="rename" method="_aWf0aVJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXYlMlJNEeiyW7NaN4qWdw">
                    <body>Server query-response for renaming an object.&#xD;
     *&#xD;
     * @param object A &lt;code>FreeColGameObject&lt;/code> to rename.&#xD;
     * @param name The name to apply.&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aRNEslJNEeiyW7NaN4qWdw" name="object" type="_aH3igFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRNrwFJNEeiyW7NaN4qWdw" name="name">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aRNrwVJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aRNrwlJNEeiyW7NaN4qWdw" name="scoutSettlement" method="_aWgbdFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXYlNVJNEeiyW7NaN4qWdw">
                    <body>Server query-response for the dialog on scouting a native&#xD;
     * settlement, *before* choosing to speak to the chief, attack, et&#xD;
     * al.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is speaking.&#xD;
     * @param direction The direction to a settlement to ask.&#xD;
     * @return The number of settlements of this tribe (which is&#xD;
     *     needed in the dialog following), or negative on error.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aRNrw1JNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aROS0FJNEeiyW7NaN4qWdw" name="direction" type="_aG4EAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aROS0VJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aROS0lJNEeiyW7NaN4qWdw" name="scoutSpeakToChief" method="_aWhCgFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXYlNlJNEeiyW7NaN4qWdw">
                    <body>Server query-response for speaking with a native chief.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is speaking.&#xD;
     * @param direction The direction to a settlement to ask.&#xD;
     * @return A string describing the result,&#xD;
     *     or null if the server interaction failed.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aROS01JNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aROS1FJNEeiyW7NaN4qWdw" name="direction" type="_aG4EAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRO54FJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aRO54VJNEeiyW7NaN4qWdw" name="sellProposition" method="_aWhChFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXYlN1JNEeiyW7NaN4qWdw">
                    <body>Server query-response to ask the natives if a sale is acceptable.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is trading.&#xD;
     * @param settlement The &lt;code>Settlement&lt;/code> that is trading.&#xD;
     * @param goods The &lt;code>Goods&lt;/code> to trade.&#xD;
     * @param gold The proposed price (including query on negative).&#xD;
     * @return The selling price for the goods.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aRO54lJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRO541JNEeiyW7NaN4qWdw" name="settlement" type="_aHKX4VJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRO55FJNEeiyW7NaN4qWdw" name="goods" type="_aHJw0FJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRO55VJNEeiyW7NaN4qWdw" name="gold">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aRO55lJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aRPg8FJNEeiyW7NaN4qWdw" name="sellToSettlement" method="_aWhCilJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXYlOFJNEeiyW7NaN4qWdw">
                    <body>Server query-response to sell the given goods to the natives.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is trading.&#xD;
     * @param settlement The &lt;code>Settlement&lt;/code> that is trading.&#xD;
     * @param goods The &lt;code>Goods&lt;/code> to sell.&#xD;
     * @param gold The agreed price.&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aRPg8VJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRPg8lJNEeiyW7NaN4qWdw" name="settlement" type="_aHKX4VJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRPg81JNEeiyW7NaN4qWdw" name="goods" type="_aHJw0FJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRPg9FJNEeiyW7NaN4qWdw" name="gold">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aRQIAFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aRQIAVJNEeiyW7NaN4qWdw" name="setAvailable" method="_aWhCkFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXYlOVJNEeiyW7NaN4qWdw">
                    <body>Server query-response to set a nation's availablility (pre-game).&#xD;
     *&#xD;
     * @param nation The &lt;code>Nation&lt;/code> to whose availability is to be set.&#xD;
     * @param state The &lt;code>NationState&lt;/code> defining the availability.&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aRQIAlJNEeiyW7NaN4qWdw" name="nation" type="_aLMjUFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRQIA1JNEeiyW7NaN4qWdw" name="state" type="_aLNKYVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRQIBFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aRRWIFJNEeiyW7NaN4qWdw" name="setBuildQueue" method="_aWhpk1JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXYlOlJNEeiyW7NaN4qWdw">
                    <body>Server query-response for changing a build queue.&#xD;
     *&#xD;
     * @param colony the Colony&#xD;
     * @param buildQueue the new values for the build queue&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aRRWIVJNEeiyW7NaN4qWdw" name="colony" type="_aGwvQFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRRWIlJNEeiyW7NaN4qWdw" name="buildQueue" type="_aHo5AFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRRWI1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aRSkQFJNEeiyW7NaN4qWdw" name="setColor" method="_aWhpl1JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXZMQFJNEeiyW7NaN4qWdw">
                    <body>Server query-response to set a nation colour&#xD;
     * (pre-game).&#xD;
     *&#xD;
     * @param nation The &lt;code>Nation&lt;/code> to set the color for.&#xD;
     * @param color The &lt;code>Color&lt;/code> selected.&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aRSkQVJNEeiyW7NaN4qWdw" name="nation" type="_aLMjUFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRSkQlJNEeiyW7NaN4qWdw" name="color" type="_aLJgAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRSkQ1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aRTLUFJNEeiyW7NaN4qWdw" name="setCurrentStop" method="_aWiQoFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXZMQVJNEeiyW7NaN4qWdw">
                    <body>Server query-response to set the current stop.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> whose stop is to be updated.&#xD;
     * @param index The stop index.&#xD;
     * @return True if the query-response succeeds.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aRTLUVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRTLUlJNEeiyW7NaN4qWdw" name="index">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aRTLU1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aRTyYFJNEeiyW7NaN4qWdw" name="setDestination" method="_aWiQpFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXZMQlJNEeiyW7NaN4qWdw">
                    <body>Server query-response to set the destination of the given unit.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> to direct.&#xD;
     * @param destination The destination &lt;code>Location&lt;/code>.&#xD;
     * @return True if the server interaction succeeded.&#xD;
     * @see Unit#setDestination(Location)</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aRTyYVJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRTyYlJNEeiyW7NaN4qWdw" name="destination" type="_aJO0cFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRTyY1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aRTyZFJNEeiyW7NaN4qWdw" name="setGoodsLevels" method="_aWiQqFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXZMQ1JNEeiyW7NaN4qWdw">
                    <body>Server query-response for setting goods levels.&#xD;
     *&#xD;
     * @param colony The &lt;code>Colony&lt;/code> where the levels are set.&#xD;
     * @param data The &lt;code>ExportData&lt;/code> setting.&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aRUZcFJNEeiyW7NaN4qWdw" name="colony" type="_aGwvQFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRUZcVJNEeiyW7NaN4qWdw" name="data" type="_aK6PcFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRUZclJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aRUZc1JNEeiyW7NaN4qWdw" name="setNation" method="_aWiQrFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXZMRFJNEeiyW7NaN4qWdw">
                    <body>Server query-response to show which nation a player has selected&#xD;
     * (pre-game).&#xD;
     *&#xD;
     * @param nation The &lt;code>Nation&lt;/code> selected.&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aRUZdFJNEeiyW7NaN4qWdw" name="nation" type="_aLMjUFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRVAgFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aRVAgVJNEeiyW7NaN4qWdw" name="setNationType" method="_aWi3sFJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXZMRVJNEeiyW7NaN4qWdw">
                    <body>Server query-response to show which nation type a player has selected&#xD;
     * (pre-game).&#xD;
     *&#xD;
     * @param nationType The &lt;code>NationType&lt;/code> selected.&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aRVAglJNEeiyW7NaN4qWdw" name="nationType" type="_aLNxcVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRVAg1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aRVnkFJNEeiyW7NaN4qWdw" name="setTradeRoutes" method="_aWi3tlJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXZMR1JNEeiyW7NaN4qWdw">
                    <body>Server query-response for setting the trade routes.&#xD;
     *&#xD;
     * @param routes A list of trade routes to update.&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aRVnkVJNEeiyW7NaN4qWdw" name="routes" type="_aHo5AFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRVnklJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aRWOoVJNEeiyW7NaN4qWdw" name="spy" method="_aWi3uVJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXZMSFJNEeiyW7NaN4qWdw">
                    <body>Server query-response for spying on a colony.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is spying.&#xD;
     * @param direction The &lt;code>Direction&lt;/code> of a colony to spy on.&#xD;
     * @return True if the client/server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aRWOolJNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRWOo1JNEeiyW7NaN4qWdw" name="direction" type="_aG4EAFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRW1sFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aRW1sVJNEeiyW7NaN4qWdw" name="trainUnitInEurope" method="_aWjewlJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXZMSlJNEeiyW7NaN4qWdw">
                    <body>Server query-response for training a unit in Europe.&#xD;
     *&#xD;
     * @param type The &lt;code>UnitType&lt;/code> to train.&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aRW1slJNEeiyW7NaN4qWdw" name="type" type="_aLBkMFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRW1s1JNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aRXcwFJNEeiyW7NaN4qWdw" name="unloadGoods" method="_aWjexVJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXZMS1JNEeiyW7NaN4qWdw">
                    <body>Server query-response for unloading goods.&#xD;
     *&#xD;
     * @param type The &lt;code>GoodsType&lt;/code> to unload.&#xD;
     * @param amount The amount of goods to unload.&#xD;
     * @param carrier The &lt;code>Unit&lt;/code> to unload from.&#xD;
     * @return True if the query-response succeeds.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aRXcwVJNEeiyW7NaN4qWdw" name="type" type="_aHcEsFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRXcwlJNEeiyW7NaN4qWdw" name="amount">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_aRXcw1JNEeiyW7NaN4qWdw" name="carrier" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRXcxFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aRYD0FJNEeiyW7NaN4qWdw" name="updateGameOptions" method="_aWjeylJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXZzUFJNEeiyW7NaN4qWdw">
                    <body>Server query-response to update the game options&#xD;
     * (pre-game).&#xD;
     *&#xD;
     * @param gameOptions The &lt;code>OptionGroup&lt;/code> containing the&#xD;
     *     game options.&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aRYD0VJNEeiyW7NaN4qWdw" name="gameOptions" type="_aLOYgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRYD0lJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aRYq4FJNEeiyW7NaN4qWdw" name="updateMapGeneratorOptions" method="_aWkF0FJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXZzUVJNEeiyW7NaN4qWdw">
                    <body>Server query-response to update the map generator options&#xD;
     * (pre-game).&#xD;
     *&#xD;
     * @param mapOptions The &lt;code>OptionGroup&lt;/code> containing the&#xD;
     *     map generator options.&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aRYq4VJNEeiyW7NaN4qWdw" name="mapOptions" type="_aLOYgVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRYq4lJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aRYq41JNEeiyW7NaN4qWdw" name="updateTradeRoute" method="_aWkF01JNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXZzUlJNEeiyW7NaN4qWdw">
                    <body>Server query-response for asking for updating the trade route.&#xD;
     *&#xD;
     * @param route The trade route to update.&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aRZR8FJNEeiyW7NaN4qWdw" name="route" type="_aG-xsFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRZR8VJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_aRZR8lJNEeiyW7NaN4qWdw" name="work" method="_aWkF1lJNEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_aXZzU1JNEeiyW7NaN4qWdw">
                    <body>Server query-response for changing a work location.&#xD;
     *&#xD;
     * @param unit The &lt;code>Unit&lt;/code> to change the workLocation of.&#xD;
     * @param workLocation The &lt;code>WorkLocation&lt;/code> to change to.&#xD;
     * @return True if the server interaction succeeded.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_aRZR81JNEeiyW7NaN4qWdw" name="unit" type="_aG5SIVJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRZR9FJNEeiyW7NaN4qWdw" name="workLocation" type="_aKupQFJNEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_aRZ5AFJNEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_aW6rIFJNEeiyW7NaN4qWdw" name="" memberEnd="_aSI401JNEeiyW7NaN4qWdw _aW7SMFJNEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_aW7SMFJNEeiyW7NaN4qWdw" name="" type="_Y8LLcFJNEeiyW7NaN4qWdw" association="_aW6rIFJNEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_aX_pMFJNEeiyW7NaN4qWdw" name="" memberEnd="_aX_pMVJNEeiyW7NaN4qWdw _aRxFYVJNEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_aX_pMVJNEeiyW7NaN4qWdw" name="" type="_Y6a38FJNEeiyW7NaN4qWdw" association="_aX_pMFJNEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_aYGW4VJNEeiyW7NaN4qWdw" name="" memberEnd="_aYGW4lJNEeiyW7NaN4qWdw _aR0IsVJNEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_aYGW4lJNEeiyW7NaN4qWdw" name="" type="_Y6ko8FJNEeiyW7NaN4qWdw" association="_aYGW4VJNEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_aYNroVJNEeiyW7NaN4qWdw" name="" memberEnd="_aYNrolJNEeiyW7NaN4qWdw _aR8rkFJNEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_aYNrolJNEeiyW7NaN4qWdw" name="" type="_Y7ZIUFJNEeiyW7NaN4qWdw" association="_aYNroVJNEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_aYVAYFJNEeiyW7NaN4qWdw" name="" memberEnd="_aYVAYVJNEeiyW7NaN4qWdw _aSA9AFJNEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_aYVAYVJNEeiyW7NaN4qWdw" name="" type="_Y7vtoFJNEeiyW7NaN4qWdw" association="_aYVAYFJNEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_aYbuEVJNEeiyW7NaN4qWdw" name="" memberEnd="_aYbuElJNEeiyW7NaN4qWdw _aSA9AlJNEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_aYbuElJNEeiyW7NaN4qWdw" name="" type="_Y7vtoFJNEeiyW7NaN4qWdw" association="_aYbuEVJNEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_aYjC0FJNEeiyW7NaN4qWdw" name="" memberEnd="_aYjC0VJNEeiyW7NaN4qWdw _aSF1gFJNEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_aYjC0VJNEeiyW7NaN4qWdw" name="" type="_Y8LLcFJNEeiyW7NaN4qWdw" association="_aYjC0FJNEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_aYqXkVJNEeiyW7NaN4qWdw" name="" memberEnd="_aYqXklJNEeiyW7NaN4qWdw _aSHqsVJNEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_aYqXklJNEeiyW7NaN4qWdw" name="" type="_Y8LLcFJNEeiyW7NaN4qWdw" association="_aYqXkVJNEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_aY3L4VJNEeiyW7NaN4qWdw" name="" memberEnd="_aY3L4lJNEeiyW7NaN4qWdw _aSHqs1JNEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_aY3L4lJNEeiyW7NaN4qWdw" name="" type="_Y8LLcFJNEeiyW7NaN4qWdw" association="_aY3L4VJNEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_aY_HsFJNEeiyW7NaN4qWdw" name="" memberEnd="_aY_HsVJNEeiyW7NaN4qWdw _aSIRwFJNEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_aY_HsVJNEeiyW7NaN4qWdw" name="" type="_Y8LLcFJNEeiyW7NaN4qWdw" association="_aY_HsFJNEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_aZF1YVJNEeiyW7NaN4qWdw" name="" memberEnd="_aZF1YlJNEeiyW7NaN4qWdw _aSIRwlJNEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_aZF1YlJNEeiyW7NaN4qWdw" name="" type="_Y8LLcFJNEeiyW7NaN4qWdw" association="_aZF1YVJNEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_aZNKIVJNEeiyW7NaN4qWdw" name="" memberEnd="_aZNKIlJNEeiyW7NaN4qWdw _aSI40VJNEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_aZNKIlJNEeiyW7NaN4qWdw" name="" type="_Y8LLcFJNEeiyW7NaN4qWdw" association="_aZNKIVJNEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_aZUe4VJNEeiyW7NaN4qWdw" name="" memberEnd="_aZUe4lJNEeiyW7NaN4qWdw _aSJf4lJNEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_aZUe4lJNEeiyW7NaN4qWdw" name="" type="_Y8LLcFJNEeiyW7NaN4qWdw" association="_aZUe4VJNEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_aZbzoFJNEeiyW7NaN4qWdw" name="" memberEnd="_aZbzoVJNEeiyW7NaN4qWdw _aSKG8VJNEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_aZbzoVJNEeiyW7NaN4qWdw" name="" type="_Y8LLcFJNEeiyW7NaN4qWdw" association="_aZbzoFJNEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_aZjIYFJNEeiyW7NaN4qWdw" name="" memberEnd="_aZjIYVJNEeiyW7NaN4qWdw _aSLVEFJNEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_aZjIYVJNEeiyW7NaN4qWdw" name="" type="_Y8rhwFJNEeiyW7NaN4qWdw" association="_aZjIYFJNEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_aZrrQVJNEeiyW7NaN4qWdw" name="" memberEnd="_aZrrQlJNEeiyW7NaN4qWdw _aSL8JFJNEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_aZrrQlJNEeiyW7NaN4qWdw" name="" type="_Y8rhwFJNEeiyW7NaN4qWdw" association="_aZrrQVJNEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_aZznEVJNEeiyW7NaN4qWdw" name="" memberEnd="_aZznElJNEeiyW7NaN4qWdw _aSQNkVJNEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_aZznElJNEeiyW7NaN4qWdw" name="" type="_Y9Z6gFJNEeiyW7NaN4qWdw" association="_aZznEVJNEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_aZ_NQVJNEeiyW7NaN4qWdw" name="" memberEnd="_aZ_NQlJNEeiyW7NaN4qWdw _aSSp0VJNEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_aZ_NQlJNEeiyW7NaN4qWdw" name="" type="_Y9rnUFJNEeiyW7NaN4qWdw" association="_aZ_NQVJNEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_aaGiAVJNEeiyW7NaN4qWdw" name="" memberEnd="_aaGiAlJNEeiyW7NaN4qWdw _aSe3EVJNEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_aaGiAlJNEeiyW7NaN4qWdw" name="" type="_Y9rnUFJNEeiyW7NaN4qWdw" association="_aaGiAVJNEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_aaN2wVJNEeiyW7NaN4qWdw" name="" memberEnd="_aaN2wlJNEeiyW7NaN4qWdw _aS01UFJNEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_aaN2wlJNEeiyW7NaN4qWdw" name="" type="_Y-wlYFJNEeiyW7NaN4qWdw" association="_aaN2wVJNEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_aaVLgFJNEeiyW7NaN4qWdw" name="" memberEnd="_aaVLgVJNEeiyW7NaN4qWdw _aS5t0VJNEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_aaVLgVJNEeiyW7NaN4qWdw" name="" type="_Y_AdAFJNEeiyW7NaN4qWdw" association="_aaVLgFJNEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_aab5MVJNEeiyW7NaN4qWdw" name="" memberEnd="_aab5MlJNEeiyW7NaN4qWdw _aTHwQFJNEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_aab5MlJNEeiyW7NaN4qWdw" name="" type="_Y_504FJNEeiyW7NaN4qWdw" association="_aab5MVJNEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_aajN8VJNEeiyW7NaN4qWdw" name="" memberEnd="_aajN8lJNEeiyW7NaN4qWdw _aTLaoFJNEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_aajN8lJNEeiyW7NaN4qWdw" name="" type="_Y_504FJNEeiyW7NaN4qWdw" association="_aajN8VJNEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_aaqisVJNEeiyW7NaN4qWdw" name="" memberEnd="_aaqislJNEeiyW7NaN4qWdw _aTNP0FJNEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_aaqislJNEeiyW7NaN4qWdw" name="" type="_ZAMIwFJNEeiyW7NaN4qWdw" association="_aaqisVJNEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_aazsoVJNEeiyW7NaN4qWdw" name="" memberEnd="_aazsolJNEeiyW7NaN4qWdw _aTOd8FJNEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_aazsolJNEeiyW7NaN4qWdw" name="" type="_ZAWg0FJNEeiyW7NaN4qWdw" association="_aazsoVJNEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_aa7ocVJNEeiyW7NaN4qWdw" name="" memberEnd="_aa7oclJNEeiyW7NaN4qWdw _aTPFAlJNEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_aa7oclJNEeiyW7NaN4qWdw" name="" type="_ZAWg0FJNEeiyW7NaN4qWdw" association="_aa7ocVJNEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_abCWIVJNEeiyW7NaN4qWdw" name="" memberEnd="_abCWIlJNEeiyW7NaN4qWdw _aTSIUFJNEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_abCWIlJNEeiyW7NaN4qWdw" name="" type="_ZAttMFJNEeiyW7NaN4qWdw" association="_abCWIVJNEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_abJD0VJNEeiyW7NaN4qWdw" name="" memberEnd="_abJD0lJNEeiyW7NaN4qWdw _aTXA0FJNEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_abJD0lJNEeiyW7NaN4qWdw" name="" type="_ZBYbkFJNEeiyW7NaN4qWdw" association="_abJD0VJNEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_abPxgVJNEeiyW7NaN4qWdw" name="" memberEnd="_abPxglJNEeiyW7NaN4qWdw _aTgx0VJNEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_abPxglJNEeiyW7NaN4qWdw" name="" type="_ZCNiAFJNEeiyW7NaN4qWdw" association="_abPxgVJNEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_abV4IFJNEeiyW7NaN4qWdw" name="" memberEnd="_abV4IVJNEeiyW7NaN4qWdw _aThY4VJNEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_abV4IVJNEeiyW7NaN4qWdw" name="" type="_ZCNiAFJNEeiyW7NaN4qWdw" association="_abV4IFJNEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_abawoVJNEeiyW7NaN4qWdw" name="" memberEnd="_abawolJNEeiyW7NaN4qWdw _aTh_8VJNEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_abawolJNEeiyW7NaN4qWdw" name="" type="_ZCNiAFJNEeiyW7NaN4qWdw" association="_abawoVJNEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_abiFYFJNEeiyW7NaN4qWdw" name="" memberEnd="_abiFYVJNEeiyW7NaN4qWdw _aTinAFJNEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_abiFYVJNEeiyW7NaN4qWdw" name="" type="_ZCNiAFJNEeiyW7NaN4qWdw" association="_abiFYFJNEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_abqBMVJNEeiyW7NaN4qWdw" name="" memberEnd="_abqBMlJNEeiyW7NaN4qWdw _aTj1IFJNEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_abqBMlJNEeiyW7NaN4qWdw" name="" type="_ZCLs0FJNEeiyW7NaN4qWdw" association="_abqBMVJNEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_ab1AUFJNEeiyW7NaN4qWdw" name="" memberEnd="_ab1AUVJNEeiyW7NaN4qWdw _aTrw8VJNEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_ab1AUVJNEeiyW7NaN4qWdw" name="" type="_ZCLs0FJNEeiyW7NaN4qWdw" association="_ab1AUFJNEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_ab88IVJNEeiyW7NaN4qWdw" name="" memberEnd="_ab88IlJNEeiyW7NaN4qWdw _aTtmIFJNEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_ab88IlJNEeiyW7NaN4qWdw" name="" type="_ZClVcFJNEeiyW7NaN4qWdw" association="_ab88IVJNEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_acDp0VJNEeiyW7NaN4qWdw" name="" memberEnd="_acDp0lJNEeiyW7NaN4qWdw _aTu0QlJNEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_acDp0lJNEeiyW7NaN4qWdw" name="" type="_ZCnKoFJNEeiyW7NaN4qWdw" association="_acDp0VJNEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_acKXgFJNEeiyW7NaN4qWdw" name="" memberEnd="_acKXgVJNEeiyW7NaN4qWdw _aT2JAFJNEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_acKXgVJNEeiyW7NaN4qWdw" name="" type="_ZClVcFJNEeiyW7NaN4qWdw" association="_acKXgFJNEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_acQeIFJNEeiyW7NaN4qWdw" name="" memberEnd="_acQeIVJNEeiyW7NaN4qWdw _aT5MUVJNEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_acQeIVJNEeiyW7NaN4qWdw" name="" type="_ZClVcFJNEeiyW7NaN4qWdw" association="_acQeIFJNEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_acXL0VJNEeiyW7NaN4qWdw" name="" memberEnd="_acXL0lJNEeiyW7NaN4qWdw _aT5zYFJNEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_acXL0lJNEeiyW7NaN4qWdw" name="" type="_ZClVcFJNEeiyW7NaN4qWdw" association="_acXL0VJNEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_acd5gVJNEeiyW7NaN4qWdw" name="" memberEnd="_acd5glJNEeiyW7NaN4qWdw _aUBIIVJNEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_acd5glJNEeiyW7NaN4qWdw" name="" type="_ZDdfMFJNEeiyW7NaN4qWdw" association="_acd5gVJNEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_acnDcVJNEeiyW7NaN4qWdw" name="" memberEnd="_acnDclJNEeiyW7NaN4qWdw _aUDkYFJNEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_acnDclJNEeiyW7NaN4qWdw" name="" type="_ZDlbAFJNEeiyW7NaN4qWdw" association="_acnDcVJNEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_acwNYVJNEeiyW7NaN4qWdw" name="" memberEnd="_acwNYlJNEeiyW7NaN4qWdw _aUKSEVJNEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_acwNYlJNEeiyW7NaN4qWdw" name="" type="_ZEVB4FJNEeiyW7NaN4qWdw" association="_acwNYVJNEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_ac5-YFJNEeiyW7NaN4qWdw" name="" memberEnd="_ac5-YVJNEeiyW7NaN4qWdw _aULgMlJNEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_ac5-YVJNEeiyW7NaN4qWdw" name="" type="_ZEdkwFJNEeiyW7NaN4qWdw" association="_ac5-YFJNEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_adAsEVJNEeiyW7NaN4qWdw" name="" memberEnd="_adAsElJNEeiyW7NaN4qWdw _aUSN4FJNEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_adAsElJNEeiyW7NaN4qWdw" name="" type="_ZE8F4FJNEeiyW7NaN4qWdw" association="_adAsEVJNEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_adIA0VJNEeiyW7NaN4qWdw" name="" memberEnd="_adIA0lJNEeiyW7NaN4qWdw _aUS08FJNEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_adIA0lJNEeiyW7NaN4qWdw" name="" type="_ZFA-YFJNEeiyW7NaN4qWdw" association="_adIA0VJNEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_adPVkFJNEeiyW7NaN4qWdw" name="" memberEnd="_adPVkVJNEeiyW7NaN4qWdw _aUTcAFJNEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_adPVkVJNEeiyW7NaN4qWdw" name="" type="_ZFA-YFJNEeiyW7NaN4qWdw" association="_adPVkFJNEeiyW7NaN4qWdw"/>
              </packagedElement>
            </packagedElement>
            <packagedElement xmi:type="uml:Package" xmi:id="_YuVjwlJNEeiyW7NaN4qWdw" name="debug">
              <packagedElement xmi:type="uml:Class" xmi:id="_aIVckVJNEeiyW7NaN4qWdw" name="FreeColDebugger"/>
            </packagedElement>
            <packagedElement xmi:type="uml:Package" xmi:id="_YuVjw1JNEeiyW7NaN4qWdw" name="io">
              <packagedElement xmi:type="uml:Class" xmi:id="_aIWDoVJNEeiyW7NaN4qWdw" name="FreeColXMLReader"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_aIploFJNEeiyW7NaN4qWdw" name="FreeColXMLWriter"/>
            </packagedElement>
            <packagedElement xmi:type="uml:Package" xmi:id="_Yun3oFJNEeiyW7NaN4qWdw" name="util">
              <packagedElement xmi:type="uml:Class" xmi:id="_aIqMsVJNEeiyW7NaN4qWdw" name="Introspector"/>
            </packagedElement>
            <packagedElement xmi:type="uml:Package" xmi:id="_YzqIoFJNEeiyW7NaN4qWdw" name="option">
              <packagedElement xmi:type="uml:Class" xmi:id="_aLOYgVJNEeiyW7NaN4qWdw" name="OptionGroup"/>
            </packagedElement>
            <packagedElement xmi:type="uml:Class" xmi:id="_aIAFYVJNEeiyW7NaN4qWdw" name="FreeColException"/>
          </packagedElement>
          <packagedElement xmi:type="uml:Package" xmi:id="_YsuaMFJNEeiyW7NaN4qWdw" name="server">
            <packagedElement xmi:type="uml:Package" xmi:id="_YsvBQFJNEeiyW7NaN4qWdw" name="model">
              <packagedElement xmi:type="uml:Class" xmi:id="_aGzykVJNEeiyW7NaN4qWdw" name="ServerPlayer"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_aHK-8VJNEeiyW7NaN4qWdw" name="ServerIndianSettlement"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_aJLxIFJNEeiyW7NaN4qWdw" name="ServerUnit"/>
            </packagedElement>
            <packagedElement xmi:type="uml:Package" xmi:id="_YukNQFJNEeiyW7NaN4qWdw" name="control">
              <packagedElement xmi:type="uml:Class" xmi:id="_aIhCwFJNEeiyW7NaN4qWdw" name="FreeColServerHolder"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_aJD1UVJNEeiyW7NaN4qWdw" name="InGameController"/>
            </packagedElement>
            <packagedElement xmi:type="uml:Class" xmi:id="_aGzLgVJNEeiyW7NaN4qWdw" name="FreeColServer"/>
          </packagedElement>
          <packagedElement xmi:type="uml:Class" xmi:id="_aLKHEVJNEeiyW7NaN4qWdw" name="FreeCol"/>
        </packagedElement>
      </packagedElement>
    </packagedElement>
    <packagedElement xmi:type="uml:Package" xmi:id="_YsvoUFJNEeiyW7NaN4qWdw" name="org">
      <packagedElement xmi:type="uml:Package" xmi:id="_YsvoUVJNEeiyW7NaN4qWdw" name="w3c">
        <packagedElement xmi:type="uml:Package" xmi:id="_YsvoUlJNEeiyW7NaN4qWdw" name="dom">
          <packagedElement xmi:type="uml:Interface" xmi:id="_aG0ZoVJNEeiyW7NaN4qWdw" name="Element"/>
          <packagedElement xmi:type="uml:Interface" xmi:id="_aIqzwVJNEeiyW7NaN4qWdw" name="Document"/>
          <packagedElement xmi:type="uml:Interface" xmi:id="_aIsB4FJNEeiyW7NaN4qWdw" name="NodeList"/>
          <packagedElement xmi:type="uml:Interface" xmi:id="_aLO_kVJNEeiyW7NaN4qWdw" name="Node"/>
        </packagedElement>
      </packagedElement>
      <packagedElement xmi:type="uml:Package" xmi:id="_YuVjxFJNEeiyW7NaN4qWdw" name="xml">
        <packagedElement xmi:type="uml:Package" xmi:id="_YuVjxVJNEeiyW7NaN4qWdw" name="sax">
          <packagedElement xmi:type="uml:Class" xmi:id="_aIXRwFJNEeiyW7NaN4qWdw" name="SAXException"/>
          <packagedElement xmi:type="uml:Class" xmi:id="_aIso8VJNEeiyW7NaN4qWdw" name="InputSource"/>
        </packagedElement>
      </packagedElement>
    </packagedElement>
    <packagedElement xmi:type="uml:Package" xmi:id="_Yt5e4FJNEeiyW7NaN4qWdw" name="java">
      <packagedElement xmi:type="uml:Package" xmi:id="_Yt5e4VJNEeiyW7NaN4qWdw" name="util">
        <packagedElement xmi:type="uml:Package" xmi:id="_YuJWgVJNEeiyW7NaN4qWdw" name="logging">
          <packagedElement xmi:type="uml:Class" xmi:id="_aH-3QVJNEeiyW7NaN4qWdw" name="Level"/>
          <packagedElement xmi:type="uml:Class" xmi:id="_aH_eUVJNEeiyW7NaN4qWdw" name="Logger"/>
        </packagedElement>
        <packagedElement xmi:type="uml:Class" xmi:id="_aHmcwFJNEeiyW7NaN4qWdw" name="ArrayList"/>
        <packagedElement xmi:type="uml:Interface" xmi:id="_aHo5AFJNEeiyW7NaN4qWdw" name="List"/>
        <packagedElement xmi:type="uml:Interface" xmi:id="_aKTygFJNEeiyW7NaN4qWdw" name="Comparator"/>
        <packagedElement xmi:type="uml:Class" xmi:id="_aKbHQFJNEeiyW7NaN4qWdw" name="Collections"/>
        <packagedElement xmi:type="uml:Class" xmi:id="_aKbuUVJNEeiyW7NaN4qWdw" name="HashMap"/>
        <packagedElement xmi:type="uml:Interface" xmi:id="_aKcVYVJNEeiyW7NaN4qWdw" name="Map"/>
      </packagedElement>
      <packagedElement xmi:type="uml:Package" xmi:id="_YuJWgFJNEeiyW7NaN4qWdw" name="io">
        <packagedElement xmi:type="uml:Class" xmi:id="_aH-QMFJNEeiyW7NaN4qWdw" name="IOException"/>
        <packagedElement xmi:type="uml:Class" xmi:id="_aIJ2YFJNEeiyW7NaN4qWdw" name="BufferedInputStream"/>
        <packagedElement xmi:type="uml:Class" xmi:id="_aIKdcVJNEeiyW7NaN4qWdw" name="BufferedWriter"/>
        <packagedElement xmi:type="uml:Interface" xmi:id="_aILEgVJNEeiyW7NaN4qWdw" name="Closeable"/>
        <packagedElement xmi:type="uml:Class" xmi:id="_aILrkVJNEeiyW7NaN4qWdw" name="InputStream"/>
        <packagedElement xmi:type="uml:Class" xmi:id="_aIMSoVJNEeiyW7NaN4qWdw" name="OutputStream"/>
        <packagedElement xmi:type="uml:Class" xmi:id="_aIM5sVJNEeiyW7NaN4qWdw" name="OutputStreamWriter"/>
        <packagedElement xmi:type="uml:Class" xmi:id="_aINgwVJNEeiyW7NaN4qWdw" name="Writer"/>
        <packagedElement xmi:type="uml:Class" xmi:id="_aIlUMFJNEeiyW7NaN4qWdw" name="ByteArrayOutputStream"/>
        <packagedElement xmi:type="uml:Class" xmi:id="_aIl7QVJNEeiyW7NaN4qWdw" name="StringWriter"/>
        <packagedElement xmi:type="uml:Class" xmi:id="_aJ6w8FJNEeiyW7NaN4qWdw" name="StringReader"/>
      </packagedElement>
      <packagedElement xmi:type="uml:Package" xmi:id="_YuUVoFJNEeiyW7NaN4qWdw" name="net">
        <packagedElement xmi:type="uml:Class" xmi:id="_aIOH0VJNEeiyW7NaN4qWdw" name="InetSocketAddress"/>
        <packagedElement xmi:type="uml:Class" xmi:id="_aIPV8VJNEeiyW7NaN4qWdw" name="Socket"/>
        <packagedElement xmi:type="uml:Class" xmi:id="_aIP9AVJNEeiyW7NaN4qWdw" name="SocketAddress"/>
      </packagedElement>
      <packagedElement xmi:type="uml:Package" xmi:id="_YzoTcFJNEeiyW7NaN4qWdw" name="awt">
        <packagedElement xmi:type="uml:Class" xmi:id="_aLJgAFJNEeiyW7NaN4qWdw" name="Color"/>
      </packagedElement>
      <packagedElement xmi:type="uml:Package" xmi:id="_aO6lsFJNEeiyW7NaN4qWdw" name="lang">
        <packagedElement xmi:type="uml:Class" xmi:id="_aO6lsVJNEeiyW7NaN4qWdw" name="ClassCastException"/>
        <packagedElement xmi:type="uml:Class" xmi:id="_aPNgoFJNEeiyW7NaN4qWdw" name="Object"/>
        <packagedElement xmi:type="uml:Class" xmi:id="_aPnJQFJNEeiyW7NaN4qWdw" name="Thread"/>
      </packagedElement>
    </packagedElement>
    <packagedElement xmi:type="uml:Package" xmi:id="_YuU8sFJNEeiyW7NaN4qWdw" name="javax">
      <packagedElement xmi:type="uml:Package" xmi:id="_YuU8sVJNEeiyW7NaN4qWdw" name="xml">
        <packagedElement xmi:type="uml:Package" xmi:id="_YuU8slJNEeiyW7NaN4qWdw" name="stream">
          <packagedElement xmi:type="uml:Class" xmi:id="_aIQkEVJNEeiyW7NaN4qWdw" name="XMLStreamException"/>
        </packagedElement>
        <packagedElement xmi:type="uml:Package" xmi:id="_YuU8s1JNEeiyW7NaN4qWdw" name="transform">
          <packagedElement xmi:type="uml:Package" xmi:id="_YuVjwFJNEeiyW7NaN4qWdw" name="dom">
            <packagedElement xmi:type="uml:Class" xmi:id="_aIUOcVJNEeiyW7NaN4qWdw" name="DOMSource"/>
          </packagedElement>
          <packagedElement xmi:type="uml:Package" xmi:id="_YuVjwVJNEeiyW7NaN4qWdw" name="stream">
            <packagedElement xmi:type="uml:Class" xmi:id="_aIU1gVJNEeiyW7NaN4qWdw" name="StreamResult"/>
          </packagedElement>
          <packagedElement xmi:type="uml:Class" xmi:id="_aIRLIVJNEeiyW7NaN4qWdw" name="OutputKeys"/>
          <packagedElement xmi:type="uml:Class" xmi:id="_aIRyMVJNEeiyW7NaN4qWdw" name="Transformer"/>
          <packagedElement xmi:type="uml:Class" xmi:id="_aISZQVJNEeiyW7NaN4qWdw" name="TransformerException"/>
          <packagedElement xmi:type="uml:Class" xmi:id="_aITAUVJNEeiyW7NaN4qWdw" name="TransformerFactory"/>
        </packagedElement>
        <packagedElement xmi:type="uml:Package" xmi:id="_YunQkFJNEeiyW7NaN4qWdw" name="parsers">
          <packagedElement xmi:type="uml:Class" xmi:id="_aInJYFJNEeiyW7NaN4qWdw" name="DocumentBuilder"/>
          <packagedElement xmi:type="uml:Class" xmi:id="_aInwcVJNEeiyW7NaN4qWdw" name="DocumentBuilderFactory"/>
          <packagedElement xmi:type="uml:Class" xmi:id="_aIoXgVJNEeiyW7NaN4qWdw" name="ParserConfigurationException"/>
        </packagedElement>
      </packagedElement>
    </packagedElement>
    <profileApplication xmi:id="_WgTl8FJNEeiyW7NaN4qWdw">
      <eAnnotations xmi:id="_WgTl8VJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
        <references xmi:type="ecore:EPackage" href="pathmap://UMLLAB_PROFILES/UMLLab.profile.uml#UMLLabProfile-Annotation_2-UMLLabProfile"/>
      </eAnnotations>
      <appliedProfile href="pathmap://UMLLAB_PROFILES/UMLLab.profile.uml#UMLLabProfile"/>
    </profileApplication>
    <profileApplication xmi:id="_aSSp0lJNEeiyW7NaN4qWdw">
      <eAnnotations xmi:id="_aSSp01JNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
        <references xmi:type="ecore:EPackage" href="pathmap://PERSISTENCY_PROFILES/Persistency.profile.uml#Persistency_2-Annotation-Persistency"/>
      </eAnnotations>
      <appliedProfile href="pathmap://PERSISTENCY_PROFILES/Persistency.profile.uml#Persistency_2"/>
    </profileApplication>
  </uml:Model>
  <UMLLabProfile:TargetLanguage xmi:id="_WgUNAFJNEeiyW7NaN4qWdw" base_Package="_WLi24FJNEeiyW7NaN4qWdw">
    <languageName>java</languageName>
  </UMLLabProfile:TargetLanguage>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Y5iuMFJNEeiyW7NaN4qWdw" base_Element="_Y5iHIFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_Y5j8UFJNEeiyW7NaN4qWdw" base_Element="_Y5iHIFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_Y5j8UVJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Y5rREFJNEeiyW7NaN4qWdw" base_Element="_Y5qqAFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_Y5r4IFJNEeiyW7NaN4qWdw" base_Element="_Y5qqAFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_Y5r4IVJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Y51CEFJNEeiyW7NaN4qWdw" base_Element="_Y50bAFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_Y51pIFJNEeiyW7NaN4qWdw" base_Element="_Y50bAFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_Y51pIVJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Y6BPUFJNEeiyW7NaN4qWdw" base_Element="_Y6AoQFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_Y6BPUVJNEeiyW7NaN4qWdw" base_Element="_Y6AoQFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_Y6B2YFJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Y6ODoFJNEeiyW7NaN4qWdw" base_Element="_Y6NckFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_Y6ODoVJNEeiyW7NaN4qWdw" base_Element="_Y6NckFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_Y6ODolJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Y6V_cFJNEeiyW7NaN4qWdw" base_Element="_Y6VYYFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_Y6WmgFJNEeiyW7NaN4qWdw" base_Element="_Y6VYYFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_Y6WmgVJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Y6eiUFJNEeiyW7NaN4qWdw" base_Element="_Y6d7QFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_Y6fJYFJNEeiyW7NaN4qWdw" base_Element="_Y6d7QFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_Y6fJYVJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Y6oTUFJNEeiyW7NaN4qWdw" base_Element="_Y6nsQFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_Y6oTUVJNEeiyW7NaN4qWdw" base_Element="_Y6nsQFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_Y6oTUlJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Y6w2MFJNEeiyW7NaN4qWdw" base_Element="_Y6wPIFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_Y6w2MVJNEeiyW7NaN4qWdw" base_Element="_Y6wPIFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_Y6w2MlJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Y64K8FJNEeiyW7NaN4qWdw" base_Element="_Y63j4FJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_Y65ZEFJNEeiyW7NaN4qWdw" base_Element="_Y63j4FJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_Y65ZEVJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Y7DxIFJNEeiyW7NaN4qWdw" base_Element="_Y7DKEFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_Y7EYMFJNEeiyW7NaN4qWdw" base_Element="_Y7DKEFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_Y7EYMVJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Y7M7EFJNEeiyW7NaN4qWdw" base_Element="_Y7MUAFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_Y7NiIFJNEeiyW7NaN4qWdw" base_Element="_Y7MUAFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_Y7NiIVJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Y7UP0VJNEeiyW7NaN4qWdw" base_Element="_Y7UP0FJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_Y7U24FJNEeiyW7NaN4qWdw" base_Element="_Y7UP0FJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_Y7U24VJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Y7cLoFJNEeiyW7NaN4qWdw" base_Element="_Y7bkkFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_Y7cLoVJNEeiyW7NaN4qWdw" base_Element="_Y7bkkFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_Y7cysFJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Y7kHcVJNEeiyW7NaN4qWdw" base_Element="_Y7kHcFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_Y7kugFJNEeiyW7NaN4qWdw" base_Element="_Y7kHcFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_Y7kugVJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Y7sDQFJNEeiyW7NaN4qWdw" base_Element="_Y7rcMFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_Y7sqUFJNEeiyW7NaN4qWdw" base_Element="_Y7rcMFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_Y7sqUVJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Y8D2sFJNEeiyW7NaN4qWdw" base_Element="_Y8CokFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_Y8FE0FJNEeiyW7NaN4qWdw" base_Element="_Y8CokFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_Y8FE0VJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Y8UVYFJNEeiyW7NaN4qWdw" base_Element="_Y8TuUVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_Y8U8cFJNEeiyW7NaN4qWdw" base_Element="_Y8TuUVJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_Y8U8cVJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Y8Ym0FJNEeiyW7NaN4qWdw" base_Element="_Y8X_wFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_Y8Ym0VJNEeiyW7NaN4qWdw" base_Element="_Y8X_wFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_Y8Ym0lJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Y8_q0FJNEeiyW7NaN4qWdw" base_Element="_Y8-csFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Array xmi:id="_Y9AR4FJNEeiyW7NaN4qWdw" base_Element="_Y8-cslJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Y9EjUFJNEeiyW7NaN4qWdw" base_Element="_Y9D8QFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_Y9FKYFJNEeiyW7NaN4qWdw" base_Element="_Y9D8QFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_Y9FKYVJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Y9QJgVJNEeiyW7NaN4qWdw" base_Element="_Y9QJgFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_Y9QwkFJNEeiyW7NaN4qWdw" base_Element="_Y9QJgFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_Y9QwkVJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Y9WQIFJNEeiyW7NaN4qWdw" base_Element="_Y9VpEFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_Y9WQIVJNEeiyW7NaN4qWdw" base_Element="_Y9VpEFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_Y9WQIlJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Y9dk4VJNEeiyW7NaN4qWdw" base_Element="_Y9dk4FJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_Y9eL8FJNEeiyW7NaN4qWdw" base_Element="_Y9dk4FJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_Y9eL8VJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Y9lgsFJNEeiyW7NaN4qWdw" base_Element="_Y9k5oFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_Y9mHwFJNEeiyW7NaN4qWdw" base_Element="_Y9k5oFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_Y9mHwVJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Y9xG4FJNEeiyW7NaN4qWdw" base_Element="_Y9wf0FJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_Y9xG4VJNEeiyW7NaN4qWdw" base_Element="_Y9wf0FJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_Y9xG4lJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Y-AXcFJNEeiyW7NaN4qWdw" base_Element="_Y9_JUFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_Y-BlkFJNEeiyW7NaN4qWdw" base_Element="_Y9_JUFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_Y-CMoFJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Y-KvgVJNEeiyW7NaN4qWdw" base_Element="_Y-KvgFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_Y-LWkFJNEeiyW7NaN4qWdw" base_Element="_Y-KvgFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_Y-LWkVJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Y-RdMFJNEeiyW7NaN4qWdw" base_Element="_Y-Q2IFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_Y-SEQFJNEeiyW7NaN4qWdw" base_Element="_Y-Q2IFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_Y-SEQVJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Y-Yx8VJNEeiyW7NaN4qWdw" base_Element="_Y-Yx8FJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_Y-ZZAFJNEeiyW7NaN4qWdw" base_Element="_Y-Yx8FJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_Y-ZZAVJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Y-e4kFJNEeiyW7NaN4qWdw" base_Element="_Y-eRgFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_Y-ffoFJNEeiyW7NaN4qWdw" base_Element="_Y-eRgFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_Y-ffoVJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Y-nbcVJNEeiyW7NaN4qWdw" base_Element="_Y-nbcFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_Y-oCgFJNEeiyW7NaN4qWdw" base_Element="_Y-nbcFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_Y-oCgVJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Y-zBoFJNEeiyW7NaN4qWdw" base_Element="_Y-yakFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_Y-zosFJNEeiyW7NaN4qWdw" base_Element="_Y-yakFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_Y-zosVJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Y-6WYFJNEeiyW7NaN4qWdw" base_Element="_Y-5vUFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_Y-6WYVJNEeiyW7NaN4qWdw" base_Element="_Y-5vUFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_Y-6WYlJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Y_FVgFJNEeiyW7NaN4qWdw" base_Element="_Y_EucFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_Y_GjoFJNEeiyW7NaN4qWdw" base_Element="_Y_EucFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_Y_GjoVJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Y_PtkFJNEeiyW7NaN4qWdw" base_Element="_Y_PGgFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_Y_QUoFJNEeiyW7NaN4qWdw" base_Element="_Y_PGgFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_Y_QUoVJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Y_assFJNEeiyW7NaN4qWdw" base_Element="_Y_aFoVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_Y_bTwFJNEeiyW7NaN4qWdw" base_Element="_Y_aFoVJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_Y_bTwVJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Y_kdsFJNEeiyW7NaN4qWdw" base_Element="_Y_j2oFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_Y_kdsVJNEeiyW7NaN4qWdw" base_Element="_Y_j2oFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_Y_lEwFJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Y_sZgFJNEeiyW7NaN4qWdw" base_Element="_Y_rycFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_Y_sZgVJNEeiyW7NaN4qWdw" base_Element="_Y_rycFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_Y_tAkFJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Y_08YFJNEeiyW7NaN4qWdw" base_Element="_Y_0VUFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_Y_1jcFJNEeiyW7NaN4qWdw" base_Element="_Y_0VUFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_Y_1jcVJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_ZAE0AVJNEeiyW7NaN4qWdw" base_Element="_ZAE0AFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_ZAFbEFJNEeiyW7NaN4qWdw" base_Element="_ZAE0AFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_ZAFbEVJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_ZAQaMFJNEeiyW7NaN4qWdw" base_Element="_ZAPzIFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_ZAQaMVJNEeiyW7NaN4qWdw" base_Element="_ZAPzIFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_ZAQaMlJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_ZAfqwVJNEeiyW7NaN4qWdw" base_Element="_ZAfDsVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_ZAgR0FJNEeiyW7NaN4qWdw" base_Element="_ZAfDsVJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_ZAgR0VJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_ZApbwFJNEeiyW7NaN4qWdw" base_Element="_ZAo0sFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_ZApbwVJNEeiyW7NaN4qWdw" base_Element="_ZAo0sFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_ZApbwlJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_ZAylsFJNEeiyW7NaN4qWdw" base_Element="_ZAx-oFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_ZAylsVJNEeiyW7NaN4qWdw" base_Element="_ZAx-oFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_ZAzMwFJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_ZA9k0FJNEeiyW7NaN4qWdw" base_Element="_ZA8WsFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_ZA_aAFJNEeiyW7NaN4qWdw" base_Element="_ZA8WsFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_ZBABEFJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_ZBPRoFJNEeiyW7NaN4qWdw" base_Element="_ZBODgFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_ZBP4sFJNEeiyW7NaN4qWdw" base_Element="_ZBODgFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_ZBP4sVJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:MultiDeclaration xmi:id="_ZBXNcFJNEeiyW7NaN4qWdw" base_Property="_ZBWmYFJNEeiyW7NaN4qWdw" siblings="_aXJ7t1JNEeiyW7NaN4qWdw _aXKiw1JNEeiyW7NaN4qWdw _aXLJ01JNEeiyW7NaN4qWdw" root="true"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_ZBX0gFJNEeiyW7NaN4qWdw" base_Element="_ZBWmYFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_ZBizoFJNEeiyW7NaN4qWdw" base_Element="_ZBiMkFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_ZBizoVJNEeiyW7NaN4qWdw" base_Element="_ZBiMkFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_ZBizolJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_ZBtLsFJNEeiyW7NaN4qWdw" base_Element="_ZBskoFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_ZBtLsVJNEeiyW7NaN4qWdw" base_Element="_ZBskoFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_ZBtywFJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_ZB2VoFJNEeiyW7NaN4qWdw" base_Element="_ZB1ukFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_ZB28sFJNEeiyW7NaN4qWdw" base_Element="_ZB1ukFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_ZB28sVJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_ZB8cQVJNEeiyW7NaN4qWdw" base_Element="_ZB8cQFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_ZB9DUFJNEeiyW7NaN4qWdw" base_Element="_ZB8cQFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_ZB9DUVJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_ZCFmMFJNEeiyW7NaN4qWdw" base_Element="_ZCE_IFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_ZCGNQFJNEeiyW7NaN4qWdw" base_Element="_ZCE_IFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_ZCG0UFJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_ZCOwIlJNEeiyW7NaN4qWdw" base_Element="_ZCOJEFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_ZCVd0VJNEeiyW7NaN4qWdw" base_Element="_ZCU2w1JNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_ZCWE4FJNEeiyW7NaN4qWdw" base_Element="_ZCU2w1JNEeiyW7NaN4qWdw">
    <annotations xmi:id="_ZCWE4VJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_ZCbkcFJNEeiyW7NaN4qWdw" base_Element="_ZCa9YFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_ZCbkcVJNEeiyW7NaN4qWdw" base_Element="_ZCa9YFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_ZCbkclJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_ZCqN8FJNEeiyW7NaN4qWdw" base_Element="_ZCpm4FJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_ZCqN8VJNEeiyW7NaN4qWdw" base_Element="_ZCpm4FJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_ZCqN8lJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_ZCsqMFJNEeiyW7NaN4qWdw" base_Element="_ZCsDIFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Array xmi:id="_ZCsqMlJNEeiyW7NaN4qWdw" base_Element="_ZCsDIVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_ZCtRQFJNEeiyW7NaN4qWdw" base_Element="_ZCsDIFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_ZCtRQVJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_ZCzX4VJNEeiyW7NaN4qWdw" base_Element="_ZCzX4FJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_ZCz-8FJNEeiyW7NaN4qWdw" base_Element="_ZCzX4FJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_ZCz-8VJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_ZC-XAFJNEeiyW7NaN4qWdw" base_Element="_ZC9I4FJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_ZC-XAVJNEeiyW7NaN4qWdw" base_Element="_ZC9I4FJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_ZC-XAlJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_ZDPcwFJNEeiyW7NaN4qWdw" base_Element="_ZDOOoFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_ZDQD0FJNEeiyW7NaN4qWdw" base_Element="_ZDOOoFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_ZDQD0VJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_ZDYmsVJNEeiyW7NaN4qWdw" base_Element="_ZDYmsFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_ZDZNwFJNEeiyW7NaN4qWdw" base_Element="_ZDYmsFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_ZDZNwVJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_ZDgigFJNEeiyW7NaN4qWdw" base_Element="_ZDf7cFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_ZDhJkFJNEeiyW7NaN4qWdw" base_Element="_ZDf7cFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_ZDhJkVJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_ZDpFYFJNEeiyW7NaN4qWdw" base_Element="_ZDoeUFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_ZDpscFJNEeiyW7NaN4qWdw" base_Element="_ZDoeUFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_ZDpscVJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_ZDwaIFJNEeiyW7NaN4qWdw" base_Element="_ZDvzEFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_ZDxBMFJNEeiyW7NaN4qWdw" base_Element="_ZDvzEFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_ZDxBMVJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_ZD2gwFJNEeiyW7NaN4qWdw" base_Element="_ZD15sFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_ZD2gwVJNEeiyW7NaN4qWdw" base_Element="_ZD15sFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_ZD2gwlJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_ZD8nYFJNEeiyW7NaN4qWdw" base_Element="_ZD8AUFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_ZD9OcFJNEeiyW7NaN4qWdw" base_Element="_ZD8AUFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_ZD9OcVJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_ZEFxUFJNEeiyW7NaN4qWdw" base_Element="_ZEFKQFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_ZEFxUVJNEeiyW7NaN4qWdw" base_Element="_ZEFKQFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_ZEFxUlJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_ZEZTUFJNEeiyW7NaN4qWdw" base_Element="_ZEYsQFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_ZEZ6YFJNEeiyW7NaN4qWdw" base_Element="_ZEYsQFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_ZEZ6YVJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_ZEgoEFJNEeiyW7NaN4qWdw" base_Element="_ZEgBAFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_ZEgoEVJNEeiyW7NaN4qWdw" base_Element="_ZEgBAFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_ZEgoElJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_ZEnVwVJNEeiyW7NaN4qWdw" base_Element="_ZEnVwFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_ZEn80FJNEeiyW7NaN4qWdw" base_Element="_ZEnVwFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_ZEn80VJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_ZEs1UVJNEeiyW7NaN4qWdw" base_Element="_ZEs1UFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_ZEtcYFJNEeiyW7NaN4qWdw" base_Element="_ZEs1UFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_ZEtcYVJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_ZEyU5VJNEeiyW7NaN4qWdw" base_Element="_ZEyU4FJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Array xmi:id="_ZEy78VJNEeiyW7NaN4qWdw" base_Element="_ZEyU4lJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_ZEzjAFJNEeiyW7NaN4qWdw" base_Element="_ZEy78lJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_ZEzjAVJNEeiyW7NaN4qWdw" base_Element="_ZEy78lJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_ZEzjAlJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_ZE30cFJNEeiyW7NaN4qWdw" base_Element="_ZE3NYFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_ZE30cVJNEeiyW7NaN4qWdw" base_Element="_ZE3NYFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_ZE30clJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_ZE97EFJNEeiyW7NaN4qWdw" base_Element="_ZE9UAFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_ZE97EVJNEeiyW7NaN4qWdw" base_Element="_ZE9UAFJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_ZE-iIFJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_ZFEow1JNEeiyW7NaN4qWdw" base_Element="_ZFEowFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Generics xmi:id="_ZFITIFJNEeiyW7NaN4qWdw" genericsValue="String, String" base_Element="_ZFHFAFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_ZFITIVJNEeiyW7NaN4qWdw" base_Element="_ZFHFAFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Array xmi:id="_ZFITI1JNEeiyW7NaN4qWdw" base_Element="_ZFHFAVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Generics xmi:id="_ZFbOEFJNEeiyW7NaN4qWdw" genericsValue="String, String" base_Element="_ZFanAFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aGxWUFJNEeiyW7NaN4qWdw" base_Element="_aGwvQFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aGykcFJNEeiyW7NaN4qWdw" base_Element="_aGx9YFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aGzLgFJNEeiyW7NaN4qWdw" base_Element="_aGykcVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aGzykFJNEeiyW7NaN4qWdw" base_Element="_aGzLgVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aG0ZoFJNEeiyW7NaN4qWdw" base_Element="_aGzykVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aG1AsFJNEeiyW7NaN4qWdw" base_Element="_aG0ZoVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aG3c8VJNEeiyW7NaN4qWdw" base_Element="_aG3c8FJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aG4rEFJNEeiyW7NaN4qWdw" base_Element="_aG4EAFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aG5SIFJNEeiyW7NaN4qWdw" base_Element="_aG4rEVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aG55MFJNEeiyW7NaN4qWdw" base_Element="_aG5SIVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aG6gQFJNEeiyW7NaN4qWdw" base_Element="_aG55MVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aHBN8FJNEeiyW7NaN4qWdw" base_Element="_aG-xsFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aHKX4FJNEeiyW7NaN4qWdw" base_Element="_aHJw0FJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aHK-8FJNEeiyW7NaN4qWdw" base_Element="_aHKX4VJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aHLmAFJNEeiyW7NaN4qWdw" base_Element="_aHK-8VJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aHUv8FJNEeiyW7NaN4qWdw" base_Element="_aHUI4FJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aHXzQFJNEeiyW7NaN4qWdw" base_Element="_aHXMMFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aHYaUFJNEeiyW7NaN4qWdw" base_Element="_aHXzQVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aHZBYFJNEeiyW7NaN4qWdw" base_Element="_aHYaUVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aHcrwFJNEeiyW7NaN4qWdw" base_Element="_aHcEsFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aHnq4FJNEeiyW7NaN4qWdw" base_Element="_aHmcwFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aHpgEFJNEeiyW7NaN4qWdw" base_Element="_aHo5AFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aHquMFJNEeiyW7NaN4qWdw" base_Element="_aHqHIFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aHr8UFJNEeiyW7NaN4qWdw" base_Element="_aHquMVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aHsjYFJNEeiyW7NaN4qWdw" base_Element="_aHr8UVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aH4JkFJNEeiyW7NaN4qWdw" base_Element="_aH3igFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aH5-wFJNEeiyW7NaN4qWdw" base_Element="_aH4JkVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aH-3QFJNEeiyW7NaN4qWdw" base_Element="_aH-QMFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aH_eUFJNEeiyW7NaN4qWdw" base_Element="_aH-3QVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aIAFYFJNEeiyW7NaN4qWdw" base_Element="_aH_eUVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aIBTgFJNEeiyW7NaN4qWdw" base_Element="_aIAFYVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aIKdcFJNEeiyW7NaN4qWdw" base_Element="_aIJ2YFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aILEgFJNEeiyW7NaN4qWdw" base_Element="_aIKdcVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aILrkFJNEeiyW7NaN4qWdw" base_Element="_aILEgVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aIMSoFJNEeiyW7NaN4qWdw" base_Element="_aILrkVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aIM5sFJNEeiyW7NaN4qWdw" base_Element="_aIMSoVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aINgwFJNEeiyW7NaN4qWdw" base_Element="_aIM5sVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aIOH0FJNEeiyW7NaN4qWdw" base_Element="_aINgwVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aIPV8FJNEeiyW7NaN4qWdw" base_Element="_aIOH0VJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aIP9AFJNEeiyW7NaN4qWdw" base_Element="_aIPV8VJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aIQkEFJNEeiyW7NaN4qWdw" base_Element="_aIP9AVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aIRLIFJNEeiyW7NaN4qWdw" base_Element="_aIQkEVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aIRyMFJNEeiyW7NaN4qWdw" base_Element="_aIRLIVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aISZQFJNEeiyW7NaN4qWdw" base_Element="_aIRyMVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aITAUFJNEeiyW7NaN4qWdw" base_Element="_aISZQVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aIUOcFJNEeiyW7NaN4qWdw" base_Element="_aITAUVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aIU1gFJNEeiyW7NaN4qWdw" base_Element="_aIUOcVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aIVckFJNEeiyW7NaN4qWdw" base_Element="_aIU1gVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aIWDoFJNEeiyW7NaN4qWdw" base_Element="_aIVckVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aIWqsFJNEeiyW7NaN4qWdw" base_Element="_aIWDoVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aIX40FJNEeiyW7NaN4qWdw" base_Element="_aIXRwFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aIhp0FJNEeiyW7NaN4qWdw" base_Element="_aIhCwFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aIl7QFJNEeiyW7NaN4qWdw" base_Element="_aIlUMFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aImiUFJNEeiyW7NaN4qWdw" base_Element="_aIl7QVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aInwcFJNEeiyW7NaN4qWdw" base_Element="_aInJYFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aIoXgFJNEeiyW7NaN4qWdw" base_Element="_aInwcVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aIo-kFJNEeiyW7NaN4qWdw" base_Element="_aIoXgVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aIqMsFJNEeiyW7NaN4qWdw" base_Element="_aIploFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aIqzwFJNEeiyW7NaN4qWdw" base_Element="_aIqMsVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aIra0FJNEeiyW7NaN4qWdw" base_Element="_aIqzwVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aIso8FJNEeiyW7NaN4qWdw" base_Element="_aIsB4FJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aItQAFJNEeiyW7NaN4qWdw" base_Element="_aIso8VJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aI2Z8FJNEeiyW7NaN4qWdw" base_Element="_aI1y4FJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aI6rYFJNEeiyW7NaN4qWdw" base_Element="_aI6EUFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aJDOQFJNEeiyW7NaN4qWdw" base_Element="_aJCnMFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aJD1UFJNEeiyW7NaN4qWdw" base_Element="_aJDOQVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aJEcYFJNEeiyW7NaN4qWdw" base_Element="_aJD1UVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aJMYMFJNEeiyW7NaN4qWdw" base_Element="_aJLxIFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aJPbgFJNEeiyW7NaN4qWdw" base_Element="_aJO0cFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aJSe0FJNEeiyW7NaN4qWdw" base_Element="_aJR3wFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aJTF4FJNEeiyW7NaN4qWdw" base_Element="_aJSe0VJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aJViIFJNEeiyW7NaN4qWdw" base_Element="_aJU7EFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aJbowFJNEeiyW7NaN4qWdw" base_Element="_aJbBsFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aJ7YAFJNEeiyW7NaN4qWdw" base_Element="_aJ6w8FJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aKBeoFJNEeiyW7NaN4qWdw" base_Element="_aKA3kFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aKL2sFJNEeiyW7NaN4qWdw" base_Element="_aKLPoFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aKUZkFJNEeiyW7NaN4qWdw" base_Element="_aKTygFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aKbuUFJNEeiyW7NaN4qWdw" base_Element="_aKbHQFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aKcVYFJNEeiyW7NaN4qWdw" base_Element="_aKbuUVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aKc8cFJNEeiyW7NaN4qWdw" base_Element="_aKcVYVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aKhN4FJNEeiyW7NaN4qWdw" base_Element="_aKgm0FJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aKvQUFJNEeiyW7NaN4qWdw" base_Element="_aKupQFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aKy6sFJNEeiyW7NaN4qWdw" base_Element="_aKyToFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aK62gFJNEeiyW7NaN4qWdw" base_Element="_aK6PcFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aLCLQFJNEeiyW7NaN4qWdw" base_Element="_aLBkMFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aLKHEFJNEeiyW7NaN4qWdw" base_Element="_aLJgAFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aLKuIFJNEeiyW7NaN4qWdw" base_Element="_aLKHEVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aLLVMFJNEeiyW7NaN4qWdw" base_Element="_aLKuIVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aLL8QVJNEeiyW7NaN4qWdw" base_Element="_aLL8QFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aLNKYFJNEeiyW7NaN4qWdw" base_Element="_aLMjUFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aLNxcFJNEeiyW7NaN4qWdw" base_Element="_aLNKYVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aLOYgFJNEeiyW7NaN4qWdw" base_Element="_aLNxcVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aLO_kFJNEeiyW7NaN4qWdw" base_Element="_aLOYgVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aLPmoFJNEeiyW7NaN4qWdw" base_Element="_aLO_kVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Generics xmi:id="_aNJrIFJNEeiyW7NaN4qWdw" genericsValue="FoundingFather" base_Element="_aNJEEVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aNlwAFJNEeiyW7NaN4qWdw" base_Element="_aNlI8FJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_aNmXEFJNEeiyW7NaN4qWdw" base_Element="_aNlI8FJNEeiyW7NaN4qWdw">
    <annotations xmi:id="_aNmXEVJNEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:Generics xmi:id="_aNwIEFJNEeiyW7NaN4qWdw" genericsValue="Element" base_Element="_aNvhAFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Generics xmi:id="_aOcEkFJNEeiyW7NaN4qWdw" genericsValue="Goods" base_Element="_aOa2c1JNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Generics xmi:id="_aO5XkFJNEeiyW7NaN4qWdw" genericsValue="Goods" base_Element="_aO4wg1JNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aO7MwFJNEeiyW7NaN4qWdw" base_Element="_aO6lsVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aPNgoVJNEeiyW7NaN4qWdw" base_Element="_aPNgoFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aPnJQVJNEeiyW7NaN4qWdw" base_Element="_aPnJQFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Generics xmi:id="_aQAx4FJNEeiyW7NaN4qWdw" genericsValue="BuildableType" base_Element="_aQAK0VJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Generics xmi:id="_aQLxAFJNEeiyW7NaN4qWdw" genericsValue="TradeRoute" base_Element="_aQKi4VJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Generics xmi:id="_aQc2wFJNEeiyW7NaN4qWdw" genericsValue="String, String" base_Element="_aQcPs1JNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Generics xmi:id="_aQq5MFJNEeiyW7NaN4qWdw" genericsValue="String, String" base_Element="_aQoc8VJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Generics xmi:id="_aQ6JwFJNEeiyW7NaN4qWdw" genericsValue="FoundingFather" base_Element="_aQ5isVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Generics xmi:id="_aRIMMFJNEeiyW7NaN4qWdw" genericsValue="Goods" base_Element="_aRHlI1JNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Array xmi:id="_aRLPhVJNEeiyW7NaN4qWdw" base_Element="_aRLPgFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Generics xmi:id="_aRR9MFJNEeiyW7NaN4qWdw" genericsValue="BuildableType" base_Element="_aRRWIlJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Generics xmi:id="_aRWOoFJNEeiyW7NaN4qWdw" genericsValue="TradeRoute" base_Element="_aRVnkVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aRmtUVJNEeiyW7NaN4qWdw" base_Element="_aRmtUFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aRoigVJNEeiyW7NaN4qWdw" base_Element="_aRoigFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aRpJkVJNEeiyW7NaN4qWdw" base_Element="_aRpJkFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aRpwoVJNEeiyW7NaN4qWdw" base_Element="_aRpwoFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aRqXsVJNEeiyW7NaN4qWdw" base_Element="_aRqXsFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aRq-wVJNEeiyW7NaN4qWdw" base_Element="_aRq-wFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aRrl0VJNEeiyW7NaN4qWdw" base_Element="_aRrl0FJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aRsz8FJNEeiyW7NaN4qWdw" base_Element="_aRsM4FJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aRtbAFJNEeiyW7NaN4qWdw" base_Element="_aRsz8VJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aRuCEFJNEeiyW7NaN4qWdw" base_Element="_aRtbAVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aRvQMFJNEeiyW7NaN4qWdw" base_Element="_aRuCEVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aRv3QVJNEeiyW7NaN4qWdw" base_Element="_aRv3QFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aRxFYFJNEeiyW7NaN4qWdw" base_Element="_aRweUFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aRxscFJNEeiyW7NaN4qWdw" base_Element="_aRxFYVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aRyTgFJNEeiyW7NaN4qWdw" base_Element="_aRxscVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aRzhoFJNEeiyW7NaN4qWdw" base_Element="_aRy6kFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aR0IsFJNEeiyW7NaN4qWdw" base_Element="_aRzhoVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aR0IslJNEeiyW7NaN4qWdw" base_Element="_aR0IsVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aR1W0FJNEeiyW7NaN4qWdw" base_Element="_aR0vwFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aR194FJNEeiyW7NaN4qWdw" base_Element="_aR1W0VJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aR2k8VJNEeiyW7NaN4qWdw" base_Element="_aR2k8FJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aR3MAVJNEeiyW7NaN4qWdw" base_Element="_aR3MAFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aR4aIFJNEeiyW7NaN4qWdw" base_Element="_aR3zEFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aR4aIlJNEeiyW7NaN4qWdw" base_Element="_aR4aIVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aR5oQFJNEeiyW7NaN4qWdw" base_Element="_aR5BMFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aR5oQlJNEeiyW7NaN4qWdw" base_Element="_aR5oQVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aR6PUVJNEeiyW7NaN4qWdw" base_Element="_aR6PUFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aR62YFJNEeiyW7NaN4qWdw" base_Element="_aR6PUlJNEeiyW7NaN4qWdw">
    <associatedElement xmi:type="uml:Operation" xmi:id="_aR7dcFJNEeiyW7NaN4qWdw" name="getMessage" method="_aU1ngFJNEeiyW7NaN4qWdw">
      <ownedParameter xmi:id="_aR7dcVJNEeiyW7NaN4qWdw" direction="return">
        <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
      </ownedParameter>
    </associatedElement>
  </UMLLabProfile:LegacyStyledElement>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aR8EgFJNEeiyW7NaN4qWdw" base_Element="_aR7dclJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aR9SoVJNEeiyW7NaN4qWdw" base_Element="_aR9SoFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aR-gwFJNEeiyW7NaN4qWdw" base_Element="_aR95sFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aR_H0FJNEeiyW7NaN4qWdw" base_Element="_aR-gwVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aR_H0lJNEeiyW7NaN4qWdw" base_Element="_aR_H0VJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aSAV8FJNEeiyW7NaN4qWdw" base_Element="_aR_u4FJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aSBkEFJNEeiyW7NaN4qWdw" base_Element="_aSA9AlJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aSBkElJNEeiyW7NaN4qWdw" base_Element="_aSBkEVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aSCLIVJNEeiyW7NaN4qWdw" base_Element="_aSCLIFJNEeiyW7NaN4qWdw">
    <associatedElement xmi:type="uml:Operation" xmi:id="_aSCyMFJNEeiyW7NaN4qWdw" name="getPort" method="_aU6gBFJNEeiyW7NaN4qWdw">
      <ownedParameter xmi:id="_aSCyMVJNEeiyW7NaN4qWdw" direction="return">
        <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
      </ownedParameter>
    </associatedElement>
  </UMLLabProfile:LegacyStyledElement>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aSEAUFJNEeiyW7NaN4qWdw" base_Element="_aSDZQFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aSEnYFJNEeiyW7NaN4qWdw" base_Element="_aSEAUVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aSHqslJNEeiyW7NaN4qWdw" base_Element="_aSHqsVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aSIRwVJNEeiyW7NaN4qWdw" base_Element="_aSIRwFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aSI40FJNEeiyW7NaN4qWdw" base_Element="_aSIRwlJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aSI40lJNEeiyW7NaN4qWdw" base_Element="_aSI40VJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aSJf4VJNEeiyW7NaN4qWdw" base_Element="_aSJf4FJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aSKG8FJNEeiyW7NaN4qWdw" base_Element="_aSJf4lJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aSKG8lJNEeiyW7NaN4qWdw" base_Element="_aSKG8VJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aSMjMFJNEeiyW7NaN4qWdw" base_Element="_aSL8JFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aSNxUFJNEeiyW7NaN4qWdw" base_Element="_aSNKQFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aSNxUlJNEeiyW7NaN4qWdw" base_Element="_aSNxUVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aSOYYVJNEeiyW7NaN4qWdw" base_Element="_aSOYYFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aSO_cFJNEeiyW7NaN4qWdw" base_Element="_aSOYYlJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aSPmgVJNEeiyW7NaN4qWdw" base_Element="_aSPmgFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aSQNkFJNEeiyW7NaN4qWdw" base_Element="_aSPmglJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aSQNklJNEeiyW7NaN4qWdw" base_Element="_aSQNkVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aSQ0oVJNEeiyW7NaN4qWdw" base_Element="_aSQ0oFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aSRbsFJNEeiyW7NaN4qWdw" base_Element="_aSQ0olJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aSSCwFJNEeiyW7NaN4qWdw" base_Element="_aSRbsVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aSSp0FJNEeiyW7NaN4qWdw" base_Element="_aSSCwVJNEeiyW7NaN4qWdw"/>
  <Persistency:JPA1StyledElement xmi:id="_aSe3EFJNEeiyW7NaN4qWdw" base_Element="_aSSp0VJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aSgsQFJNEeiyW7NaN4qWdw" base_Element="_aSgFMFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aShTUVJNEeiyW7NaN4qWdw" base_Element="_aShTUFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aSihcFJNEeiyW7NaN4qWdw" base_Element="_aSh6YFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aSjIgVJNEeiyW7NaN4qWdw" base_Element="_aSjIgFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aSjvkFJNEeiyW7NaN4qWdw" base_Element="_aSjIglJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aSkWoVJNEeiyW7NaN4qWdw" base_Element="_aSkWoFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aSk9sVJNEeiyW7NaN4qWdw" base_Element="_aSk9sFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aSlkwVJNEeiyW7NaN4qWdw" base_Element="_aSlkwFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aSmL0FJNEeiyW7NaN4qWdw" base_Element="_aSlkwlJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aSmy4VJNEeiyW7NaN4qWdw" base_Element="_aSmy4FJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aSv80FJNEeiyW7NaN4qWdw" base_Element="_aSmy4lJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aSwj4FJNEeiyW7NaN4qWdw" base_Element="_aSv80VJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aSxK8FJNEeiyW7NaN4qWdw" base_Element="_aSwj4VJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aSxK8lJNEeiyW7NaN4qWdw" base_Element="_aSxK8VJNEeiyW7NaN4qWdw">
    <associatedElement xmi:type="uml:Operation" xmi:id="_aSxyAFJNEeiyW7NaN4qWdw" name="getResult" method="_aVThkFJNEeiyW7NaN4qWdw">
      <ownedParameter xmi:id="_aSyZEFJNEeiyW7NaN4qWdw" direction="return">
        <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
      </ownedParameter>
    </associatedElement>
    <associatedElement xmi:type="uml:Operation" xmi:id="_aSxyAVJNEeiyW7NaN4qWdw" name="setResult" method="_aVThklJNEeiyW7NaN4qWdw">
      <ownedParameter xmi:id="_aSxyAlJNEeiyW7NaN4qWdw" name="result">
        <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
      </ownedParameter>
      <ownedParameter xmi:id="_aSyZEVJNEeiyW7NaN4qWdw" type="_Y-jxEFJNEeiyW7NaN4qWdw" direction="return"/>
    </associatedElement>
  </UMLLabProfile:LegacyStyledElement>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aS0OQVJNEeiyW7NaN4qWdw" base_Element="_aS0OQFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aS01UVJNEeiyW7NaN4qWdw" base_Element="_aS01UFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aS2qgFJNEeiyW7NaN4qWdw" base_Element="_aS2DcFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aS34oFJNEeiyW7NaN4qWdw" base_Element="_aS3RkFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aS4fsVJNEeiyW7NaN4qWdw" base_Element="_aS4fsFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aS5t0FJNEeiyW7NaN4qWdw" base_Element="_aS5GwFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aS678FJNEeiyW7NaN4qWdw" base_Element="_aS5t0VJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aS8KEFJNEeiyW7NaN4qWdw" base_Element="_aS7jAFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aS8xIFJNEeiyW7NaN4qWdw" base_Element="_aS8KEVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aS9YMFJNEeiyW7NaN4qWdw" base_Element="_aS8xIVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aS9_QFJNEeiyW7NaN4qWdw" base_Element="_aS9YMVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aS-mUVJNEeiyW7NaN4qWdw" base_Element="_aS-mUFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aS_NYVJNEeiyW7NaN4qWdw" base_Element="_aS_NYFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aS_0cVJNEeiyW7NaN4qWdw" base_Element="_aS_0cFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTAbgFJNEeiyW7NaN4qWdw" base_Element="_aS_0clJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTBCkVJNEeiyW7NaN4qWdw" base_Element="_aTBCkFJNEeiyW7NaN4qWdw">
    <associatedElement xmi:type="uml:Operation" xmi:id="_aTBpoFJNEeiyW7NaN4qWdw" name="getResult" method="_aVa2UFJNEeiyW7NaN4qWdw">
      <ownedParameter xmi:id="_aTCQslJNEeiyW7NaN4qWdw" direction="return">
        <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
      </ownedParameter>
    </associatedElement>
    <associatedElement xmi:type="uml:Operation" xmi:id="_aTCQsFJNEeiyW7NaN4qWdw" name="setResult" method="_aVa2UlJNEeiyW7NaN4qWdw">
      <ownedParameter xmi:id="_aTCQsVJNEeiyW7NaN4qWdw" name="result">
        <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
      </ownedParameter>
    </associatedElement>
  </UMLLabProfile:LegacyStyledElement>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTDe0FJNEeiyW7NaN4qWdw" base_Element="_aTC3wFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTEF4FJNEeiyW7NaN4qWdw" base_Element="_aTDe0VJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTEs8VJNEeiyW7NaN4qWdw" base_Element="_aTEs8FJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTFUAVJNEeiyW7NaN4qWdw" base_Element="_aTFUAFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTF7EVJNEeiyW7NaN4qWdw" base_Element="_aTF7EFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTGiIFJNEeiyW7NaN4qWdw" base_Element="_aTF7ElJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTHJMFJNEeiyW7NaN4qWdw" base_Element="_aTGiIVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTHJMlJNEeiyW7NaN4qWdw" base_Element="_aTHJMVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTHwQVJNEeiyW7NaN4qWdw" base_Element="_aTHwQFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTIXUVJNEeiyW7NaN4qWdw" base_Element="_aTIXUFJNEeiyW7NaN4qWdw">
    <associatedElement xmi:type="uml:Operation" xmi:id="_aTIXUlJNEeiyW7NaN4qWdw" name="getUserName" method="_aVgV4FJNEeiyW7NaN4qWdw">
      <ownedParameter xmi:id="_aTIXU1JNEeiyW7NaN4qWdw" direction="return">
        <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
      </ownedParameter>
    </associatedElement>
  </UMLLabProfile:LegacyStyledElement>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTI-YVJNEeiyW7NaN4qWdw" base_Element="_aTI-YFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTJlcFJNEeiyW7NaN4qWdw" base_Element="_aTI-YlJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTJlclJNEeiyW7NaN4qWdw" base_Element="_aTJlcVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTKMgFJNEeiyW7NaN4qWdw" base_Element="_aTJlc1JNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTKzkFJNEeiyW7NaN4qWdw" base_Element="_aTKMgVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTKzklJNEeiyW7NaN4qWdw" base_Element="_aTKzkVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTLaoVJNEeiyW7NaN4qWdw" base_Element="_aTLaoFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTMowFJNEeiyW7NaN4qWdw" base_Element="_aTMBsFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTMowlJNEeiyW7NaN4qWdw" base_Element="_aTMowVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTNP0VJNEeiyW7NaN4qWdw" base_Element="_aTNP0FJNEeiyW7NaN4qWdw">
    <associatedElement xmi:type="uml:Operation" xmi:id="_aTNP01JNEeiyW7NaN4qWdw" name="getGoods" method="_aViyIFJNEeiyW7NaN4qWdw">
      <ownedParameter xmi:id="_aTN24FJNEeiyW7NaN4qWdw" type="_aHJw0FJNEeiyW7NaN4qWdw" isOrdered="true" direction="return">
        <upperValue xmi:type="uml:LiteralUnlimitedNatural" xmi:id="_aTN24VJNEeiyW7NaN4qWdw" value="*"/>
      </ownedParameter>
    </associatedElement>
  </UMLLabProfile:LegacyStyledElement>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTPFA1JNEeiyW7NaN4qWdw" base_Element="_aTPFAlJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTQTIFJNEeiyW7NaN4qWdw" base_Element="_aTPsEFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTQ6MFJNEeiyW7NaN4qWdw" base_Element="_aTQTIVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTQ6MlJNEeiyW7NaN4qWdw" base_Element="_aTQ6MVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTRhQVJNEeiyW7NaN4qWdw" base_Element="_aTRhQFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTSIUVJNEeiyW7NaN4qWdw" base_Element="_aTSIUFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTSvYFJNEeiyW7NaN4qWdw" base_Element="_aTSIUlJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTSvYlJNEeiyW7NaN4qWdw" base_Element="_aTSvYVJNEeiyW7NaN4qWdw">
    <associatedElement xmi:type="uml:Operation" xmi:id="_aTTWcFJNEeiyW7NaN4qWdw" name="getTax" method="_aVoRslJNEeiyW7NaN4qWdw">
      <ownedParameter xmi:id="_aTTWc1JNEeiyW7NaN4qWdw" direction="return">
        <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
      </ownedParameter>
    </associatedElement>
    <associatedElement xmi:type="uml:Operation" xmi:id="_aTTWcVJNEeiyW7NaN4qWdw" name="setTax" method="_aVoRtFJNEeiyW7NaN4qWdw">
      <ownedParameter xmi:id="_aTTWclJNEeiyW7NaN4qWdw" name="tax">
        <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
      </ownedParameter>
      <ownedParameter xmi:id="_aTTWdFJNEeiyW7NaN4qWdw" type="_ZAttMFJNEeiyW7NaN4qWdw" direction="return"/>
    </associatedElement>
  </UMLLabProfile:LegacyStyledElement>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTT9gVJNEeiyW7NaN4qWdw" base_Element="_aTT9gFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTVLoFJNEeiyW7NaN4qWdw" base_Element="_aTUkkFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTVLolJNEeiyW7NaN4qWdw" base_Element="_aTVLoVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTWZwFJNEeiyW7NaN4qWdw" base_Element="_aTVysFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTWZwlJNEeiyW7NaN4qWdw" base_Element="_aTWZwVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTXn4FJNEeiyW7NaN4qWdw" base_Element="_aTXA0FJNEeiyW7NaN4qWdw">
    <associatedElement xmi:type="uml:Operation" xmi:id="_aTXn4lJNEeiyW7NaN4qWdw" name="setResponse" method="_aVu_YFJNEeiyW7NaN4qWdw">
      <eAnnotations xmi:id="_aTYO8FJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
        <details xmi:id="_aTYO8VJNEeiyW7NaN4qWdw" key="synchronized"/>
      </eAnnotations>
      <ownedParameter xmi:id="_aTXn41JNEeiyW7NaN4qWdw" name="response" type="_aPNgoFJNEeiyW7NaN4qWdw"/>
    </associatedElement>
    <associatedElement xmi:type="uml:Operation" xmi:id="_aTXn5FJNEeiyW7NaN4qWdw" name="getResponse" method="_aVvmcFJNEeiyW7NaN4qWdw">
      <eAnnotations xmi:id="_aTYO8lJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
        <details xmi:id="_aTYO81JNEeiyW7NaN4qWdw" key="synchronized"/>
      </eAnnotations>
      <ownedParameter xmi:id="_aTYO9FJNEeiyW7NaN4qWdw" type="_aPNgoFJNEeiyW7NaN4qWdw" direction="return"/>
    </associatedElement>
  </UMLLabProfile:LegacyStyledElement>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTY2AlJNEeiyW7NaN4qWdw" base_Element="_aTY2AFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTZdEFJNEeiyW7NaN4qWdw" base_Element="_aTY2A1JNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTarMVJNEeiyW7NaN4qWdw" base_Element="_aTarMFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTbSQVJNEeiyW7NaN4qWdw" base_Element="_aTbSQFJNEeiyW7NaN4qWdw">
    <associatedElement xmi:type="uml:Operation" xmi:id="_aTbSQlJNEeiyW7NaN4qWdw" name="getNewLandName" method="_aVwNgVJNEeiyW7NaN4qWdw">
      <ownedParameter xmi:id="_aTb5UFJNEeiyW7NaN4qWdw" direction="return">
        <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
      </ownedParameter>
    </associatedElement>
  </UMLLabProfile:LegacyStyledElement>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTcgYVJNEeiyW7NaN4qWdw" base_Element="_aTcgYFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTdHcVJNEeiyW7NaN4qWdw" base_Element="_aTdHcFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTdugFJNEeiyW7NaN4qWdw" base_Element="_aTdHclJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTeVkFJNEeiyW7NaN4qWdw" base_Element="_aTdugVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTe8oVJNEeiyW7NaN4qWdw" base_Element="_aTe8oFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTfjsVJNEeiyW7NaN4qWdw" base_Element="_aTfjsFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTgx0FJNEeiyW7NaN4qWdw" base_Element="_aTgKwFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aThY4FJNEeiyW7NaN4qWdw" base_Element="_aTgx0VJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTh_8FJNEeiyW7NaN4qWdw" base_Element="_aThY4VJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTh_8lJNEeiyW7NaN4qWdw" base_Element="_aTh_8VJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTinAVJNEeiyW7NaN4qWdw" base_Element="_aTinAFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTjOEFJNEeiyW7NaN4qWdw" base_Element="_aTinAlJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Generics xmi:id="_aTrJ4FJNEeiyW7NaN4qWdw" genericsValue="UnitChange" base_Element="_aTj1IFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTrw8FJNEeiyW7NaN4qWdw" base_Element="_aTrJ4lJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTsYAVJNEeiyW7NaN4qWdw" base_Element="_aTrw8VJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTvbUFJNEeiyW7NaN4qWdw" base_Element="_aTu0QlJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Array xmi:id="_aTwCYVJNEeiyW7NaN4qWdw" base_Element="_aTvbUVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTwpcVJNEeiyW7NaN4qWdw" base_Element="_aTvbUVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTx3kFJNEeiyW7NaN4qWdw" base_Element="_aTxQgFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTyeoFJNEeiyW7NaN4qWdw" base_Element="_aTx3kVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTzFsFJNEeiyW7NaN4qWdw" base_Element="_aTyeoVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aTzswVJNEeiyW7NaN4qWdw" base_Element="_aTzFsVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aT4lQFJNEeiyW7NaN4qWdw" base_Element="_aT2JAFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aT5MUlJNEeiyW7NaN4qWdw" base_Element="_aT5MUVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aT5zYVJNEeiyW7NaN4qWdw" base_Element="_aT5zYFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aT6acFJNEeiyW7NaN4qWdw" base_Element="_aT5zYlJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aT7BgFJNEeiyW7NaN4qWdw" base_Element="_aT6acVJNEeiyW7NaN4qWdw">
    <associatedElement xmi:type="uml:Operation" xmi:id="_aT7BgVJNEeiyW7NaN4qWdw" name="getNextNetworkReplyId" method="_aWBTRlJNEeiyW7NaN4qWdw">
      <eAnnotations xmi:id="_aT7BglJNEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
        <details xmi:id="_aT7Bg1JNEeiyW7NaN4qWdw" key="synchronized"/>
      </eAnnotations>
      <ownedParameter xmi:id="_aT7BhFJNEeiyW7NaN4qWdw" direction="return">
        <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
      </ownedParameter>
    </associatedElement>
  </UMLLabProfile:LegacyStyledElement>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aT82sFJNEeiyW7NaN4qWdw" base_Element="_aT8PoFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aT82slJNEeiyW7NaN4qWdw" base_Element="_aT82sVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aT-E0FJNEeiyW7NaN4qWdw" base_Element="_aT9dwFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aT-r4FJNEeiyW7NaN4qWdw" base_Element="_aT-E0VJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aT_S8FJNEeiyW7NaN4qWdw" base_Element="_aT-r4VJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aT_6AFJNEeiyW7NaN4qWdw" base_Element="_aT_S8VJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aUAhEFJNEeiyW7NaN4qWdw" base_Element="_aT_6AVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aUBIIFJNEeiyW7NaN4qWdw" base_Element="_aUAhEVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aUBIIlJNEeiyW7NaN4qWdw" base_Element="_aUBIIVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aUBvMVJNEeiyW7NaN4qWdw" base_Element="_aUBvMFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aUC9UFJNEeiyW7NaN4qWdw" base_Element="_aUCWQFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aUC9UlJNEeiyW7NaN4qWdw" base_Element="_aUC9UVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aUDkYVJNEeiyW7NaN4qWdw" base_Element="_aUDkYFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aUELcFJNEeiyW7NaN4qWdw" base_Element="_aUDkYlJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aUEygVJNEeiyW7NaN4qWdw" base_Element="_aUEygFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aUFZkFJNEeiyW7NaN4qWdw" base_Element="_aUEyglJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aUGAoVJNEeiyW7NaN4qWdw" base_Element="_aUGAoFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Array xmi:id="_aUGnslJNEeiyW7NaN4qWdw" base_Element="_aUGnsFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aUGns1JNEeiyW7NaN4qWdw" base_Element="_aUGnsFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aUH10FJNEeiyW7NaN4qWdw" base_Element="_aUHOwFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aUIc4FJNEeiyW7NaN4qWdw" base_Element="_aUH10VJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aUJD8VJNEeiyW7NaN4qWdw" base_Element="_aUJD8FJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aUJrAFJNEeiyW7NaN4qWdw" base_Element="_aUJD8lJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aUKSEFJNEeiyW7NaN4qWdw" base_Element="_aUJrAVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aUK5IFJNEeiyW7NaN4qWdw" base_Element="_aUKSEVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aUMHQFJNEeiyW7NaN4qWdw" base_Element="_aULgMlJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aUMuUVJNEeiyW7NaN4qWdw" base_Element="_aUMuUFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aUNVYVJNEeiyW7NaN4qWdw" base_Element="_aUNVYFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aUOjgFJNEeiyW7NaN4qWdw" base_Element="_aUN8cFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aUPKkVJNEeiyW7NaN4qWdw" base_Element="_aUPKkFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Array xmi:id="_aUPxoVJNEeiyW7NaN4qWdw" base_Element="_aUPKklJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aUPxolJNEeiyW7NaN4qWdw" base_Element="_aUPKklJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aUQYsVJNEeiyW7NaN4qWdw" base_Element="_aUQYsFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aUQ_wFJNEeiyW7NaN4qWdw" base_Element="_aUQYslJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aURm0FJNEeiyW7NaN4qWdw" base_Element="_aUQ_wVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aUSN4VJNEeiyW7NaN4qWdw" base_Element="_aUSN4FJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aUTcAVJNEeiyW7NaN4qWdw" base_Element="_aUTcAFJNEeiyW7NaN4qWdw"/>
  <uml:OpaqueBehavior xmi:id="_aU1ngFJNEeiyW7NaN4qWdw" name="getMessage" specification="_aR7dcFJNEeiyW7NaN4qWdw">
    <ownedParameter xmi:id="_aU1ngVJNEeiyW7NaN4qWdw" direction="return">
      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
    </ownedParameter>
    <language>java</language>
    <body>return message;&#xD;
 </body>
  </uml:OpaqueBehavior>
  <uml:OpaqueBehavior xmi:id="_aU6gBFJNEeiyW7NaN4qWdw" name="getPort" specification="_aSCyMFJNEeiyW7NaN4qWdw">
    <ownedParameter xmi:id="_aU7HEFJNEeiyW7NaN4qWdw" direction="return">
      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
    </ownedParameter>
    <language>java</language>
    <body>return port;&#xD;
 </body>
  </uml:OpaqueBehavior>
  <uml:OpaqueBehavior xmi:id="_aVThkFJNEeiyW7NaN4qWdw" name="getResult" specification="_aSxyAFJNEeiyW7NaN4qWdw">
    <ownedParameter xmi:id="_aVThkVJNEeiyW7NaN4qWdw" direction="return">
      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
    </ownedParameter>
    <language>java</language>
    <body>return Boolean.parseBoolean(result);&#xD;
 </body>
  </uml:OpaqueBehavior>
  <uml:OpaqueBehavior xmi:id="_aVThklJNEeiyW7NaN4qWdw" name="setResult" specification="_aSxyAVJNEeiyW7NaN4qWdw">
    <ownedParameter xmi:id="_aVThk1JNEeiyW7NaN4qWdw" name="result">
      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
    </ownedParameter>
    <ownedParameter xmi:id="_aVThlFJNEeiyW7NaN4qWdw" type="_Y-jxEFJNEeiyW7NaN4qWdw" direction="return"/>
    <language>java</language>
    <body>this.result = String.valueOf(result);&#xD;
     return this;&#xD;
 </body>
  </uml:OpaqueBehavior>
  <uml:OpaqueBehavior xmi:id="_aVa2UFJNEeiyW7NaN4qWdw" name="getResult" specification="_aTBpoFJNEeiyW7NaN4qWdw">
    <ownedParameter xmi:id="_aVa2UVJNEeiyW7NaN4qWdw" direction="return">
      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
    </ownedParameter>
    <language>java</language>
    <body>return Boolean.parseBoolean(result);&#xD;
 </body>
  </uml:OpaqueBehavior>
  <uml:OpaqueBehavior xmi:id="_aVa2UlJNEeiyW7NaN4qWdw" name="setResult" specification="_aTCQsFJNEeiyW7NaN4qWdw">
    <ownedParameter xmi:id="_aVa2U1JNEeiyW7NaN4qWdw" name="result">
      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
    </ownedParameter>
    <language>java</language>
    <body>this.result = Boolean.toString(result);&#xD;
 </body>
  </uml:OpaqueBehavior>
  <uml:OpaqueBehavior xmi:id="_aVgV4FJNEeiyW7NaN4qWdw" name="getUserName" specification="_aTIXUlJNEeiyW7NaN4qWdw">
    <ownedParameter xmi:id="_aVgV4VJNEeiyW7NaN4qWdw" direction="return">
      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
    </ownedParameter>
    <language>java</language>
    <body>return userName;&#xD;
 </body>
  </uml:OpaqueBehavior>
  <uml:OpaqueBehavior xmi:id="_aViyIFJNEeiyW7NaN4qWdw" name="getGoods" specification="_aTNP01JNEeiyW7NaN4qWdw">
    <ownedParameter xmi:id="_aViyIVJNEeiyW7NaN4qWdw" type="_aHJw0FJNEeiyW7NaN4qWdw" isOrdered="true" direction="return">
      <upperValue xmi:type="uml:LiteralUnlimitedNatural" xmi:id="_aViyIlJNEeiyW7NaN4qWdw" value="*"/>
    </ownedParameter>
    <language>java</language>
    <body>return goods;&#xD;
 </body>
  </uml:OpaqueBehavior>
  <uml:OpaqueBehavior xmi:id="_aVoRslJNEeiyW7NaN4qWdw" name="getTax" specification="_aTTWcFJNEeiyW7NaN4qWdw">
    <ownedParameter xmi:id="_aVoRs1JNEeiyW7NaN4qWdw" direction="return">
      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
    </ownedParameter>
    <language>java</language>
    <body>try {&#xD;
         return Integer.parseInt(tax);&#xD;
     } catch (Exception e) {&#xD;
         return -1;&#xD;
     }&#xD;
 </body>
  </uml:OpaqueBehavior>
  <uml:OpaqueBehavior xmi:id="_aVoRtFJNEeiyW7NaN4qWdw" name="setTax" specification="_aTTWcVJNEeiyW7NaN4qWdw">
    <ownedParameter xmi:id="_aVo4wFJNEeiyW7NaN4qWdw" name="tax">
      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
    </ownedParameter>
    <ownedParameter xmi:id="_aVo4wVJNEeiyW7NaN4qWdw" type="_ZAttMFJNEeiyW7NaN4qWdw" direction="return"/>
    <language>java</language>
    <body>this.tax = Integer.toString(tax);&#xD;
     return this;&#xD;
 </body>
  </uml:OpaqueBehavior>
  <uml:OpaqueBehavior xmi:id="_aVu_YFJNEeiyW7NaN4qWdw" name="setResponse" specification="_aTXn4lJNEeiyW7NaN4qWdw">
    <ownedParameter xmi:id="_aVu_YVJNEeiyW7NaN4qWdw" name="response" type="_aPNgoFJNEeiyW7NaN4qWdw"/>
    <language>java</language>
    <body>if (response == null) {&#xD;
         throw new NullPointerException();&#xD;
     }&#xD;
     this.response = response;&#xD;
     this.responseGiven = true;&#xD;
     notify();&#xD;
 </body>
  </uml:OpaqueBehavior>
  <uml:OpaqueBehavior xmi:id="_aVvmcFJNEeiyW7NaN4qWdw" name="getResponse" specification="_aTXn5FJNEeiyW7NaN4qWdw">
    <ownedParameter xmi:id="_aVvmcVJNEeiyW7NaN4qWdw" type="_aPNgoFJNEeiyW7NaN4qWdw" direction="return"/>
    <language>java</language>
    <body>if (response == null) {&#xD;
         try {&#xD;
             while (!responseGiven) {&#xD;
                 wait();&#xD;
             }&#xD;
         } catch (InterruptedException ie) {}&#xD;
     }&#xD;
&#xD;
     return response;&#xD;
 </body>
  </uml:OpaqueBehavior>
  <uml:OpaqueBehavior xmi:id="_aVwNgVJNEeiyW7NaN4qWdw" name="getNewLandName" specification="_aTbSQlJNEeiyW7NaN4qWdw">
    <ownedParameter xmi:id="_aVw0kFJNEeiyW7NaN4qWdw" direction="return">
      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
    </ownedParameter>
    <language>java</language>
    <body>return newLandName;&#xD;
 </body>
  </uml:OpaqueBehavior>
  <uml:OpaqueBehavior xmi:id="_aWBTRlJNEeiyW7NaN4qWdw" name="getNextNetworkReplyId" specification="_aT7BgVJNEeiyW7NaN4qWdw">
    <ownedParameter xmi:id="_aWBTR1JNEeiyW7NaN4qWdw" direction="return">
      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
    </ownedParameter>
    <language>java</language>
    <body>return nextNetworkReplyId++;&#xD;
 </body>
  </uml:OpaqueBehavior>
  <UMLLabProfile:MultiDeclaration xmi:id="_aXKiwFJNEeiyW7NaN4qWdw" base_Property="_aXJ7t1JNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aXKiwVJNEeiyW7NaN4qWdw" base_Element="_aXJ7t1JNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:MultiDeclaration xmi:id="_aXLJ0FJNEeiyW7NaN4qWdw" base_Property="_aXKiw1JNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aXLJ0VJNEeiyW7NaN4qWdw" base_Element="_aXKiw1JNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:MultiDeclaration xmi:id="_aXLJ1FJNEeiyW7NaN4qWdw" base_Property="_aXLJ01JNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_aXLw4FJNEeiyW7NaN4qWdw" base_Element="_aXLJ01JNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aYGW4FJNEeiyW7NaN4qWdw" base_Element="_aX_pMFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aYNroFJNEeiyW7NaN4qWdw" base_Element="_aYGW4VJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aYUZUFJNEeiyW7NaN4qWdw" base_Element="_aYNroVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aYbuEFJNEeiyW7NaN4qWdw" base_Element="_aYVAYFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aYibwFJNEeiyW7NaN4qWdw" base_Element="_aYbuEVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aYqXkFJNEeiyW7NaN4qWdw" base_Element="_aYjC0FJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aY3L4FJNEeiyW7NaN4qWdw" base_Element="_aYqXkVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aY-goFJNEeiyW7NaN4qWdw" base_Element="_aY3L4VJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aZF1YFJNEeiyW7NaN4qWdw" base_Element="_aY_HsFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aZNKIFJNEeiyW7NaN4qWdw" base_Element="_aZF1YVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aZUe4FJNEeiyW7NaN4qWdw" base_Element="_aZNKIVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aZbMkFJNEeiyW7NaN4qWdw" base_Element="_aZUe4VJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aZihUFJNEeiyW7NaN4qWdw" base_Element="_aZbzoFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aZrrQFJNEeiyW7NaN4qWdw" base_Element="_aZjIYFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aZznEFJNEeiyW7NaN4qWdw" base_Element="_aZrrQVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aZ_NQFJNEeiyW7NaN4qWdw" base_Element="_aZznEVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aaGiAFJNEeiyW7NaN4qWdw" base_Element="_aZ_NQVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aaN2wFJNEeiyW7NaN4qWdw" base_Element="_aaGiAVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aaUkcFJNEeiyW7NaN4qWdw" base_Element="_aaN2wVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aab5MFJNEeiyW7NaN4qWdw" base_Element="_aaVLgFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aajN8FJNEeiyW7NaN4qWdw" base_Element="_aab5MVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aaqisFJNEeiyW7NaN4qWdw" base_Element="_aajN8VJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aazsoFJNEeiyW7NaN4qWdw" base_Element="_aaqisVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_aa7ocFJNEeiyW7NaN4qWdw" base_Element="_aazsoVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_abCWIFJNEeiyW7NaN4qWdw" base_Element="_aa7ocVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_abJD0FJNEeiyW7NaN4qWdw" base_Element="_abCWIVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_abPxgFJNEeiyW7NaN4qWdw" base_Element="_abJD0VJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_abVREFJNEeiyW7NaN4qWdw" base_Element="_abPxgVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_abawoFJNEeiyW7NaN4qWdw" base_Element="_abV4IFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_abheUFJNEeiyW7NaN4qWdw" base_Element="_abawoVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_abqBMFJNEeiyW7NaN4qWdw" base_Element="_abiFYFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_ab0ZQFJNEeiyW7NaN4qWdw" base_Element="_abqBMVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_ab88IFJNEeiyW7NaN4qWdw" base_Element="_ab1AUFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_acDp0FJNEeiyW7NaN4qWdw" base_Element="_ab88IVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_acJwcFJNEeiyW7NaN4qWdw" base_Element="_acDp0VJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_acP3EFJNEeiyW7NaN4qWdw" base_Element="_acKXgFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_acXL0FJNEeiyW7NaN4qWdw" base_Element="_acQeIFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_acd5gFJNEeiyW7NaN4qWdw" base_Element="_acXL0VJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_acnDcFJNEeiyW7NaN4qWdw" base_Element="_acd5gVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_acwNYFJNEeiyW7NaN4qWdw" base_Element="_acnDcVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_ac5XUFJNEeiyW7NaN4qWdw" base_Element="_acwNYVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_adAsEFJNEeiyW7NaN4qWdw" base_Element="_ac5-YFJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_adIA0FJNEeiyW7NaN4qWdw" base_Element="_adAsEVJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_adOugFJNEeiyW7NaN4qWdw" base_Element="_adIA0VJNEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_adWDQFJNEeiyW7NaN4qWdw" base_Element="_adPVkFJNEeiyW7NaN4qWdw"/>
</xmi:XMI>
