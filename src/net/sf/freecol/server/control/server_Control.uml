<?xml version="1.0" encoding="UTF-8"?>
<xmi:XMI xmi:version="20131001" xmlns:xmi="http://www.omg.org/spec/XMI/20131001" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:UMLLabProfile="http:///schemas/UMLLabProfile/NS/0" xmlns:ecore="http://www.eclipse.org/emf/2002/Ecore" xmlns:uml="http://www.eclipse.org/uml2/5.0.0/UML" xsi:schemaLocation="http:///schemas/UMLLabProfile/NS/0 pathmap://UMLLAB_PROFILES/UMLLab.profile.uml#UMLLabProfile-Annotation_2-UMLLabProfile">
  <uml:Model xmi:id="_OB6V8FJQEeiyW7NaN4qWdw" name="server_Control">
    <eAnnotations xmi:id="_Otu6IFJQEeiyW7NaN4qWdw" source="http://ns.yatta.de/umllab">
      <contents xmi:type="ecore:EAnnotation" xmi:id="_Otu6IVJQEeiyW7NaN4qWdw" source="codegen">
        <details xmi:id="_Otu6IlJQEeiyW7NaN4qWdw" key="codegenDirectory" value="/COSC442-FinalProject/src"/>
        <details xmi:id="_R0ugQFJQEeiyW7NaN4qWdw" key="AssociatedSourceCode" value="/COSC442-FinalProject/src/net/sf/freecol/server/control/PreGameController.java;2407975601/1;/COSC442-FinalProject/src/net/sf/freecol/server/control/Controller.java;2134948584/1;/COSC442-FinalProject/src/net/sf/freecol/server/control/FreeColServerHolder.java;3511958965/1;/COSC442-FinalProject/src/net/sf/freecol/server/control/InputHandler.java;1035562207/1;/COSC442-FinalProject/src/net/sf/freecol/server/control/InGameInputHandler.java;3246926312/1;/COSC442-FinalProject/src/net/sf/freecol/server/control/InGameController.java;3322854859/1;/COSC442-FinalProject/src/net/sf/freecol/server/control/ChangeSet.java;4085927586/1;/COSC442-FinalProject/src/net/sf/freecol/server/control/PreGameInputHandler.java;2945622714/1;/COSC442-FinalProject/src/net/sf/freecol/server/control/UserConnectionHandler.java;870081252/1;"/>
      </contents>
    </eAnnotations>
    <elementImport xmi:id="_P46T0FJQEeiyW7NaN4qWdw">
      <importedElement xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
    </elementImport>
    <elementImport xmi:id="_P46T0VJQEeiyW7NaN4qWdw">
      <importedElement xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#byte"/>
    </elementImport>
    <elementImport xmi:id="_P46T0lJQEeiyW7NaN4qWdw">
      <importedElement xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#char"/>
    </elementImport>
    <elementImport xmi:id="_P46T01JQEeiyW7NaN4qWdw">
      <importedElement xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#double"/>
    </elementImport>
    <elementImport xmi:id="_P4664FJQEeiyW7NaN4qWdw">
      <importedElement xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#float"/>
    </elementImport>
    <elementImport xmi:id="_P4664VJQEeiyW7NaN4qWdw">
      <importedElement xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
    </elementImport>
    <elementImport xmi:id="_P4664lJQEeiyW7NaN4qWdw">
      <importedElement xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#long"/>
    </elementImport>
    <elementImport xmi:id="_P46641JQEeiyW7NaN4qWdw">
      <importedElement xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#short"/>
    </elementImport>
    <elementImport xmi:id="_P4665FJQEeiyW7NaN4qWdw">
      <importedElement xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
    </elementImport>
    <packagedElement xmi:type="uml:Package" xmi:id="_P1t14FJQEeiyW7NaN4qWdw" name="net">
      <packagedElement xmi:type="uml:Package" xmi:id="_P1t14VJQEeiyW7NaN4qWdw" name="sf">
        <packagedElement xmi:type="uml:Package" xmi:id="_P1t14lJQEeiyW7NaN4qWdw" name="freecol">
          <packagedElement xmi:type="uml:Package" xmi:id="_P1t141JQEeiyW7NaN4qWdw" name="server">
            <packagedElement xmi:type="uml:Package" xmi:id="_P1wSIFJQEeiyW7NaN4qWdw" name="model">
              <packagedElement xmi:type="uml:Class" xmi:id="_QhaeQ1JQEeiyW7NaN4qWdw" name="ServerPlayer"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QhdhkVJQEeiyW7NaN4qWdw" name="ServerGame"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qi6TE1JQEeiyW7NaN4qWdw" name="DiplomacySession"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qi66IVJQEeiyW7NaN4qWdw" name="LootSession"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qi66I1JQEeiyW7NaN4qWdw" name="MonarchSession"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qi7hMVJQEeiyW7NaN4qWdw" name="ServerColony"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qi8IQVJQEeiyW7NaN4qWdw" name="ServerEurope"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qi8IQ1JQEeiyW7NaN4qWdw" name="ServerIndianSettlement"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qi8vUVJQEeiyW7NaN4qWdw" name="ServerRegion"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qi9WYVJQEeiyW7NaN4qWdw" name="ServerUnit"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qi9WY1JQEeiyW7NaN4qWdw" name="TradeSession"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qi99cVJQEeiyW7NaN4qWdw" name="TransactionSession"/>
            </packagedElement>
            <packagedElement xmi:type="uml:Package" xmi:id="_P1xgQFJQEeiyW7NaN4qWdw" name="control">
              <packagedElement xmi:type="uml:Package" xmi:id="_P2OzQFJQEeiyW7NaN4qWdw" name="ChangeSet">
                <packagedElement xmi:type="uml:Enumeration" xmi:id="_Qi5sAVJQEeiyW7NaN4qWdw" name="ChangePriority"/>
                <packagedElement xmi:type="uml:Class" xmi:id="_Qi6TEVJQEeiyW7NaN4qWdw" name="See"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_P45swFJQEeiyW7NaN4qWdw" name="PreGameController" isLeaf="true">
                <ownedComment xmi:id="_QobFMFJQEeiyW7NaN4qWdw">
                  <body>The control object that is responsible for setting parameters&#xD;
and starting a new game. {@link PreGameInputHandler} is used&#xD;
to receive and handle network messages from the clients.&#xD;
 *&#xD;
The game enters the state&#xD;
{@link net.sf.freecol.server.FreeColServer.GameState#IN_GAME}, when the&#xD;
{@link #startGame} has successfully been invoked.&#xD;
 *&#xD;
@see InGameInputHandler</body>
                </ownedComment>
                <generalization xmi:id="_QhbsYVJQEeiyW7NaN4qWdw" general="_P48JAFJQEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_QnVgEFJQEeiyW7NaN4qWdw" name="logger" visibility="private" isLeaf="true" isStatic="true" type="_QhXa8VJQEeiyW7NaN4qWdw" isReadOnly="true" association="_QovOQFJQEeiyW7NaN4qWdw">
                  <defaultValue xmi:type="uml:LiteralString" xmi:id="_QnVgEVJQEeiyW7NaN4qWdw" value="Logger.getLogger(PreGameController.class.getName())"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn45sFJQEeiyW7NaN4qWdw" name="PreGameController" specification="_QkeZUFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn45sVJQEeiyW7NaN4qWdw" name="freeColServer" type="_QhaeQVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn45slJQEeiyW7NaN4qWdw" type="_P45swFJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(freeColServer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn5gwFJQEeiyW7NaN4qWdw" name="startGame" specification="_P4665VJQEeiyW7NaN4qWdw">
                  <language>java</language>
                  <body>final FreeColServer freeColServer = getFreeColServer();&#xD;
     Game game = freeColServer.buildGame();&#xD;
&#xD;
     // Inform the clients.&#xD;
     for (Player player : game.getLivePlayers(null)) {&#xD;
         if (player.isAI()) continue;&#xD;
&#xD;
         player.invalidateCanSeeTiles();//Send clean copy of the game&#xD;
         Connection conn = ((ServerPlayer)player).getConnection();&#xD;
         Element update = DOMMessage.createMessage(&quot;updateGame&quot;);&#xD;
         update.appendChild(game.toXMLElement(update.getOwnerDocument(),&#xD;
                                              player));&#xD;
         try {&#xD;
             conn.ask(update);&#xD;
         } catch (IOException e) {&#xD;
             logger.log(Level.WARNING, &quot;Unable to updateGame&quot;, e);&#xD;
         }&#xD;
     }&#xD;
&#xD;
     // Start the game:&#xD;
     freeColServer.setGameState(FreeColServer.GameState.IN_GAME);&#xD;
     freeColServer.updateMetaServer();&#xD;
     freeColServer.getServer()&#xD;
         .sendToAll(DOMMessage.createMessage(&quot;startGame&quot;));&#xD;
     freeColServer.getServer().setMessageHandlerToAllConnections(freeColServer.getInGameInputHandler());&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_P4665VJQEeiyW7NaN4qWdw" name="startGame" method="_Qn5gwFJQEeiyW7NaN4qWdw" raisedException="_QhYCAVJQEeiyW7NaN4qWdw"/>
                <ownedOperation xmi:id="_QkeZUFJQEeiyW7NaN4qWdw" name="PreGameController" method="_Qn45sFJQEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_QkeZUlJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_QkeZU1JQEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedParameter xmi:id="_QkeZUVJQEeiyW7NaN4qWdw" name="freeColServer" type="_QhaeQVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QkeZVFJQEeiyW7NaN4qWdw" type="_P45swFJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_P48JAFJQEeiyW7NaN4qWdw" name="Controller" isAbstract="true">
                <ownedComment xmi:id="_QobFMVJQEeiyW7NaN4qWdw">
                  <body>The control object that is responsible for making changes to the internal&#xD;
model and for communicating with the clients.</body>
                </ownedComment>
                <generalization xmi:id="_QhdhkFJQEeiyW7NaN4qWdw" general="_P49XIFJQEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_QnVgElJQEeiyW7NaN4qWdw" name="logger" visibility="private" isLeaf="true" isStatic="true" type="_QhXa8VJQEeiyW7NaN4qWdw" isReadOnly="true" association="_Qov1UVJQEeiyW7NaN4qWdw">
                  <defaultValue xmi:type="uml:LiteralString" xmi:id="_QnVgE1JQEeiyW7NaN4qWdw" value="Logger.getLogger(Controller.class.getName())"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn5gwVJQEeiyW7NaN4qWdw" name="Controller" specification="_QkfAYFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn5gwlJQEeiyW7NaN4qWdw" name="freeColServer" type="_QhaeQVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn5gw1JQEeiyW7NaN4qWdw" type="_P48JAFJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(freeColServer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn5gxFJQEeiyW7NaN4qWdw" name="shutdown" specification="_P48wEFJQEeiyW7NaN4qWdw">
                  <language>java</language>
                  <body>Server server = getFreeColServer().getServer();&#xD;
     if (server != null) {&#xD;
         server.shutdown();&#xD;
     } else {&#xD;
         logger.warning(&quot;Tried to shut down a null server.&quot;);&#xD;
     }&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_P48wEFJQEeiyW7NaN4qWdw" name="shutdown" method="_Qn5gxFJQEeiyW7NaN4qWdw"/>
                <ownedOperation xmi:id="_QkfAYFJQEeiyW7NaN4qWdw" name="Controller" method="_Qn5gwVJQEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_QkfAYlJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_QkfAY1JQEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedParameter xmi:id="_QkfAYVJQEeiyW7NaN4qWdw" name="freeColServer" type="_QhaeQVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QkfAZFJQEeiyW7NaN4qWdw" type="_P48JAFJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_P49XIFJQEeiyW7NaN4qWdw" name="FreeColServerHolder">
                <ownedComment xmi:id="_QobFMlJQEeiyW7NaN4qWdw">
                  <body>This base class provides thread-safe access to a&#xD;
{@link net.sf.freecol.server.FreeColServer} for several subclasses.</body>
                </ownedComment>
                <ownedAttribute xmi:id="_QnWHIFJQEeiyW7NaN4qWdw" name="freeColServer" visibility="private" isLeaf="true" type="_QhaeQVJQEeiyW7NaN4qWdw" isReadOnly="true" association="_QowcYVJQEeiyW7NaN4qWdw"/>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn5gxVJQEeiyW7NaN4qWdw" name="FreeColServerHolder" specification="_QkfncFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn5gxlJQEeiyW7NaN4qWdw" name="server" type="_QhaeQVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn5gx1JQEeiyW7NaN4qWdw" type="_P49XIFJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>this.freeColServer = server;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn5gyFJQEeiyW7NaN4qWdw" name="getFreeColServer" specification="_P49-MFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn5gyVJQEeiyW7NaN4qWdw" type="_QhaeQVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return freeColServer;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn5gylJQEeiyW7NaN4qWdw" name="getGame" specification="_P4-lQFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn5gy1JQEeiyW7NaN4qWdw" type="_QhdhkVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return freeColServer.getGame();&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_P49-MFJQEeiyW7NaN4qWdw" name="getFreeColServer" visibility="protected" method="_Qn5gyFJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QobFNFJQEeiyW7NaN4qWdw">
                    <body>Returns the main server object.&#xD;
     * &#xD;
     * @return The main server object.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QkfndVJQEeiyW7NaN4qWdw" type="_QhaeQVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_P4-lQFJQEeiyW7NaN4qWdw" name="getGame" visibility="protected" method="_Qn5gylJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QobFNVJQEeiyW7NaN4qWdw">
                    <body>Returns the Game.&#xD;
     *&#xD;
     * @return a &lt;code>Game&lt;/code> value</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QkfndlJQEeiyW7NaN4qWdw" type="_QhdhkVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QkfncFJQEeiyW7NaN4qWdw" name="FreeColServerHolder" visibility="protected" method="_Qn5gxVJQEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_QkfnclJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_Qkfnc1JQEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_QobFM1JQEeiyW7NaN4qWdw">
                    <body>Constructor.&#xD;
     * &#xD;
     * @param server The initial value for the server.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QkfncVJQEeiyW7NaN4qWdw" name="server" type="_QhaeQVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QkfndFJQEeiyW7NaN4qWdw" type="_P49XIFJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_P4_MUFJQEeiyW7NaN4qWdw" name="InputHandler" isAbstract="true">
                <ownedComment xmi:id="_QobFNlJQEeiyW7NaN4qWdw">
                  <body>Handles the network messages.&#xD;
&#xD;
@see Controller</body>
                </ownedComment>
                <generalization xmi:id="_QhiaEFJQEeiyW7NaN4qWdw" general="_P49XIFJQEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_QnWHIlJQEeiyW7NaN4qWdw" name="logger" visibility="private" isLeaf="true" isStatic="true" type="_QhXa8VJQEeiyW7NaN4qWdw" isReadOnly="true" association="_QoxDcVJQEeiyW7NaN4qWdw">
                  <defaultValue xmi:type="uml:LiteralString" xmi:id="_QnWHI1JQEeiyW7NaN4qWdw" value="Logger.getLogger(InputHandler.class.getName())"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_QnWuMFJQEeiyW7NaN4qWdw" name="_handlerMap" visibility="private" isLeaf="true" type="_QhhL8VJQEeiyW7NaN4qWdw" isReadOnly="true" association="_QoxqgFJQEeiyW7NaN4qWdw">
                  <qualifier xmi:id="_QnWuM1JQEeiyW7NaN4qWdw">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </qualifier>
                  <defaultValue xmi:type="uml:LiteralString" xmi:id="_QnWuMVJQEeiyW7NaN4qWdw" value="Collections.synchronizedMap(new HashMap&lt;String, NetworkRequestHandler>())"/>
                </ownedAttribute>
                <interfaceRealization xmi:id="_Qkfnd1JQEeiyW7NaN4qWdw" client="_P4_MUFJQEeiyW7NaN4qWdw" supplier="_Qhgk41JQEeiyW7NaN4qWdw" contract="_Qhgk41JQEeiyW7NaN4qWdw"/>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn5gzFJQEeiyW7NaN4qWdw" name="InputHandler" specification="_QkgOgFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn5gzVJQEeiyW7NaN4qWdw" name="freeColServer" type="_QhaeQVJQEeiyW7NaN4qWdw">
                    <eAnnotations xmi:id="_Qn5gzlJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                      <details xmi:id="_Qn5gz1JQEeiyW7NaN4qWdw" key="final"/>
                    </eAnnotations>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Qn5g0FJQEeiyW7NaN4qWdw" type="_P4_MUFJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(freeColServer);&#xD;
     // All sub-classes are forced to implement this one&#xD;
     register(&quot;logout&quot;, (Connection connection, Element element) ->&#xD;
         logout(connection, element));&#xD;
     register(&quot;disconnect&quot;, new DisconnectHandler());&#xD;
     register(&quot;chat&quot;, (Connection connection, Element element) ->&#xD;
         new ChatMessage(getGame(), element)&#xD;
             .handle(freeColServer, connection));&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn5g0VJQEeiyW7NaN4qWdw" name="register" specification="_Qkg1klJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn5g0lJQEeiyW7NaN4qWdw" name="name">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Qn5g01JQEeiyW7NaN4qWdw" name="handler" type="_QhhL8VJQEeiyW7NaN4qWdw"/>
                  <language>java</language>
                  <body>_handlerMap.put(name, handler);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn6H0FJQEeiyW7NaN4qWdw" name="unregister" specification="_Qkg1lVJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn6H0VJQEeiyW7NaN4qWdw" name="name">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Qn6H0lJQEeiyW7NaN4qWdw" name="handler" type="_QhhL8VJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn6H01JQEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>// _handlerMap.remove(name, handler) would be better?&#xD;
     return _handlerMap.remove(name) == handler;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn6H1FJQEeiyW7NaN4qWdw" name="handle" specification="_QkhcolJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn6H1VJQEeiyW7NaN4qWdw" name="connection" type="_QhZQIlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn6H1lJQEeiyW7NaN4qWdw" name="element" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn6H11JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>if (element == null) return null;&#xD;
     String tagName = element.getTagName();&#xD;
     NetworkRequestHandler handler = _handlerMap.get(tagName);&#xD;
     if (handler != null) {&#xD;
         try {&#xD;
             logger.log(Level.FINEST, &quot;Handling &quot; + tagName);&#xD;
             return handler.handle(connection, element);&#xD;
         } catch (Exception e) {&#xD;
             // FIXME: should we really catch Exception? The old code did.&#xD;
             logger.log(Level.WARNING, &quot;Handler failed&quot;, e);&#xD;
             sendReconnectSafely(connection);&#xD;
         }&#xD;
     } else {&#xD;
         // Should we return an error here? The old handler returned null.&#xD;
         logger.warning(&quot;No handler installed for &quot; + tagName);&#xD;
     }&#xD;
     return null;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn6H2FJQEeiyW7NaN4qWdw" name="sendReconnectSafely" specification="_QkiDs1JQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn6H2VJQEeiyW7NaN4qWdw" name="connection" type="_QhZQIlJQEeiyW7NaN4qWdw"/>
                  <language>java</language>
                  <body>try {&#xD;
         connection.send(DOMMessage.createMessage(&quot;reconnect&quot;));&#xD;
     } catch (IOException e) {&#xD;
         logger.log(Level.WARNING, &quot;Could not send reconnect message!&quot;, e);&#xD;
     }&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn6H2lJQEeiyW7NaN4qWdw" name="createErrorReply" specification="_P5AacFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn6H21JQEeiyW7NaN4qWdw" name="message">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Qn6H3FJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return DOMMessage.createMessage(&quot;error&quot;,&#xD;
         &quot;message&quot;, message);&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_P5AacFJQEeiyW7NaN4qWdw" name="createErrorReply" visibility="protected" method="_Qn6H2lJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QobFO1JQEeiyW7NaN4qWdw">
                    <body>Create a reply message with an error.&#xD;
     *&#xD;
     * FIXME: should this be localized (return message name)?&#xD;
     * &#xD;
     * @param message The error message.&#xD;
     * @return An error message.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_P5BBgFJQEeiyW7NaN4qWdw" name="message">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QkiDtVJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QkgOgFJQEeiyW7NaN4qWdw" name="InputHandler" method="_Qn5gzFJQEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_QkgOglJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_QkgOg1JQEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_QobFN1JQEeiyW7NaN4qWdw">
                    <body>The constructor to use.&#xD;
     * &#xD;
     * @param freeColServer The main server object.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QkgOgVJQEeiyW7NaN4qWdw" name="freeColServer" type="_QhaeQVJQEeiyW7NaN4qWdw">
                    <eAnnotations xmi:id="_Qkg1kFJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                      <details xmi:id="_Qkg1kVJQEeiyW7NaN4qWdw" key="final"/>
                    </eAnnotations>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QkgOhFJQEeiyW7NaN4qWdw" type="_P4_MUFJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Qkg1klJQEeiyW7NaN4qWdw" name="register" visibility="protected" isLeaf="true" method="_Qn5g0VJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QobFOFJQEeiyW7NaN4qWdw">
                    <body>Register a network request handler.&#xD;
     * &#xD;
     * @param name The name.&#xD;
     * @param handler The handler.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qkg1k1JQEeiyW7NaN4qWdw" name="name">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Qkg1lFJQEeiyW7NaN4qWdw" name="handler" type="_QhhL8VJQEeiyW7NaN4qWdw"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Qkg1lVJQEeiyW7NaN4qWdw" name="unregister" visibility="protected" isLeaf="true" method="_Qn6H0FJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QobFOVJQEeiyW7NaN4qWdw">
                    <body>Unregister a network request handler.&#xD;
     * &#xD;
     * @param name The name.&#xD;
     * @param handler The handler.&#xD;
     * @return True if the supplied handler was actually removed.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qkg1llJQEeiyW7NaN4qWdw" name="name">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QkhcoFJQEeiyW7NaN4qWdw" name="handler" type="_QhhL8VJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QkhcoVJQEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_QkhcolJQEeiyW7NaN4qWdw" name="handle" isLeaf="true" method="_Qn6H1FJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qkhco1JQEeiyW7NaN4qWdw" name="connection" type="_QhZQIlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QkhcpFJQEeiyW7NaN4qWdw" name="element" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QkhcpVJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QkiDs1JQEeiyW7NaN4qWdw" name="sendReconnectSafely" visibility="private" method="_Qn6H2FJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QobFOlJQEeiyW7NaN4qWdw">
                    <body>Send a reconnect message ignoring (but logging) IO errors.&#xD;
     * &#xD;
     * @param connection The connection.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QkiDtFJQEeiyW7NaN4qWdw" name="connection" type="_QhZQIlJQEeiyW7NaN4qWdw"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QkiqwFJQEeiyW7NaN4qWdw" name="logout" visibility="protected" isAbstract="true">
                  <ownedComment xmi:id="_QobFPFJQEeiyW7NaN4qWdw">
                    <body>Handles a &quot;logout&quot;-message.&#xD;
     * &#xD;
     * @param connection The &lt;code>Connection&lt;/code> the message was received&#xD;
     *     on.&#xD;
     * @param element The &lt;code>Element&lt;/code> (root element in a&#xD;
     *     DOM-parsed XML tree) that holds all the information.&#xD;
     * @return The reply.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QkiqwVJQEeiyW7NaN4qWdw" name="connection" type="_QhZQIlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QkiqwlJQEeiyW7NaN4qWdw" name="element" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qkiqw1JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <nestedClassifier xmi:type="uml:Class" xmi:id="_P5BBgVJQEeiyW7NaN4qWdw" name="DisconnectHandler" visibility="private">
                  <interfaceRealization xmi:id="_QkiqxFJQEeiyW7NaN4qWdw" client="_P5BBgVJQEeiyW7NaN4qWdw" supplier="_QhhL8VJQEeiyW7NaN4qWdw" contract="_QhhL8VJQEeiyW7NaN4qWdw"/>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn6H3VJQEeiyW7NaN4qWdw" name="handle" specification="_QkiqxVJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_Qn6H3lJQEeiyW7NaN4qWdw" name="connection" type="_QhZQIlJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_Qn6H31JQEeiyW7NaN4qWdw" name="disconnectElement" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_Qn6H4FJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                    <language>java</language>
                    <body>ServerPlayer player = getFreeColServer().getPlayer(connection);&#xD;
         logDisconnect(connection, player);&#xD;
         if (player != null &amp;&amp; player.isConnected()) {&#xD;
             logout(connection, null);&#xD;
         }&#xD;
         connection.reallyClose();&#xD;
         Server server = getFreeColServer().getServer();&#xD;
         if (server != null) {&#xD;
             server.removeConnection(connection);&#xD;
         }&#xD;
         return null;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn6H4VJQEeiyW7NaN4qWdw" name="logDisconnect" specification="_Qkj44FJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_Qn6H4lJQEeiyW7NaN4qWdw" name="connection" type="_QhZQIlJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_Qn6H41JQEeiyW7NaN4qWdw" name="player" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <language>java</language>
                    <body>logger.info(&quot;Disconnection by: &quot; + connection + ((player != null) ? &quot; (&quot; + player.getName() + &quot;) &quot; : &quot;&quot;));&#xD;
     </body>
                  </ownedBehavior>
                  <ownedOperation xmi:id="_QkiqxVJQEeiyW7NaN4qWdw" name="handle" method="_Qn6H3VJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QkjR0FJQEeiyW7NaN4qWdw" name="connection" type="_QhZQIlJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QkjR0VJQEeiyW7NaN4qWdw" name="disconnectElement" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QkjR0lJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  </ownedOperation>
                  <ownedOperation xmi:id="_Qkj44FJQEeiyW7NaN4qWdw" name="logDisconnect" visibility="private" method="_Qn6H4VJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_Qkj44VJQEeiyW7NaN4qWdw" name="connection" type="_QhZQIlJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_Qkj44lJQEeiyW7NaN4qWdw" name="player" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  </ownedOperation>
                </nestedClassifier>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_P5FS8FJQEeiyW7NaN4qWdw" name="InGameInputHandler" isLeaf="true">
                <ownedComment xmi:id="_QobFPVJQEeiyW7NaN4qWdw">
                  <body>Handles the network messages that arrives while&#xD;
{@link net.sf.freecol.server.FreeColServer.GameState#IN_GAME in game}.</body>
                </ownedComment>
                <generalization xmi:id="_QiLTQVJQEeiyW7NaN4qWdw" general="_P4_MUFJQEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_QnXVQFJQEeiyW7NaN4qWdw" name="logger" visibility="private" isLeaf="true" isStatic="true" type="_QhXa8VJQEeiyW7NaN4qWdw" isReadOnly="true" association="_Qoxqg1JQEeiyW7NaN4qWdw">
                  <defaultValue xmi:type="uml:LiteralString" xmi:id="_QnXVQVJQEeiyW7NaN4qWdw" value="Logger.getLogger(InGameInputHandler.class.getName())"/>
                </ownedAttribute>
                <interfaceRealization xmi:id="_Qkj441JQEeiyW7NaN4qWdw" client="_P5FS8FJQEeiyW7NaN4qWdw" supplier="_Qh_tEFJQEeiyW7NaN4qWdw" contract="_Qh_tEFJQEeiyW7NaN4qWdw"/>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn6H5FJQEeiyW7NaN4qWdw" name="InGameInputHandler" specification="_Qkkf8FJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn6H5VJQEeiyW7NaN4qWdw" name="freeColServer" type="_QhaeQVJQEeiyW7NaN4qWdw">
                    <eAnnotations xmi:id="_Qn6H5lJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                      <details xmi:id="_Qn6H51JQEeiyW7NaN4qWdw" key="final"/>
                    </eAnnotations>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Qn6H6FJQEeiyW7NaN4qWdw" type="_P5FS8FJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(freeColServer);&#xD;
     // FIXME: move and simplify methods later, for now just delegate&#xD;
     // FIXME: check that NRHs and CPNRHs are sensibly chosen&#xD;
&#xD;
     // Messages that are not specialized are trivial elements identified&#xD;
     // by tag name only.&#xD;
     register(AbandonColonyMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new AbandonColonyMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(AskSkillMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new AskSkillMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(AssignTeacherMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new AssignTeacherMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(AttackMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new AttackMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(BuildColonyMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new BuildColonyMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(BuyMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new BuyMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(BuyPropositionMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new BuyPropositionMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(CashInTreasureTrainMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new CashInTreasureTrainMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(ChangeStateMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new ChangeStateMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(ChangeWorkImprovementTypeMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new ChangeWorkImprovementTypeMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(ChangeWorkTypeMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new ChangeWorkTypeMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(ChooseFoundingFatherMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new ChooseFoundingFatherMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(ClaimLandMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new ClaimLandMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(ClearSpecialityMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new ClearSpecialityMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(CloseTransactionMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new CloseTransactionMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(DeclareIndependenceMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new DeclareIndependenceMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(DeclineMoundsMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new DeclineMoundsMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(DeliverGiftMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new DeliverGiftMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(DemandTributeMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new DemandTributeMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(DisbandUnitMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new DisbandUnitMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(DisembarkMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new DisembarkMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(EmbarkMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new EmbarkMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(EmigrateUnitMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new EmigrateUnitMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(&quot;endTurn&quot;,&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return freeColServer.getInGameController()&#xD;
                 .endTurn(freeColServer.getPlayer(connection));&#xD;
         }});&#xD;
     register(EquipForRoleMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new EquipForRoleMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(&quot;getREFUnits&quot;,&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return freeColServer.getInGameController()&#xD;
                 .getREFUnits(freeColServer.getPlayer(connection));&#xD;
         }});&#xD;
     register(GetTransactionMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new GetTransactionMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(GoodsForSaleMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new GoodsForSaleMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(InciteMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new InciteMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(IndianDemandMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new IndianDemandMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(JoinColonyMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new JoinColonyMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(LearnSkillMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new LearnSkillMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(LoadGoodsMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new LoadGoodsMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(LootCargoMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new LootCargoMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(MissionaryMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new MissionaryMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(MonarchActionMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new MonarchActionMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(MoveMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new MoveMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(MoveToMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new MoveToMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(NewLandNameMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new NewLandNameMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(NewRegionNameMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new NewRegionNameMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(PayArrearsMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new PayArrearsMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(PayForBuildingMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new PayForBuildingMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(PutOutsideColonyMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new PutOutsideColonyMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(RearrangeColonyMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new RearrangeColonyMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(RenameMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new RenameMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(ScoutIndianSettlementMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new ScoutIndianSettlementMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(ScoutSpeakToChiefMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new ScoutSpeakToChiefMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(SellMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new SellMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(SellPropositionMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new SellPropositionMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(SetBuildQueueMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new SetBuildQueueMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(SetGoodsLevelsMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new SetGoodsLevelsMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(TrainUnitInEuropeMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new TrainUnitInEuropeMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(UnloadGoodsMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new UnloadGoodsMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
     register(WorkMessage.getXMLElementTagName(),&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             return new WorkMessage(getGame(), element)&#xD;
                 .handle(freeColServer, player, connection);&#xD;
         }});&#xD;
&#xD;
     register(&quot;multiple&quot;,&#xD;
              new CurrentPlayerNetworkRequestHandler(freeColServer) {&#xD;
         @Override&#xD;
         public Element handle(Player player, Connection connection,&#xD;
                               Element element) {&#xD;
             final NodeList nodes = element.getChildNodes();&#xD;
             List&lt;Element> results = new ArrayList&lt;>();&#xD;
&#xD;
             for (int i = 0; i &lt; nodes.getLength(); i++) {&#xD;
                 final Element node = (Element)nodes.item(i);&#xD;
                 final String tag = node.getTagName();&#xD;
                 try {&#xD;
                     Element reply = InGameInputHandler.this&#xD;
                         .handle(connection, node);&#xD;
                     if (reply != null) results.add(reply);&#xD;
                     logger.log(Level.FINEST, &quot;multiple(&quot; + i + &quot;): &quot; + tag&#xD;
                             + &quot; -> &quot; + ((reply == null) ? &quot;null&quot;&#xD;
                                 : reply.getTagName()));&#xD;
                 } catch (Exception e) {&#xD;
                     logger.log(Level.WARNING, &quot;Crash in multiple &quot; + i&#xD;
                         + &quot;, tag &quot; + tag + &quot;, continuing.&quot;, e);&#xD;
                 }&#xD;
             }&#xD;
             return DOMMessage.collapseElements(results);&#xD;
         }});&#xD;
&#xD;
     // NetworkRequestHandlers&#xD;
     register(AssignTradeRouteMessage.getXMLElementTagName(),&#xD;
         (Connection connection, Element element) ->&#xD;
         new AssignTradeRouteMessage(getGame(), element)&#xD;
             .handle(freeColServer, connection));&#xD;
     register(&quot;continuePlaying&quot;,&#xD;
         (Connection connection, Element element) ->&#xD;
         freeColServer.getInGameController()&#xD;
             .continuePlaying(freeColServer.getPlayer(connection)));&#xD;
     register(DiplomacyMessage.getXMLElementTagName(),&#xD;
         (Connection connection, Element element) ->&#xD;
         new DiplomacyMessage(getGame(), element)&#xD;
             .handle(freeColServer, connection));&#xD;
     register(&quot;enterRevengeMode&quot;,&#xD;
         (Connection connection, Element element) ->&#xD;
         freeColServer.getInGameController()&#xD;
             .enterRevengeMode(freeColServer.getPlayer(connection)));&#xD;
     register(FirstContactMessage.getXMLElementTagName(),&#xD;
         (Connection connection, Element element) ->&#xD;
         new FirstContactMessage(getGame(), element)&#xD;
             .handle(freeColServer, connection));&#xD;
     register(&quot;getHighScores&quot;,&#xD;
         (Connection connection, Element element) ->&#xD;
         freeColServer.getInGameController()&#xD;
             .getHighScores(freeColServer.getPlayer(connection)));&#xD;
     register(GetNationSummaryMessage.getXMLElementTagName(),&#xD;
         (Connection connection, Element element) ->&#xD;
         new GetNationSummaryMessage(element)&#xD;
             .handle(freeColServer, connection));&#xD;
     register(&quot;getNewTradeRoute&quot;,&#xD;
         (Connection connection, Element element) ->&#xD;
         freeColServer.getInGameController()&#xD;
             .getNewTradeRoute(freeColServer.getPlayer(connection)));&#xD;
     register(&quot;retire&quot;,&#xD;
         (Connection connection, Element element) ->&#xD;
         freeColServer.getInGameController()&#xD;
             .retire(freeColServer.getPlayer(connection)));&#xD;
     register(SetCurrentStopMessage.getXMLElementTagName(),&#xD;
         (Connection connection, Element element) ->&#xD;
         new SetCurrentStopMessage(getGame(), element)&#xD;
             .handle(freeColServer, connection));&#xD;
     register(SetDestinationMessage.getXMLElementTagName(),&#xD;
         (Connection connection, Element element) ->&#xD;
         new SetDestinationMessage(getGame(), element)&#xD;
             .handle(freeColServer, connection));&#xD;
     register(SetTradeRoutesMessage.getXMLElementTagName(),&#xD;
         (Connection connection, Element element) ->&#xD;
         new SetTradeRoutesMessage(getGame(), element)&#xD;
             .handle(freeColServer, connection));&#xD;
     register(SpySettlementMessage.getXMLElementTagName(),&#xD;
         (Connection connection, Element element) ->&#xD;
         new SpySettlementMessage(getGame(), element)&#xD;
             .handle(freeColServer, connection));&#xD;
     register(&quot;getStatistics&quot;,&#xD;
         (Connection connection, Element element) ->&#xD;
         freeColServer.getInGameController()&#xD;
             .getStatistics(freeColServer.getPlayer(connection)));&#xD;
     register(UpdateTradeRouteMessage.getXMLElementTagName(),&#xD;
         (Connection connection, Element element) ->&#xD;
         new UpdateTradeRouteMessage(getGame(), element)&#xD;
             .handle(freeColServer, connection));&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn6u4FJQEeiyW7NaN4qWdw" name="logout" specification="_QklHAFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn6u4VJQEeiyW7NaN4qWdw" name="connection" type="_QhZQIlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn6u4lJQEeiyW7NaN4qWdw" name="logoutElement" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn6u41JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>ServerPlayer player = getFreeColServer().getPlayer(connection);&#xD;
     logger.info(&quot;Logout by: &quot; + connection&#xD;
                 + ((player != null) ? &quot; (&quot; + player.getName() + &quot;) &quot; : &quot;&quot;));&#xD;
     if (player == null) {&#xD;
         return null;&#xD;
     }&#xD;
     // FIXME:&#xD;
     // Remove the player's units/colonies from the map and send map updates&#xD;
     // to the&#xD;
     // players that can see such units or colonies.&#xD;
     // SHOULDN'T THIS WAIT UNTIL THE CURRENT PLAYER HAS FINISHED HIS TURN?&#xD;
     /*&#xD;
      * player.setDead(true); Element setDeadElement =&#xD;
      * Message.createNewRootElement(&quot;setDead&quot;);&#xD;
      * setDeadElement.setAttribute(&quot;player&quot;, player.getId());&#xD;
      * freeColServer.getServer().sendToAll(setDeadElement, connection);&#xD;
      */&#xD;
&#xD;
     /*&#xD;
      * FIXME: Setting the player dead directly should be a server&#xD;
      * option, but for now - allow the player to reconnect:&#xD;
      */&#xD;
     Element reply = null;&#xD;
     player.setConnected(false);&#xD;
     if (getFreeColServer().getGame().getCurrentPlayer() == player&#xD;
             &amp;&amp; !getFreeColServer().getSinglePlayer()) {&#xD;
         reply = getFreeColServer().getInGameController().endTurn(player);&#xD;
     }&#xD;
     getFreeColServer().updateMetaServer();&#xD;
     return reply;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_Qkkf8FJQEeiyW7NaN4qWdw" name="InGameInputHandler" method="_Qn6H5FJQEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_Qkkf8lJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_Qkkf81JQEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedParameter xmi:id="_Qkkf8VJQEeiyW7NaN4qWdw" name="freeColServer" type="_QhaeQVJQEeiyW7NaN4qWdw">
                    <eAnnotations xmi:id="_Qkkf9VJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                      <details xmi:id="_Qkkf9lJQEeiyW7NaN4qWdw" key="final"/>
                    </eAnnotations>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Qkkf9FJQEeiyW7NaN4qWdw" type="_P5FS8FJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QklHAFJQEeiyW7NaN4qWdw" name="logout" visibility="protected" method="_Qn6u4FJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QklHAVJQEeiyW7NaN4qWdw" name="connection" type="_QhZQIlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QklHAlJQEeiyW7NaN4qWdw" name="logoutElement" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QklHA1JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_P5I9UFJQEeiyW7NaN4qWdw" name="InGameController" isLeaf="true">
                <ownedComment xmi:id="_QobFPlJQEeiyW7NaN4qWdw">
                  <body>The main server controller.</body>
                </ownedComment>
                <generalization xmi:id="_QjGgUFJQEeiyW7NaN4qWdw" general="_P48JAFJQEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_QnXVQlJQEeiyW7NaN4qWdw" name="logger" visibility="private" isLeaf="true" isStatic="true" type="_QhXa8VJQEeiyW7NaN4qWdw" isReadOnly="true" association="_QoxqhlJQEeiyW7NaN4qWdw">
                  <defaultValue xmi:type="uml:LiteralString" xmi:id="_QnX8UFJQEeiyW7NaN4qWdw" value="Logger.getLogger(InGameController.class.getName())"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_QnX8UVJQEeiyW7NaN4qWdw" name="random" visibility="private" isLeaf="true" type="_QiQLwFJQEeiyW7NaN4qWdw" isReadOnly="true" association="_QoyRkVJQEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_QnYjYFJQEeiyW7NaN4qWdw" name="debugOnlyAITurns" visibility="private">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  <defaultValue xmi:type="uml:LiteralString" xmi:id="_QnYjYVJQEeiyW7NaN4qWdw" value="0"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_QnYjY1JQEeiyW7NaN4qWdw" name="debugMonarchAction" visibility="private" type="_QiomQFJQEeiyW7NaN4qWdw">
                  <defaultValue xmi:type="uml:LiteralString" xmi:id="_QnZKcFJQEeiyW7NaN4qWdw" value="null"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_QnZKclJQEeiyW7NaN4qWdw" name="debugMonarchPlayer" visibility="private" type="_QhaeQ1JQEeiyW7NaN4qWdw" association="_Qoy4oVJQEeiyW7NaN4qWdw">
                  <defaultValue xmi:type="uml:LiteralString" xmi:id="_QnZKc1JQEeiyW7NaN4qWdw" value="null"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_Qna_oVJQEeiyW7NaN4qWdw" name="executor" visibility="private" isLeaf="true" type="_QiRZ41JQEeiyW7NaN4qWdw" isReadOnly="true" association="_Qo0t0VJQEeiyW7NaN4qWdw">
                  <defaultValue xmi:type="uml:LiteralString" xmi:id="_Qna_olJQEeiyW7NaN4qWdw" value="Executors.newCachedThreadPool()"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn6u5FJQEeiyW7NaN4qWdw" name="InGameController" specification="_QknjQFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn6u5VJQEeiyW7NaN4qWdw" name="freeColServer" type="_QhaeQVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn6u5lJQEeiyW7NaN4qWdw" name="random" type="_QiQLwFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn6u51JQEeiyW7NaN4qWdw" type="_P5I9UFJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(freeColServer);&#xD;
&#xD;
     this.random = random;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn6u6FJQEeiyW7NaN4qWdw" name="getSkippedTurns" specification="_P5LZkFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn6u6VJQEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return (FreeColDebugger.isInDebugMode(FreeColDebugger.DebugMode.MENUS))&#xD;
         ? debugOnlyAITurns : -1;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn6u6lJQEeiyW7NaN4qWdw" name="setSkippedTurns" specification="_P5MAoVJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn6u61JQEeiyW7NaN4qWdw" name="turns">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>if (FreeColDebugger.isInDebugMode(FreeColDebugger.DebugMode.MENUS)) {&#xD;
         debugOnlyAITurns = turns;&#xD;
     }&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn6u7FJQEeiyW7NaN4qWdw" name="setMonarchAction" specification="_QkoKUFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn6u7VJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn6u7lJQEeiyW7NaN4qWdw" name="action" type="_QiomQFJQEeiyW7NaN4qWdw"/>
                  <language>java</language>
                  <body>if (FreeColDebugger.isInDebugMode(FreeColDebugger.DebugMode.MENUS)) {&#xD;
         debugMonarchPlayer = serverPlayer;&#xD;
         debugMonarchAction = action;&#xD;
     }&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn6u71JQEeiyW7NaN4qWdw" name="stepRandom" specification="_P5MnsFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn6u8FJQEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>return randomInt(logger, &quot;step random&quot;, random, 100);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn7V8FJQEeiyW7NaN4qWdw" name="yearlyGoodsAdjust" specification="_QkoKU1JQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn7V8VJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <language>java</language>
                  <body>ChangeSet cs = new ChangeSet();&#xD;
     serverPlayer.csYearlyGoodsAdjust(random, cs);&#xD;
     serverPlayer.send(cs);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn7V8lJQEeiyW7NaN4qWdw" name="addFoundingFather" specification="_QkoxYFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn7V81JQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn7V9FJQEeiyW7NaN4qWdw" name="father" type="_QidnIFJQEeiyW7NaN4qWdw"/>
                  <language>java</language>
                  <body>ChangeSet cs = new ChangeSet();&#xD;
     serverPlayer.csAddFoundingFather(father, random, cs);&#xD;
     cs.addAttribute(See.only(serverPlayer), &quot;flush&quot;,&#xD;
                     Boolean.TRUE.toString());&#xD;
     serverPlayer.send(cs);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn7V9VJQEeiyW7NaN4qWdw" name="changeStance" specification="_QkoxY1JQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn7V9lJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn7V91JQEeiyW7NaN4qWdw" name="stance" type="_QisQoFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn7V-FJQEeiyW7NaN4qWdw" name="other" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn7V-VJQEeiyW7NaN4qWdw" name="symmetric">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>ChangeSet cs = new ChangeSet();&#xD;
     if (serverPlayer.csChangeStance(stance, other, symmetric, cs)) {&#xD;
         getGame().sendToAll(cs);&#xD;
     }&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn7V-lJQEeiyW7NaN4qWdw" name="debugChangeOwner" specification="_Qkp_gFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn7V-1JQEeiyW7NaN4qWdw" name="colony" type="_Qi7hMVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn7V_FJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <language>java</language>
                  <body>ChangeSet cs = new ChangeSet();&#xD;
     ServerPlayer owner = (ServerPlayer)colony.getOwner();&#xD;
     colony.csChangeOwner(serverPlayer, cs);//-vis(serverPlayer,owner)&#xD;
     cs.add(See.perhaps().always(owner), colony.getOwnedTiles());&#xD;
     serverPlayer.invalidateCanSeeTiles();//+vis(serverPlayer)&#xD;
     owner.invalidateCanSeeTiles();//+vis(owner)&#xD;
     getGame().sendToAll(cs);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn7V_VJQEeiyW7NaN4qWdw" name="debugChangeOwner" specification="_QkqmkFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn7V_lJQEeiyW7NaN4qWdw" name="unit" type="_Qi9WYVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn7V_1JQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <language>java</language>
                  <body>ChangeSet cs = new ChangeSet();&#xD;
     ServerPlayer owner = (ServerPlayer)unit.getOwner();&#xD;
     owner.csChangeOwner(unit, serverPlayer, null, null,&#xD;
                         cs);//-vis(serverPlayer,owner)&#xD;
     cs.add(See.perhaps().always(owner), unit.getTile());&#xD;
     serverPlayer.invalidateCanSeeTiles();//+vis(serverPlayer)&#xD;
     owner.invalidateCanSeeTiles();//+vis(owner)&#xD;
     getGame().sendToAll(cs);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn7WAFJQEeiyW7NaN4qWdw" name="debugApplyDisaster" specification="_QkrNoFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn7WAVJQEeiyW7NaN4qWdw" name="colony" type="_Qi7hMVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn7WAlJQEeiyW7NaN4qWdw" name="disaster" type="_QibK4VJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn7WA1JQEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>ChangeSet cs = new ChangeSet();&#xD;
     ServerPlayer owner = (ServerPlayer)colony.getOwner();&#xD;
     List&lt;ModelMessage> messages&#xD;
         = owner.csApplyDisaster(random, colony, disaster, cs);&#xD;
     if (!messages.isEmpty()) {&#xD;
         cs.addMessage(See.all(),&#xD;
             new ModelMessage(ModelMessage.MessageType.DEFAULT,&#xD;
                 &quot;model.disaster.strikes&quot;, owner)&#xD;
             .addName(&quot;%colony%&quot;, colony.getName())&#xD;
             .addName(&quot;%disaster%&quot;, disaster));&#xD;
         for (ModelMessage message : messages) {&#xD;
             cs.addMessage(See.all(), message);&#xD;
         }&#xD;
         getGame().sendToAll(cs);&#xD;
     }&#xD;
     return messages.size();&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn7WBFJQEeiyW7NaN4qWdw" name="moveGoods" specification="_QksbwFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn7WBVJQEeiyW7NaN4qWdw" name="src" type="_QifcUlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn7WBlJQEeiyW7NaN4qWdw" name="goodsType" type="_QigDYVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn7WB1JQEeiyW7NaN4qWdw" name="amount">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Qn7WCFJQEeiyW7NaN4qWdw" name="dst" type="_QifcUlJQEeiyW7NaN4qWdw"/>
                  <language>java</language>
                  <body>src.getGoodsContainer().saveState();&#xD;
     src.removeGoods(goodsType, amount);&#xD;
     if (dst != null) {&#xD;
         dst.getGoodsContainer().saveState();&#xD;
         dst.addGoods(goodsType, amount);&#xD;
     }&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn79AFJQEeiyW7NaN4qWdw" name="getNationSummary" specification="_QksbxVJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn79AVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn79AlJQEeiyW7NaN4qWdw" name="player" type="_QhZQIFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn79A1JQEeiyW7NaN4qWdw" type="_QiqbcFJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>return new NationSummary(player, serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn79BFJQEeiyW7NaN4qWdw" name="createREFPlayer" specification="_QktC0lJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn79BVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn79BlJQEeiyW7NaN4qWdw" type="_QhaeQ1JQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>Nation refNation = serverPlayer.getNation().getREFNation();&#xD;
     Monarch monarch = serverPlayer.getMonarch();&#xD;
     ServerPlayer refPlayer = getFreeColServer().makeAIPlayer(refNation);&#xD;
     Europe europe = refPlayer.getEurope();&#xD;
     // Inherit rebel player knowledge of the seas, coasts, claimed&#xD;
     // land but not full detailed scouting knowledge.&#xD;
     Set&lt;Tile> explore = new HashSet&lt;>();&#xD;
     for (Tile t : getGame().getMap().getAllTiles()) {&#xD;
         if (!t.isExploredBy(serverPlayer)) continue;&#xD;
         if (!t.isLand()&#xD;
             || t.isCoastland()&#xD;
             || t.getOwner() == serverPlayer) {&#xD;
             explore.add(t);&#xD;
         }&#xD;
     }&#xD;
     refPlayer.exploreTiles(explore);&#xD;
&#xD;
     // Trigger initial placement routine&#xD;
     refPlayer.setEntryLocation(null);&#xD;
     // Will change, setup only&#xD;
     Player.makeContact(serverPlayer, refPlayer);&#xD;
&#xD;
     // Instantiate the REF in Europe&#xD;
     Monarch.Force exf = monarch.getExpeditionaryForce();&#xD;
     // @compat 0.10.5&#xD;
     // There was a bug that seriously under provisioned the navy back&#xD;
     // around 0.10.5, the game in BR#2435 has it.  For now, just add&#xD;
     // enough ships to carry all the units.&#xD;
     UnitType ut = monarch.getNavalREFUnitType();&#xD;
     while (exf.getSpaceRequired() > exf.getCapacity()) {&#xD;
         AbstractUnit au&#xD;
             = new AbstractUnit(ut, Specification.DEFAULT_ROLE_ID, 1);&#xD;
         exf.add(au);&#xD;
     }&#xD;
     // end @compat 0.10.5&#xD;
     List&lt;Unit> landUnits = refPlayer.createUnits(exf.getLandUnits(),&#xD;
                                                  europe);//-vis: safe!map&#xD;
     List&lt;Unit> navalUnits = refPlayer.createUnits(exf.getNavalUnits(),&#xD;
                                                   europe);//-vis: safe!map&#xD;
     refPlayer.loadShips(landUnits, navalUnits, random);//-vis: safe!map&#xD;
     return refPlayer;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn79D1JQEeiyW7NaN4qWdw" name="askFuture" specification="_QkvfEFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn79EFJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn79EVJQEeiyW7NaN4qWdw" name="question" type="_QhZ3MVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn79ElJQEeiyW7NaN4qWdw" name="handler" type="_P5N10FJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn79E1JQEeiyW7NaN4qWdw" type="_QiSoAlJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>Callable&lt;DOMMessage> callable&#xD;
         = new DOMMessageCallable(serverPlayer.getConnection(), getGame(),&#xD;
                                  question, handler);&#xD;
     return executor.submit(callable);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn79FFJQEeiyW7NaN4qWdw" name="askTimeout" specification="_QkwtMFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn79FVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn79FlJQEeiyW7NaN4qWdw" name="request" type="_QhZ3MVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn79F1JQEeiyW7NaN4qWdw" type="_QhZ3MVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>Future&lt;DOMMessage> future = askFuture(serverPlayer, request,&#xD;
         new DOMMessageHandler() {&#xD;
             @Override&#xD;
             public DOMMessage handle(DOMMessage message) {&#xD;
                 return message;&#xD;
             }&#xD;
         });&#xD;
     DOMMessage reply;&#xD;
     try {&#xD;
         boolean single = getFreeColServer().getSinglePlayer();&#xD;
         reply = future.get(FreeCol.getTimeout(single), TimeUnit.SECONDS);&#xD;
     } catch (TimeoutException te) {&#xD;
         serverPlayer.send(new ChangeSet()&#xD;
             .addTrivial(See.only(serverPlayer), &quot;closeMenus&quot;,&#xD;
                         ChangePriority.CHANGE_NORMAL));&#xD;
         reply = null;&#xD;
     } catch (InterruptedException | ExecutionException e) {&#xD;
         reply = null;&#xD;
         logger.log(Level.WARNING, &quot;Exception completing future&quot;, e);&#xD;
     }&#xD;
     return reply;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn79GFJQEeiyW7NaN4qWdw" name="csVisit" specification="_QkxUQFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn79GVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn79GlJQEeiyW7NaN4qWdw" name="is" type="_QiifoFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn79G1JQEeiyW7NaN4qWdw" name="scout">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Qn79HFJQEeiyW7NaN4qWdw" name="cs" type="_P6C8QFJQEeiyW7NaN4qWdw"/>
                  <language>java</language>
                  <body>final ServerPlayer owner = (ServerPlayer)is.getOwner();&#xD;
     if (serverPlayer.csContact(owner, cs)) {&#xD;
         serverPlayer.csNativeFirstContact(owner, null, cs);&#xD;
     }&#xD;
     is.setVisited(serverPlayer);&#xD;
     if (scout > 0 || (scout == 0 &amp;&amp; getGame().getSpecification()&#xD;
             .getBoolean(GameOptions.SETTLEMENT_ACTIONS_CONTACT_CHIEF))) {&#xD;
         is.setScouted(serverPlayer);&#xD;
     }&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn8kEFJQEeiyW7NaN4qWdw" name="endTurn" specification="_Qkx7UFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn8kEVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn8kElJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final FreeColServer freeColServer = getFreeColServer();&#xD;
     final ServerGame game = getGame();&#xD;
     final ServerPlayer winner = (ServerPlayer)game.checkForWinner();&#xD;
&#xD;
     ServerPlayer player = (ServerPlayer)game.getCurrentPlayer();&#xD;
     if (serverPlayer != player) {&#xD;
         throw new IllegalArgumentException(&quot;It is not &quot;&#xD;
             + serverPlayer.getName() + &quot;'s turn, it is &quot;&#xD;
             + ((player == null) ? &quot;noone&quot; : player.getName()) + &quot;'s!&quot;);&#xD;
     }&#xD;
&#xD;
     for (;;) {&#xD;
         logger.finest(&quot;Ending turn for &quot; + player.getName());&#xD;
         player.clearModelMessages();&#xD;
&#xD;
         // Check for new turn&#xD;
         ChangeSet cs = new ChangeSet();&#xD;
         if (game.isNextPlayerInNewTurn()) {&#xD;
             ChangeSet next = new ChangeSet();&#xD;
             game.csNextTurn(next);&#xD;
             game.sendToAll(next);&#xD;
&#xD;
             LogBuilder lb = new LogBuilder(512);&#xD;
             lb.add(&quot;New turn &quot;, game.getTurn(), &quot; for &quot;);&#xD;
             game.csNewTurn(random, lb, cs);&#xD;
             lb.shrink(&quot;, &quot;);&#xD;
             lb.log(logger, Level.FINEST);&#xD;
             if (debugOnlyAITurns > 0) {&#xD;
                 if (--debugOnlyAITurns &lt;= 0) {&#xD;
                     // If this was a debug run, complete it.  This will&#xD;
                     // signal the client to save and quit at the next&#xD;
                     // suitable opportunity.&#xD;
                     FreeColDebugger.signalEndDebugRun();&#xD;
                 }&#xD;
             }&#xD;
         }&#xD;
&#xD;
         if ((player = (ServerPlayer)game.getNextPlayer()) == null) {&#xD;
             // &quot;can not happen&quot;&#xD;
             return DOMMessage.clientError(&quot;Can not get next player&quot;);&#xD;
         }&#xD;
&#xD;
         // Remove dead players and retry&#xD;
         switch (player.checkForDeath()) {&#xD;
         case ServerPlayer.IS_DEAD:&#xD;
             player.csWithdraw(cs);&#xD;
             logger.info(&quot;For &quot; + serverPlayer.getSuffix()&#xD;
                 + &quot;, &quot; + player.getNation() + &quot; is dead.&quot;);&#xD;
             game.sendToAll(cs, player);&#xD;
             continue;&#xD;
         case ServerPlayer.IS_ALIVE:&#xD;
             if (player.isREF() &amp;&amp; player.checkForREFDefeat()) {&#xD;
                 for (Player p : player.getRebels()) {&#xD;
                     csGiveIndependence(player, (ServerPlayer)p, cs);&#xD;
                 }&#xD;
                 player.csWithdraw(cs);&#xD;
                 logger.info(player.getNation() + &quot; is defeated.&quot;);&#xD;
                 game.sendToAll(cs, player);&#xD;
                 continue;&#xD;
             }&#xD;
             break;&#xD;
         default: // Need to autorecruit a unit to keep alive.&#xD;
             player.csEmigrate(0, MigrationType.SURVIVAL, random, cs);&#xD;
             break;&#xD;
         }&#xD;
         // Are there humans left?&#xD;
         // FIXME: see if this can be relaxed so we can run large&#xD;
         // AI-only simulations.&#xD;
         boolean onlyAI = all(game.getConnectedPlayers(), Player::isAI);&#xD;
         if (onlyAI) {&#xD;
             logger.info(&quot;No human player left.&quot;);&#xD;
             if (debugOnlyAITurns > 0) { // Complete debug runs&#xD;
                 FreeColDebugger.signalEndDebugRun();&#xD;
             }&#xD;
             game.setCurrentPlayer(null);&#xD;
&#xD;
             cs.addTrivial(See.all(), &quot;gameEnded&quot;,&#xD;
                           ChangePriority.CHANGE_NORMAL);&#xD;
             game.sendToOthers(serverPlayer, cs);&#xD;
             return cs.build(serverPlayer);&#xD;
         }&#xD;
&#xD;
         // Has the player won?&#xD;
         // Do not end single player games where an AI has won,&#xD;
         // that would stop revenge mode.&#xD;
         if (winner == player&#xD;
             &amp;&amp; !(freeColServer.getSinglePlayer() &amp;&amp; winner.isAI())) {&#xD;
             boolean highScore = !winner.isAI()&#xD;
                 &amp;&amp; HighScore.newHighScore(winner);&#xD;
             cs.addTrivial(See.all(), &quot;gameEnded&quot;,&#xD;
                           ChangePriority.CHANGE_NORMAL,&#xD;
                           &quot;highScore&quot;, String.valueOf(highScore),&#xD;
                           &quot;winner&quot;, winner.getId());&#xD;
         }&#xD;
&#xD;
         // Do &quot;new turn&quot;-like actions that need to wait until right&#xD;
         // before the player is about to move.&#xD;
         game.setCurrentPlayer(player);&#xD;
         if (player.isREF() &amp;&amp; player.getEntryLocation() == null) {&#xD;
             // Initialize this newly created REF&#xD;
             // If the teleportREF option is enabled, teleport it in.&#xD;
             REFAIPlayer refAIPlayer = (REFAIPlayer)freeColServer&#xD;
                 .getAIPlayer(player);&#xD;
             boolean teleport = game.getSpecification()&#xD;
                 .getBoolean(GameOptions.TELEPORT_REF);&#xD;
             if (refAIPlayer.initialize(teleport)) {&#xD;
                 csLaunchREF(player, teleport, cs);&#xD;
             } else {&#xD;
                 logger.severe(&quot;REF failed to initialize.&quot;);&#xD;
             }&#xD;
         }&#xD;
         player.csStartTurn(random, cs);&#xD;
&#xD;
         cs.addTrivial(See.all(), &quot;setCurrentPlayer&quot;,&#xD;
                       ChangePriority.CHANGE_LATE,&#xD;
                       &quot;player&quot;, player.getId());&#xD;
         if (player.getPlayerType() == PlayerType.COLONIAL) {&#xD;
             Monarch monarch = player.getMonarch();&#xD;
             MonarchAction action = null;&#xD;
             if (debugMonarchAction != null&#xD;
                 &amp;&amp; player == debugMonarchPlayer) {&#xD;
                 action = debugMonarchAction;&#xD;
                 debugMonarchAction = null;&#xD;
                 debugMonarchPlayer = null;&#xD;
                 logger.finest(&quot;Debug monarch action: &quot; + action);&#xD;
             } else {&#xD;
                 action = RandomChoice.getWeightedRandom(logger,&#xD;
                         &quot;Choose monarch action&quot;,&#xD;
                     monarch.getActionChoices(), random);&#xD;
             }&#xD;
             if (action != null) {&#xD;
                 if (monarch.actionIsValid(action)) {&#xD;
                     logger.finest(&quot;Monarch action: &quot; + action);&#xD;
                     csMonarchAction(player, action, cs);&#xD;
                 } else {&#xD;
                     logger.finest(&quot;Skipping invalid monarch action: &quot;&#xD;
                         + action);&#xD;
                 }&#xD;
             }&#xD;
         }&#xD;
&#xD;
         // Flush accumulated changes.  Send to all players, but&#xD;
         // take care that the new player is last so that it does&#xD;
         // not immediately start moving and cause further changes&#xD;
         // which conflict with these updates.  Finally return to the&#xD;
         // current player which requested the end-of-turn, unless&#xD;
         // it is doing a debug run.&#xD;
         boolean debugSkip = !player.isAI()&#xD;
             &amp;&amp; freeColServer.getSinglePlayer()&#xD;
             &amp;&amp; debugOnlyAITurns > 0;&#xD;
         if (debugSkip) {&#xD;
             game.sendToOthers(player, cs);&#xD;
             player.send(cs);&#xD;
             continue;&#xD;
         }&#xD;
         game.sendToList(game.getConnectedPlayers(player, serverPlayer),&#xD;
                         cs);&#xD;
         if (player != serverPlayer) player.send(cs);&#xD;
         return cs.build(serverPlayer);&#xD;
     }&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn8kE1JQEeiyW7NaN4qWdw" name="csLaunchREF" specification="_Qkx7U1JQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn8kFFJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn8kFVJQEeiyW7NaN4qWdw" name="teleport">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Qn8kFlJQEeiyW7NaN4qWdw" name="cs" type="_P6C8QFJQEeiyW7NaN4qWdw"/>
                  <language>java</language>
                  <body>// Set the REF player entry location from the rebels.  Note&#xD;
     // that the REF units will have their own unit-specific entry&#xD;
     // locations set by their missions.  This just flags that the&#xD;
     // REF is initialized.&#xD;
     for (Player p : serverPlayer.getRebels()) {&#xD;
         serverPlayer.setEntryLocation(p.getEntryLocation().getTile());&#xD;
         break;&#xD;
     }&#xD;
&#xD;
     if (teleport) { // Teleport in the units.&#xD;
         Set&lt;Tile> seen = new HashSet&lt;>();&#xD;
         for (Unit u : serverPlayer.getUnits()) {&#xD;
             if (!u.isNaval()) continue;&#xD;
             Tile entry = u.getEntryLocation().getTile();&#xD;
             u.setLocation(entry);//-vis(serverPlayer)&#xD;
             u.setWorkLeft(-1);&#xD;
             u.setState(Unit.UnitState.ACTIVE);&#xD;
             if (!seen.contains(entry)) {&#xD;
                 seen.add(entry);&#xD;
                 cs.add(See.only(serverPlayer),&#xD;
                        serverPlayer.exploreForUnit(u));&#xD;
                 cs.add(See.perhaps().except(serverPlayer), entry);&#xD;
             }&#xD;
         }&#xD;
         serverPlayer.invalidateCanSeeTiles();//+vis(serverPlayer)&#xD;
     } else {&#xD;
         // Put navy on the high seas, with 1-turn sail time&#xD;
         for (Unit u : serverPlayer.getUnits()) {&#xD;
             if (!u.isNaval()) continue;&#xD;
             u.setWorkLeft(1);&#xD;
             u.setDestination(u.getEntryLocation());&#xD;
             u.setLocation(u.getOwner().getHighSeas());//-vis: safe!map&#xD;
         }&#xD;
     }&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn8kF1JQEeiyW7NaN4qWdw" name="csGiveIndependence" specification="_QkyiYVJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn8kGFJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn8kGVJQEeiyW7NaN4qWdw" name="independent" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn8kGlJQEeiyW7NaN4qWdw" name="cs" type="_P6C8QFJQEeiyW7NaN4qWdw"/>
                  <language>java</language>
                  <body>serverPlayer.csChangeStance(Stance.PEACE, independent, true, cs);&#xD;
     independent.changePlayerType(PlayerType.INDEPENDENT);&#xD;
     Game game = getGame();&#xD;
     Turn turn = game.getTurn();&#xD;
     independent.setTax(0);&#xD;
     independent.reinitialiseMarket();&#xD;
     HistoryEvent h = new HistoryEvent(turn,&#xD;
         HistoryEvent.HistoryEventType.INDEPENDENCE, independent);&#xD;
&#xD;
     // The score for actual independence is actually a percentage&#xD;
     // bonus depending on how many other nations are independent.&#xD;
     // If we ever go for a more complex scoring algorithm it might&#xD;
     // be better to replace the score int with a Modifier, but for&#xD;
     // now we just set the score value to the number of&#xD;
     // independent players other than the one we are granting&#xD;
     // here, and generate the bonus with a special case in&#xD;
     // ServerPlayer.updateScore().&#xD;
     int n = 0;&#xD;
     for (Player p : game.getLiveEuropeanPlayers(independent)) {&#xD;
         if (p.getPlayerType() == PlayerType.INDEPENDENT) n++;&#xD;
     }&#xD;
     h.setScore(n);&#xD;
     cs.addGlobalHistory(game, h);&#xD;
     cs.addMessage(See.only(independent),&#xD;
         new ModelMessage(ModelMessage.MessageType.FOREIGN_DIPLOMACY,&#xD;
             &quot;giveIndependence.announce&quot;, independent)&#xD;
         .addStringTemplate(&quot;%ref%&quot;, serverPlayer.getNationLabel()));&#xD;
&#xD;
     // Who surrenders?&#xD;
     List&lt;Unit> surrenderUnits = new ArrayList&lt;>();&#xD;
     for (Unit u : serverPlayer.getUnits()) {&#xD;
         if (u.hasTile() &amp;&amp; !u.isNaval() &amp;&amp; !u.isOnCarrier()&#xD;
             &amp;&amp; serverPlayer.csChangeOwner(u, independent,&#xD;
                 ChangeType.CAPTURE, null, cs)) {//-vis(both)&#xD;
             u.setMovesLeft(0);&#xD;
             u.setState(Unit.UnitState.ACTIVE);&#xD;
             cs.add(See.perhaps().always(serverPlayer), u.getTile());&#xD;
             surrenderUnits.add(u);&#xD;
         }&#xD;
     }&#xD;
     if (!surrenderUnits.isEmpty()) {&#xD;
         cs.addMessage(See.only(independent),&#xD;
             new ModelMessage(ModelMessage.MessageType.FOREIGN_DIPLOMACY,&#xD;
                 &quot;giveIndependence.unitsAcquired&quot;, independent)&#xD;
             .addStringTemplate(&quot;%units%&quot;,&#xD;
                 unitTemplate(&quot;, &quot;, surrenderUnits)));&#xD;
         independent.invalidateCanSeeTiles();//+vis(independent)&#xD;
         serverPlayer.invalidateCanSeeTiles();//+vis(serverPlayer)&#xD;
     }&#xD;
&#xD;
     // Update player type.  Again, a pity to have to do a whole&#xD;
     // player update, but a partial update works for other players.&#xD;
     cs.addPartial(See.all().except(independent), independent, &quot;playerType&quot;);&#xD;
     cs.addMessage(See.all().except(independent),&#xD;
         new ModelMessage(ModelMessage.MessageType.FOREIGN_DIPLOMACY,&#xD;
             &quot;giveIndependence.otherAnnounce&quot;, independent)&#xD;
             .addStringTemplate(&quot;%nation%&quot;, independent.getNationLabel())&#xD;
             .addStringTemplate(&quot;%ref%&quot;, serverPlayer.getNationLabel()));&#xD;
     cs.add(See.only(independent), independent);&#xD;
&#xD;
     // Reveal the map on independence.&#xD;
     cs.add(See.only(independent), independent.exploreMap(true));&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn8kG1JQEeiyW7NaN4qWdw" name="unitTemplate" specification="_QkzJcFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn8kHFJQEeiyW7NaN4qWdw" name="base">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Qn8kHVJQEeiyW7NaN4qWdw" name="units" type="_QhldYVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn8kHlJQEeiyW7NaN4qWdw" type="_Qius4FJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>StringTemplate template = StringTemplate.label(base);&#xD;
     for (Unit u : units) {&#xD;
         template.addStringTemplate(u.getLabel(Unit.UnitLabelType.PLAIN));&#xD;
     }&#xD;
     return template;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn8kH1JQEeiyW7NaN4qWdw" name="raiseTax" specification="_QkzwgVJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn8kIFJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn8kIVJQEeiyW7NaN4qWdw" name="taxRaise">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Qn8kIlJQEeiyW7NaN4qWdw" name="goods" type="_Qie1QVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn8kI1JQEeiyW7NaN4qWdw" name="result">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>ChangeSet cs = new ChangeSet();&#xD;
     serverPlayer.csRaiseTax(taxRaise, goods, result, cs);&#xD;
     serverPlayer.send(cs);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn9LIFJQEeiyW7NaN4qWdw" name="csMonarchAction" specification="_Qk0Xk1JQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn9LIVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw">
                    <eAnnotations xmi:id="_Qn9LIlJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                      <details xmi:id="_Qn9LI1JQEeiyW7NaN4qWdw" key="final"/>
                    </eAnnotations>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Qn9LJFJQEeiyW7NaN4qWdw" name="action" type="_QiomQFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn9LJVJQEeiyW7NaN4qWdw" name="cs" type="_P6C8QFJQEeiyW7NaN4qWdw"/>
                  <language>java</language>
                  <body>final Monarch monarch = serverPlayer.getMonarch();&#xD;
     final Game game = getGame();&#xD;
     final Specification spec = game.getSpecification();&#xD;
     boolean valid = monarch.actionIsValid(action);&#xD;
     if (!valid) return;&#xD;
     String messageId = action.getTextKey();&#xD;
     StringTemplate template;&#xD;
     MonarchActionMessage message;&#xD;
     String monarchKey = serverPlayer.getMonarchKey();&#xD;
&#xD;
     switch (action) {&#xD;
     case NO_ACTION:&#xD;
         break;&#xD;
     case RAISE_TAX_WAR: case RAISE_TAX_ACT:&#xD;
         final int taxRaise = monarch.raiseTax(random);&#xD;
         final Goods goods = serverPlayer.getMostValuableGoods();&#xD;
         if (goods == null) {&#xD;
             logger.finest(&quot;Ignoring tax raise, no goods to boycott.&quot;);&#xD;
             break;&#xD;
         }&#xD;
         template = StringTemplate.template(messageId)&#xD;
             .addStringTemplate(&quot;%goods%&quot;, goods.getType().getLabel())&#xD;
             .addAmount(&quot;%amount%&quot;, taxRaise);&#xD;
         if (action == MonarchAction.RAISE_TAX_WAR) {&#xD;
             template = template.add(&quot;%nation%&quot;,&#xD;
                 Nation.getRandomNonPlayerNationNameKey(game, random));&#xD;
         } else if (action == MonarchAction.RAISE_TAX_ACT) {&#xD;
             template = template.addAmount(&quot;%number%&quot;,&#xD;
                 randomInt(logger, &quot;Tax act goods&quot;, random, 6))&#xD;
                 .addName(&quot;%newWorld%&quot;, serverPlayer.getNewLandName());&#xD;
         }&#xD;
         message = new MonarchActionMessage(action, template, monarchKey)&#xD;
             .setTax(taxRaise);&#xD;
         cs.add(See.only(serverPlayer), ChangePriority.CHANGE_EARLY,&#xD;
                message);&#xD;
         new MonarchSession(serverPlayer, action, taxRaise, goods);&#xD;
         break;&#xD;
     case LOWER_TAX_WAR: case LOWER_TAX_OTHER:&#xD;
         int oldTax = serverPlayer.getTax();&#xD;
         int taxLower = monarch.lowerTax(random);&#xD;
         serverPlayer.csSetTax(taxLower, cs);&#xD;
         template = StringTemplate.template(messageId)&#xD;
             .addAmount(&quot;%difference%&quot;, oldTax - taxLower)&#xD;
             .addAmount(&quot;%newTax%&quot;, taxLower);&#xD;
         if (action == MonarchAction.LOWER_TAX_WAR) {&#xD;
             template = template.add(&quot;%nation%&quot;,&#xD;
                 Nation.getRandomNonPlayerNationNameKey(game, random));&#xD;
         } else {&#xD;
             template = template.addAmount(&quot;%number%&quot;,&#xD;
                 randomInt(logger, &quot;Lower tax reason&quot;, random, 5));&#xD;
         }&#xD;
         cs.add(See.only(serverPlayer), ChangePriority.CHANGE_LATE,&#xD;
             new MonarchActionMessage(action, template, monarchKey));&#xD;
         break;&#xD;
     case WAIVE_TAX:&#xD;
         cs.add(See.only(serverPlayer), ChangePriority.CHANGE_NORMAL,&#xD;
             new MonarchActionMessage(action,&#xD;
                 StringTemplate.template(messageId), monarchKey));&#xD;
         break;&#xD;
     case ADD_TO_REF:&#xD;
         AbstractUnit refAdditions = monarch.chooseForREF(random);&#xD;
         if (refAdditions == null) break;&#xD;
         monarch.getExpeditionaryForce().add(refAdditions);&#xD;
         template = StringTemplate.template(messageId)&#xD;
             .addAmount(&quot;%number%&quot;, refAdditions.getNumber())&#xD;
             .addNamed(&quot;%unit%&quot;, refAdditions.getType(spec));&#xD;
         cs.add(See.only(serverPlayer), monarch);&#xD;
         cs.add(See.only(serverPlayer), ChangePriority.CHANGE_LATE,&#xD;
             new MonarchActionMessage(action, template, monarchKey));&#xD;
         break;&#xD;
     case DECLARE_PEACE:&#xD;
         List&lt;Player> friends = monarch.collectPotentialFriends();&#xD;
         if (friends.isEmpty()) break;&#xD;
         Player friend = getRandomMember(logger, &quot;Choose friend&quot;,&#xD;
                                         friends, random);&#xD;
         serverPlayer.csChangeStance(Stance.PEACE, (ServerPlayer)friend,&#xD;
                                     true, cs);&#xD;
         cs.add(See.only(serverPlayer), ChangePriority.CHANGE_LATE,&#xD;
             new MonarchActionMessage(action, StringTemplate&#xD;
                 .template(messageId)&#xD;
                 .addStringTemplate(&quot;%nation%&quot;, friend.getNationLabel()),&#xD;
                 monarchKey));&#xD;
         break;&#xD;
     case DECLARE_WAR:&#xD;
         List&lt;Player> enemies = monarch.collectPotentialEnemies();&#xD;
         if (enemies.isEmpty()) break;&#xD;
         Player enemy = getRandomMember(logger, &quot;Choose enemy&quot;,&#xD;
                                        enemies, random);&#xD;
         List&lt;AbstractUnit> warSupport &#xD;
             = monarch.getWarSupport(enemy, random);&#xD;
         int warGold = 0;&#xD;
         if (!warSupport.isEmpty()) {&#xD;
             serverPlayer.createUnits(warSupport,&#xD;
                 serverPlayer.getEurope());//-vis: safe, Europe&#xD;
             warGold = spec.getInteger(GameOptions.WAR_SUPPORT_GOLD);&#xD;
             warGold += (warGold/10) * (randomInt(logger, &quot;War support gold&quot;,&#xD;
                                                  random, 5) - 2);&#xD;
             serverPlayer.modifyGold(warGold);&#xD;
             cs.addPartial(See.only(serverPlayer), serverPlayer,&#xD;
                           &quot;gold&quot;, &quot;score&quot;);&#xD;
             logger.fine(&quot;War support v &quot; + enemy.getNation().getSuffix()&#xD;
                 + &quot; &quot; + warGold + &quot; gold + &quot; + Messages.message(AbstractUnit&#xD;
                     .getListLabel(&quot;, &quot;, warSupport)));&#xD;
         }&#xD;
         serverPlayer.csChangeStance(Stance.WAR, (ServerPlayer)enemy,&#xD;
                                     true, cs);&#xD;
         cs.add(See.only(serverPlayer), ChangePriority.CHANGE_LATE,&#xD;
             new MonarchActionMessage(action, StringTemplate&#xD;
                 .template((warSupport.isEmpty()) ? messageId&#xD;
                     : &quot;model.monarch.action.declareWarSupported.text&quot;)&#xD;
                     .addStringTemplate(&quot;%nation%&quot;, enemy.getNationLabel())&#xD;
                     .addStringTemplate(&quot;%force%&quot;,&#xD;
                         AbstractUnit.getListLabel(&quot;, &quot;, warSupport))&#xD;
                     .addAmount(&quot;%gold%&quot;, warGold),&#xD;
                 monarchKey));&#xD;
         break;&#xD;
     case SUPPORT_LAND: case SUPPORT_SEA:&#xD;
         boolean sea = action == MonarchAction.SUPPORT_SEA;&#xD;
         List&lt;AbstractUnit> support = monarch.getSupport(random, sea);&#xD;
         if (support.isEmpty()) break;&#xD;
         serverPlayer.createUnits(support,&#xD;
             serverPlayer.getEurope());//-vis: safe, Europe&#xD;
         cs.add(See.only(serverPlayer), serverPlayer.getEurope());&#xD;
         cs.add(See.only(serverPlayer), ChangePriority.CHANGE_LATE,&#xD;
             new MonarchActionMessage(action, StringTemplate&#xD;
                 .template(messageId)&#xD;
                 .addStringTemplate(&quot;%addition%&quot;,&#xD;
                     AbstractUnit.getListLabel(&quot;, &quot;, support)),&#xD;
                 monarchKey));&#xD;
         break;&#xD;
     case MONARCH_MERCENARIES:&#xD;
         final List&lt;AbstractUnit> mercenaries&#xD;
             = monarch.getMercenaries(random);&#xD;
         if (mercenaries.isEmpty()) break;&#xD;
         final int mercPrice = serverPlayer.priceMercenaries(mercenaries);&#xD;
         message = new MonarchActionMessage(action, StringTemplate&#xD;
             .template(messageId)&#xD;
             .addAmount(&quot;%gold%&quot;, mercPrice)&#xD;
             .addStringTemplate(&quot;%mercenaries%&quot;,&#xD;
                 AbstractUnit.getListLabel(&quot;, &quot;, mercenaries)),&#xD;
             monarchKey);&#xD;
         cs.add(See.only(serverPlayer), ChangePriority.CHANGE_EARLY,&#xD;
                message);&#xD;
         new MonarchSession(serverPlayer, action, mercenaries, mercPrice);&#xD;
         break;&#xD;
     case HESSIAN_MERCENARIES:&#xD;
         final List&lt;AbstractUnit> hessians&#xD;
             = monarch.getMercenaries(random);&#xD;
         if (hessians.isEmpty()) break;&#xD;
         int n = NameCache.getMercenaryLeaderIndex(random);&#xD;
         final int hessPrice = serverPlayer.priceMercenaries(hessians);&#xD;
         message = new MonarchActionMessage(action, StringTemplate&#xD;
             .template(messageId)&#xD;
             .addName(&quot;%leader%&quot;, NameCache.getMercenaryLeaderName(n))&#xD;
             .addAmount(&quot;%gold%&quot;, hessPrice)&#xD;
             .addStringTemplate(&quot;%mercenaries%&quot;,&#xD;
                 AbstractUnit.getListLabel(&quot;, &quot;, hessians)),&#xD;
             &quot;image.flavor.model.mercenaries.&quot; + n);&#xD;
         cs.add(See.only(serverPlayer), ChangePriority.CHANGE_EARLY,&#xD;
                message);&#xD;
         new MonarchSession(serverPlayer, action, hessians, hessPrice);&#xD;
         break;&#xD;
     case DISPLEASURE: default:&#xD;
         logger.warning(&quot;Bogus action: &quot; + action);&#xD;
         break;&#xD;
     }&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn9LJlJQEeiyW7NaN4qWdw" name="monarchAction" specification="_Qk0-pFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn9LJ1JQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn9LKFJQEeiyW7NaN4qWdw" name="action" type="_QiomQFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn9LKVJQEeiyW7NaN4qWdw" name="result">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Qn9LKlJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>MonarchSession session = TransactionSession.lookup(MonarchSession.class,&#xD;
         serverPlayer.getId(), &quot;&quot;);&#xD;
     if (session == null) {&#xD;
         return DOMMessage.clientError(&quot;Bogus monarch action: &quot; + action);&#xD;
     } else if (action != session.getAction()) {&#xD;
         return DOMMessage.clientError(&quot;Session action mismatch, &quot;&#xD;
             + session.getAction() + &quot; expected: &quot; + action);&#xD;
     }&#xD;
&#xD;
     ChangeSet cs = new ChangeSet();&#xD;
     session.complete(result, cs);&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn9LK1JQEeiyW7NaN4qWdw" name="retire" specification="_Qk0-qVJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn9LLFJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn9LLVJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>boolean highScore = HighScore.newHighScore(serverPlayer);&#xD;
     ChangeSet cs = new ChangeSet();&#xD;
     serverPlayer.csWithdraw(cs); // Clean up the player.&#xD;
     getGame().sendToOthers(serverPlayer, cs);&#xD;
     cs.addAttribute(See.only(serverPlayer),&#xD;
                     &quot;highScore&quot;, Boolean.toString(highScore));&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn9LLlJQEeiyW7NaN4qWdw" name="continuePlaying" specification="_Qk2MwFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn9LL1JQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn9LMFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerGame game = getGame();&#xD;
     Element reply = null;&#xD;
     if (!getFreeColServer().getSinglePlayer()) {&#xD;
         logger.warning(&quot;Can not continue playing in multiplayer!&quot;);&#xD;
     } else if (serverPlayer != game.checkForWinner()) {&#xD;
         logger.warning(&quot;Can not continue playing, as &quot;&#xD;
                        + serverPlayer.getName()&#xD;
                        + &quot; has not won the game!&quot;);&#xD;
     } else {&#xD;
         final Specification spec = game.getSpecification();&#xD;
         spec.getBooleanOption(GameOptions.VICTORY_DEFEAT_REF)&#xD;
             .setValue(Boolean.FALSE);&#xD;
         spec.getBooleanOption(GameOptions.VICTORY_DEFEAT_EUROPEANS)&#xD;
             .setValue(Boolean.FALSE);&#xD;
         spec.getBooleanOption(GameOptions.VICTORY_DEFEAT_HUMANS)&#xD;
             .setValue(Boolean.FALSE);&#xD;
         logger.info(&quot;Disabled victory conditions, as &quot;&#xD;
                     + serverPlayer.getName()&#xD;
                     + &quot; has won, but is continuing to play.&quot;);&#xD;
     }&#xD;
     return null;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn9LMVJQEeiyW7NaN4qWdw" name="cashInTreasureTrain" specification="_Qk2Mw1JQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn9LMlJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn9LM1JQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn9LNFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>ChangeSet cs = new ChangeSet();&#xD;
&#xD;
     // Work out the cash in amount and the message to send.&#xD;
     int fullAmount = unit.getTreasureAmount();&#xD;
     int cashInAmount;&#xD;
     String messageId;&#xD;
     if (serverPlayer.getPlayerType() == PlayerType.COLONIAL) {&#xD;
         // Charge transport fee and apply tax&#xD;
         cashInAmount = (fullAmount - unit.getTransportFee())&#xD;
             * (100 - serverPlayer.getTax()) / 100;&#xD;
         messageId = &quot;cashInTreasureTrain.colonial&quot;;&#xD;
     } else {&#xD;
         // No fee possible, no tax applies.&#xD;
         cashInAmount = fullAmount;&#xD;
         messageId = &quot;cashInTreasureTrain.independent&quot;;&#xD;
     }&#xD;
&#xD;
     serverPlayer.modifyGold(cashInAmount);&#xD;
     cs.addPartial(See.only(serverPlayer), serverPlayer, &quot;gold&quot;, &quot;score&quot;);&#xD;
     cs.addMessage(See.only(serverPlayer),&#xD;
         new ModelMessage(messageId, serverPlayer, unit)&#xD;
             .addAmount(&quot;%amount%&quot;, fullAmount)&#xD;
             .addAmount(&quot;%cashInAmount%&quot;, cashInAmount));&#xD;
     messageId = (serverPlayer.isRebel()&#xD;
                  || serverPlayer.getPlayerType() == PlayerType.INDEPENDENT)&#xD;
         ? &quot;cashInTreasureTrain.otherIndependent&quot;&#xD;
         : &quot;cashInTreasureTrain.otherColonial&quot;;&#xD;
     cs.addMessage(See.all().except(serverPlayer),&#xD;
         new ModelMessage(ModelMessage.MessageType.FOREIGN_DIPLOMACY,&#xD;
                          messageId, serverPlayer)&#xD;
             .addAmount(&quot;%amount%&quot;, fullAmount)&#xD;
             .addStringTemplate(&quot;%nation%&quot;, serverPlayer.getNationLabel()));&#xD;
&#xD;
     // Dispose of the unit, only visible to the owner.&#xD;
     cs.add(See.only(serverPlayer), (FreeColGameObject)unit.getLocation());&#xD;
     cs.addRemove(See.only(serverPlayer), null, unit);//-vis: safe in colony&#xD;
     unit.dispose();&#xD;
&#xD;
     // Others can see the cash in message.&#xD;
     getGame().sendToOthers(serverPlayer, cs);&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn9LNVJQEeiyW7NaN4qWdw" name="declareIndependence" specification="_Qk2z0FJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn9yMFJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw">
                    <eAnnotations xmi:id="_Qn9yMVJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                      <details xmi:id="_Qn9yMlJQEeiyW7NaN4qWdw" key="final"/>
                    </eAnnotations>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Qn9yM1JQEeiyW7NaN4qWdw" name="nationName">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Qn9yNFJQEeiyW7NaN4qWdw" name="countryName">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Qn9yNVJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final Game game = getGame();&#xD;
     final Specification spec = game.getSpecification();&#xD;
     ChangeSet cs = new ChangeSet();&#xD;
&#xD;
     // Cross the Rubicon&#xD;
     StringTemplate oldNation = serverPlayer.getNationLabel();&#xD;
     serverPlayer.setIndependentNationName(nationName);&#xD;
     serverPlayer.setNewLandName(countryName);&#xD;
     serverPlayer.changePlayerType(PlayerType.REBEL);&#xD;
&#xD;
     // Do not add history event to cs as we are going to update the&#xD;
     // entire player.  Likewise clear model messages.&#xD;
     Turn turn = game.getTurn();&#xD;
     HistoryEvent h = new HistoryEvent(turn,&#xD;
         HistoryEvent.HistoryEventType.DECLARE_INDEPENDENCE, serverPlayer);&#xD;
     final int independenceTurn = spec.getInteger(GameOptions.INDEPENDENCE_TURN);&#xD;
     h.setScore(Math.max(0, independenceTurn - turn.getNumber()));&#xD;
     cs.addGlobalHistory(game, h);&#xD;
     serverPlayer.clearModelMessages();&#xD;
     cs.addMessage(See.only(serverPlayer),&#xD;
         new ModelMessage(ModelMessage.MessageType.FOREIGN_DIPLOMACY,&#xD;
             &quot;declareIndependence.resolution&quot;, serverPlayer));&#xD;
&#xD;
     // Dispose of units in or heading to Europe.&#xD;
     Europe europe = serverPlayer.getEurope();&#xD;
     StringTemplate seized = StringTemplate.label(&quot;, &quot;);&#xD;
     boolean lost = false;&#xD;
     for (Unit u : europe.getUnitList()) {&#xD;
         seized.addStringTemplate(u.getLabel());&#xD;
         cs.addRemoves(See.only(serverPlayer), null, u.getDisposeList());&#xD;
         u.dispose();&#xD;
         lost = true;&#xD;
     }&#xD;
     for (Unit u : serverPlayer.getHighSeas().getUnitList()) {&#xD;
         if (u.getDestination() == europe) {&#xD;
             seized.addStringTemplate(u.getLabel());&#xD;
             cs.addRemoves(See.only(serverPlayer), null, u.getDisposeList());&#xD;
             u.dispose();&#xD;
             lost = true;&#xD;
         }&#xD;
     }&#xD;
     if (lost) {&#xD;
         cs.addMessage(See.only(serverPlayer),&#xD;
             new ModelMessage(ModelMessage.MessageType.UNIT_LOST,&#xD;
                              &quot;declareIndependence.unitsSeized&quot;,&#xD;
                              serverPlayer)&#xD;
                 .addStringTemplate(&quot;%units%&quot;, seized));&#xD;
     }&#xD;
     serverPlayer.csLoseLocation(europe, cs);&#xD;
&#xD;
     // Create the REF.&#xD;
     ServerPlayer refPlayer = createREFPlayer(serverPlayer);&#xD;
     cs.addPlayer(refPlayer);&#xD;
     // Update the intervention force&#xD;
     serverPlayer.getMonarch().updateInterventionForce();&#xD;
     String otherKey = Nation.getRandomNonPlayerNationNameKey(game, random);&#xD;
     cs.addMessage(See.only(serverPlayer),&#xD;
         new ModelMessage(ModelMessage.MessageType.FOREIGN_DIPLOMACY,&#xD;
                          &quot;declareIndependence.interventionForce&quot;,&#xD;
                          serverPlayer)&#xD;
             .add(&quot;%nation%&quot;, otherKey)&#xD;
             .addAmount(&quot;%number%&quot;,&#xD;
                 spec.getInteger(GameOptions.INTERVENTION_BELLS)));&#xD;
     serverPlayer.csChangeStance(Stance.WAR, refPlayer, true, cs);&#xD;
&#xD;
     // Now the REF is ready, we can dispose of the European connection.&#xD;
     cs.addRemove(See.only(serverPlayer), null, europe);//-vis: not on map&#xD;
     europe.dispose();&#xD;
     // Do not clean up the Monarch, it contains the intervention force&#xD;
&#xD;
     // Generalized continental army muster.&#xD;
     // Do not use UnitType.getTargetType.&#xD;
     java.util.Map&lt;UnitType, UnitType> upgrades = new HashMap&lt;>();&#xD;
     for (UnitType unitType : spec.getUnitTypeList()) {&#xD;
         UnitType upgrade = unitType.getTargetType(ChangeType.INDEPENDENCE,&#xD;
                                                   serverPlayer);&#xD;
         if (upgrade != null) upgrades.put(unitType, upgrade);&#xD;
     }&#xD;
     java.util.Map&lt;UnitType, List&lt;Unit>> unitMap = new HashMap&lt;>();&#xD;
     for (Colony colony : serverPlayer.getColonies()) {&#xD;
         List&lt;Unit> allUnits = new ArrayList&lt;>();&#xD;
         allUnits.addAll(colony.getTile().getUnitList());&#xD;
         allUnits.addAll(colony.getUnitList());&#xD;
         int limit = (allUnits.size() + 2) * (colony.getSoL() - 50) / 100;&#xD;
         if (limit &lt;= 0) continue;&#xD;
&#xD;
         unitMap.clear();&#xD;
         for (Unit unit : allUnits) {&#xD;
             if (upgrades.containsKey(unit.getType())) {&#xD;
                 List&lt;Unit> unitList = unitMap.get(unit.getType());&#xD;
                 if (unitList == null) {&#xD;
                     unitList = new ArrayList&lt;>();&#xD;
                     unitMap.put(unit.getType(), unitList);&#xD;
                 }&#xD;
                 unitList.add(unit);&#xD;
             }&#xD;
         }&#xD;
         for (Entry&lt;UnitType, List&lt;Unit>> entry : unitMap.entrySet()) {&#xD;
             int n = 0;&#xD;
             UnitType type = entry.getKey();&#xD;
             List&lt;Unit> units = entry.getValue();&#xD;
             while (!units.isEmpty() &amp;&amp; n &lt; limit) {&#xD;
                 Unit unit = units.remove(0);&#xD;
                 unit.changeType(upgrades.get(type));//-vis&#xD;
                 cs.add(See.only(serverPlayer), unit);&#xD;
                 n++;&#xD;
             }&#xD;
             cs.addMessage(See.only(serverPlayer),&#xD;
                 new ModelMessage(ModelMessage.MessageType.UNIT_IMPROVED,&#xD;
                     &quot;declareIndependence.continentalArmyMuster&quot;,&#xD;
                     serverPlayer, colony)&#xD;
                 .addName(&quot;%colony%&quot;, colony.getName())&#xD;
                 .addAmount(&quot;%number%&quot;, n)&#xD;
                 .addNamed(&quot;%oldUnit%&quot;, type)&#xD;
                 .addNamed(&quot;%unit%&quot;, upgrades.get(type)));&#xD;
             limit -= n;&#xD;
         }&#xD;
     }&#xD;
&#xD;
     // Most hostile contacted non-warring natives declare war on&#xD;
     // you and peace with the REF, least hostile contacted natives&#xD;
     // declare peace on you and war on the REF.  If they are the&#xD;
     // same nation, go to the next most hostile nation that may&#xD;
     // already be at war.&#xD;
     List&lt;Player> natives = game.getLiveNativePlayers(null).stream()&#xD;
         .filter(p -> p.hasContacted(serverPlayer))&#xD;
         .sorted(new Comparator&lt;Player>() {&#xD;
                 public int compare(Player p1, Player p2) {&#xD;
                     return p1.getTension(serverPlayer).getValue()&#xD;
                         - p2.getTension(serverPlayer).getValue();&#xD;
                 }&#xD;
             })&#xD;
         .collect(Collectors.toList());&#xD;
     if (!natives.isEmpty()) {&#xD;
         ServerPlayer good = (ServerPlayer)natives.get(0);&#xD;
         logger.info(&quot;Native ally following independence: &quot; + good);&#xD;
         cs.addMessage(See.only(serverPlayer),&#xD;
             new ModelMessage(ModelMessage.MessageType.FOREIGN_DIPLOMACY,&#xD;
                              &quot;declareIndependence.nativeSupport&quot;, good)&#xD;
                 .addStringTemplate(&quot;%nation%&quot;, good.getNationLabel())&#xD;
                 .add(&quot;%ruler%&quot;, serverPlayer.getRulerNameKey())&#xD;
                       );&#xD;
         int delta;&#xD;
         switch (good.getStance(serverPlayer)) {&#xD;
         case ALLIANCE: case PEACE: default:&#xD;
             delta = 0;&#xD;
             break;&#xD;
         case CEASE_FIRE:&#xD;
             delta = Tension.Level.HAPPY.getLimit()&#xD;
                 - good.getTension(serverPlayer).getValue();&#xD;
             break;&#xD;
         case WAR:&#xD;
             delta = Tension.Level.CONTENT.getLimit()&#xD;
                 - good.getTension(serverPlayer).getValue();&#xD;
             break;&#xD;
         }&#xD;
         good.csModifyTension(serverPlayer, delta, cs);&#xD;
         Player.makeContact(good, refPlayer);&#xD;
         good.csModifyTension(refPlayer,&#xD;
             Tension.Level.HATEFUL.getLimit(), cs);&#xD;
&#xD;
         reverse(natives);&#xD;
         ServerPlayer bad = null;&#xD;
         for (Player p : natives) {&#xD;
             if (p == good&#xD;
                 || p.getStance(serverPlayer) == Stance.ALLIANCE) break;&#xD;
             bad = (ServerPlayer)p;&#xD;
             if (!p.atWarWith(serverPlayer)) break;&#xD;
         }&#xD;
         logger.info(&quot;Native enemy following independence: &quot; + bad);&#xD;
         if (bad != null) {&#xD;
             switch (bad.getStance(serverPlayer)) {&#xD;
             case PEACE: case CEASE_FIRE:&#xD;
                 delta = Tension.Level.HATEFUL.getLimit()&#xD;
                     - bad.getTension(serverPlayer).getValue();&#xD;
                 break;&#xD;
             case WAR: default:&#xD;
                 delta = 0;&#xD;
                 break;&#xD;
             }&#xD;
             cs.addMessage(See.only(serverPlayer),&#xD;
                 new ModelMessage(ModelMessage.MessageType.FOREIGN_DIPLOMACY,&#xD;
                                  &quot;declareIndependence.nativeHostile&quot;, bad)&#xD;
                     .addStringTemplate(&quot;%nation%&quot;, bad.getNationLabel()));&#xD;
             if (delta != 0) bad.csModifyTension(serverPlayer, delta, cs);&#xD;
             Player.makeContact(bad, refPlayer);&#xD;
             bad.csModifyTension(refPlayer,&#xD;
                 -bad.getTension(refPlayer).getValue(), cs);&#xD;
         }&#xD;
     }&#xD;
&#xD;
     //&#xD;
     // Pity to have to update such a heavy object as the player,&#xD;
     // but we do this, at most, once per player.  Other players&#xD;
     // only need a partial player update and the stance change.&#xD;
     // Put the stance change after the name change so that the&#xD;
     // other players see the new nation name declaring war.  The&#xD;
     // REF is hardwired to declare war on rebels so there is no&#xD;
     // need to adjust its stance or tension.&#xD;
     cs.addPartial(See.all().except(serverPlayer), serverPlayer,&#xD;
                   &quot;playerType&quot;, &quot;independentNationName&quot;, &quot;newLandName&quot;);&#xD;
     cs.addMessage(See.all().except(serverPlayer),&#xD;
         new ModelMessage(ModelMessage.MessageType.FOREIGN_DIPLOMACY,&#xD;
                          &quot;declareIndependence.announce&quot;,&#xD;
                          serverPlayer)&#xD;
             .addStringTemplate(&quot;%oldNation%&quot;, oldNation)&#xD;
             .addStringTemplate(&quot;%newNation%&quot;, serverPlayer.getNationLabel())&#xD;
             .add(&quot;%ruler%&quot;, serverPlayer.getRulerNameKey()));&#xD;
     cs.add(See.only(serverPlayer), serverPlayer);&#xD;
     serverPlayer.invalidateCanSeeTiles();//+vis(serverPlayer)&#xD;
&#xD;
     getGame().sendToOthers(serverPlayer, cs);&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn9yNlJQEeiyW7NaN4qWdw" name="renameObject" specification="_Qk3a4FJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn9yN1JQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn9yOFJQEeiyW7NaN4qWdw" name="object" type="_QipNUFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn9yOVJQEeiyW7NaN4qWdw" name="newName">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Qn9yOlJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>ChangeSet cs = new ChangeSet();&#xD;
&#xD;
     if (object instanceof Settlement) {&#xD;
         ((Settlement)object).getTile().cacheUnseen();//+til&#xD;
     }&#xD;
     object.setName(newName);//-til?&#xD;
     FreeColGameObject fcgo = (FreeColGameObject)object;&#xD;
     cs.addPartial(See.all(), fcgo, &quot;name&quot;);&#xD;
&#xD;
     // Others may be able to see the name change.&#xD;
     getGame().sendToOthers(serverPlayer, cs);&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn9yO1JQEeiyW7NaN4qWdw" name="getTransaction" specification="_Qk4B8FJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn9yPFJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn9yPVJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn9yPlJQEeiyW7NaN4qWdw" name="settlement" type="_QitewVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn9yP1JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>ChangeSet cs = new ChangeSet();&#xD;
     TradeSession session = TransactionSession.lookup(TradeSession.class,&#xD;
         unit, settlement);&#xD;
     if (session == null) {&#xD;
         if (unit.getMovesLeft() &lt;= 0) {&#xD;
             return DOMMessage.clientError(&quot;Unit &quot; + unit.getId()&#xD;
                 + &quot; has no moves left.&quot;);&#xD;
         }&#xD;
         session = new TradeSession(unit, settlement);&#xD;
         // Sets unit moves to zero to avoid cheating.  If no&#xD;
         // action is taken, the moves will be restored when&#xD;
         // closing the session&#xD;
         unit.setMovesLeft(0);&#xD;
         cs.addPartial(See.only(serverPlayer), unit, &quot;movesLeft&quot;);&#xD;
     }&#xD;
&#xD;
     // Add just the attributes the client needs.&#xD;
     cs.addAttribute(See.only(serverPlayer), &quot;canBuy&quot;,&#xD;
         Boolean.toString(session.getBuy()));&#xD;
     cs.addAttribute(See.only(serverPlayer), &quot;canSell&quot;,&#xD;
         Boolean.toString(session.getSell()));&#xD;
     cs.addAttribute(See.only(serverPlayer), &quot;canGift&quot;,&#xD;
         Boolean.toString(session.getGift()));&#xD;
&#xD;
     // Others can not see transactions.&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn9yQFJQEeiyW7NaN4qWdw" name="closeTransaction" specification="_Qk4B9VJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn9yQVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn9yQlJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn9yQ1JQEeiyW7NaN4qWdw" name="settlement" type="_QitewVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn9yRFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>TradeSession session&#xD;
         = TradeSession.lookup(TradeSession.class, unit, settlement);&#xD;
     if (session == null) {&#xD;
         return DOMMessage.clientError(&quot;No such transaction session.&quot;);&#xD;
     }&#xD;
&#xD;
     ChangeSet cs = new ChangeSet();&#xD;
     // Restore unit movement if no action taken.&#xD;
     if (!session.getActionTaken()) {&#xD;
         unit.setMovesLeft(session.getMovesLeft());&#xD;
         cs.addPartial(See.only(serverPlayer), unit, &quot;movesLeft&quot;);&#xD;
     }&#xD;
     session.complete(cs);&#xD;
&#xD;
     // Others can not see end of transaction.&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn9yRVJQEeiyW7NaN4qWdw" name="getGoodsForSale" specification="_Qk4pAFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn9yRlJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn9yR1JQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn9ySFJQEeiyW7NaN4qWdw" name="settlement" type="_QitewVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn9ySVJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>List&lt;Goods> sellGoods = null;&#xD;
&#xD;
     if (settlement instanceof IndianSettlement) {&#xD;
         IndianSettlement indianSettlement = (IndianSettlement) settlement;&#xD;
         AIPlayer aiPlayer = getFreeColServer()&#xD;
             .getAIPlayer(indianSettlement.getOwner());&#xD;
         sellGoods = indianSettlement.getSellGoods(3, unit);&#xD;
         for (Goods goods : sellGoods) {&#xD;
             aiPlayer.registerSellGoods(goods);&#xD;
         }&#xD;
     } else { // Colony might be supported one day?&#xD;
         return DOMMessage.clientError(&quot;Bogus settlement&quot;);&#xD;
     }&#xD;
     return new GoodsForSaleMessage(unit, settlement, sellGoods)&#xD;
         .toXMLElement();&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn9ySlJQEeiyW7NaN4qWdw" name="buyProposition" specification="_Qk5QEFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn9yS1JQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn9yTFJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn9yTVJQEeiyW7NaN4qWdw" name="settlement" type="_QitewVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn9yTlJQEeiyW7NaN4qWdw" name="goods" type="_Qie1QVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn9yT1JQEeiyW7NaN4qWdw" name="price">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Qn9yUFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>TradeSession session&#xD;
         = TradeSession.lookup(TradeSession.class, unit, settlement);&#xD;
     if (session == null) {&#xD;
         return DOMMessage.clientError(&quot;Proposing to buy without opening a transaction session?!&quot;);&#xD;
     }&#xD;
     if (!session.getBuy()) {&#xD;
         return DOMMessage.clientError(&quot;Proposing to buy in a session where buying is not allowed.&quot;);&#xD;
     }&#xD;
     ChangeSet cs = new ChangeSet();&#xD;
     if (settlement instanceof IndianSettlement) {&#xD;
         csVisit(serverPlayer, (IndianSettlement)settlement, 0, cs);&#xD;
     }&#xD;
&#xD;
     // AI considers the proposition, return with a gold value&#xD;
     AIPlayer ai = getFreeColServer().getAIPlayer(settlement.getOwner());&#xD;
     int gold = ai.buyProposition(unit, settlement, goods, price);&#xD;
&#xD;
     // Others can not see proposals.&#xD;
     cs.addAttribute(See.only(serverPlayer),&#xD;
                     &quot;gold&quot;, Integer.toString(gold));&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn9yUVJQEeiyW7NaN4qWdw" name="sellProposition" specification="_Qk53IFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn9yUlJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn9yU1JQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn9yVFJQEeiyW7NaN4qWdw" name="settlement" type="_QitewVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn9yVVJQEeiyW7NaN4qWdw" name="goods" type="_Qie1QVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn9yVlJQEeiyW7NaN4qWdw" name="price">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Qn9yV1JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>TradeSession session&#xD;
         = TradeSession.lookup(TradeSession.class, unit, settlement);&#xD;
     if (session == null) {&#xD;
         return DOMMessage.clientError(&quot;Proposing to sell without opening a transaction session&quot;);&#xD;
     }&#xD;
     if (!session.getSell()) {&#xD;
         return DOMMessage.clientError(&quot;Proposing to sell in a session where selling is not allowed.&quot;);&#xD;
     }&#xD;
     ChangeSet cs = new ChangeSet();&#xD;
     if (settlement instanceof IndianSettlement) {&#xD;
         csVisit(serverPlayer, (IndianSettlement)settlement, 0, cs);&#xD;
     }&#xD;
&#xD;
     // AI considers the proposition, return with a gold value&#xD;
     AIPlayer ai = getFreeColServer().getAIPlayer(settlement.getOwner());&#xD;
     int gold = ai.sellProposition(unit, settlement, goods, price);&#xD;
&#xD;
     // Others can not see proposals.&#xD;
     cs.addAttribute(See.only(serverPlayer),&#xD;
                     &quot;gold&quot;, Integer.toString(gold));&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn-ZQFJQEeiyW7NaN4qWdw" name="buyGoods" specification="_Qk6eMFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn-ZQVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn-ZQlJQEeiyW7NaN4qWdw" name="type" type="_QigDYVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn-ZQ1JQEeiyW7NaN4qWdw" name="amount">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Qn-ZRFJQEeiyW7NaN4qWdw" name="carrier" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn-ZRVJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>if (!serverPlayer.canTrade(type, Access.EUROPE)) {&#xD;
         return DOMMessage.clientError(&quot;Can not trade boycotted goods&quot;);&#xD;
     }&#xD;
&#xD;
     ChangeSet cs = new ChangeSet();&#xD;
     GoodsContainer container = carrier.getGoodsContainer();&#xD;
     container.saveState();&#xD;
     int gold = serverPlayer.getGold();&#xD;
     int buyAmount = serverPlayer.buy(container, type, amount);&#xD;
     if (buyAmount &lt; 0) {&#xD;
         return DOMMessage.clientError(&quot;Player &quot; + serverPlayer.getName()&#xD;
             + &quot; tried to buy &quot; + amount + &quot; &quot; + type.getSuffix());&#xD;
     }&#xD;
     serverPlayer.propagateToEuropeanMarkets(type, -buyAmount, random);&#xD;
     serverPlayer.csFlushMarket(type, cs);&#xD;
     carrier.setMovesLeft(0);&#xD;
     cs.addPartial(See.only(serverPlayer), serverPlayer, &quot;gold&quot;);&#xD;
     cs.add(See.only(serverPlayer), carrier);&#xD;
     logger.finest(carrier + &quot; bought &quot; + amount + &quot;(&quot; + buyAmount + &quot;)&quot;&#xD;
         + &quot; &quot; + type.getSuffix()&#xD;
         + &quot; in Europe for &quot; + (serverPlayer.getGold() - gold));&#xD;
     // Action occurs in Europe, nothing is visible to other players.&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn-ZRlJQEeiyW7NaN4qWdw" name="sellGoods" specification="_Qk6eNlJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn-ZR1JQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn-ZSFJQEeiyW7NaN4qWdw" name="type" type="_QigDYVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn-ZSVJQEeiyW7NaN4qWdw" name="amount">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Qn-ZSlJQEeiyW7NaN4qWdw" name="carrier" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn-ZS1JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>ChangeSet cs = new ChangeSet();&#xD;
     GoodsContainer container = carrier.getGoodsContainer();&#xD;
     container.saveState();&#xD;
     if (serverPlayer.canTrade(type, Access.EUROPE)) {&#xD;
         int gold = serverPlayer.getGold();&#xD;
         int sellAmount = serverPlayer.sell(container, type, amount);&#xD;
         if (sellAmount &lt; 0) {&#xD;
             return DOMMessage.clientError(&quot;Player &quot; + serverPlayer.getName()&#xD;
                 + &quot; tried to sell &quot; + amount + &quot; &quot; + type.getSuffix());&#xD;
         }&#xD;
         serverPlayer.propagateToEuropeanMarkets(type, sellAmount, random);&#xD;
         serverPlayer.csFlushMarket(type, cs);&#xD;
         cs.addPartial(See.only(serverPlayer), serverPlayer, &quot;gold&quot;);&#xD;
         logger.finest(carrier + &quot; sold &quot; + amount + &quot;(&quot; + sellAmount + &quot;)&quot;&#xD;
             + &quot; &quot; + type.getSuffix()&#xD;
             + &quot; in Europe for &quot; + (serverPlayer.getGold() - gold));&#xD;
     } else {&#xD;
         // Dumping goods in Europe&#xD;
         moveGoods(carrier, type, amount, null);&#xD;
         logger.finest(carrier + &quot; dumped &quot; + amount&#xD;
             + &quot; &quot; + type.getSuffix() + &quot; in Europe&quot;);&#xD;
     }&#xD;
     carrier.setMovesLeft(0);&#xD;
     cs.add(See.only(serverPlayer), carrier);&#xD;
     // Action occurs in Europe, nothing is visible to other players.&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn-ZTFJQEeiyW7NaN4qWdw" name="emigrate" specification="_Qk7FRFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn-ZTVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn-ZTlJQEeiyW7NaN4qWdw" name="slot">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Qn-ZT1JQEeiyW7NaN4qWdw" name="type" type="_QicZAVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn-ZUFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>ChangeSet cs = new ChangeSet();&#xD;
     serverPlayer.csEmigrate(slot, type, random, cs);&#xD;
&#xD;
     // Do not update others, emigration is private.&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn-ZUVJQEeiyW7NaN4qWdw" name="move" specification="_Qk7sUFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn-ZUlJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn-ZU1JQEeiyW7NaN4qWdw" name="unit" type="_Qi9WYVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn-ZVFJQEeiyW7NaN4qWdw" name="newTile" type="_QivT8VJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn-ZVVJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>ChangeSet cs = new ChangeSet();&#xD;
     unit.csMove(newTile, random, cs);&#xD;
     getGame().sendToOthers(serverPlayer, cs);&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn-ZVlJQEeiyW7NaN4qWdw" name="declineMounds" specification="_Qk7sVVJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn-ZV1JQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn-ZWFJQEeiyW7NaN4qWdw" name="tile" type="_QivT8VJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn-ZWVJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>tile.cacheUnseen();//+til&#xD;
     tile.removeLostCityRumour();//-til&#xD;
&#xD;
     // Others might see rumour disappear&#xD;
     ChangeSet cs = new ChangeSet();&#xD;
     cs.add(See.perhaps(), tile);&#xD;
     getGame().sendToOthers(serverPlayer, cs);&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn_AUFJQEeiyW7NaN4qWdw" name="setNewLandName" specification="_Qk8TYFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn_AUVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn_AUlJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn_AU1JQEeiyW7NaN4qWdw" name="name">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Qn_AVFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>ChangeSet cs = new ChangeSet();&#xD;
&#xD;
     // Special case of a welcome from an adjacent native unit,&#xD;
     // offering the land the landing unit is on if a peace treaty&#xD;
     // is accepted.&#xD;
     serverPlayer.setNewLandName(name);&#xD;
&#xD;
     // Update the name and note the history.&#xD;
     cs.addPartial(See.only(serverPlayer), serverPlayer, &quot;newLandName&quot;);&#xD;
     Turn turn = serverPlayer.getGame().getTurn();&#xD;
     HistoryEvent h = new HistoryEvent(turn,&#xD;
         HistoryEvent.HistoryEventType.DISCOVER_NEW_WORLD, serverPlayer)&#xD;
             .addName(&quot;%name%&quot;, name);&#xD;
     cs.addHistory(serverPlayer, h);&#xD;
&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn_AVVJQEeiyW7NaN4qWdw" name="setNewRegionName" specification="_Qk8TZVJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn_AVlJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn_AV1JQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn_AWFJQEeiyW7NaN4qWdw" name="region" type="_Qis3sVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn_AWVJQEeiyW7NaN4qWdw" name="name">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Qn_AWlJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final Game game = getGame();&#xD;
     ServerRegion serverRegion = (ServerRegion)region;&#xD;
     // Discoverer is set when unit moves in.&#xD;
     if (!Utils.equals(region.getDiscoverer(), unit.getId())) {&#xD;
         return DOMMessage.clientError(&quot;Discoverer mismatch, &quot;&#xD;
             + region.getDiscoverer() + &quot; expected, &quot;&#xD;
             + unit.getId() + &quot; provided.&quot;);&#xD;
     }&#xD;
     ChangeSet cs = new ChangeSet();&#xD;
     serverRegion.csDiscover(serverPlayer, game.getTurn(), name, cs);&#xD;
&#xD;
     // Others do find out about region name changes.&#xD;
     getGame().sendToOthers(serverPlayer, cs);&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn_AW1JQEeiyW7NaN4qWdw" name="moveTo" specification="_Qk86dVJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn_AXFJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn_AXVJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn_AXlJQEeiyW7NaN4qWdw" name="destination" type="_QikU0FJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn_AX1JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>ChangeSet cs = new ChangeSet();&#xD;
     HighSeas highSeas = serverPlayer.getHighSeas();&#xD;
     Location current = unit.getDestination();&#xD;
     boolean others = false; // Notify others?&#xD;
     boolean invalid = false; // Not a highSeas move?&#xD;
&#xD;
     if (!unit.getType().canMoveToHighSeas()) {&#xD;
         invalid = true;&#xD;
     } else if (destination instanceof Europe) {&#xD;
         if (!highSeas.getDestinations().contains(destination)) {&#xD;
             return DOMMessage.clientError(&quot;HighSeas does not connect to: &quot;&#xD;
                 + destination.getId());&#xD;
         } else if (unit.getLocation() == highSeas) {&#xD;
             if (!(current instanceof Europe)) {&#xD;
                 // Changed direction&#xD;
                 unit.setWorkLeft(unit.getSailTurns()&#xD;
                     - unit.getWorkLeft() + 1);&#xD;
             }&#xD;
             unit.setDestination(destination);&#xD;
             cs.add(See.only(serverPlayer), unit, highSeas);&#xD;
         } else if (unit.hasTile()) {&#xD;
             Tile tile = unit.getTile();&#xD;
             unit.setEntryLocation(tile);&#xD;
             unit.setWorkLeft(unit.getSailTurns());&#xD;
             unit.setDestination(destination);&#xD;
             unit.setMovesLeft(0);&#xD;
             unit.setLocation(highSeas);//-vis(serverPlayer)&#xD;
             serverPlayer.invalidateCanSeeTiles();//+vis(serverPlayer)&#xD;
             cs.addDisappear(serverPlayer, tile, unit);&#xD;
             cs.add(See.only(serverPlayer), tile, highSeas);&#xD;
             others = true;&#xD;
         } else {&#xD;
             invalid = true;&#xD;
         }&#xD;
     } else if (destination instanceof Map) {&#xD;
         if (!highSeas.getDestinations().contains(destination)) {&#xD;
             return DOMMessage.clientError(&quot;HighSeas does not connect to: &quot;&#xD;
                 + destination.getId());&#xD;
         } else if (unit.getLocation() == highSeas) {&#xD;
             if (current != destination &amp;&amp; (current == null&#xD;
                     || current.getTile() == null&#xD;
                     || current.getTile().getMap() != destination)) {&#xD;
                 // Changed direction&#xD;
                 unit.setWorkLeft(unit.getSailTurns()&#xD;
                     - unit.getWorkLeft() + 1);&#xD;
             }&#xD;
             unit.setDestination(destination);&#xD;
             cs.add(See.only(serverPlayer), highSeas);&#xD;
         } else if (unit.getLocation() instanceof Europe) {&#xD;
             Europe europe = (Europe) unit.getLocation();&#xD;
             unit.setWorkLeft(unit.getSailTurns());&#xD;
             unit.setDestination(destination);&#xD;
             unit.setMovesLeft(0);&#xD;
             unit.setLocation(highSeas);//-vis: safe!map&#xD;
             cs.add(See.only(serverPlayer), europe, highSeas);&#xD;
         } else {&#xD;
             invalid = true;&#xD;
         }&#xD;
     } else if (destination instanceof Settlement) {&#xD;
         Tile tile = destination.getTile();&#xD;
         if (!highSeas.getDestinations().contains(tile.getMap())) {&#xD;
             return DOMMessage.clientError(&quot;HighSeas does not connect to: &quot;&#xD;
                 + destination.getId());&#xD;
         } else if (unit.getLocation() == highSeas) {&#xD;
             // Direction is somewhat moot, so just reset.&#xD;
             unit.setWorkLeft(unit.getSailTurns());&#xD;
             unit.setDestination(destination);&#xD;
             cs.add(See.only(serverPlayer), highSeas);&#xD;
         } else if (unit.getLocation() instanceof Europe) {&#xD;
             Europe europe = (Europe) unit.getLocation();&#xD;
             unit.setWorkLeft(unit.getSailTurns());&#xD;
             unit.setDestination(destination);&#xD;
             unit.setMovesLeft(0);&#xD;
             unit.setLocation(highSeas);//-vis: safe!map&#xD;
             cs.add(See.only(serverPlayer), europe, highSeas);&#xD;
         } else {&#xD;
             invalid = true;&#xD;
         }&#xD;
     } else {&#xD;
         return DOMMessage.clientError(&quot;Bogus moveTo destination: &quot;&#xD;
             + destination.getId());&#xD;
     }&#xD;
     if (invalid) {&#xD;
         return DOMMessage.clientError(&quot;Invalid moveTo: unit=&quot; + unit.getId()&#xD;
             + &quot; from=&quot; + unit.getLocation().getId()&#xD;
             + &quot; to=&quot; + destination.getId());&#xD;
     }&#xD;
&#xD;
     if (others) getGame().sendToOthers(serverPlayer, cs);&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn_AYFJQEeiyW7NaN4qWdw" name="embarkUnit" specification="_Qk9hgVJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn_AYVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn_AYlJQEeiyW7NaN4qWdw" name="serverUnit" type="_Qi9WYVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn_AY1JQEeiyW7NaN4qWdw" name="carrier" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn_AZFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>if (serverUnit.isNaval()) {&#xD;
         return DOMMessage.clientError(&quot;Naval unit &quot; + serverUnit.getId()&#xD;
             + &quot; can not embark.&quot;);&#xD;
     }&#xD;
     UnitLocation.NoAddReason reason = carrier.getNoAddReason(serverUnit);&#xD;
     if (reason != UnitLocation.NoAddReason.NONE) {&#xD;
         return DOMMessage.clientError(&quot;Carrier: &quot; + carrier.getId()&#xD;
             + &quot; can not carry &quot; + serverUnit.getId() + &quot;: &quot; + reason);&#xD;
     }&#xD;
&#xD;
     ChangeSet cs = new ChangeSet();&#xD;
     serverUnit.csEmbark(carrier, cs);&#xD;
&#xD;
     // Others might see the unit disappear, or the carrier capacity.&#xD;
     getGame().sendToOthers(serverPlayer, cs);&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn_nYFJQEeiyW7NaN4qWdw" name="disembarkUnit" specification="_Qk-IkFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qn_nYVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn_nYlJQEeiyW7NaN4qWdw" name="serverUnit" type="_Qi9WYVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qn_nY1JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>if (serverUnit.isNaval()) {&#xD;
         return DOMMessage.clientError(&quot;Naval unit &quot; + serverUnit.getId()&#xD;
             + &quot; can not disembark.&quot;);&#xD;
     }&#xD;
     Unit carrier = serverUnit.getCarrier();&#xD;
     if (carrier == null) {&#xD;
         return DOMMessage.clientError(&quot;Unit &quot; + serverUnit.getId()&#xD;
             + &quot; is not embarked.&quot;);&#xD;
     }&#xD;
&#xD;
     ChangeSet cs = new ChangeSet();&#xD;
&#xD;
     Location newLocation = carrier.getLocation();&#xD;
     List&lt;Tile> newTiles = (newLocation.getTile() == null) ? null&#xD;
         : serverUnit.collectNewTiles(newLocation.getTile());&#xD;
     serverUnit.setLocation(newLocation);//-vis(serverPlayer)&#xD;
     serverPlayer.invalidateCanSeeTiles();//+vis(serverPlayer)&#xD;
     serverUnit.setMovesLeft(0); // In Col1 disembark consumes whole move.&#xD;
     cs.add(See.perhaps(), (FreeColGameObject)newLocation);&#xD;
     if (newTiles != null) {&#xD;
         serverPlayer.csSeeNewTiles(newTiles, cs);&#xD;
     }&#xD;
&#xD;
     // Others can (potentially) see the location.&#xD;
     getGame().sendToOthers(serverPlayer, cs);&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoAOcFJQEeiyW7NaN4qWdw" name="combat" specification="_Qk-IlFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoAOcVJQEeiyW7NaN4qWdw" name="attackerPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoAOclJQEeiyW7NaN4qWdw" name="attacker" type="_QidnIlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoAOc1JQEeiyW7NaN4qWdw" name="defender" type="_QidnIlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoAOdFJQEeiyW7NaN4qWdw" name="crs" type="_QhldYVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoAOdVJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>ChangeSet cs = new ChangeSet();&#xD;
     try {&#xD;
         attackerPlayer.csCombat(attacker, defender, crs, random, cs);&#xD;
     } catch (IllegalStateException e) {&#xD;
         logger.log(Level.WARNING, &quot;Combat FAIL&quot;, e);&#xD;
         return DOMMessage.clientError(e.getMessage());&#xD;
     }&#xD;
     getGame().sendToOthers(attackerPlayer, cs);&#xD;
     return cs.build(attackerPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoAOdlJQEeiyW7NaN4qWdw" name="askLearnSkill" specification="_Qk_WsFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoAOd1JQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoAOeFJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoAOeVJQEeiyW7NaN4qWdw" name="settlement" type="_QiifoFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoAOelJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>ChangeSet cs = new ChangeSet();&#xD;
&#xD;
     csVisit(serverPlayer, settlement, 0, cs);&#xD;
     Tile tile = settlement.getTile();&#xD;
     tile.updateIndianSettlement(serverPlayer);&#xD;
     cs.add(See.only(serverPlayer), tile);&#xD;
     unit.setMovesLeft(0);&#xD;
     cs.addPartial(See.only(serverPlayer), unit, &quot;movesLeft&quot;);&#xD;
&#xD;
     // Do not update others, nothing to see yet.&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoAOe1JQEeiyW7NaN4qWdw" name="learnFromIndianSettlement" specification="_Qk_9wFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoAOfFJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoAOfVJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoAOflJQEeiyW7NaN4qWdw" name="settlement" type="_QiifoFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoAOf1JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>// Sanity checks.&#xD;
     UnitType skill = settlement.getLearnableSkill();&#xD;
     if (skill == null) {&#xD;
         return DOMMessage.clientError(&quot;No skill to learn at &quot;&#xD;
             + settlement.getName());&#xD;
     }&#xD;
     if (!unit.getType().canBeUpgraded(skill, ChangeType.NATIVES)) {&#xD;
         return DOMMessage.clientError(&quot;Unit &quot; + unit&#xD;
             + &quot; can not learn skill &quot; + skill&#xD;
             + &quot; at &quot; + settlement.getName());&#xD;
     }&#xD;
&#xD;
     // Try to learn&#xD;
     final Specification spec = getGame().getSpecification();&#xD;
     ChangeSet cs = new ChangeSet();&#xD;
     unit.setMovesLeft(0);&#xD;
     csVisit(serverPlayer, settlement, 0, cs);&#xD;
     switch (settlement.getAlarm(serverPlayer).getLevel()) {&#xD;
     case HATEFUL: // Killed, might be visible to other players.&#xD;
         cs.add(See.perhaps().always(serverPlayer),&#xD;
                (FreeColGameObject)unit.getLocation());&#xD;
         cs.addRemove(See.perhaps().always(serverPlayer),&#xD;
                      unit.getLocation(), unit);//-vis(serverPlayer)&#xD;
         unit.dispose();&#xD;
         serverPlayer.invalidateCanSeeTiles();//+vis(serverPlayer)&#xD;
         break;&#xD;
     case ANGRY: // Learn nothing, not even a pet update&#xD;
         cs.addPartial(See.only(serverPlayer), unit, &quot;movesLeft&quot;);&#xD;
         break;&#xD;
     default:&#xD;
         // Teach the unit, and expend the skill if necessary.&#xD;
         // Do a full information update as the unit is in the settlement.&#xD;
         unit.changeType(skill);//-vis(serverPlayer)&#xD;
         serverPlayer.invalidateCanSeeTiles();//+vis(serverPlayer)&#xD;
         cs.add(See.perhaps(), unit);&#xD;
         if (!settlement.isCapital()&#xD;
             &amp;&amp; !(settlement.hasMissionary(serverPlayer)&#xD;
                 &amp;&amp; spec.getBoolean(GameOptions.ENHANCED_MISSIONARIES))) {&#xD;
             settlement.setLearnableSkill(null);&#xD;
         }&#xD;
         break;&#xD;
     }&#xD;
     Tile tile = settlement.getTile();&#xD;
     tile.updateIndianSettlement(serverPlayer);&#xD;
     cs.add(See.only(serverPlayer), tile);&#xD;
&#xD;
     // Others always see the unit, it may have died or been taught.&#xD;
     getGame().sendToOthers(serverPlayer, cs);&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoAOgFJQEeiyW7NaN4qWdw" name="demandTribute" specification="_QlAk0FJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoAOgVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoAOglJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoAOg1JQEeiyW7NaN4qWdw" name="settlement" type="_Qi8IQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoAOhFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>ChangeSet cs = new ChangeSet();&#xD;
     final int TURNS_PER_TRIBUTE = 5;&#xD;
&#xD;
     csVisit(serverPlayer, settlement, 0, cs);&#xD;
&#xD;
     Player indianPlayer = settlement.getOwner();&#xD;
     int gold = 0;&#xD;
     int year = getGame().getTurn().getNumber();&#xD;
     RandomRange gifts = settlement.getType().getGifts(unit);&#xD;
     if (settlement.getLastTribute() + TURNS_PER_TRIBUTE &lt; year&#xD;
         &amp;&amp; gifts != null) {&#xD;
         switch (indianPlayer.getTension(serverPlayer).getLevel()) {&#xD;
         case HAPPY: case CONTENT:&#xD;
             gold = Math.min(gifts.getAmount(&quot;Tribute&quot;, random, true) / 10,&#xD;
                             100);&#xD;
             break;&#xD;
         case DISPLEASED:&#xD;
             gold = Math.min(gifts.getAmount(&quot;Tribute&quot;, random, true) / 20,&#xD;
                             100);&#xD;
             break;&#xD;
         case ANGRY: case HATEFUL:&#xD;
         default:&#xD;
             gold = 0; // No tribute for you.&#xD;
             break;&#xD;
         }&#xD;
     }&#xD;
&#xD;
     // Increase tension whether we paid or not.  Apply tension&#xD;
     // directly to the settlement and let propagation work.&#xD;
     settlement.csModifyAlarm(serverPlayer, Tension.TENSION_ADD_NORMAL,&#xD;
                              true, cs);&#xD;
     settlement.setLastTribute(year);&#xD;
     ModelMessage m;&#xD;
     if (gold > 0) {&#xD;
         indianPlayer.modifyGold(-gold);&#xD;
         serverPlayer.modifyGold(gold);&#xD;
         cs.addPartial(See.only(serverPlayer), serverPlayer, &quot;gold&quot;, &quot;score&quot;);&#xD;
         m = new ModelMessage(ModelMessage.MessageType.FOREIGN_DIPLOMACY,&#xD;
                              &quot;scoutSettlement.tributeAgree&quot;,&#xD;
                              unit, settlement)&#xD;
             .addAmount(&quot;%amount%&quot;, gold);&#xD;
     } else {&#xD;
         m = new ModelMessage(ModelMessage.MessageType.FOREIGN_DIPLOMACY,&#xD;
                              &quot;scoutSettlement.tributeDisagree&quot;,&#xD;
                              unit, settlement);&#xD;
     }&#xD;
     cs.addMessage(See.only(serverPlayer), m);&#xD;
     Tile tile = settlement.getTile();&#xD;
     tile.updateIndianSettlement(serverPlayer);&#xD;
     cs.add(See.only(serverPlayer), tile);&#xD;
     unit.setMovesLeft(0);&#xD;
     cs.addPartial(See.only(serverPlayer), unit, &quot;movesLeft&quot;);&#xD;
&#xD;
     // Do not update others, this is all private.&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoAOhVJQEeiyW7NaN4qWdw" name="scoutIndianSettlement" specification="_QlBL4FJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoAOhlJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoAOh1JQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoAOiFJQEeiyW7NaN4qWdw" name="settlement" type="_QiifoFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoAOiVJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>ChangeSet cs = new ChangeSet();&#xD;
     Tile tile = settlement.getTile();&#xD;
&#xD;
     csVisit(serverPlayer, settlement, -1, cs);&#xD;
     tile.updateIndianSettlement(serverPlayer);&#xD;
     cs.add(See.only(serverPlayer), tile);&#xD;
     cs.addAttribute(See.only(serverPlayer), &quot;settlements&quot;,&#xD;
         Integer.toString(settlement.getOwner().getSettlements().size()));&#xD;
&#xD;
     // This is private.&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoAOilJQEeiyW7NaN4qWdw" name="scoutSpeakToChief" specification="_QlBy81JQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoAOi1JQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoAOjFJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoAOjVJQEeiyW7NaN4qWdw" name="settlement" type="_QiifoFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoAOjlJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>ChangeSet cs = new ChangeSet();&#xD;
     Tile tile = settlement.getTile();&#xD;
     boolean tileDirty = settlement.setVisited(serverPlayer);&#xD;
     String result;&#xD;
&#xD;
     // Hateful natives kill the scout right away.&#xD;
     Tension tension = settlement.getAlarm(serverPlayer);&#xD;
     if (tension.getLevel() == Tension.Level.HATEFUL) {&#xD;
         cs.add(See.perhaps().always(serverPlayer),&#xD;
                (FreeColGameObject)unit.getLocation());&#xD;
         cs.addRemove(See.perhaps().always(serverPlayer),&#xD;
                      unit.getLocation(), unit);//-vis(serverPlayer)&#xD;
         unit.dispose();&#xD;
         serverPlayer.invalidateCanSeeTiles();//+vis(serverPlayer)&#xD;
         result = &quot;die&quot;;&#xD;
     } else {&#xD;
         // Otherwise player gets to visit, and learn about the settlement.&#xD;
         List&lt;UnitType> scoutTypes = getGame().getSpecification()&#xD;
             .getUnitTypesWithAbility(Ability.EXPERT_SCOUT);&#xD;
         UnitType scoutSkill = (scoutTypes.isEmpty()) ? null&#xD;
             : scoutTypes.get(0);&#xD;
         int radius = unit.getLineOfSight();&#xD;
         UnitType skill = settlement.getLearnableSkill();&#xD;
         int rnd = randomInt(logger, &quot;scouting&quot;, random, 10);&#xD;
         if (settlement.hasAnyScouted()) {&#xD;
             // Do nothing if already spoken to.&#xD;
             result = &quot;nothing&quot;;&#xD;
         } else if (scoutSkill != null &amp;&amp; unit.getType() != scoutSkill&#xD;
             &amp;&amp; ((skill != null &amp;&amp; skill.hasAbility(Ability.EXPERT_SCOUT))&#xD;
                 || rnd == 0)) {&#xD;
             // If the scout can be taught to be an expert it will be.&#xD;
             unit.changeType(scoutSkill);//-vis(serverPlayer)&#xD;
             serverPlayer.invalidateCanSeeTiles();//+vis(serverPlayer)&#xD;
             result = &quot;expert&quot;;&#xD;
         } else {&#xD;
             // Choose tales 1/3 of the time, or if there are no beads.&#xD;
             RandomRange gifts = settlement.getType().getGifts(unit);&#xD;
             int gold = (gifts == null) ? 0&#xD;
                 : gifts.getAmount(&quot;Base beads amount&quot;, random, true);&#xD;
             if (gold &lt;= 0 || rnd &lt;= 3) {&#xD;
                 radius = Math.max(radius, IndianSettlement.TALES_RADIUS);&#xD;
                 result = &quot;tales&quot;;&#xD;
             } else {&#xD;
                 if (unit.hasAbility(Ability.EXPERT_SCOUT)) {&#xD;
                     gold = (gold * 11) / 10; // FIXME: magic number&#xD;
                 }&#xD;
                 serverPlayer.modifyGold(gold);&#xD;
                 settlement.getOwner().modifyGold(-gold);&#xD;
                 result = &quot;beads&quot;;&#xD;
             }&#xD;
         }&#xD;
&#xD;
         // Have now spoken to the chief.&#xD;
         csVisit(serverPlayer, settlement, 1, cs);&#xD;
         tileDirty = true;&#xD;
&#xD;
         // Update settlement tile with new information, and any&#xD;
         // newly visible tiles, possibly with enhanced radius.&#xD;
         Set&lt;Tile> tiles = new HashSet&lt;>();&#xD;
         for (Tile t : tile.getSurroundingTiles(1, radius)) {&#xD;
             if (!serverPlayer.canSee(t) &amp;&amp; (t.isLand() || t.isShore())) {&#xD;
                 tiles.add(t);&#xD;
             }&#xD;
         }&#xD;
         cs.add(See.only(serverPlayer), serverPlayer.exploreTiles(tiles));&#xD;
&#xD;
         // If the unit was promoted, update it completely, otherwise just&#xD;
         // update moves and possibly gold+score.&#xD;
         unit.setMovesLeft(0);&#xD;
         if (&quot;expert&quot;.equals(result)) {&#xD;
             cs.add(See.perhaps(), unit);&#xD;
         } else {&#xD;
             cs.addPartial(See.only(serverPlayer), unit, &quot;movesLeft&quot;);&#xD;
             if (&quot;beads&quot;.equals(result)) {&#xD;
                 cs.addPartial(See.only(serverPlayer), serverPlayer,&#xD;
                               &quot;gold&quot;, &quot;score&quot;);&#xD;
             }&#xD;
         }&#xD;
     }&#xD;
     if (tileDirty) {&#xD;
         tile.updateIndianSettlement(serverPlayer);&#xD;
         cs.add(See.only(serverPlayer), tile);&#xD;
     }&#xD;
&#xD;
     // Always add result.&#xD;
     cs.addAttribute(See.only(serverPlayer), &quot;result&quot;, result);&#xD;
&#xD;
     // Other players may be able to see unit disappearing, or&#xD;
     // learning.&#xD;
     getGame().sendToOthers(serverPlayer, cs);&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoAOj1JQEeiyW7NaN4qWdw" name="denounceMission" specification="_QlCaAFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoAOkFJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoAOkVJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoAOklJQEeiyW7NaN4qWdw" name="settlement" type="_Qi8IQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoAOk1JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>ChangeSet cs = new ChangeSet();&#xD;
     csVisit(serverPlayer, settlement, 0, cs);&#xD;
&#xD;
     // Determine result&#xD;
     Unit missionary = settlement.getMissionary();&#xD;
     if (missionary == null) {&#xD;
         return DOMMessage.clientError(&quot;Denouncing null missionary&quot;);&#xD;
     }&#xD;
     ServerPlayer enemy = (ServerPlayer) missionary.getOwner();&#xD;
     double denounce = randomDouble(logger, &quot;Denounce base&quot;, random)&#xD;
         * enemy.getImmigration() / (serverPlayer.getImmigration() + 1);&#xD;
     if (missionary.hasAbility(Ability.EXPERT_MISSIONARY)) {&#xD;
         denounce += 0.2;&#xD;
     }&#xD;
     if (unit.hasAbility(Ability.EXPERT_MISSIONARY)) {&#xD;
         denounce -= 0.2;&#xD;
     }&#xD;
&#xD;
     if (denounce &lt; 0.5) { // Success, remove old mission and establish ours&#xD;
         return establishMission(serverPlayer, unit, settlement);&#xD;
     }&#xD;
&#xD;
     // Denounce failed&#xD;
     Player owner = settlement.getOwner();&#xD;
     cs.add(See.only(serverPlayer), settlement);&#xD;
     cs.addMessage(See.only(serverPlayer),&#xD;
         new ModelMessage(ModelMessage.MessageType.FOREIGN_DIPLOMACY,&#xD;
                          &quot;indianSettlement.mission.noDenounce&quot;,&#xD;
                          serverPlayer, unit)&#xD;
             .addStringTemplate(&quot;%nation%&quot;, owner.getNationLabel()));&#xD;
     cs.addMessage(See.only(enemy),&#xD;
         new ModelMessage(ModelMessage.MessageType.FOREIGN_DIPLOMACY,&#xD;
                          &quot;indianSettlement.mission.enemyDenounce&quot;,&#xD;
                          enemy, settlement)&#xD;
             .addStringTemplate(&quot;%enemy%&quot;, serverPlayer.getNationLabel())&#xD;
             .addStringTemplate(&quot;%settlement%&quot;,&#xD;
                 settlement.getLocationLabelFor(enemy))&#xD;
             .addStringTemplate(&quot;%nation%&quot;, owner.getNationLabel()));&#xD;
     cs.add(See.perhaps().always(serverPlayer),&#xD;
            (FreeColGameObject)unit.getLocation());&#xD;
     cs.addRemove(See.perhaps().always(serverPlayer),&#xD;
                  unit.getLocation(), unit);//-vis(serverPlayer)&#xD;
     unit.dispose();&#xD;
     serverPlayer.invalidateCanSeeTiles();//+vis(serverPlayer)&#xD;
&#xD;
     // Others can see missionary disappear&#xD;
     getGame().sendToOthers(serverPlayer, cs);&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoAOlFJQEeiyW7NaN4qWdw" name="establishMission" specification="_QlDBEFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoAOlVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoAOllJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoAOl1JQEeiyW7NaN4qWdw" name="settlement" type="_Qi8IQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoAOmFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>ChangeSet cs = new ChangeSet();&#xD;
     csVisit(serverPlayer, settlement, 0, cs);&#xD;
&#xD;
     // Result depends on tension wrt this settlement.&#xD;
     // Establish if at least not angry.&#xD;
     final Tension tension = settlement.getAlarm(serverPlayer);&#xD;
     switch (tension.getLevel()) {&#xD;
     case HATEFUL: case ANGRY:&#xD;
         cs.add(See.perhaps().always(serverPlayer),&#xD;
                (FreeColGameObject)unit.getLocation());&#xD;
         cs.addRemove(See.perhaps().always(serverPlayer),&#xD;
                      unit.getLocation(), unit);//-vis(serverPlayer)&#xD;
         unit.dispose();&#xD;
         serverPlayer.invalidateCanSeeTiles();//+vis(serverPlayer)&#xD;
         break;&#xD;
&#xD;
     case HAPPY: case CONTENT: case DISPLEASED:&#xD;
         if (settlement.hasMissionary()) {&#xD;
             settlement.csKillMissionary(false, cs);&#xD;
         }&#xD;
         // Always show the tile the unit was on&#xD;
         cs.add(See.perhaps().always(serverPlayer), unit.getTile());&#xD;
         &#xD;
         settlement.csChangeMissionary(unit, cs);//+vis(serverPlayer)&#xD;
         break;&#xD;
     }&#xD;
&#xD;
     // Add the descriptive message.&#xD;
     final StringTemplate nation = settlement.getOwner().getNationLabel();&#xD;
     cs.addMessage(See.only(serverPlayer),&#xD;
         new ModelMessage(ModelMessage.MessageType.FOREIGN_DIPLOMACY,&#xD;
                          &quot;indianSettlement.mission.&quot; + tension.getKey(),&#xD;
                          serverPlayer, unit)&#xD;
             .addStringTemplate(&quot;%nation%&quot;, nation));&#xD;
&#xD;
     // Others can see missionary disappear and settlement acquire&#xD;
     // mission.&#xD;
     getGame().sendToOthers(serverPlayer, cs);&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoAOmVJQEeiyW7NaN4qWdw" name="incite" specification="_QlDoIFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoAOmlJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoAOm1JQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoAOnFJQEeiyW7NaN4qWdw" name="settlement" type="_QiifoFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoAOnVJQEeiyW7NaN4qWdw" name="enemy" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoAOnlJQEeiyW7NaN4qWdw" name="gold">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QoAOn1JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>ChangeSet cs = new ChangeSet();&#xD;
&#xD;
     Tile tile = settlement.getTile();&#xD;
     csVisit(serverPlayer, settlement, 0, cs);&#xD;
     tile.updateIndianSettlement(serverPlayer);&#xD;
     cs.add(See.only(serverPlayer), tile);&#xD;
&#xD;
     // How much gold will be needed?&#xD;
     ServerPlayer enemyPlayer = enemy;&#xD;
     ServerPlayer nativePlayer = (ServerPlayer)settlement.getOwner();&#xD;
     int payingValue = nativePlayer.getTension(serverPlayer).getValue();&#xD;
     int targetValue = nativePlayer.getTension(enemyPlayer).getValue();&#xD;
     int goldToPay = (payingValue > targetValue) ? 10000 : 5000;&#xD;
     goldToPay += 20 * (payingValue - targetValue);&#xD;
     goldToPay = Math.max(goldToPay, 650);&#xD;
&#xD;
     // Try to incite?&#xD;
     if (gold &lt; 0) { // Initial enquiry.&#xD;
         cs.addAttribute(See.only(serverPlayer),&#xD;
                         &quot;gold&quot;, Integer.toString(goldToPay));&#xD;
     } else if (gold &lt; goldToPay || !serverPlayer.checkGold(gold)) {&#xD;
         cs.addMessage(See.only(serverPlayer),&#xD;
             new ModelMessage(ModelMessage.MessageType.FOREIGN_DIPLOMACY,&#xD;
                              &quot;indianSettlement.inciteGoldFail&quot;,&#xD;
                              serverPlayer, settlement)&#xD;
                 .addStringTemplate(&quot;%player%&quot;, enemyPlayer.getNationLabel())&#xD;
                 .addAmount(&quot;%amount%&quot;, goldToPay));&#xD;
         cs.addAttribute(See.only(serverPlayer), &quot;gold&quot;, &quot;0&quot;);&#xD;
         unit.setMovesLeft(0);&#xD;
         cs.addPartial(See.only(serverPlayer), unit, &quot;movesLeft&quot;);&#xD;
     } else {&#xD;
         // Success.  Raise the tension for the native player with respect&#xD;
         // to the European player.  Let resulting stance changes happen&#xD;
         // naturally in the AI player turn/s.&#xD;
         nativePlayer.csModifyTension(enemyPlayer,&#xD;
             Tension.WAR_MODIFIER, cs);//+til&#xD;
         enemyPlayer.csModifyTension(serverPlayer,&#xD;
             Tension.TENSION_ADD_WAR_INCITER, cs);//+til&#xD;
         cs.addAttribute(See.only(serverPlayer),&#xD;
                         &quot;gold&quot;, Integer.toString(gold));&#xD;
         serverPlayer.modifyGold(-gold);&#xD;
         nativePlayer.modifyGold(gold);&#xD;
         cs.addPartial(See.only(serverPlayer), serverPlayer, &quot;gold&quot;);&#xD;
         unit.setMovesLeft(0);&#xD;
         cs.addPartial(See.only(serverPlayer), unit, &quot;movesLeft&quot;);&#xD;
     }&#xD;
&#xD;
     // Others might include enemy.&#xD;
     getGame().sendToOthers(serverPlayer, cs);&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoAOoFJQEeiyW7NaN4qWdw" name="setDestination" specification="_QlEPMFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoAOoVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoAOolJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoAOo1JQEeiyW7NaN4qWdw" name="destination" type="_QikU0FJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoAOpFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>if (unit.getTradeRoute() != null) {&#xD;
         // Override destination to bring the unit to port.&#xD;
         if (destination == null &amp;&amp; unit.isAtSea()) {&#xD;
             destination = unit.getStop().getLocation();&#xD;
         }&#xD;
         unit.setTradeRoute(null);&#xD;
     }&#xD;
     unit.setDestination(destination);&#xD;
&#xD;
     // Others can not see a destination change.&#xD;
     return new ChangeSet().add(See.only(serverPlayer), unit)&#xD;
         .build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoAOpVJQEeiyW7NaN4qWdw" name="setCurrentStop" specification="_QlE2QFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoAOplJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoAOp1JQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoAOqFJQEeiyW7NaN4qWdw" name="index">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QoAOqVJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>TradeRoute tr = unit.getTradeRoute();&#xD;
     if (tr == null) {&#xD;
         return DOMMessage.clientError(&quot;Unit has no trade route to set stop for.&quot;);&#xD;
     } else if (index &lt; 0 || index >= tr.getStops().size()) {&#xD;
         return DOMMessage.clientError(&quot;Stop index out of range [0..&quot;&#xD;
             + tr.getStops().size() + &quot;]: &quot; + index);&#xD;
     }&#xD;
&#xD;
     unit.setCurrentStop(index);&#xD;
&#xD;
     // Others can not see a stop change.&#xD;
     return new ChangeSet().add(See.only(serverPlayer), unit)&#xD;
         .build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoA1gFJQEeiyW7NaN4qWdw" name="buyFromSettlement" specification="_QlFdUFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoA1gVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoA1glJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoA1g1JQEeiyW7NaN4qWdw" name="settlement" type="_Qi8IQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoA1hFJQEeiyW7NaN4qWdw" name="goods" type="_Qie1QVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoA1hVJQEeiyW7NaN4qWdw" name="amount">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QoA1hlJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>ChangeSet cs = new ChangeSet();&#xD;
     csVisit(serverPlayer, settlement, 0, cs);&#xD;
&#xD;
     TradeSession session&#xD;
         = TradeSession.lookup(TradeSession.class, unit, settlement);&#xD;
     if (session == null) {&#xD;
         return DOMMessage.clientError(&quot;Trying to buy without opening a transaction session&quot;);&#xD;
     }&#xD;
     if (!session.getBuy()) {&#xD;
         return DOMMessage.clientError(&quot;Trying to buy in a session where buying is not allowed.&quot;);&#xD;
     }&#xD;
     if (!unit.hasSpaceLeft()) {&#xD;
         return DOMMessage.clientError(&quot;Unit is full, unable to buy.&quot;);&#xD;
     }&#xD;
&#xD;
     // Check that this is the agreement that was made&#xD;
     AIPlayer ai = getFreeColServer().getAIPlayer(settlement.getOwner());&#xD;
     int returnGold = ai.buyProposition(unit, settlement, goods, amount);&#xD;
     if (returnGold != amount) {&#xD;
         return DOMMessage.clientError(&quot;This was not the price we agreed upon! Cheater?&quot;);&#xD;
     }&#xD;
     if (!serverPlayer.checkGold(amount)) { // Check this is funded.&#xD;
         return DOMMessage.clientError(&quot;Insufficient gold to buy.&quot;);&#xD;
     }&#xD;
&#xD;
     // Valid, make the trade.&#xD;
     moveGoods(settlement, goods.getType(), goods.getAmount(), unit);&#xD;
     cs.add(See.perhaps(), unit);&#xD;
&#xD;
     Player settlementPlayer = settlement.getOwner();&#xD;
     Tile tile = settlement.getTile();&#xD;
     settlement.updateWantedGoods();&#xD;
     settlementPlayer.modifyGold(amount);&#xD;
     serverPlayer.modifyGold(-amount);&#xD;
     settlement.csModifyAlarm(serverPlayer, -amount / 50, true, cs);&#xD;
     tile.updateIndianSettlement(serverPlayer);&#xD;
     cs.add(See.only(serverPlayer), tile);&#xD;
     cs.addPartial(See.only(serverPlayer), serverPlayer, &quot;gold&quot;);&#xD;
     session.setBuy();&#xD;
     logger.finest(serverPlayer.getName() + &quot; &quot; + unit + &quot; buys &quot; + goods&#xD;
                   + &quot; at &quot; + settlement.getName() + &quot; for &quot; + amount);&#xD;
&#xD;
     // Others can see the unit capacity.&#xD;
     getGame().sendToOthers(serverPlayer, cs);&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoA1h1JQEeiyW7NaN4qWdw" name="sellToSettlement" specification="_QlGEYFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoA1iFJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoA1iVJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoA1ilJQEeiyW7NaN4qWdw" name="settlement" type="_Qi8IQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoA1i1JQEeiyW7NaN4qWdw" name="goods" type="_Qie1QVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoA1jFJQEeiyW7NaN4qWdw" name="amount">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QoA1jVJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>ChangeSet cs = new ChangeSet();&#xD;
     csVisit(serverPlayer, settlement, 0, cs);&#xD;
&#xD;
     TradeSession session&#xD;
         = TransactionSession.lookup(TradeSession.class, unit, settlement);&#xD;
     if (session == null) {&#xD;
         return DOMMessage.clientError(&quot;Trying to sell without opening a transaction session&quot;);&#xD;
     }&#xD;
     if (!session.getSell()) {&#xD;
         return DOMMessage.clientError(&quot;Trying to sell in a session where selling is not allowed.&quot;);&#xD;
     }&#xD;
&#xD;
     // Check that the gold is the agreed amount&#xD;
     AIPlayer ai = getFreeColServer().getAIPlayer(settlement.getOwner());&#xD;
     int returnGold = ai.sellProposition(unit, settlement, goods, amount);&#xD;
     if (returnGold != amount) {&#xD;
         return DOMMessage.clientError(&quot;This was not the price we agreed upon! Cheater?&quot;);&#xD;
     }&#xD;
&#xD;
     // Valid, make the trade.&#xD;
     moveGoods(unit, goods.getType(), goods.getAmount(), settlement);&#xD;
     cs.add(See.perhaps(), unit);&#xD;
&#xD;
     Player settlementPlayer = settlement.getOwner();&#xD;
     settlementPlayer.modifyGold(-amount);&#xD;
     serverPlayer.modifyGold(amount);&#xD;
     settlement.csModifyAlarm(serverPlayer, -amount / 500, true, cs);&#xD;
     Tile tile = settlement.getTile();&#xD;
     settlement.updateWantedGoods();&#xD;
     tile.updateIndianSettlement(serverPlayer);&#xD;
     cs.add(See.only(serverPlayer), tile);&#xD;
     cs.addPartial(See.only(serverPlayer), serverPlayer, &quot;gold&quot;);&#xD;
     session.setSell();&#xD;
     cs.addSale(serverPlayer, settlement, goods.getType(),&#xD;
             Math.round((float) amount / goods.getAmount()));&#xD;
     logger.finest(serverPlayer.getName() + &quot; &quot; + unit + &quot; sells &quot; + goods&#xD;
                   + &quot; at &quot; + settlement.getName() + &quot; for &quot; + amount);&#xD;
&#xD;
     // Others can see the unit capacity.&#xD;
     getGame().sendToOthers(serverPlayer, cs);&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoA1jlJQEeiyW7NaN4qWdw" name="deliverGiftToSettlement" specification="_QlGrcFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoA1j1JQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoA1kFJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoA1kVJQEeiyW7NaN4qWdw" name="settlement" type="_QitewVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoA1klJQEeiyW7NaN4qWdw" name="goods" type="_Qie1QVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoA1k1JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>TradeSession session&#xD;
         = TransactionSession.lookup(TradeSession.class, unit, settlement);&#xD;
     if (session == null) {&#xD;
         return DOMMessage.clientError(&quot;Trying to deliver gift without opening a session&quot;);&#xD;
     }&#xD;
     if (!session.getGift()) {&#xD;
         return DOMMessage.clientError(&quot;Trying to deliver gift in a session where gift giving is not allowed: &quot; + unit + &quot; &quot; + settlement + &quot; &quot; + session);&#xD;
     }&#xD;
&#xD;
     ChangeSet cs = new ChangeSet();&#xD;
     Tile tile = settlement.getTile();&#xD;
     moveGoods(unit, goods.getType(), goods.getAmount(), settlement);&#xD;
     cs.add(See.perhaps(), unit);&#xD;
     if (settlement instanceof ServerIndianSettlement) {&#xD;
         ServerIndianSettlement sis = (ServerIndianSettlement)settlement;&#xD;
         csVisit(serverPlayer, sis, 0, cs);&#xD;
         sis.csModifyAlarm(serverPlayer, -sis.getPriceToBuy(goods) / 50,&#xD;
                           true, cs);&#xD;
         sis.updateWantedGoods();&#xD;
         tile.updateIndianSettlement(serverPlayer);&#xD;
         cs.add(See.only(serverPlayer), tile);&#xD;
     }&#xD;
     session.setGift();&#xD;
&#xD;
     // Inform the receiver of the gift.&#xD;
     ModelMessage m = new ModelMessage(ModelMessage.MessageType.GIFT_GOODS,&#xD;
                                       &quot;deliverGift.goods&quot;,&#xD;
                                       settlement, goods.getType())&#xD;
         .addStringTemplate(&quot;%player%&quot;, serverPlayer.getNationLabel())&#xD;
         .addNamed(&quot;%type%&quot;, goods)&#xD;
         .addAmount(&quot;%amount%&quot;, goods.getAmount())&#xD;
         .addName(&quot;%settlement%&quot;, settlement.getName());&#xD;
     cs.addMessage(See.only(serverPlayer), m);&#xD;
     ServerPlayer receiver = (ServerPlayer) settlement.getOwner();&#xD;
     if (receiver.isConnected() &amp;&amp; settlement instanceof Colony) {&#xD;
         cs.add(See.only(receiver), unit);&#xD;
         cs.add(See.only(receiver), settlement);&#xD;
         cs.addMessage(See.only(receiver), m);&#xD;
     }&#xD;
     logger.info(&quot;Gift delivered by unit: &quot; + unit.getId()&#xD;
                 + &quot; to settlement: &quot; + settlement.getName());&#xD;
&#xD;
     // Others can see unit capacity, receiver gets it own items.&#xD;
     getGame().sendToOthers(serverPlayer, cs);&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoA1lFJQEeiyW7NaN4qWdw" name="loadGoods" specification="_QlHSgVJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoA1lVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoA1llJQEeiyW7NaN4qWdw" name="loc" type="_QikU0FJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoA1l1JQEeiyW7NaN4qWdw" name="goodsType" type="_QigDYVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoA1mFJQEeiyW7NaN4qWdw" name="amount">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QoA1mVJQEeiyW7NaN4qWdw" name="carrier" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoA1mlJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>if (loc instanceof Europe) {&#xD;
         if (carrier.isInEurope()) {&#xD;
             return buyGoods(serverPlayer, goodsType, amount, carrier);&#xD;
         } else {&#xD;
             return DOMMessage.clientError(&quot;Carrier not in Europe: &quot; + loc);&#xD;
         }&#xD;
     }&#xD;
     // All loading locations other than Europe are GoodsLocations&#xD;
     if (!(loc instanceof GoodsLocation)) {&#xD;
         return DOMMessage.clientError(&quot;Not a goods location: &quot; + loc);&#xD;
     }&#xD;
     GoodsLocation gl = (GoodsLocation)loc;&#xD;
     if (!carrier.isAtLocation(loc)) {&#xD;
         return DOMMessage.clientError(&quot;Carrier not at location: &quot; + loc);&#xD;
     }&#xD;
     if (carrier.getLoadableAmount(goodsType) &lt; amount) {&#xD;
         return DOMMessage.clientError(&quot;Too much goods&quot;);&#xD;
     }&#xD;
     if (gl.getGoodsCount(goodsType) &lt; amount) {&#xD;
         return DOMMessage.clientError(&quot;Not enough goods (&quot;&#xD;
             + gl.getGoodsCount(goodsType) + &quot; &lt; &quot; + amount&#xD;
             + &quot; &quot; + goodsType.getSuffix() + &quot;) at &quot; + gl);&#xD;
     }&#xD;
&#xD;
     ChangeSet cs = new ChangeSet();&#xD;
     moveGoods(gl, goodsType, amount, carrier);&#xD;
     logger.finest(Messages.message(loc.getLocationLabel())&#xD;
         + &quot; loaded &quot; + amount + &quot; &quot; + goodsType.getSuffix()&#xD;
         + &quot; onto &quot; + carrier);&#xD;
     cs.add(See.only(serverPlayer), gl.getGoodsContainer());&#xD;
     cs.add(See.only(serverPlayer), carrier.getGoodsContainer());&#xD;
     if (carrier.getInitialMovesLeft() != carrier.getMovesLeft()) {&#xD;
         carrier.setMovesLeft(0);&#xD;
         cs.addPartial(See.only(serverPlayer), carrier, &quot;movesLeft&quot;);&#xD;
     }&#xD;
&#xD;
     // Invisible in settlement&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoA1m1JQEeiyW7NaN4qWdw" name="unloadGoods" specification="_QlIgoFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoA1nFJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoA1nVJQEeiyW7NaN4qWdw" name="goodsType" type="_QigDYVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoA1nlJQEeiyW7NaN4qWdw" name="amount">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QoA1n1JQEeiyW7NaN4qWdw" name="carrier" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoA1oFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>if (carrier.getGoodsCount(goodsType) &lt; amount) {&#xD;
         return DOMMessage.clientError(&quot;Too few goods&quot;);&#xD;
     }&#xD;
     if (carrier.isInEurope()) {&#xD;
         return sellGoods(serverPlayer, goodsType, amount, carrier);&#xD;
     }&#xD;
&#xD;
     ChangeSet cs = new ChangeSet();&#xD;
     if (carrier.getSettlement() != null) {&#xD;
         Settlement settlement = carrier.getSettlement();&#xD;
         moveGoods(carrier, goodsType, amount, settlement);&#xD;
         logger.finest(carrier&#xD;
             + &quot; unloaded &quot; + amount + &quot; &quot; + goodsType.getSuffix()&#xD;
             + &quot; to &quot; + settlement.getName());&#xD;
         cs.add(See.only(serverPlayer), settlement.getGoodsContainer());&#xD;
         cs.add(See.only(serverPlayer), carrier.getGoodsContainer());&#xD;
         if (carrier.getInitialMovesLeft() != carrier.getMovesLeft()) {&#xD;
             carrier.setMovesLeft(0);&#xD;
             cs.addPartial(See.only(serverPlayer), carrier, &quot;movesLeft&quot;);&#xD;
         }&#xD;
     } else { // Dump of goods onto a tile&#xD;
         moveGoods(carrier, goodsType, amount, null);&#xD;
         logger.finest(carrier + &quot; dumped &quot; + amount&#xD;
             + &quot; &quot; + goodsType.getSuffix() + &quot; to &quot; + carrier.getLocation());&#xD;
         cs.add(See.perhaps(), (FreeColGameObject)carrier.getLocation());&#xD;
         // Others might see a capacity change.&#xD;
         getGame().sendToOthers(serverPlayer, cs);&#xD;
     }&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoA1oVJQEeiyW7NaN4qWdw" name="clearSpeciality" specification="_QlJHsFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoA1olJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoA1o1JQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoA1pFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>UnitType newType = unit.getTypeChange(ChangeType.CLEAR_SKILL,&#xD;
                                           serverPlayer);&#xD;
     if (newType == null) {&#xD;
         return DOMMessage.clientError(&quot;Can not clear unit speciality: &quot;&#xD;
             + unit.getId());&#xD;
     }&#xD;
&#xD;
     // There can be some restrictions that may prevent the&#xD;
     // clearing of the speciality.  AFAICT the only ATM is that a&#xD;
     // teacher can not lose its speciality, but this will need to&#xD;
     // be revisited if we invent a work location that requires a&#xD;
     // particular unit type.&#xD;
     if (unit.getStudent() != null) {&#xD;
         return DOMMessage.clientError(&quot;Can not clear speciality of a teacher.&quot;);&#xD;
     }&#xD;
&#xD;
     // Valid, change type.&#xD;
     unit.changeType(newType);//-vis: safe in colony&#xD;
&#xD;
     // Update just the unit, others can not see it as this only happens&#xD;
     // in-colony.&#xD;
     return new ChangeSet().add(See.only(serverPlayer), unit)&#xD;
         .build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoBckFJQEeiyW7NaN4qWdw" name="disbandUnit" specification="_QlJuwFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoBckVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoBcklJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoBck1JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>ChangeSet cs = new ChangeSet();&#xD;
&#xD;
     // Dispose of the unit.&#xD;
     cs.add(See.perhaps().always(serverPlayer),&#xD;
            (FreeColGameObject)unit.getLocation());&#xD;
     cs.addRemove(See.perhaps().always(serverPlayer),&#xD;
                  unit.getLocation(), unit);//-vis(serverPlayer)&#xD;
     unit.dispose();&#xD;
     serverPlayer.invalidateCanSeeTiles();//+vis(serverPlayer)&#xD;
&#xD;
     // Others can see the unit removal and the space it leaves.&#xD;
     getGame().sendToOthers(serverPlayer, cs);&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoBclFJQEeiyW7NaN4qWdw" name="buildSettlement" specification="_QlKV0FJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoBclVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoBcllJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoBcl1JQEeiyW7NaN4qWdw" name="name">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QoBcmFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final ServerGame game = getGame();&#xD;
     final Specification spec = game.getSpecification();&#xD;
     ChangeSet cs = new ChangeSet();&#xD;
&#xD;
     // Build settlement&#xD;
     Tile tile = unit.getTile();&#xD;
     Settlement settlement;&#xD;
     if (Player.ASSIGN_SETTLEMENT_NAME.equals(name)) {&#xD;
         name = serverPlayer.getSettlementName(random);&#xD;
     }&#xD;
     if (serverPlayer.isEuropean()) {&#xD;
         StringTemplate nation = serverPlayer.getNationLabel();&#xD;
         settlement = new ServerColony(game, serverPlayer, name, tile);&#xD;
         for (Tile t : tile.getSurroundingTiles(settlement.getRadius())) {&#xD;
             t.cacheUnseen();//+til&#xD;
         }&#xD;
         serverPlayer.addSettlement(settlement);&#xD;
         settlement.placeSettlement(false);//-vis(serverPlayer,?),-til&#xD;
         cs.add(See.only(serverPlayer),&#xD;
                serverPlayer.exploreForSettlement(settlement));&#xD;
&#xD;
         cs.addHistory(serverPlayer, new HistoryEvent(game.getTurn(),&#xD;
                 HistoryEvent.HistoryEventType.FOUND_COLONY, serverPlayer)&#xD;
             .addName(&quot;%colony%&quot;, settlement.getName()));&#xD;
&#xD;
         // Remove equipment from founder in case role confuses&#xD;
         // placement.&#xD;
         settlement.equipForRole(unit, spec.getDefaultRole(), 0);&#xD;
&#xD;
         // Coronado&#xD;
         for (ServerPlayer sp : game.getConnectedPlayers(serverPlayer)) {&#xD;
             if (!sp.hasAbility(Ability.SEE_ALL_COLONIES)) continue;&#xD;
             cs.add(See.only(sp), sp.exploreForSettlement(settlement));//-vis(sp)&#xD;
             sp.invalidateCanSeeTiles();//+vis(sp)&#xD;
             cs.addMessage(See.only(sp),&#xD;
                 new ModelMessage(ModelMessage.MessageType.FOREIGN_DIPLOMACY,&#xD;
                                  &quot;buildColony.others&quot;, settlement)&#xD;
                     .addStringTemplate(&quot;%nation%&quot;, nation)&#xD;
                     .addStringTemplate(&quot;%colony%&quot;,&#xD;
                         settlement.getLocationLabelFor(sp))&#xD;
                     .addStringTemplate(&quot;%region%&quot;,&#xD;
                         tile.getRegion().getLabel()));&#xD;
         }&#xD;
     } else {&#xD;
         IndianNationType nationType&#xD;
             = (IndianNationType) serverPlayer.getNationType();&#xD;
         UnitType skill = RandomChoice&#xD;
             .getWeightedRandom(logger, &quot;Choose skill&quot;,&#xD;
                                nationType.generateSkillsForTile(tile),&#xD;
                                random);&#xD;
         if (skill == null) { // Seasoned Scout&#xD;
             List&lt;UnitType> scouts = spec&#xD;
                 .getUnitTypesWithAbility(Ability.EXPERT_SCOUT);&#xD;
             skill = getRandomMember(logger, &quot;Choose scout&quot;, scouts, random);&#xD;
         }&#xD;
         settlement = new ServerIndianSettlement(game, serverPlayer, name,&#xD;
                                                 tile, false, skill, null);&#xD;
         for (Tile t : tile.getSurroundingTiles(settlement.getRadius())) {&#xD;
             t.cacheUnseen();//+til&#xD;
         }&#xD;
         serverPlayer.addSettlement(settlement);&#xD;
         settlement.placeSettlement(true);//-vis(serverPlayer),-til&#xD;
         for (Player p : getGame().getLivePlayers(serverPlayer)) {&#xD;
             if (p == serverPlayer) continue;&#xD;
             ((IndianSettlement)settlement).setAlarm(p, (p.isIndian())&#xD;
                 ? new Tension(Tension.Level.CONTENT.getLimit())&#xD;
                 : serverPlayer.getTension(p));//-til&#xD;
         }&#xD;
     }&#xD;
&#xD;
     // Join the settlement.&#xD;
     unit.setLocation(settlement);//-vis(serverPlayer),-til&#xD;
     unit.setMovesLeft(0);&#xD;
&#xD;
     // Update with settlement tile, and newly owned tiles.&#xD;
     cs.add(See.perhaps(), settlement.getOwnedTiles());&#xD;
     serverPlayer.invalidateCanSeeTiles();//+vis(serverPlayer)&#xD;
&#xD;
     // Others can see tile changes.&#xD;
     getGame().sendToOthers(serverPlayer, cs);&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoBcmVJQEeiyW7NaN4qWdw" name="joinColony" specification="_QlLj8FJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoBcmlJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoBcm1JQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoBcnFJQEeiyW7NaN4qWdw" name="colony" type="_QiYuoVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoBcnVJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final Specification spec = getGame().getSpecification();&#xD;
     ChangeSet cs = new ChangeSet();&#xD;
     Set&lt;Tile> ownedTiles = colony.getOwnedTiles();&#xD;
     Tile tile = colony.getTile();&#xD;
&#xD;
     // Join.&#xD;
     tile.cacheUnseen();//+til&#xD;
     unit.setLocation(colony);//-vis: safe/colony,-til&#xD;
     unit.setMovesLeft(0);&#xD;
     colony.equipForRole(unit, spec.getDefaultRole(), 0);&#xD;
&#xD;
     // Update with colony tile, and tiles now owned.&#xD;
     cs.add(See.only(serverPlayer), tile);&#xD;
     for (Tile t : tile.getSurroundingTiles(colony.getRadius())) {&#xD;
         if (t.getOwningSettlement() == colony &amp;&amp; !ownedTiles.contains(t)) {&#xD;
             cs.add(See.perhaps(), t);&#xD;
         }&#xD;
     }&#xD;
&#xD;
     // Others might see a tile ownership change.&#xD;
     getGame().sendToOthers(serverPlayer, cs);&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoBcnlJQEeiyW7NaN4qWdw" name="abandonSettlement" specification="_QlMLAFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoBcn1JQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoBcoFJQEeiyW7NaN4qWdw" name="settlement" type="_QitewVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoBcoVJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>ChangeSet cs = new ChangeSet();&#xD;
&#xD;
     // Drop trade routes and create history event before disposing.&#xD;
     if (settlement instanceof Colony) {&#xD;
         serverPlayer.csLoseLocation(settlement, cs);&#xD;
         cs.addHistory(serverPlayer,&#xD;
             new HistoryEvent(getGame().getTurn(),&#xD;
                 HistoryEvent.HistoryEventType.ABANDON_COLONY, serverPlayer)&#xD;
                 .addName(&quot;%colony%&quot;, settlement.getName()));&#xD;
     }&#xD;
&#xD;
     // Comprehensive dispose.&#xD;
     serverPlayer.csDisposeSettlement(settlement, cs);//+vis&#xD;
&#xD;
     // FIXME: Player.settlements is still being fixed on the client side.&#xD;
     getGame().sendToOthers(serverPlayer, cs);&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoBcolJQEeiyW7NaN4qWdw" name="claimLand" specification="_QlMyEFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoBco1JQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoBcpFJQEeiyW7NaN4qWdw" name="tile" type="_QivT8VJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoBcpVJQEeiyW7NaN4qWdw" name="settlement" type="_QitewVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoBcplJQEeiyW7NaN4qWdw" name="price">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QoBcp1JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>ChangeSet cs = new ChangeSet();&#xD;
     serverPlayer.csClaimLand(tile, settlement, price, cs);&#xD;
&#xD;
     if (settlement != null &amp;&amp; serverPlayer.isEuropean()) {&#xD;
         // Define Coronado to make all colony-owned tiles visible&#xD;
         for (ServerPlayer sp : getGame().getConnectedPlayers(serverPlayer)) {&#xD;
             if (sp.isEuropean()&#xD;
                 &amp;&amp; sp.hasAbility(Ability.SEE_ALL_COLONIES)) {&#xD;
                 sp.exploreTile(tile);&#xD;
                 cs.add(See.only(sp), tile);&#xD;
                 sp.invalidateCanSeeTiles();//+vis(sp)&#xD;
             }&#xD;
         }&#xD;
     }&#xD;
&#xD;
     // Others can see the tile.&#xD;
     getGame().sendToOthers(serverPlayer, cs);&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoBcqFJQEeiyW7NaN4qWdw" name="csAcceptTrade" specification="_QlOAMFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoBcqVJQEeiyW7NaN4qWdw" name="agreement" type="_Qiaj0FJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoBcqlJQEeiyW7NaN4qWdw" name="session" type="_Qi6TE1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoBcq1JQEeiyW7NaN4qWdw" name="cs" type="_P6C8QFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoBcrFJQEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>final ServerPlayer srcPlayer = (ServerPlayer)agreement.getSender();&#xD;
     final ServerPlayer dstPlayer = (ServerPlayer)agreement.getRecipient();&#xD;
     final Unit unit = session.getUnit();&#xD;
     final Settlement settlement = session.getSettlement();&#xD;
     boolean visibilityChange = false;&#xD;
&#xD;
     // Check trade carefully before committing.&#xD;
     boolean fail = false;&#xD;
     for (TradeItem tradeItem : agreement.getTradeItems()) {&#xD;
         final ServerPlayer source = (ServerPlayer)tradeItem.getSource();&#xD;
         final ServerPlayer dest = (ServerPlayer)tradeItem.getDestination();&#xD;
         if (!tradeItem.isValid()) {&#xD;
             logger.warning(&quot;Trade with invalid tradeItem: &quot; + tradeItem);&#xD;
             fail = true;&#xD;
             continue;&#xD;
         }&#xD;
         if (source != srcPlayer &amp;&amp; source != dstPlayer) {&#xD;
             logger.warning(&quot;Trade with invalid source: &quot;&#xD;
                            + ((source == null) ? &quot;null&quot; : source.getId()));&#xD;
             fail = true;&#xD;
             continue;&#xD;
         }&#xD;
         if (dest != srcPlayer &amp;&amp; dest != dstPlayer) {&#xD;
             logger.warning(&quot;Trade with invalid destination: &quot;&#xD;
                            + ((dest == null) ? &quot;null&quot; : dest.getId()));&#xD;
             fail = true;&#xD;
             continue;&#xD;
         }&#xD;
&#xD;
         Colony colony = tradeItem.getColony(getGame());&#xD;
         if (colony != null &amp;&amp; !source.owns(colony)) {&#xD;
             logger.warning(&quot;Trade with invalid source owner: &quot; + colony);&#xD;
             fail = true;&#xD;
             continue;&#xD;
         }&#xD;
         int gold = tradeItem.getGold();&#xD;
         if (gold > 0 &amp;&amp; !source.checkGold(gold)) {&#xD;
             logger.warning(&quot;Trade with invalid gold: &quot; + gold);&#xD;
             fail = true;&#xD;
             continue;&#xD;
         }&#xD;
&#xD;
         Goods goods = tradeItem.getGoods();&#xD;
         if (goods != null) {&#xD;
             Location loc = goods.getLocation();&#xD;
             if (loc instanceof Ownable&#xD;
                 &amp;&amp; !source.owns((Ownable)loc)) {&#xD;
                 logger.warning(&quot;Trade with invalid source owner: &quot; + loc);&#xD;
                 fail = true;&#xD;
             } else if (!(loc instanceof GoodsLocation&#xD;
                     &amp;&amp; loc.contains(goods))) {&#xD;
                 logger.warning(&quot;Trade of unavailable goods &quot; + goods&#xD;
                     + &quot; at &quot; + loc);&#xD;
                 fail = true;&#xD;
             } else if (dest.owns(unit) &amp;&amp; !unit.couldCarry(goods)) {&#xD;
                 logger.warning(&quot;Trade unit can not carry traded goods: &quot;&#xD;
                     + goods);&#xD;
                 fail = true;&#xD;
             }&#xD;
         }&#xD;
&#xD;
         // Stance trade fail is harmless&#xD;
         Unit u = tradeItem.getUnit();&#xD;
         if (u != null) {&#xD;
             if (!source.owns(u)) {&#xD;
                 logger.warning(&quot;Trade with invalid source owner: &quot; + u);&#xD;
                 fail = true;&#xD;
                 continue;&#xD;
             } else if (dest.owns(unit) &amp;&amp; !unit.couldCarry(u)) {&#xD;
                 logger.warning(&quot;Trade unit can not carry traded unit: &quot;&#xD;
                     + u);&#xD;
                 fail = true;&#xD;
             }&#xD;
         }&#xD;
     }&#xD;
     if (fail) return false;&#xD;
&#xD;
     for (TradeItem tradeItem : agreement.getTradeItems()) {&#xD;
         final ServerPlayer source = (ServerPlayer)tradeItem.getSource();&#xD;
         final ServerPlayer dest = (ServerPlayer)tradeItem.getDestination();&#xD;
         // Collect changes for updating.  Not very OO but&#xD;
         // TradeItem should not know about server internals.&#xD;
         // Take care to show items that change hands to the *old*&#xD;
         // owner too.&#xD;
         Stance stance = tradeItem.getStance();&#xD;
         if (stance != null&#xD;
             &amp;&amp; !source.csChangeStance(stance, dest, true, cs)) {&#xD;
             logger.warning(&quot;Stance trade failure: &quot; + stance);&#xD;
         }&#xD;
         Colony colony = tradeItem.getColony(getGame());&#xD;
         if (colony != null) {&#xD;
             ServerPlayer former = (ServerPlayer) colony.getOwner();&#xD;
             for (Tile t : colony.getOwnedTiles()) {&#xD;
                 t.cacheUnseen(dest);//+til&#xD;
             }&#xD;
             ((ServerColony)colony).csChangeOwner(dest, cs);//-vis(both),-til&#xD;
             cs.add(See.only(dest), dest.exploreForSettlement(colony));&#xD;
             cs.add(See.perhaps().always(former), colony.getOwnedTiles());&#xD;
             visibilityChange = true;&#xD;
         }&#xD;
         int gold = tradeItem.getGold();&#xD;
         if (gold > 0) {&#xD;
             source.modifyGold(-gold);&#xD;
             dest.modifyGold(gold);&#xD;
             cs.addPartial(See.only(source), source, &quot;gold&quot;, &quot;score&quot;);&#xD;
             cs.addPartial(See.only(dest), dest, &quot;gold&quot;, &quot;score&quot;);&#xD;
         }&#xD;
         Goods goods = tradeItem.getGoods();&#xD;
         if (goods != null &amp;&amp; settlement != null) {&#xD;
             if (dest.owns(settlement)) {&#xD;
                 goods.setLocation(unit);&#xD;
                 moveGoods(unit, goods.getType(), goods.getAmount(), settlement);&#xD;
                 cs.add(See.only(source), unit);&#xD;
                 cs.add(See.only(dest), settlement.getGoodsContainer());&#xD;
             } else {&#xD;
                 goods.setLocation(settlement);&#xD;
                 moveGoods(settlement, goods.getType(), goods.getAmount(), unit);&#xD;
                 cs.add(See.only(dest), unit);&#xD;
                 cs.add(See.only(source), settlement.getGoodsContainer());&#xD;
             }&#xD;
         }&#xD;
         ServerPlayer victim = (ServerPlayer)tradeItem.getVictim();&#xD;
         if (victim != null) {&#xD;
             if (source.csChangeStance(Stance.WAR, victim, true, cs)) {&#xD;
                 // Have to add in an explicit stance change and&#xD;
                 // message because the player does not normally&#xD;
                 // have visibility of stance changes between other nations.&#xD;
                 cs.addStance(See.only(dest), source, Stance.WAR, victim);&#xD;
                 cs.addMessage(See.only(dest),&#xD;
                     new ModelMessage(ModelMessage.MessageType.FOREIGN_DIPLOMACY,&#xD;
                         Stance.WAR.getOtherStanceChangeKey(), source)&#xD;
                         .addStringTemplate(&quot;%attacker%&quot;,&#xD;
                             source.getNationLabel())&#xD;
                         .addStringTemplate(&quot;%defender%&quot;,&#xD;
                             victim.getNationLabel()));&#xD;
             } else {&#xD;
                 logger.warning(&quot;Incite trade failure: &quot; + victim);&#xD;
             }&#xD;
         }                &#xD;
         ServerUnit newUnit = (ServerUnit)tradeItem.getUnit();&#xD;
         if (newUnit != null &amp;&amp; settlement != null) {&#xD;
             ServerPlayer former = (ServerPlayer)newUnit.getOwner();&#xD;
             Tile oldTile = newUnit.getTile();&#xD;
             Location newLoc;&#xD;
             if (unit.isOnCarrier()) {&#xD;
                 Unit carrier = unit.getCarrier();&#xD;
                 if (!carrier.couldCarry(newUnit)) {&#xD;
                     logger.warning(&quot;Can not add &quot; + newUnit&#xD;
                         + &quot; to &quot; + carrier);&#xD;
                     continue;&#xD;
                 }&#xD;
                 newLoc = carrier;&#xD;
             } else if (dest == unit.getOwner()) {&#xD;
                 newLoc = unit.getTile();&#xD;
             } else {&#xD;
                 newLoc = settlement.getTile();&#xD;
             }&#xD;
             if (source.csChangeOwner(newUnit, dest, ChangeType.CAPTURE,&#xD;
                                      newLoc, cs)) {//-vis(both)&#xD;
                 newUnit.setMovesLeft(0);&#xD;
                 cs.add(See.perhaps().always(former), oldTile);&#xD;
             }&#xD;
             visibilityChange = true;&#xD;
         }&#xD;
     }&#xD;
     if (visibilityChange) {&#xD;
         srcPlayer.invalidateCanSeeTiles();//+vis(srcPlayer)&#xD;
         dstPlayer.invalidateCanSeeTiles();//+vis(dstPlayer)&#xD;
     }&#xD;
     return true;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoCDoFJQEeiyW7NaN4qWdw" name="nativeFirstContact" specification="_QlOnQFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoCDoVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoCDolJQEeiyW7NaN4qWdw" name="other" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoCDo1JQEeiyW7NaN4qWdw" name="tile" type="_QivT8VJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoCDpFJQEeiyW7NaN4qWdw" name="result">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QoCDpVJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>ChangeSet cs = new ChangeSet();&#xD;
     if (result) {&#xD;
         if (tile != null) {&#xD;
             Unit u = tile.getFirstUnit();&#xD;
             Settlement s = tile.getOwningSettlement();&#xD;
             DiplomacySession session&#xD;
                 = TransactionSession.lookup(DiplomacySession.class, u, s);&#xD;
             if (session == null) {&#xD;
                 return DOMMessage.clientError(&quot;No diplomacy in effect for: &quot;&#xD;
                     + tile.getId());&#xD;
             }&#xD;
             tile.cacheUnseen();//+til&#xD;
             tile.changeOwnership(serverPlayer, null);//-til&#xD;
             cs.add(See.perhaps(), tile);&#xD;
         }&#xD;
     } else {&#xD;
         // Consider not accepting the treaty to be an insult and&#xD;
         // ban missions.&#xD;
         other.csModifyTension(serverPlayer,&#xD;
             Tension.TENSION_ADD_MAJOR, cs);//+til&#xD;
         other.addMissionBan(serverPlayer);&#xD;
     }&#xD;
&#xD;
     getGame().sendToOthers(serverPlayer, cs);&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoCDplJQEeiyW7NaN4qWdw" name="csDiplomacySession" specification="_QlPOUFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoCDp1JQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoCDqFJQEeiyW7NaN4qWdw" name="otherPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoCDqVJQEeiyW7NaN4qWdw" name="agreement" type="_Qiaj0FJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoCDqlJQEeiyW7NaN4qWdw" name="session" type="_Qi6TE1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoCDq1JQEeiyW7NaN4qWdw" name="message" type="_Qh0t8FJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoCDrFJQEeiyW7NaN4qWdw" name="cs" type="_P6C8QFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoCDrVJQEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>// Consider the status, process acceptance and rejection,&#xD;
     // which need no further action.&#xD;
     TradeStatus status = agreement.getStatus();&#xD;
     switch (status) {&#xD;
     case PROPOSE_TRADE:&#xD;
         session.setAgreement(agreement);&#xD;
         break;&#xD;
     case ACCEPT_TRADE:&#xD;
         // Process the agreement that was sent!&#xD;
         agreement = session.getAgreement();&#xD;
         agreement.setStatus(TradeStatus.ACCEPT_TRADE);&#xD;
         if (csAcceptTrade(agreement, session, cs)) {&#xD;
             session.complete(cs);&#xD;
             getGame().sendToOthers(serverPlayer, cs);&#xD;
             return false;&#xD;
         }&#xD;
         // Trade was invalid, fall through into rejection.&#xD;
     case REJECT_TRADE: default:&#xD;
         agreement = session.getAgreement();&#xD;
         agreement.setStatus(TradeStatus.REJECT_TRADE);&#xD;
         session.complete(cs);&#xD;
         getGame().sendToOthers(serverPlayer, cs);&#xD;
         return false;&#xD;
     }&#xD;
&#xD;
     // Ask the other player to consider the agreement.&#xD;
     // Treat a missing reply as a rejection.&#xD;
     DOMMessage reply = askTimeout(otherPlayer, message);&#xD;
     if (reply instanceof DiplomacyMessage) {&#xD;
         agreement = ((DiplomacyMessage)reply).getAgreement();&#xD;
         status = agreement.getStatus();&#xD;
     } else {&#xD;
         status = TradeStatus.REJECT_TRADE;&#xD;
         agreement.setStatus(status);&#xD;
     }&#xD;
     agreement.incrementVersion();&#xD;
&#xD;
     // Process the result.  Always return true here as the serverPlayer&#xD;
     // needs to be informed of the other player's response.&#xD;
     switch (status) {&#xD;
     case PROPOSE_TRADE:&#xD;
         session.setAgreement(agreement);&#xD;
         break;&#xD;
     case ACCEPT_TRADE:&#xD;
         agreement = session.getAgreement(); // Accept offered agreement&#xD;
         agreement.setStatus(TradeStatus.ACCEPT_TRADE);&#xD;
         if (csAcceptTrade(agreement, session, cs)) {&#xD;
             session.complete(cs);&#xD;
             getGame().sendToOthers(serverPlayer, cs);&#xD;
             break;&#xD;
         }&#xD;
         // Trade was invalid, fall through into rejection.&#xD;
     case REJECT_TRADE: default:&#xD;
         agreement.setStatus(TradeStatus.REJECT_TRADE);&#xD;
         session.setAgreement(agreement);&#xD;
         session.complete(cs);&#xD;
         getGame().sendToOthers(serverPlayer, cs);&#xD;
         break;&#xD;
     }&#xD;
     return true;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoCDrlJQEeiyW7NaN4qWdw" name="europeanFirstContact" specification="_QlQccFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoCDr1JQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoCDsFJQEeiyW7NaN4qWdw" name="ourUnit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoCDsVJQEeiyW7NaN4qWdw" name="otherUnit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoCDslJQEeiyW7NaN4qWdw" name="agreement" type="_Qiaj0FJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoCDs1JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>ChangeSet cs = new ChangeSet();&#xD;
     DiplomacySession session&#xD;
         = TransactionSession.lookup(DiplomacySession.class, &#xD;
                                     ourUnit, otherUnit);&#xD;
     if (session == null) {&#xD;
         session = TransactionSession.lookup(DiplomacySession.class,&#xD;
                                             otherUnit, ourUnit);&#xD;
     }&#xD;
     if (session == null) {&#xD;
         if (agreement.getStatus() != TradeStatus.PROPOSE_TRADE) {&#xD;
             return DOMMessage.clientError(&quot;Missing uu1-diplomacy session for &quot;&#xD;
                 + ourUnit.getId() + &quot;,&quot; + otherUnit.getId()&#xD;
                 + &quot; with &quot; + agreement);&#xD;
         }&#xD;
         session = new DiplomacySession(ourUnit, otherUnit);&#xD;
         ourUnit.setMovesLeft(0);&#xD;
         cs.addPartial(See.only(serverPlayer), ourUnit, &quot;movesLeft&quot;);&#xD;
     }&#xD;
     ServerPlayer otherPlayer = (ServerPlayer)otherUnit.getOwner();&#xD;
     if (csDiplomacySession(serverPlayer, otherPlayer,&#xD;
             agreement, session,&#xD;
             new DiplomacyMessage(otherUnit, ourUnit, agreement), cs)) {&#xD;
         cs.add(See.only(serverPlayer), ChangePriority.CHANGE_LATE,&#xD;
             new DiplomacyMessage(ourUnit, otherUnit, &#xD;
                                  session.getAgreement()));&#xD;
     }&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoCDtFJQEeiyW7NaN4qWdw" name="europeanFirstContact" specification="_QlRqkFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoCDtVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoCDtlJQEeiyW7NaN4qWdw" name="ourUnit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoCDt1JQEeiyW7NaN4qWdw" name="otherColony" type="_QiYuoVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoCDuFJQEeiyW7NaN4qWdw" name="agreement" type="_Qiaj0FJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoCDuVJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>ChangeSet cs = new ChangeSet();&#xD;
     DiplomacySession session&#xD;
         = TransactionSession.lookup(DiplomacySession.class,&#xD;
                                     ourUnit, otherColony);&#xD;
     if (session == null) {&#xD;
         if (agreement.getStatus() != TradeStatus.PROPOSE_TRADE) {&#xD;
             return DOMMessage.clientError(&quot;Missing uc1-diplomacy session for &quot;&#xD;
                 + ourUnit.getId() + &quot;,&quot; + otherColony.getId()&#xD;
                 + &quot; with &quot; + agreement);&#xD;
         }&#xD;
         session = new DiplomacySession(ourUnit, otherColony);&#xD;
         ourUnit.setMovesLeft(0);&#xD;
         cs.addPartial(See.only(serverPlayer), ourUnit, &quot;movesLeft&quot;);&#xD;
     }&#xD;
     ServerPlayer otherPlayer = (ServerPlayer)otherColony.getOwner();&#xD;
     if (csDiplomacySession(serverPlayer, otherPlayer,&#xD;
             agreement, session,&#xD;
             new DiplomacyMessage(otherColony, ourUnit, agreement), cs)) {&#xD;
         cs.add(See.only(serverPlayer), ChangePriority.CHANGE_LATE,&#xD;
             new DiplomacyMessage(ourUnit, otherColony, &#xD;
                                  session.getAgreement()));&#xD;
     }&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoCDulJQEeiyW7NaN4qWdw" name="europeanFirstContact" specification="_QlSRoFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoCDu1JQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoCDvFJQEeiyW7NaN4qWdw" name="ourColony" type="_QiYuoVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoCDvVJQEeiyW7NaN4qWdw" name="otherUnit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoCDvlJQEeiyW7NaN4qWdw" name="agreement" type="_Qiaj0FJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoCDv1JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>ChangeSet cs = new ChangeSet();&#xD;
     DiplomacySession session&#xD;
         = TransactionSession.lookup(DiplomacySession.class,&#xD;
                                     otherUnit, ourColony);&#xD;
     if (session == null) {&#xD;
         return DOMMessage.clientError(&quot;Missing cu1-diplomacy session for &quot;&#xD;
             + ourColony.getId() + &quot;,&quot; + otherUnit.getId()&#xD;
             + &quot; with &quot; + agreement);&#xD;
     }&#xD;
     ServerPlayer otherPlayer = (ServerPlayer)otherUnit.getOwner();&#xD;
     if (csDiplomacySession(serverPlayer, otherPlayer,&#xD;
             agreement, session,&#xD;
             new DiplomacyMessage(otherUnit, ourColony, agreement), cs)) {&#xD;
         cs.add(See.only(serverPlayer), ChangePriority.CHANGE_LATE,&#xD;
             new DiplomacyMessage(ourColony, otherUnit,&#xD;
                                  session.getAgreement()));&#xD;
     }&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoCqsFJQEeiyW7NaN4qWdw" name="diplomacy" specification="_QlTfwFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoCqsVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoCqslJQEeiyW7NaN4qWdw" name="ourUnit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoCqs1JQEeiyW7NaN4qWdw" name="otherColony" type="_QiYuoVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoCqtFJQEeiyW7NaN4qWdw" name="agreement" type="_Qiaj0FJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoCqtVJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>ChangeSet cs = new ChangeSet();&#xD;
     TradeStatus status = agreement.getStatus();&#xD;
     DiplomacySession session&#xD;
         = TransactionSession.lookup(DiplomacySession.class,&#xD;
                                     ourUnit, otherColony);&#xD;
     if (session == null) {&#xD;
         if (status != TradeStatus.PROPOSE_TRADE) {&#xD;
             return DOMMessage.clientError(&quot;Mission uc-diplomacy session for &quot;&#xD;
                 + ourUnit.getId() + &quot;/&quot; + otherColony.getId()&#xD;
                 + &quot; with &quot; + agreement);&#xD;
         }&#xD;
         session = new DiplomacySession(ourUnit, otherColony);&#xD;
     }&#xD;
     ServerPlayer otherPlayer = (ServerPlayer)otherColony.getOwner();&#xD;
     if (csDiplomacySession(serverPlayer, otherPlayer, agreement, session,&#xD;
             new DiplomacyMessage(otherColony, ourUnit, agreement), cs)) {&#xD;
         cs.add(See.only(serverPlayer), ChangePriority.CHANGE_LATE,&#xD;
             new DiplomacyMessage(ourUnit, otherColony, &#xD;
                                  session.getAgreement()));&#xD;
     }&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoCqtlJQEeiyW7NaN4qWdw" name="diplomacy" specification="_QlUt4FJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoCqt1JQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoCquFJQEeiyW7NaN4qWdw" name="ourColony" type="_QiYuoVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoCquVJQEeiyW7NaN4qWdw" name="otherUnit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoCqulJQEeiyW7NaN4qWdw" name="agreement" type="_Qiaj0FJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoCqu1JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>ChangeSet cs = new ChangeSet();&#xD;
     DiplomacySession session&#xD;
         = TransactionSession.lookup(DiplomacySession.class,&#xD;
                                     otherUnit, ourColony);&#xD;
     if (session == null) {&#xD;
         return DOMMessage.clientError(&quot;Mission cu-diplomacy session for &quot;&#xD;
             + otherUnit.getId() + &quot;/&quot; + ourColony.getId()&#xD;
             + &quot; with &quot; + agreement);&#xD;
     }&#xD;
     ServerPlayer otherPlayer = (ServerPlayer)otherUnit.getOwner();&#xD;
     if (csDiplomacySession(serverPlayer, otherPlayer, agreement, session,&#xD;
             new DiplomacyMessage(otherUnit, ourColony, agreement), cs)) {&#xD;
         cs.add(See.only(serverPlayer), ChangePriority.CHANGE_LATE,&#xD;
             new DiplomacyMessage(ourColony, otherUnit,&#xD;
                                  session.getAgreement()));&#xD;
     }&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoCqvFJQEeiyW7NaN4qWdw" name="spySettlement" specification="_QlVU8FJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoCqvVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoCqvlJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoCqv1JQEeiyW7NaN4qWdw" name="settlement" type="_QitewVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoCqwFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>ChangeSet cs = new ChangeSet();&#xD;
&#xD;
     cs.addSpy(See.only(serverPlayer), settlement);&#xD;
     unit.setMovesLeft(0);&#xD;
     cs.addPartial(See.only(serverPlayer), unit, &quot;movesLeft&quot;);&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoCqwVJQEeiyW7NaN4qWdw" name="work" specification="_QlWjEFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoCqwlJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoCqw1JQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoCqxFJQEeiyW7NaN4qWdw" name="workLocation" type="_Qi2BoFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoCqxVJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final Specification spec = getGame().getSpecification();&#xD;
     final Colony colony = workLocation.getColony();&#xD;
     colony.getGoodsContainer().saveState();&#xD;
&#xD;
     ChangeSet cs = new ChangeSet();&#xD;
     if (workLocation instanceof ColonyTile) {&#xD;
         Tile tile = ((ColonyTile) workLocation).getWorkTile();&#xD;
         if (tile.getOwningSettlement() != colony) {&#xD;
             // Claim known free land (because canAdd() succeeded).&#xD;
             serverPlayer.csClaimLand(tile, colony, 0, cs);&#xD;
         }&#xD;
     }&#xD;
&#xD;
     colony.equipForRole(unit, spec.getDefaultRole(), 0);&#xD;
&#xD;
     // Check for upgrade.&#xD;
     UnitType newType = unit.getTypeChange(ChangeType.ENTER_COLONY,&#xD;
                                           unit.getOwner());&#xD;
     if (newType != null) unit.changeType(newType);//-vis: safe in colony&#xD;
&#xD;
     // Change the location.&#xD;
     // We could avoid updating the whole tile if we knew that this&#xD;
     // was definitely a move between locations and no student/teacher&#xD;
     // interaction occurred.&#xD;
     if (!unit.isInColony()) unit.getColony().getTile().cacheUnseen();//+til&#xD;
     unit.setLocation(workLocation);//-vis: safe/colony,-til if not in colony&#xD;
     cs.add(See.perhaps(), colony.getTile());&#xD;
     // Others can see colony change size&#xD;
     getGame().sendToOthers(serverPlayer, cs);&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoCqxlJQEeiyW7NaN4qWdw" name="lootCargo" specification="_QlXKIFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoCqx1JQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoCqyFJQEeiyW7NaN4qWdw" name="winner" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoCqyVJQEeiyW7NaN4qWdw" name="loserId">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QoCqylJQEeiyW7NaN4qWdw" name="loot" type="_QhldYVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoCqy1JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>LootSession session = TransactionSession.lookup(LootSession.class,&#xD;
         winner.getId(), loserId);&#xD;
     if (session == null) {&#xD;
         return DOMMessage.clientError(&quot;Bogus looting!&quot;);&#xD;
     }&#xD;
     if (!winner.hasSpaceLeft()) {&#xD;
         return DOMMessage.clientError(&quot;No space to loot to: &quot;&#xD;
             + winner.getId());&#xD;
     }&#xD;
&#xD;
     ChangeSet cs = new ChangeSet();&#xD;
     List&lt;Goods> available = session.getCapture();&#xD;
     if (loot == null) { // Initial inquiry&#xD;
         cs.add(See.only(serverPlayer), ChangePriority.CHANGE_LATE,&#xD;
                new LootCargoMessage(winner, loserId, available));&#xD;
     } else {&#xD;
         for (Goods g : loot) {&#xD;
             if (!available.contains(g)) {&#xD;
                 return DOMMessage.clientError(&quot;Invalid loot: &quot; + g);&#xD;
             }&#xD;
             available.remove(g);&#xD;
             if (!winner.canAdd(g)) {&#xD;
                 return DOMMessage.clientError(&quot;Loot failed: &quot; + g);&#xD;
             }&#xD;
             winner.add(g);&#xD;
         }&#xD;
&#xD;
         // Others can see cargo capacity change.&#xD;
         session.complete(cs);&#xD;
         cs.add(See.perhaps(), winner);&#xD;
         getGame().sendToOthers(serverPlayer, cs);&#xD;
     }&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoCqzFJQEeiyW7NaN4qWdw" name="payArrears" specification="_QlY_UFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoCqzVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoCqzlJQEeiyW7NaN4qWdw" name="type" type="_QigDYVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoCqz1JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>int arrears = serverPlayer.getArrears(type);&#xD;
     if (arrears &lt;= 0) {&#xD;
         return DOMMessage.clientError(&quot;No arrears for pay for: &quot;&#xD;
             + type.getId());&#xD;
     } else if (!serverPlayer.checkGold(arrears)) {&#xD;
         return DOMMessage.clientError(&quot;Not enough gold to pay arrears for: &quot;&#xD;
             + type.getId());&#xD;
     }&#xD;
&#xD;
     ChangeSet cs = new ChangeSet();&#xD;
     Market market = serverPlayer.getMarket();&#xD;
     serverPlayer.modifyGold(-arrears);&#xD;
     market.setArrears(type, 0);&#xD;
     cs.addPartial(See.only(serverPlayer), serverPlayer, &quot;gold&quot;);&#xD;
     cs.add(See.only(serverPlayer), market.getMarketData(type));&#xD;
     // Arrears payment is private.&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoDRwFJQEeiyW7NaN4qWdw" name="equipForRole" specification="_QlaNcFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoDRwVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoDRwlJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoDRw1JQEeiyW7NaN4qWdw" name="role" type="_QizlYVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoDRxFJQEeiyW7NaN4qWdw" name="roleCount">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QoDRxVJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>ChangeSet cs = new ChangeSet();&#xD;
     boolean ret = false;&#xD;
     if (unit.isInEurope()) {&#xD;
         ServerEurope serverEurope = (ServerEurope)serverPlayer.getEurope();&#xD;
         ret = serverEurope.csEquipForRole(unit, role, roleCount,&#xD;
                                           random, cs);&#xD;
     } else if (unit.getColony() != null) {&#xD;
         ServerColony serverColony = (ServerColony)unit.getColony();&#xD;
         ret = serverColony.csEquipForRole(unit, role, roleCount,&#xD;
                                           random, cs);&#xD;
     } else if (unit.getIndianSettlement() != null) {&#xD;
         ServerIndianSettlement sis = (ServerIndianSettlement)unit.getIndianSettlement();&#xD;
         ret = sis.csEquipForRole(unit, role, roleCount, random, cs);&#xD;
     } else {&#xD;
         return DOMMessage.clientError(&quot;Unsuitable equip location for: &quot;&#xD;
             + unit.getId());&#xD;
     }&#xD;
     if (!ret) return null;&#xD;
&#xD;
     if (unit.getInitialMovesLeft() != unit.getMovesLeft()) {&#xD;
         unit.setMovesLeft(0);&#xD;
     }&#xD;
     Unit carrier = unit.getCarrier();&#xD;
     if (carrier != null&#xD;
         &amp;&amp; carrier.getInitialMovesLeft() != carrier.getMovesLeft()&#xD;
         &amp;&amp; carrier.getMovesLeft() != 0) {&#xD;
         carrier.setMovesLeft(0);&#xD;
     }&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoDRxlJQEeiyW7NaN4qWdw" name="payForBuilding" specification="_QlbbkFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoDRx1JQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoDRyFJQEeiyW7NaN4qWdw" name="colony" type="_QiYuoVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoDRyVJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>if (!getGame().getSpecification()&#xD;
         .getBoolean(GameOptions.PAY_FOR_BUILDING)) {&#xD;
         return DOMMessage.clientError(&quot;Pay for building is disabled&quot;);&#xD;
     }&#xD;
&#xD;
     BuildableType build = colony.getCurrentlyBuilding();&#xD;
     if (build == null) {&#xD;
         return DOMMessage.clientError(&quot;Colony &quot; + colony.getId()&#xD;
             + &quot; is not building anything!&quot;);&#xD;
     }&#xD;
     List&lt;AbstractGoods> required = colony.getRequiredGoods(build);&#xD;
     int price = colony.priceGoodsForBuilding(required);&#xD;
     if (!serverPlayer.checkGold(price)) {&#xD;
         return DOMMessage.clientError(&quot;Insufficient funds to pay for build.&quot;);&#xD;
     }&#xD;
&#xD;
     // Save the correct final gold for the player, as we are going to&#xD;
     // use buy() below, but it deducts the normal uninflated price for&#xD;
     // the goods being bought.  We restore this correct amount later.&#xD;
     int savedGold = serverPlayer.modifyGold(-price);&#xD;
     serverPlayer.modifyGold(price);&#xD;
&#xD;
     ChangeSet cs = new ChangeSet();&#xD;
     GoodsContainer container = colony.getGoodsContainer();&#xD;
     container.saveState();&#xD;
     for (AbstractGoods ag : required) {&#xD;
         GoodsType type = ag.getType();&#xD;
         int amount = ag.getAmount();&#xD;
         if (type.isStorable()) {&#xD;
             // FIXME: should also check canTrade(type, Access.?)&#xD;
             if ((amount = serverPlayer.buy(container, type, amount)) &lt; 0) {&#xD;
                 return DOMMessage.clientError(&quot;Can not buy &quot; + amount&#xD;
                     + &quot; &quot; + type + &quot; for &quot; + build);&#xD;
             }&#xD;
             serverPlayer.propagateToEuropeanMarkets(type, -amount, random);&#xD;
             serverPlayer.csFlushMarket(type, cs);&#xD;
         } else {&#xD;
             container.addGoods(type, amount);&#xD;
         }&#xD;
     }&#xD;
     colony.invalidateCache();&#xD;
&#xD;
     // Nothing to see for others, colony internal.&#xD;
     serverPlayer.setGold(savedGold);&#xD;
     cs.addPartial(See.only(serverPlayer), serverPlayer, &quot;gold&quot;);&#xD;
     cs.add(See.only(serverPlayer), container);&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoDRylJQEeiyW7NaN4qWdw" name="indianDemand" specification="_QlcCoFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoDRy1JQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw">
                    <eAnnotations xmi:id="_QoDRzFJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                      <details xmi:id="_QoDRzVJQEeiyW7NaN4qWdw" key="final"/>
                    </eAnnotations>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QoDRzlJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoDRz1JQEeiyW7NaN4qWdw" name="colony" type="_QiYuoVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoDR0FJQEeiyW7NaN4qWdw" name="type" type="_QigDYVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoDR0VJQEeiyW7NaN4qWdw" name="amount">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QoDR0lJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final Game game = getGame();&#xD;
     final Specification spec = game.getSpecification();&#xD;
     ServerPlayer victim = (ServerPlayer) colony.getOwner();&#xD;
     int difficulty = spec.getInteger(GameOptions.NATIVE_DEMANDS);&#xD;
     ChangeSet cs = new ChangeSet();&#xD;
&#xD;
     DOMMessage reply = askTimeout(victim,&#xD;
         new IndianDemandMessage(unit, colony, type, amount));&#xD;
     boolean result = (reply instanceof IndianDemandMessage)&#xD;
         ? ((IndianDemandMessage)reply).getResult()&#xD;
         : false;&#xD;
     logger.info(serverPlayer.getName() + &quot; unit &quot; + unit&#xD;
         + &quot; demands &quot; + amount + &quot; &quot; + ((type == null) ? &quot;gold&quot; : type)&#xD;
         + &quot; from &quot; + colony.getName() + &quot; accepted: &quot; + result);&#xD;
&#xD;
     IndianDemandMessage message = new IndianDemandMessage(unit, colony,&#xD;
                                                           type, amount);&#xD;
     message.setResult(result);&#xD;
     cs.add(See.only(serverPlayer), ChangePriority.CHANGE_NORMAL, message);&#xD;
     if (result) {&#xD;
         if (type == null) {&#xD;
             victim.modifyGold(-amount);&#xD;
             serverPlayer.modifyGold(amount);&#xD;
             cs.addPartial(See.only(victim), victim, &quot;gold&quot;);&#xD;
             //cs.addPartial(See.only(serverPlayer), serverPlayer, &quot;gold&quot;);&#xD;
         } else {&#xD;
             GoodsContainer colonyContainer = colony.getGoodsContainer();&#xD;
             colonyContainer.saveState();&#xD;
             GoodsContainer unitContainer = unit.getGoodsContainer();&#xD;
             unitContainer.saveState();&#xD;
             moveGoods(colony, type, amount, unit);&#xD;
             cs.add(See.only(victim), colonyContainer);&#xD;
             //cs.add(See.only(serverPlayer), unitContainer);&#xD;
         }&#xD;
         int tension = -(5 - difficulty) * 50;&#xD;
         ServerIndianSettlement is = (ServerIndianSettlement)&#xD;
             unit.getHomeIndianSettlement();&#xD;
         if (is == null) {&#xD;
             serverPlayer.csModifyTension(victim, tension, cs);&#xD;
         } else {&#xD;
             is.csModifyAlarm(victim, tension, true, cs);&#xD;
         }&#xD;
     }&#xD;
&#xD;
     getGame().sendToOthers(serverPlayer, cs);&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoDR01JQEeiyW7NaN4qWdw" name="trainUnitInEurope" specification="_Qld30FJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoDR1FJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoDR1VJQEeiyW7NaN4qWdw" name="type" type="_Qi0zgVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoDR1lJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>Europe europe = serverPlayer.getEurope();&#xD;
     if (europe == null) {&#xD;
         return DOMMessage.clientError(&quot;No Europe to train in.&quot;);&#xD;
     }&#xD;
     int price = europe.getUnitPrice(type);&#xD;
     if (price &lt;= 0) {&#xD;
         return DOMMessage.clientError(&quot;Bogus price: &quot; + price);&#xD;
     } else if (!serverPlayer.checkGold(price)) {&#xD;
         return DOMMessage.clientError(&quot;Not enough gold (&quot;&#xD;
             + serverPlayer.getGold() + &quot; &lt; &quot; + price&#xD;
             + &quot;) to train &quot; + type);&#xD;
     }&#xD;
&#xD;
     final Game game = getGame();&#xD;
     final Specification spec = game.getSpecification();&#xD;
     Role role = (spec.getBoolean(GameOptions.EQUIP_EUROPEAN_RECRUITS))&#xD;
         ? type.getDefaultRole()&#xD;
         : spec.getDefaultRole();&#xD;
     Unit unit = new ServerUnit(game, europe, serverPlayer, type,&#xD;
                                role);//-vis: safe, Europe&#xD;
     unit.setName(serverPlayer.getNameForUnit(type, random));&#xD;
     serverPlayer.modifyGold(-price);&#xD;
     ((ServerEurope)europe).increasePrice(type, price);&#xD;
&#xD;
     // Only visible in Europe&#xD;
     ChangeSet cs = new ChangeSet();&#xD;
     cs.addPartial(See.only(serverPlayer), serverPlayer, &quot;gold&quot;);&#xD;
     cs.add(See.only(serverPlayer), europe);&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoD40FJQEeiyW7NaN4qWdw" name="setBuildQueue" specification="_QlfF8FJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoD40VJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoD40lJQEeiyW7NaN4qWdw" name="colony" type="_QiYuoVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoD401JQEeiyW7NaN4qWdw" name="queue" type="_QhldYVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoD41FJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>BuildableType current = colony.getCurrentlyBuilding();&#xD;
     colony.setBuildQueue(queue);&#xD;
     if (getGame().getSpecification()&#xD;
         .getBoolean(GameOptions.CLEAR_HAMMERS_ON_CONSTRUCTION_SWITCH)&#xD;
         &amp;&amp; current != colony.getCurrentlyBuilding()) {&#xD;
         for (AbstractGoods ag : current.getRequiredGoods()) {&#xD;
             if (!ag.getType().isStorable()) {&#xD;
                 colony.removeGoods(ag.getType());&#xD;
             }&#xD;
         }&#xD;
     }&#xD;
     colony.invalidateCache();&#xD;
&#xD;
     // Only visible to player.&#xD;
     ChangeSet cs = new ChangeSet();&#xD;
     cs.add(See.only(serverPlayer), colony);&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoD41VJQEeiyW7NaN4qWdw" name="setGoodsLevels" specification="_QlhiMFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoD41lJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoD411JQEeiyW7NaN4qWdw" name="colony" type="_QiYuoVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoD42FJQEeiyW7NaN4qWdw" name="exportData" type="_QidAEVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoD42VJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>colony.setExportData(exportData);&#xD;
     return new ChangeSet().add(See.only(serverPlayer), colony)&#xD;
         .build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoD42lJQEeiyW7NaN4qWdw" name="putOutsideColony" specification="_QliwUFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoD421JQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoD43FJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoD43VJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>Tile tile = unit.getTile();&#xD;
     Colony colony = unit.getColony();&#xD;
     if (unit.isInColony()) tile.cacheUnseen();//+til&#xD;
     unit.setLocation(tile);//-vis: safe/colony,-til if in colony&#xD;
&#xD;
     // Full tile update for the player, the rest get their limited&#xD;
     // view of the colony so that population changes.&#xD;
     ChangeSet cs = new ChangeSet();&#xD;
     cs.add(See.only(serverPlayer), tile);&#xD;
     cs.add(See.perhaps().except(serverPlayer), colony);&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoD43lJQEeiyW7NaN4qWdw" name="changeWorkType" specification="_Qlj-cFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoD431JQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoD44FJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoD44VJQEeiyW7NaN4qWdw" name="type" type="_QigDYVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoD44lJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>if (unit.getWorkType() != type) {&#xD;
         unit.setExperience(0);&#xD;
         unit.changeWorkType(type);&#xD;
     }&#xD;
&#xD;
     // Private update of the colony.&#xD;
     return new ChangeSet().add(See.only(serverPlayer), unit.getColony())&#xD;
         .build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoD441JQEeiyW7NaN4qWdw" name="changeWorkImprovementType" specification="_QlklgFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoD45FJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoD45VJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoD45lJQEeiyW7NaN4qWdw" name="type" type="_QiwiEVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoD451JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>Tile tile = unit.getTile();&#xD;
     TileImprovement improvement = tile.getTileImprovement(type);&#xD;
     if (improvement == null) { // Create the new improvement.&#xD;
         improvement = new TileImprovement(getGame(), tile, type);&#xD;
         tile.add(improvement);&#xD;
     }&#xD;
&#xD;
     unit.setWorkImprovement(improvement);&#xD;
     unit.setState(UnitState.IMPROVING);&#xD;
&#xD;
     // Private update of the tile.&#xD;
     return new ChangeSet().add(See.only(serverPlayer), tile)&#xD;
         .build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoD46FJQEeiyW7NaN4qWdw" name="changeState" specification="_QllzoFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoD46VJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoD46lJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoD461JQEeiyW7NaN4qWdw" name="state" type="_QizlY1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoD47FJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>ChangeSet cs = new ChangeSet();&#xD;
&#xD;
     Tile tile = unit.getTile();&#xD;
     boolean tileDirty = tile != null &amp;&amp; tile.getIndianSettlement() != null;&#xD;
     if (state == UnitState.FORTIFYING &amp;&amp; tile != null) {&#xD;
         ServerColony colony = (tile.getOwningSettlement() instanceof Colony)&#xD;
             ? (ServerColony) tile.getOwningSettlement()&#xD;
             : null;&#xD;
         Player owner = (colony == null) ? null : colony.getOwner();&#xD;
         if (owner != null&#xD;
             &amp;&amp; owner != unit.getOwner()&#xD;
             &amp;&amp; serverPlayer.getStance(owner) != Stance.ALLIANCE&#xD;
             &amp;&amp; serverPlayer.getStance(owner) != Stance.PEACE) {&#xD;
             if (colony.isTileInUse(tile)) {&#xD;
                 colony.csEvictUsers(unit, cs);&#xD;
             }&#xD;
             if (serverPlayer.getStance(owner) == Stance.WAR) {&#xD;
                 tile.changeOwnership(null, null); // Clear owner if at war&#xD;
                 tileDirty = true;&#xD;
             }&#xD;
         }&#xD;
     }&#xD;
&#xD;
     unit.setState(state);&#xD;
     if (tileDirty) {&#xD;
         cs.add(See.perhaps(), tile);&#xD;
     } else {&#xD;
         cs.add(See.perhaps(), (FreeColGameObject)unit.getLocation());&#xD;
     }&#xD;
&#xD;
     // Others might be able to see the unit.&#xD;
     getGame().sendToOthers(serverPlayer, cs);&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoD47VJQEeiyW7NaN4qWdw" name="assignTeacher" specification="_QlmasFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoD47lJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoD471JQEeiyW7NaN4qWdw" name="student" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoD48FJQEeiyW7NaN4qWdw" name="teacher" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoD48VJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>Unit oldStudent = teacher.getStudent();&#xD;
     Unit oldTeacher = student.getTeacher();&#xD;
&#xD;
     // Only update units that changed their teaching situation.&#xD;
     ChangeSet cs = new ChangeSet();&#xD;
     if (oldTeacher != null) {&#xD;
         oldTeacher.setStudent(null);&#xD;
         cs.add(See.only(serverPlayer), oldTeacher);&#xD;
     }&#xD;
     if (oldStudent != null) {&#xD;
         oldStudent.setTeacher(null);&#xD;
         cs.add(See.only(serverPlayer), oldStudent);&#xD;
     }&#xD;
     teacher.setStudent(student);&#xD;
     teacher.changeWorkType(null);&#xD;
     student.setTeacher(teacher);&#xD;
     cs.add(See.only(serverPlayer), student, teacher);&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoEf4FJQEeiyW7NaN4qWdw" name="assignTradeRoute" specification="_QlnBwFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoEf4VJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoEf4lJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoEf41JQEeiyW7NaN4qWdw" name="tradeRoute" type="_QixwMVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoEf5FJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>// If clearing a trade route and the unit is at sea, set&#xD;
     // the destination to the next stop.  Otherwise just clear&#xD;
     // the destination.&#xD;
     TradeRouteStop stop;&#xD;
     unit.setDestination((tradeRoute == null &amp;&amp; unit.isAtSea()&#xD;
             &amp;&amp; (stop = unit.getStop()) != null) ? stop.getLocation()&#xD;
         : null);&#xD;
     unit.setTradeRoute(tradeRoute);&#xD;
     if (tradeRoute != null) {&#xD;
         List&lt;TradeRouteStop> stops = tradeRoute.getStops();&#xD;
         int found = -1;&#xD;
         for (int i = 0; i &lt; stops.size(); i++) {&#xD;
             if (Map.isSameLocation(unit.getLocation(),&#xD;
                                    stops.get(i).getLocation())) {&#xD;
                 found = i;&#xD;
                 break;&#xD;
             }&#xD;
         }&#xD;
         if (found &lt; 0) found = 0;&#xD;
         unit.setCurrentStop(found);&#xD;
     }&#xD;
&#xD;
     // Only visible to the player&#xD;
     return new ChangeSet().add(See.only(serverPlayer), unit)&#xD;
         .build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoEf5VJQEeiyW7NaN4qWdw" name="setTradeRoutes" specification="_QloP4FJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoEf5lJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoEf51JQEeiyW7NaN4qWdw" name="routes" type="_QhldYVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoEf6FJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>serverPlayer.setTradeRoutes(routes);&#xD;
     // Have to update the whole player alas.&#xD;
     return new ChangeSet().add(See.only(serverPlayer), serverPlayer)&#xD;
         .build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoEf6VJQEeiyW7NaN4qWdw" name="getNewTradeRoute" specification="_QlpeAFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoEf6lJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoEf61JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>List&lt;TradeRoute> routes = serverPlayer.getTradeRoutes();&#xD;
     TradeRoute route = new TradeRoute(getGame(), &#xD;
         serverPlayer.getNameForTradeRoute(), serverPlayer);&#xD;
     routes.add(route);&#xD;
     return new ChangeSet().addTradeRoute(serverPlayer, route)&#xD;
         .build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoEf7FJQEeiyW7NaN4qWdw" name="getREFUnits" specification="_QlpeA1JQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoEf7VJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoEf7lJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final Game game = getGame();&#xD;
     final Specification spec = game.getSpecification();&#xD;
     List&lt;AbstractUnit> units = new ArrayList&lt;>();&#xD;
     final UnitType defaultType = spec.getDefaultUnitType(serverPlayer);&#xD;
&#xD;
     if (serverPlayer.getPlayerType() == PlayerType.COLONIAL) {&#xD;
         units = serverPlayer.getMonarch().getExpeditionaryForce().getUnits();&#xD;
     } else {&#xD;
         ServerPlayer REFPlayer = (ServerPlayer) serverPlayer.getREFPlayer();&#xD;
         java.util.Map&lt;UnitType, HashMap&lt;String, Integer>> unitHash&#xD;
             = new HashMap&lt;>();&#xD;
         for (Unit unit : REFPlayer.getUnits()) {&#xD;
             if (unit.isOffensiveUnit()) {&#xD;
                 UnitType unitType = defaultType;&#xD;
                 if (unit.getType().getOffence() > 0&#xD;
                     || unit.hasAbility(Ability.EXPERT_SOLDIER)) {&#xD;
                     unitType = unit.getType();&#xD;
                 }&#xD;
                 HashMap&lt;String, Integer> roleMap = unitHash.get(unitType);&#xD;
                 if (roleMap == null) roleMap = new HashMap&lt;>();&#xD;
                 String roleId = unit.getRole().getId();&#xD;
                 Integer count = roleMap.get(roleId);&#xD;
                 roleMap.put(roleId, (count == null) ? 1&#xD;
                         : count + 1);&#xD;
                 unitHash.put(unitType, roleMap);&#xD;
             }&#xD;
         }&#xD;
         for (java.util.Map.Entry&lt;UnitType, HashMap&lt;String, Integer>> typeEntry : unitHash.entrySet()) {&#xD;
             for (java.util.Map.Entry&lt;String, Integer> roleEntry : typeEntry.getValue().entrySet()) {&#xD;
                 units.add(new AbstractUnit(typeEntry.getKey(), roleEntry.getKey(), roleEntry.getValue()));&#xD;
             }&#xD;
         }&#xD;
     }&#xD;
&#xD;
     ChangeSet cs = new ChangeSet();&#xD;
     cs.addTrivial(See.only(serverPlayer), &quot;getREFUnits&quot;,&#xD;
                   ChangePriority.CHANGE_NORMAL);&#xD;
     Element reply = cs.build(serverPlayer);&#xD;
     // FIXME: eliminate explicit Element hackery&#xD;
     for (AbstractUnit unit : units) {&#xD;
         reply.appendChild(unit.toXMLElement(reply.getOwnerDocument()));&#xD;
     }&#xD;
     return reply;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoEf71JQEeiyW7NaN4qWdw" name="getHighScores" specification="_QlqFElJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoEf8FJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoEf8VJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>List&lt;HighScore> scores = HighScore.loadHighScores();&#xD;
     ChangeSet cs = new ChangeSet();&#xD;
     cs.addTrivial(See.only(serverPlayer), &quot;getHighScores&quot;,&#xD;
                   ChangePriority.CHANGE_NORMAL);&#xD;
     Element reply = cs.build(serverPlayer);&#xD;
     if (scores != null) {&#xD;
         for (HighScore score : scores) {&#xD;
             reply.appendChild(score.toXMLElement(reply.getOwnerDocument()));&#xD;
         }&#xD;
     }&#xD;
     return reply;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoEf8lJQEeiyW7NaN4qWdw" name="chat" specification="_QlqsIVJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoEf81JQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoEf9FJQEeiyW7NaN4qWdw" name="message">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QoEf9VJQEeiyW7NaN4qWdw" name="pri">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QoEf9lJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>getGame().sendToOthers(serverPlayer, new ChangeSet()&#xD;
         .add(See.all().except(serverPlayer),&#xD;
              ChangeSet.ChangePriority.CHANGE_NORMAL,&#xD;
              new ChatMessage(serverPlayer, message, false)));&#xD;
     return null;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoEf91JQEeiyW7NaN4qWdw" name="getStatistics" specification="_QlrTMVJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoEf-FJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoEf-VJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>// Convert statistics map to a list.&#xD;
     java.util.Map&lt;String, String> stats = getGame()&#xD;
         .getStatistics();&#xD;
&#xD;
     stats.putAll(getFreeColServer().getAIMain().getAIStatistics());&#xD;
&#xD;
     List&lt;String> all = new ArrayList&lt;>();&#xD;
     for (Entry&lt;String, String> e : mapEntriesByKey(stats)) {&#xD;
         all.add(e.getKey());&#xD;
         all.add(e.getValue());&#xD;
     }&#xD;
&#xD;
     // Return as statistics element.&#xD;
     ChangeSet cs = new ChangeSet();&#xD;
     cs.addTrivial(See.only(serverPlayer), &quot;statistics&quot;,&#xD;
                   ChangePriority.CHANGE_NORMAL,&#xD;
                   all.toArray(new String[0]));&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoEf-lJQEeiyW7NaN4qWdw" name="enterRevengeMode" specification="_Qlr6QVJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoEf-1JQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoEf_FJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>if (!getFreeColServer().getSinglePlayer()) {&#xD;
         return DOMMessage.clientError(&quot;Can not enter revenge mode,&quot;&#xD;
             + &quot; as this is not a single player game.&quot;);&#xD;
     }&#xD;
     Game game = getGame();&#xD;
     List&lt;UnitType> undeads = game.getSpecification()&#xD;
         .getUnitTypesWithAbility(Ability.UNDEAD);&#xD;
     List&lt;UnitType> navalUnits = new ArrayList&lt;>();&#xD;
     List&lt;UnitType> landUnits = new ArrayList&lt;>();&#xD;
     for (UnitType undead : undeads) {&#xD;
         if (undead.hasAbility(Ability.NAVAL_UNIT)) {&#xD;
             navalUnits.add(undead);&#xD;
         } else if (undead.hasAbility(Ability.MULTIPLE_ATTACKS)) {&#xD;
             landUnits.add(undead);&#xD;
         }&#xD;
     }&#xD;
     if (navalUnits.isEmpty() || landUnits.isEmpty()) {&#xD;
         return DOMMessage.clientError(&quot;Can not enter revenge mode,&quot;&#xD;
             + &quot; because we can not find the undead units.&quot;);&#xD;
     }&#xD;
&#xD;
     ChangeSet cs = new ChangeSet();&#xD;
     UnitType navalType = getRandomMember(logger, &quot;Choose undead navy&quot;,&#xD;
                                          navalUnits, random);&#xD;
     Tile start = ((Tile)serverPlayer.getEntryLocation())&#xD;
         .getSafeTile(serverPlayer, random);&#xD;
     Unit theFlyingDutchman&#xD;
         = new ServerUnit(game, start, serverPlayer,&#xD;
                          navalType);//-vis(serverPlayer)&#xD;
     UnitType landType = getRandomMember(logger, &quot;Choose undead army&quot;,&#xD;
                                         landUnits, random);&#xD;
     new ServerUnit(game, theFlyingDutchman, serverPlayer, landType);//-vis&#xD;
     serverPlayer.setDead(false);&#xD;
     serverPlayer.changePlayerType(PlayerType.UNDEAD);&#xD;
     serverPlayer.invalidateCanSeeTiles();//+vis(serverPlayer)&#xD;
&#xD;
     // No one likes the undead.&#xD;
     for (Player p : game.getLivePlayers(serverPlayer)) {&#xD;
         if (serverPlayer.hasContacted(p)) {&#xD;
             serverPlayer.csChangeStance(Stance.WAR, (ServerPlayer)p,&#xD;
                                         true, cs);&#xD;
         }&#xD;
     }&#xD;
&#xD;
     // Revenge begins&#xD;
     game.setCurrentPlayer(serverPlayer);&#xD;
     cs.addTrivial(See.all(), &quot;setCurrentPlayer&quot;,&#xD;
                   ChangePriority.CHANGE_LATE,&#xD;
                   &quot;player&quot;, serverPlayer.getId());&#xD;
&#xD;
     // Others can tell something has happened to the player,&#xD;
     // and possibly see the units.&#xD;
     cs.add(See.all(), serverPlayer);&#xD;
     cs.add(See.perhaps(), start);&#xD;
     getGame().sendToOthers(serverPlayer, cs);&#xD;
     return cs.build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoFG8FJQEeiyW7NaN4qWdw" name="rearrangeColony" specification="_QlshUFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoFG8VJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoFG8lJQEeiyW7NaN4qWdw" name="colony" type="_QiYuoVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoFG81JQEeiyW7NaN4qWdw" name="unitChanges" type="_QhldYVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoFG9FJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final Role defaultRole = getGame().getSpecification().getDefaultRole();&#xD;
     Tile tile = colony.getTile();&#xD;
     tile.cacheUnseen();//+til&#xD;
&#xD;
     // Move everyone out of the way and stockpile their equipment.&#xD;
     for (UnitChange uc : unitChanges) {&#xD;
         uc.unit.setLocation(tile);//-til&#xD;
         if (!uc.unit.hasDefaultRole()) {&#xD;
             colony.equipForRole(uc.unit, defaultRole, 0);&#xD;
         }&#xD;
     }&#xD;
&#xD;
     List&lt;UnitChange> todo = new ArrayList&lt;>(unitChanges);&#xD;
     while (!todo.isEmpty()) {&#xD;
         UnitChange uc = todo.remove(0);&#xD;
         if (uc.loc == tile) continue;&#xD;
         WorkLocation wl = (WorkLocation)uc.loc;&#xD;
         // Adding to wl can fail, and in the worst case there&#xD;
         // might be a circular dependency.  If the move can&#xD;
         // succeed, do it, but if not, retry.&#xD;
         switch (wl.getNoAddReason(uc.unit)) {&#xD;
         case NONE:&#xD;
             uc.unit.setLocation(wl);&#xD;
             // Fall through&#xD;
         case ALREADY_PRESENT:&#xD;
             if (uc.unit.getWorkType() != uc.work) {&#xD;
                 uc.unit.changeWorkType(uc.work);&#xD;
             }&#xD;
             break;&#xD;
         case CAPACITY_EXCEEDED:&#xD;
             todo.add(todo.size(), uc);&#xD;
             break;&#xD;
         default:&#xD;
             logger.warning(&quot;Bad move for &quot; + uc.unit + &quot; to &quot; + wl);&#xD;
             break;&#xD;
         }&#xD;
     }&#xD;
&#xD;
     Iterator&lt;UnitChange> uci = unitChanges.iterator();&#xD;
     while (uci.hasNext()) {&#xD;
         UnitChange uc = uci.next();&#xD;
         if (uc.unit.getRole() == uc.role) uci.remove();&#xD;
     }&#xD;
     if (!unitChanges.isEmpty()) {&#xD;
         Collections.sort(unitChanges,&#xD;
                          RearrangeColonyMessage.roleComparator);&#xD;
         Collections.reverse(unitChanges);&#xD;
         for (UnitChange uc : unitChanges) {&#xD;
             if (uc.role != defaultRole) {&#xD;
                 if (!colony.equipForRole(uc.unit, uc.role, uc.roleCount)) {&#xD;
                     // Should not happen if we equip simplest first&#xD;
                     return DOMMessage.clientError(&quot;Failed to equip &quot;&#xD;
                         + uc.unit.getId() + &quot; for role &quot; + uc.role&#xD;
                         + &quot; at &quot; + colony);&#xD;
                 }&#xD;
             }&#xD;
         }&#xD;
     }&#xD;
     &#xD;
     // Just update the whole tile, including for other players&#xD;
     // which might see colony population change.&#xD;
     return new ChangeSet().add(See.perhaps(), tile).build(serverPlayer);&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_P5LZkFJQEeiyW7NaN4qWdw" name="getSkippedTurns" method="_Qn6u6FJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QobFQFJQEeiyW7NaN4qWdw">
                    <body>Gets the number of AI turns to skip through.&#xD;
     *&#xD;
     * @return The number of terms to skip.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_P5MAoFJQEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_P5MAoVJQEeiyW7NaN4qWdw" name="setSkippedTurns" method="_Qn6u6lJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QobsQFJQEeiyW7NaN4qWdw">
                    <body>Sets the number of AI turns to skip through as a debug helper.&#xD;
     *&#xD;
     * @param turns The number of turns to skip through.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_P5MAolJQEeiyW7NaN4qWdw" name="turns">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_P5MnsFJQEeiyW7NaN4qWdw" name="stepRandom" method="_Qn6u71JQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QobsQlJQEeiyW7NaN4qWdw">
                    <body>Debug convenience to step the random number generator.&#xD;
     *&#xD;
     * @return The next random number in series, in the range 0-99.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_P5MnsVJQEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_QknjQFJQEeiyW7NaN4qWdw" name="InGameController" method="_Qn6u5FJQEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_QknjQ1JQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_QknjRFJQEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_QobFP1JQEeiyW7NaN4qWdw">
                    <body>The constructor to use.&#xD;
     *&#xD;
     * @param freeColServer The main server object.&#xD;
     * @param random The pseudo-random number source to use.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QknjQVJQEeiyW7NaN4qWdw" name="freeColServer" type="_QhaeQVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QknjQlJQEeiyW7NaN4qWdw" name="random" type="_QiQLwFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QknjRVJQEeiyW7NaN4qWdw" type="_P5I9UFJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QkoKUFJQEeiyW7NaN4qWdw" name="setMonarchAction" method="_Qn6u7FJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QobsQVJQEeiyW7NaN4qWdw">
                    <body>Sets a monarch action to debug/test.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> whose monarch&#xD;
     *     should act.&#xD;
     * @param action The &lt;code>MonarchAction&lt;/code> to be taken.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QkoKUVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QkoKUlJQEeiyW7NaN4qWdw" name="action" type="_QiomQFJQEeiyW7NaN4qWdw"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QkoKU1JQEeiyW7NaN4qWdw" name="yearlyGoodsAdjust" method="_Qn7V8FJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QobsQ1JQEeiyW7NaN4qWdw">
                    <body>Public version of the yearly goods adjust (public so it can be&#xD;
     * use in the Market test code).  Sends the market and change&#xD;
     * messages to the player.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> whose market&#xD;
     *            is to be updated.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QkoKVFJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QkoxYFJQEeiyW7NaN4qWdw" name="addFoundingFather" method="_Qn7V8lJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QobsRFJQEeiyW7NaN4qWdw">
                    <body>Public version of csAddFoundingFather so it can be used in the&#xD;
     * test code and DebugMenu.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> who gains a father.&#xD;
     * @param father The &lt;code>FoundingFather&lt;/code> to add.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QkoxYVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QkoxYlJQEeiyW7NaN4qWdw" name="father" type="_QidnIFJQEeiyW7NaN4qWdw"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QkoxY1JQEeiyW7NaN4qWdw" name="changeStance" method="_Qn7V9VJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QobsRVJQEeiyW7NaN4qWdw">
                    <body>Public change stance and inform all routine.  Mostly used in the&#xD;
     * test suite, but the AIs also call it.&#xD;
     *&#xD;
     * @param serverPlayer The originating &lt;code>ServerPlayer&lt;/code>.&#xD;
     * @param stance The new &lt;code>Stance&lt;/code>.&#xD;
     * @param other The &lt;code>ServerPlayer&lt;/code> wrt which the&#xD;
     *     stance changes.&#xD;
     * @param symmetric If true, change the otherPlayer stance as well.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QkpYcFJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QkpYcVJQEeiyW7NaN4qWdw" name="stance" type="_QisQoFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QkpYclJQEeiyW7NaN4qWdw" name="other" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QkpYc1JQEeiyW7NaN4qWdw" name="symmetric">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_Qkp_gFJQEeiyW7NaN4qWdw" name="debugChangeOwner" method="_Qn7V-lJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QobsRlJQEeiyW7NaN4qWdw">
                    <body>Change colony owner.  Public for DebugUtils.&#xD;
     *&#xD;
     * @param colony The &lt;code>ServerColony&lt;/code> to change.&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> to change to.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qkp_gVJQEeiyW7NaN4qWdw" name="colony" type="_Qi7hMVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qkp_glJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QkqmkFJQEeiyW7NaN4qWdw" name="debugChangeOwner" method="_Qn7V_VJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QobsR1JQEeiyW7NaN4qWdw">
                    <body>Change unit owner.  Public for DebugUtils.&#xD;
     *&#xD;
     * @param unit The &lt;code>ServerUnit&lt;/code> to change.&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> to change to.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QkqmkVJQEeiyW7NaN4qWdw" name="unit" type="_Qi9WYVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QkqmklJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QkrNoFJQEeiyW7NaN4qWdw" name="debugApplyDisaster" method="_Qn7WAFJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QobsSFJQEeiyW7NaN4qWdw">
                    <body>Apply a disaster to a colony.  Public for DebugUtils.&#xD;
     *&#xD;
     * @param colony The &lt;code>Colony&lt;/code> to apply the disaster to.&#xD;
     * @param disaster The &lt;code>Disaster&lt;/code> to apply.&#xD;
     * @return The number of messages generated.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QkrNoVJQEeiyW7NaN4qWdw" name="colony" type="_Qi7hMVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qkr0sFJQEeiyW7NaN4qWdw" name="disaster" type="_QibK4VJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qkr0sVJQEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_QksbwFJQEeiyW7NaN4qWdw" name="moveGoods" visibility="private" method="_Qn7WBFJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QobsSVJQEeiyW7NaN4qWdw">
                    <body>Move goods from one location to another.&#xD;
     *&#xD;
     * @param src The source &lt;code>GoodsLocation&lt;/code>.&#xD;
     * @param goodsType The &lt;code>GoodsType&lt;/code> to move.&#xD;
     * @param amount The amount of goods to move.&#xD;
     * @param dst The new &lt;code>GoodsLocation&lt;/code>.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QksbwVJQEeiyW7NaN4qWdw" name="src" type="_QifcUlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QksbwlJQEeiyW7NaN4qWdw" name="goodsType" type="_QigDYVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qksbw1JQEeiyW7NaN4qWdw" name="amount">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QksbxFJQEeiyW7NaN4qWdw" name="dst" type="_QifcUlJQEeiyW7NaN4qWdw"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QksbxVJQEeiyW7NaN4qWdw" name="getNationSummary" method="_Qn79AFJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QobsSlJQEeiyW7NaN4qWdw">
                    <body>Gets a nation summary.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that is querying.&#xD;
     * @param player The &lt;code>Player&lt;/code> to summarize.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QksbxlJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QktC0FJQEeiyW7NaN4qWdw" name="player" type="_QhZQIFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QktC0VJQEeiyW7NaN4qWdw" type="_QiqbcFJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QktC0lJQEeiyW7NaN4qWdw" name="createREFPlayer" method="_Qn79BFJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QobsS1JQEeiyW7NaN4qWdw">
                    <body>Create the Royal Expeditionary Force player corresponding to&#xD;
     * a given player that is about to rebel.&#xD;
     *&#xD;
     * Public for the test suite.&#xD;
     *&#xD;
     * FIXME: this should eventually generate changes for the REF player.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> about to rebel.&#xD;
     * @return The REF player.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QktC01JQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QktC1FJQEeiyW7NaN4qWdw" type="_QhaeQ1JQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QkvfEFJQEeiyW7NaN4qWdw" name="askFuture" visibility="private" method="_Qn79D1JQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QobsTFJQEeiyW7NaN4qWdw">
                    <body>Asks a question of a player in a Future.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> to ask.&#xD;
     * @param question The &lt;code>DOMMessage&lt;/code> question.&#xD;
     * @param handler The &lt;code>DOMMessageHandler&lt;/code> handler to process&#xD;
     *     the reply with.&#xD;
     * @return A future encapsulating the result.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QkvfEVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QkvfElJQEeiyW7NaN4qWdw" name="question" type="_QhZ3MVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QkvfE1JQEeiyW7NaN4qWdw" name="handler" type="_P5N10FJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QkwGIVJQEeiyW7NaN4qWdw" type="_QiSoAlJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QkwtMFJQEeiyW7NaN4qWdw" name="askTimeout" visibility="private" method="_Qn79FFJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QobsTVJQEeiyW7NaN4qWdw">
                    <body>Asks a question of a player with a timeout.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> to ask.&#xD;
     * @param request The &lt;code>DOMMessage&lt;/code> question.&#xD;
     * @return The response to the question, or null if none.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QkwtMVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QkwtMlJQEeiyW7NaN4qWdw" name="request" type="_QhZ3MVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QkwtM1JQEeiyW7NaN4qWdw" type="_QhZ3MVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QkxUQFJQEeiyW7NaN4qWdw" name="csVisit" visibility="private" method="_Qn79GFJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QobsTlJQEeiyW7NaN4qWdw">
                    <body>Visits a native settlement, possibly scouting it full if it is&#xD;
     * as a result of a scout actually asking to speak to the chief,&#xD;
     * or for other settlement-contacting events such as missionary&#xD;
     * actions, demanding tribute, learning skills and trading if the&#xD;
     * settlementActionsContactChief game option is enabled.  It is&#xD;
     * still unclear what Col1 did here.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that is contacting&#xD;
     *     the settlement.&#xD;
     * @param is The &lt;code>IndianSettlement&lt;/code> to contact.&#xD;
     * @param scout Positive if this contact is due to a scout asking to&#xD;
     *     speak to the chief, zero if it is another unit, negative if&#xD;
     *     this is from the greeting dialog generation.&#xD;
     * @param cs A &lt;code>ChangeSet&lt;/code> to update.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QkxUQVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QkxUQlJQEeiyW7NaN4qWdw" name="is" type="_QiifoFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QkxUQ1JQEeiyW7NaN4qWdw" name="scout">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QkxURFJQEeiyW7NaN4qWdw" name="cs" type="_P6C8QFJQEeiyW7NaN4qWdw"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Qkx7UFJQEeiyW7NaN4qWdw" name="endTurn" method="_Qn8kEFJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QobsT1JQEeiyW7NaN4qWdw">
                    <body>Ends the turn of the given player.&#xD;
     *&#xD;
     * Note: sends messages to other players.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> to end the turn of.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating the end of turn changes&#xD;
     *     for the given player.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qkx7UVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qkx7UlJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Qkx7U1JQEeiyW7NaN4qWdw" name="csLaunchREF" visibility="private" method="_Qn8kE1JQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QobsUFJQEeiyW7NaN4qWdw">
                    <body>Launch the REF.&#xD;
     *&#xD;
     * @param serverPlayer The REF &lt;code>ServerPlayer&lt;/code>.&#xD;
     * @param teleport If true, teleport the REF in.&#xD;
     * @param cs A &lt;code>ChangeSet&lt;/code> to update.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qkx7VFJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qkx7VVJQEeiyW7NaN4qWdw" name="teleport">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QkyiYFJQEeiyW7NaN4qWdw" name="cs" type="_P6C8QFJQEeiyW7NaN4qWdw"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QkyiYVJQEeiyW7NaN4qWdw" name="csGiveIndependence" visibility="private" method="_Qn8kF1JQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QobsUVJQEeiyW7NaN4qWdw">
                    <body>Give independence.  Note that the REF player is granting, but&#xD;
     * most of the changes happen to the newly independent player.&#xD;
     * hence the special handling.&#xD;
     *&#xD;
     * @param serverPlayer The REF &lt;code>ServerPlayer&lt;/code> that is granting.&#xD;
     * @param independent The newly independent &lt;code>ServerPlayer&lt;/code>.&#xD;
     * @param cs A &lt;code>ChangeSet&lt;/code> to update.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QkyiYlJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QkyiY1JQEeiyW7NaN4qWdw" name="independent" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QkyiZFJQEeiyW7NaN4qWdw" name="cs" type="_P6C8QFJQEeiyW7NaN4qWdw"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QkzJcFJQEeiyW7NaN4qWdw" name="unitTemplate" visibility="private" method="_Qn8kG1JQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QkzJcVJQEeiyW7NaN4qWdw" name="base">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QkzJclJQEeiyW7NaN4qWdw" name="units" type="_QhldYVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QkzJc1JQEeiyW7NaN4qWdw" type="_Qius4FJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QkzwgVJQEeiyW7NaN4qWdw" name="raiseTax" visibility="private" method="_Qn8kH1JQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QobsUlJQEeiyW7NaN4qWdw">
                    <body>Resolves a tax raise.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> whose tax is rising.&#xD;
     * @param taxRaise The amount of tax raise.&#xD;
     * @param goods The &lt;code>Goods&lt;/code> for a goods party.&#xD;
     * @param result Whether the tax was accepted or not.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QkzwglJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk0XkFJQEeiyW7NaN4qWdw" name="taxRaise">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Qk0XkVJQEeiyW7NaN4qWdw" name="goods" type="_Qie1QVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk0XklJQEeiyW7NaN4qWdw" name="result">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_Qk0Xk1JQEeiyW7NaN4qWdw" name="csMonarchAction" visibility="private" method="_Qn9LIFJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QobsU1JQEeiyW7NaN4qWdw">
                    <body>Performs a monarch action.&#xD;
     *&#xD;
     * Note that CHANGE_LATE is used so that these actions follow&#xD;
     * setting the current player, so that it is the players turn when&#xD;
     * they respond to a monarch action.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> being acted upon.&#xD;
     * @param action The monarch action.&#xD;
     * @param cs A &lt;code>ChangeSet&lt;/code> to update.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qk0XlFJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw">
                    <eAnnotations xmi:id="_Qk0-olJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                      <details xmi:id="_Qk0-o1JQEeiyW7NaN4qWdw" key="final"/>
                    </eAnnotations>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Qk0-oFJQEeiyW7NaN4qWdw" name="action" type="_QiomQFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk0-oVJQEeiyW7NaN4qWdw" name="cs" type="_P6C8QFJQEeiyW7NaN4qWdw"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Qk0-pFJQEeiyW7NaN4qWdw" name="monarchAction" method="_Qn9LJlJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qk0-pVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk0-plJQEeiyW7NaN4qWdw" name="action" type="_QiomQFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk0-p1JQEeiyW7NaN4qWdw" name="result">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Qk0-qFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Qk0-qVJQEeiyW7NaN4qWdw" name="retire" method="_Qn9LK1JQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QocTUFJQEeiyW7NaN4qWdw">
                    <body>Handle a player retiring.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that is retiring.&#xD;
     * @return An element cleaning up the player.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qk0-qlJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk0-q1JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Qk2MwFJQEeiyW7NaN4qWdw" name="continuePlaying" method="_Qn9LLlJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QocTUVJQEeiyW7NaN4qWdw">
                    <body>Continue playing after winning.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that plays on.&#xD;
     * @return Null.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qk2MwVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk2MwlJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Qk2Mw1JQEeiyW7NaN4qWdw" name="cashInTreasureTrain" method="_Qn9LMVJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QocTUlJQEeiyW7NaN4qWdw">
                    <body>Cash in a treasure train.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that is cashing in.&#xD;
     * @param unit The treasure train &lt;code>Unit&lt;/code> to cash in.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qk2MxFJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk2MxVJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk2MxlJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Qk2z0FJQEeiyW7NaN4qWdw" name="declareIndependence" method="_Qn9LNVJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QocTU1JQEeiyW7NaN4qWdw">
                    <body>Declare independence.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that is declaring.&#xD;
     * @param nationName The new name for the independent nation.&#xD;
     * @param countryName The new name for its residents.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qk2z0VJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw">
                    <eAnnotations xmi:id="_Qk2z1VJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                      <details xmi:id="_Qk2z1lJQEeiyW7NaN4qWdw" key="final"/>
                    </eAnnotations>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Qk2z0lJQEeiyW7NaN4qWdw" name="nationName">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Qk2z01JQEeiyW7NaN4qWdw" name="countryName">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Qk2z1FJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Qk3a4FJQEeiyW7NaN4qWdw" name="renameObject" method="_Qn9yNlJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QocTVFJQEeiyW7NaN4qWdw">
                    <body>Rename an object.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that is naming.&#xD;
     * @param object The &lt;code>Nameable&lt;/code> to rename.&#xD;
     * @param newName The new name.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qk3a4VJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk3a4lJQEeiyW7NaN4qWdw" name="object" type="_QipNUFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk3a41JQEeiyW7NaN4qWdw" name="newName">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Qk3a5FJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Qk4B8FJQEeiyW7NaN4qWdw" name="getTransaction" method="_Qn9yO1JQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QocTVVJQEeiyW7NaN4qWdw">
                    <body>Gets a settlement transaction session, either existing or&#xD;
     * newly opened.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that is trading.&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is trading.&#xD;
     * @param settlement The &lt;code>Settlement&lt;/code> that is trading.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qk4B8VJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk4B8lJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk4B81JQEeiyW7NaN4qWdw" name="settlement" type="_QitewVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk4B9FJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Qk4B9VJQEeiyW7NaN4qWdw" name="closeTransaction" method="_Qn9yQFJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QocTVlJQEeiyW7NaN4qWdw">
                    <body>Close a transaction.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that is trading.&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is trading.&#xD;
     * @param settlement The &lt;code>Settlement&lt;/code> that is trading.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qk4B9lJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk4B91JQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk4B-FJQEeiyW7NaN4qWdw" name="settlement" type="_QitewVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk4B-VJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Qk4pAFJQEeiyW7NaN4qWdw" name="getGoodsForSale" method="_Qn9yRVJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QocTV1JQEeiyW7NaN4qWdw">
                    <body>Get the goods for sale in a settlement.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that is enquiring.&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is trading.&#xD;
     * @param settlement The &lt;code>Settlement&lt;/code> that is trading.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qk4pAVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk4pAlJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk4pA1JQEeiyW7NaN4qWdw" name="settlement" type="_QitewVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk4pBFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Qk5QEFJQEeiyW7NaN4qWdw" name="buyProposition" method="_Qn9ySlJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QocTWFJQEeiyW7NaN4qWdw">
                    <body>Price some goods for sale from a settlement.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that is buying.&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is trading.&#xD;
     * @param settlement The &lt;code>Settlement&lt;/code> that is trading.&#xD;
     * @param goods The &lt;code>Goods&lt;/code> to buy.&#xD;
     * @param price The buyers proposed price for the goods.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qk5QEVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk5QElJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk5QE1JQEeiyW7NaN4qWdw" name="settlement" type="_QitewVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk5QFFJQEeiyW7NaN4qWdw" name="goods" type="_Qie1QVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk5QFVJQEeiyW7NaN4qWdw" name="price">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Qk5QFlJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Qk53IFJQEeiyW7NaN4qWdw" name="sellProposition" method="_Qn9yUVJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QocTWVJQEeiyW7NaN4qWdw">
                    <body>Price some goods for sale to a settlement.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that is buying.&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is trading.&#xD;
     * @param settlement The &lt;code>Settlement&lt;/code> that is trading.&#xD;
     * @param goods The &lt;code>Goods&lt;/code> to sell.&#xD;
     * @param price The sellers proposed price for the goods.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qk53IVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk53IlJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk53I1JQEeiyW7NaN4qWdw" name="settlement" type="_QitewVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk53JFJQEeiyW7NaN4qWdw" name="goods" type="_Qie1QVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk53JVJQEeiyW7NaN4qWdw" name="price">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Qk53JlJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Qk6eMFJQEeiyW7NaN4qWdw" name="buyGoods" method="_Qn-ZQFJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QocTWlJQEeiyW7NaN4qWdw">
                    <body>Buy goods in Europe.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that is buying.&#xD;
     * @param type The &lt;code>GoodsType&lt;/code> to buy.&#xD;
     * @param amount The amount of goods to buy.&#xD;
     * @param carrier The &lt;code>Unit&lt;/code> to carry the goods.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qk6eMVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk6eMlJQEeiyW7NaN4qWdw" name="type" type="_QigDYVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk6eM1JQEeiyW7NaN4qWdw" name="amount">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Qk6eNFJQEeiyW7NaN4qWdw" name="carrier" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk6eNVJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Qk6eNlJQEeiyW7NaN4qWdw" name="sellGoods" method="_Qn-ZRlJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QocTW1JQEeiyW7NaN4qWdw">
                    <body>Sell goods in Europe.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that is selling.&#xD;
     * @param type The &lt;code>GoodsType&lt;/code> to sell.&#xD;
     * @param amount The amount of goods to sell.&#xD;
     * @param carrier The &lt;code>Unit&lt;/code> carrying the goods.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qk6eN1JQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk7FQFJQEeiyW7NaN4qWdw" name="type" type="_QigDYVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk7FQVJQEeiyW7NaN4qWdw" name="amount">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Qk7FQlJQEeiyW7NaN4qWdw" name="carrier" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk7FQ1JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Qk7FRFJQEeiyW7NaN4qWdw" name="emigrate" method="_Qn-ZTFJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QocTXFJQEeiyW7NaN4qWdw">
                    <body>A unit migrates from Europe.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> whose unit it will be.&#xD;
     * @param slot The slot within &lt;code>Europe&lt;/code> to select the unit from.&#xD;
     * @param type The type of migration occurring.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qk7FRVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk7FRlJQEeiyW7NaN4qWdw" name="slot">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Qk7FR1JQEeiyW7NaN4qWdw" name="type" type="_QicZAVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk7FSFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Qk7sUFJQEeiyW7NaN4qWdw" name="move" method="_Qn-ZUVJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QocTXVJQEeiyW7NaN4qWdw">
                    <body>Move a unit.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that is moving.&#xD;
     * @param unit The &lt;code>ServerUnit&lt;/code> to move.&#xD;
     * @param newTile The &lt;code>Tile&lt;/code> to move to.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qk7sUVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk7sUlJQEeiyW7NaN4qWdw" name="unit" type="_Qi9WYVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk7sU1JQEeiyW7NaN4qWdw" name="newTile" type="_QivT8VJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk7sVFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Qk7sVVJQEeiyW7NaN4qWdw" name="declineMounds" method="_Qn-ZVlJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QocTXlJQEeiyW7NaN4qWdw">
                    <body>Decline to investigate strange mounds.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that owns the unit.&#xD;
     * @param tile The &lt;code>Tile&lt;/code> where the mounds are.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qk7sVlJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk7sV1JQEeiyW7NaN4qWdw" name="tile" type="_QivT8VJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk7sWFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Qk8TYFJQEeiyW7NaN4qWdw" name="setNewLandName" method="_Qn_AUFJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QocTX1JQEeiyW7NaN4qWdw">
                    <body>Set land name.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> who landed.&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that has come ashore.&#xD;
     * @param name The new land name.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qk8TYVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk8TYlJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk8TY1JQEeiyW7NaN4qWdw" name="name">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Qk8TZFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Qk8TZVJQEeiyW7NaN4qWdw" name="setNewRegionName" method="_Qn_AVVJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QocTYFJQEeiyW7NaN4qWdw">
                    <body>Set region name.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> discovering.&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is discovering.&#xD;
     * @param region The &lt;code>Region&lt;/code> to discover.&#xD;
     * @param name The new region name.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qk86cFJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk86cVJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk86clJQEeiyW7NaN4qWdw" name="region" type="_Qis3sVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk86c1JQEeiyW7NaN4qWdw" name="name">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Qk86dFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Qk86dVJQEeiyW7NaN4qWdw" name="moveTo" method="_Qn_AW1JQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QocTYVJQEeiyW7NaN4qWdw">
                    <body>Move a unit across the high seas.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that owns the unit.&#xD;
     * @param unit The &lt;code>Unit&lt;/code> to move.&#xD;
     * @param destination The &lt;code>Location&lt;/code> to move to.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qk86dlJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk86d1JQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk86eFJQEeiyW7NaN4qWdw" name="destination" type="_QikU0FJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk9hgFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Qk9hgVJQEeiyW7NaN4qWdw" name="embarkUnit" method="_Qn_AYFJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QocTYlJQEeiyW7NaN4qWdw">
                    <body>Embark a unit onto a carrier.&#xD;
     * Checking that the locations are appropriate is not done here.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> embarking.&#xD;
     * @param serverUnit The &lt;code>ServerUnit&lt;/code> that is embarking.&#xD;
     * @param carrier The &lt;code>Unit&lt;/code> to embark onto.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qk9hglJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk9hg1JQEeiyW7NaN4qWdw" name="serverUnit" type="_Qi9WYVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk9hhFJQEeiyW7NaN4qWdw" name="carrier" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk9hhVJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Qk-IkFJQEeiyW7NaN4qWdw" name="disembarkUnit" method="_Qn_nYFJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QocTY1JQEeiyW7NaN4qWdw">
                    <body>Disembark unit from a carrier.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> whose unit is&#xD;
     *                     embarking.&#xD;
     * @param serverUnit The &lt;code>ServerUnit&lt;/code> that is disembarking.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qk-IkVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk-IklJQEeiyW7NaN4qWdw" name="serverUnit" type="_Qi9WYVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk-Ik1JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Qk-IlFJQEeiyW7NaN4qWdw" name="combat" method="_QoAOcFJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QocTZFJQEeiyW7NaN4qWdw">
                    <body>Combat.  Public for the test suite.&#xD;
     *&#xD;
     * @param attackerPlayer The &lt;code>ServerPlayer&lt;/code> who is attacking.&#xD;
     * @param attacker The &lt;code>FreeColGameObject&lt;/code> that is attacking.&#xD;
     * @param defender The &lt;code>FreeColGameObject&lt;/code> that is defending.&#xD;
     * @param crs A list of &lt;code>CombatResult&lt;/code>s defining the result.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qk-IlVJQEeiyW7NaN4qWdw" name="attackerPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk-voFJQEeiyW7NaN4qWdw" name="attacker" type="_QidnIlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk-voVJQEeiyW7NaN4qWdw" name="defender" type="_QidnIlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk-volJQEeiyW7NaN4qWdw" name="crs" type="_QhldYVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk-vo1JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Qk_WsFJQEeiyW7NaN4qWdw" name="askLearnSkill" method="_QoAOdlJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QocTZVJQEeiyW7NaN4qWdw">
                    <body>Ask about learning a skill at an IndianSettlement.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that is learning.&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is learning.&#xD;
     * @param settlement The &lt;code>Settlement&lt;/code> to learn from.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qk_WsVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk_WslJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk_Ws1JQEeiyW7NaN4qWdw" name="settlement" type="_QiifoFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk_WtFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Qk_9wFJQEeiyW7NaN4qWdw" name="learnFromIndianSettlement" method="_QoAOe1JQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QocTZlJQEeiyW7NaN4qWdw">
                    <body>Learn a skill at an IndianSettlement.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that is learning.&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is learning.&#xD;
     * @param settlement The &lt;code>Settlement&lt;/code> to learn from.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qk_9wVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk_9wlJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk_9w1JQEeiyW7NaN4qWdw" name="settlement" type="_QiifoFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qk_9xFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QlAk0FJQEeiyW7NaN4qWdw" name="demandTribute" method="_QoAOgFJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QocTZ1JQEeiyW7NaN4qWdw">
                    <body>Demand a tribute from a native settlement.&#xD;
     *&#xD;
     * FIXME: Move TURNS_PER_TRIBUTE magic number to the spec.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> demanding the tribute.&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is demanding the tribute.&#xD;
     * @param settlement The &lt;code>ServerIndianSettlement&lt;/code> demanded of.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QlAk0VJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlAk0lJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlAk01JQEeiyW7NaN4qWdw" name="settlement" type="_Qi8IQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlAk1FJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QlBL4FJQEeiyW7NaN4qWdw" name="scoutIndianSettlement" method="_QoAOhVJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QocTaFJQEeiyW7NaN4qWdw">
                    <body>Scout a native settlement, that is, the contacting action&#xD;
     * that generates the greeting dialog.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that is scouting.&#xD;
     * @param unit The scout &lt;code>Unit&lt;/code>.&#xD;
     * @param settlement The &lt;code>IndianSettlement&lt;/code> to scout.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QlBL4VJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlBy8FJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlBy8VJQEeiyW7NaN4qWdw" name="settlement" type="_QiifoFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlBy8lJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QlBy81JQEeiyW7NaN4qWdw" name="scoutSpeakToChief" method="_QoAOilJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QocTaVJQEeiyW7NaN4qWdw">
                    <body>Speak to the chief at a native settlement.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that is scouting.&#xD;
     * @param unit The scout &lt;code>Unit&lt;/code>.&#xD;
     * @param settlement The &lt;code>IndianSettlement&lt;/code> to scout.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QlBy9FJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlBy9VJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlBy9lJQEeiyW7NaN4qWdw" name="settlement" type="_QiifoFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlBy91JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QlCaAFJQEeiyW7NaN4qWdw" name="denounceMission" method="_QoAOj1JQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QocTalJQEeiyW7NaN4qWdw">
                    <body>Denounce an existing mission.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that is denouncing.&#xD;
     * @param unit The &lt;code>Unit&lt;/code> denouncing.&#xD;
     * @param settlement The &lt;code>ServerIndianSettlement&lt;/code>&#xD;
     *     containing the mission to denounce.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QlCaAVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlCaAlJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlCaA1JQEeiyW7NaN4qWdw" name="settlement" type="_Qi8IQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlCaBFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QlDBEFJQEeiyW7NaN4qWdw" name="establishMission" method="_QoAOlFJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_Qoc6YFJQEeiyW7NaN4qWdw">
                    <body>Establish a new mission.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that is establishing.&#xD;
     * @param unit The missionary &lt;code>Unit&lt;/code>.&#xD;
     * @param settlement The &lt;code>ServerIndianSettlement&lt;/code> to&#xD;
     *     establish at.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QlDBEVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlDBElJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlDBE1JQEeiyW7NaN4qWdw" name="settlement" type="_Qi8IQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlDBFFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QlDoIFJQEeiyW7NaN4qWdw" name="incite" method="_QoAOmVJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_Qoc6YVJQEeiyW7NaN4qWdw">
                    <body>Incite a settlement against an enemy.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that is inciting.&#xD;
     * @param unit The missionary &lt;code>Unit&lt;/code> inciting.&#xD;
     * @param settlement The &lt;code>IndianSettlement&lt;/code> to incite.&#xD;
     * @param enemy The &lt;code>ServerPlayer&lt;/code> to be incited against.&#xD;
     * @param gold The amount of gold in the bribe.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QlDoIVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlDoIlJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlDoI1JQEeiyW7NaN4qWdw" name="settlement" type="_QiifoFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlDoJFJQEeiyW7NaN4qWdw" name="enemy" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlDoJVJQEeiyW7NaN4qWdw" name="gold">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QlDoJlJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QlEPMFJQEeiyW7NaN4qWdw" name="setDestination" method="_QoAOoFJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_Qoc6YlJQEeiyW7NaN4qWdw">
                    <body>Set a unit destination.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that owns the unit.&#xD;
     * @param unit The &lt;code>Unit&lt;/code> to set the destination for.&#xD;
     * @param destination The &lt;code>Location&lt;/code> to set as destination.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QlEPMVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlEPMlJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlEPM1JQEeiyW7NaN4qWdw" name="destination" type="_QikU0FJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlEPNFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QlE2QFJQEeiyW7NaN4qWdw" name="setCurrentStop" method="_QoAOpVJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_Qoc6Y1JQEeiyW7NaN4qWdw">
                    <body>Set a unit stop.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that owns the unit.&#xD;
     * @param unit The &lt;code>Unit&lt;/code> to set the destination for.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QlE2QVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlE2QlJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlE2Q1JQEeiyW7NaN4qWdw" name="index">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QlE2RFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QlFdUFJQEeiyW7NaN4qWdw" name="buyFromSettlement" method="_QoA1gFJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_Qoc6ZFJQEeiyW7NaN4qWdw">
                    <body>Buy from a settlement.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that is buying.&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that will carry the goods.&#xD;
     * @param settlement The &lt;code>ServerIndianSettlement&lt;/code> to buy from.&#xD;
     * @param goods The &lt;code>Goods&lt;/code> to buy.&#xD;
     * @param amount How much gold to pay.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QlFdUVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlFdUlJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlFdU1JQEeiyW7NaN4qWdw" name="settlement" type="_Qi8IQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlFdVFJQEeiyW7NaN4qWdw" name="goods" type="_Qie1QVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlFdVVJQEeiyW7NaN4qWdw" name="amount">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QlFdVlJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QlGEYFJQEeiyW7NaN4qWdw" name="sellToSettlement" method="_QoA1h1JQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_Qoc6ZVJQEeiyW7NaN4qWdw">
                    <body>Sell to a settlement.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that is selling.&#xD;
     * @param unit The &lt;code>Unit&lt;/code> carrying the goods.&#xD;
     * @param settlement The &lt;code>ServerIndianSettlement&lt;/code> to sell to.&#xD;
     * @param goods The &lt;code>Goods&lt;/code> to sell.&#xD;
     * @param amount How much gold to expect.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QlGEYVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlGEYlJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlGEY1JQEeiyW7NaN4qWdw" name="settlement" type="_Qi8IQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlGEZFJQEeiyW7NaN4qWdw" name="goods" type="_Qie1QVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlGEZVJQEeiyW7NaN4qWdw" name="amount">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QlGEZlJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QlGrcFJQEeiyW7NaN4qWdw" name="deliverGiftToSettlement" method="_QoA1jlJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_Qoc6ZlJQEeiyW7NaN4qWdw">
                    <body>Deliver gift to settlement.&#xD;
     * Note that this includes both European and native gifts.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that is delivering.&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is delivering.&#xD;
     * @param goods The &lt;code>Goods&lt;/code> to deliver.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QlGrcVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlGrclJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlGrc1JQEeiyW7NaN4qWdw" name="settlement" type="_QitewVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlGrdFJQEeiyW7NaN4qWdw" name="goods" type="_Qie1QVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlHSgFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QlHSgVJQEeiyW7NaN4qWdw" name="loadGoods" method="_QoA1lFJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_Qoc6Z1JQEeiyW7NaN4qWdw">
                    <body>Load goods.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that is loading.&#xD;
     * @param loc The &lt;code>Location&lt;/code> where the goods are.&#xD;
     * @param goodsType The &lt;code>GoodsType&lt;/code> to load.&#xD;
     * @param amount The amount of goods to load.&#xD;
     * @param carrier The &lt;code>Unit&lt;/code> to load.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QlH5kFJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlH5kVJQEeiyW7NaN4qWdw" name="loc" type="_QikU0FJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlH5klJQEeiyW7NaN4qWdw" name="goodsType" type="_QigDYVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlH5k1JQEeiyW7NaN4qWdw" name="amount">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QlH5lFJQEeiyW7NaN4qWdw" name="carrier" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlH5lVJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QlIgoFJQEeiyW7NaN4qWdw" name="unloadGoods" method="_QoA1m1JQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_Qoc6aFJQEeiyW7NaN4qWdw">
                    <body>Unload goods.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that is unloading.&#xD;
     * @param goodsType The &lt;code>GoodsType&lt;/code> to unload.&#xD;
     * @param amount The amount of goods to unload.&#xD;
     * @param carrier The &lt;code>Unit&lt;/code> to unload.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QlIgoVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlIgolJQEeiyW7NaN4qWdw" name="goodsType" type="_QigDYVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlIgo1JQEeiyW7NaN4qWdw" name="amount">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QlIgpFJQEeiyW7NaN4qWdw" name="carrier" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlIgpVJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QlJHsFJQEeiyW7NaN4qWdw" name="clearSpeciality" method="_QoA1oVJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_Qoc6aVJQEeiyW7NaN4qWdw">
                    <body>Clear the specialty of a unit.&#xD;
     *&#xD;
     * FIXME: why not clear speciality in the open?  You can disband!&#xD;
     * If we implement this remember to fix the visibility.&#xD;
     *&#xD;
     * @param serverPlayer The owner of the unit.&#xD;
     * @param unit The &lt;code>Unit&lt;/code> to clear the speciality of.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QlJHsVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlJHslJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlJHs1JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QlJuwFJQEeiyW7NaN4qWdw" name="disbandUnit" method="_QoBckFJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_Qoc6alJQEeiyW7NaN4qWdw">
                    <body>Disband a unit.&#xD;
     *&#xD;
     * @param serverPlayer The owner of the unit.&#xD;
     * @param unit The &lt;code>Unit&lt;/code> to disband.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QlJuwVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlJuwlJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlJuw1JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QlKV0FJQEeiyW7NaN4qWdw" name="buildSettlement" method="_QoBclFJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_Qoc6a1JQEeiyW7NaN4qWdw">
                    <body>Build a settlement.&#xD;
     *&#xD;
     * +til: Resolves many tile appearance changes.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that is building.&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is building.&#xD;
     * @param name The new settlement name.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QlKV0VJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlKV0lJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlK84FJQEeiyW7NaN4qWdw" name="name">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QlK84VJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QlLj8FJQEeiyW7NaN4qWdw" name="joinColony" method="_QoBcmVJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_Qoc6bFJQEeiyW7NaN4qWdw">
                    <body>Join a colony.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that owns the unit.&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is joining.&#xD;
     * @param colony The &lt;code>Colony&lt;/code> to join.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QlLj8VJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlLj8lJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlLj81JQEeiyW7NaN4qWdw" name="colony" type="_QiYuoVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlLj9FJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QlMLAFJQEeiyW7NaN4qWdw" name="abandonSettlement" method="_QoBcnlJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_Qoc6bVJQEeiyW7NaN4qWdw">
                    <body>Abandon a settlement.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that is abandoning.&#xD;
     * @param settlement The &lt;code>Settlement&lt;/code> to abandon.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QlMLAVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlMLAlJQEeiyW7NaN4qWdw" name="settlement" type="_QitewVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlMLA1JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QlMyEFJQEeiyW7NaN4qWdw" name="claimLand" method="_QoBcolJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_Qoc6blJQEeiyW7NaN4qWdw">
                    <body>Claim land.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> claiming.&#xD;
     * @param tile The &lt;code>Tile&lt;/code> to claim.&#xD;
     * @param settlement The &lt;code>Settlement&lt;/code> to claim for.&#xD;
     * @param price The price to pay for the land, which must agree&#xD;
     *     with the owner valuation, unless negative which denotes stealing.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QlMyEVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlMyElJQEeiyW7NaN4qWdw" name="tile" type="_QivT8VJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlMyE1JQEeiyW7NaN4qWdw" name="settlement" type="_QitewVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlMyFFJQEeiyW7NaN4qWdw" name="price">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QlNZIFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QlOAMFJQEeiyW7NaN4qWdw" name="csAcceptTrade" visibility="private" method="_QoBcqFJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_Qoc6b1JQEeiyW7NaN4qWdw">
                    <body>Accept a diplomatic trade.  Handles the transfers of TradeItems.&#xD;
     *&#xD;
     * Note that first contact contexts may not necessarily have a settlement,&#xD;
     * but this is ok because first contact trade can only include stance&#xD;
     * and gold trade items.&#xD;
     *&#xD;
     * @param agreement The &lt;code>DiplomacyTrade&lt;/code> agreement.&#xD;
     * @param session The &lt;code>DiplomacySession&lt;/code> in scope.&#xD;
     * @param cs A &lt;code>ChangeSet&lt;/code> to update.&#xD;
     * @return True if the trade was valid.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QlOAMVJQEeiyW7NaN4qWdw" name="agreement" type="_Qiaj0FJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlOAMlJQEeiyW7NaN4qWdw" name="session" type="_Qi6TE1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlOAM1JQEeiyW7NaN4qWdw" name="cs" type="_P6C8QFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlOANFJQEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_QlOnQFJQEeiyW7NaN4qWdw" name="nativeFirstContact" method="_QoCDoFJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_Qoc6cFJQEeiyW7NaN4qWdw">
                    <body>Handle first contact between European and native player.&#xD;
     *&#xD;
     * Note that we check for a diplomacy session, but do only bother&#xD;
     * in the case of tile!=null as that is the only possibility for&#xD;
     * some benefit.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> making contact.&#xD;
     * @param other The native &lt;code>ServerPlayer&lt;/code> to contact.&#xD;
     * @param tile A &lt;code>Tile&lt;/code> on offer at first landing.&#xD;
     * @param result Whether the initial peace treaty was accepted.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QlOnQVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlOnQlJQEeiyW7NaN4qWdw" name="other" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlOnQ1JQEeiyW7NaN4qWdw" name="tile" type="_QivT8VJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlOnRFJQEeiyW7NaN4qWdw" name="result">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QlOnRVJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QlPOUFJQEeiyW7NaN4qWdw" name="csDiplomacySession" visibility="private" method="_QoCDplJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_Qoc6cVJQEeiyW7NaN4qWdw">
                    <body>Process a European diplomacy session according to an agreement.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> in the session.&#xD;
     * @param otherPlayer The other &lt;code>ServerPlayer&lt;/code> in the session.&#xD;
     * @param agreement The &lt;code>DiplomaticTrade&lt;/code> to consider.&#xD;
     * @param session The &lt;code>DiplomacySession&lt;/code> underway.&#xD;
     * @param message A &lt;code>DiplomacyMessage&lt;/code> to send.&#xD;
     * @param cs A &lt;code>ChangeSet&lt;/code> to contain the trade changes&#xD;
     *     if accepted.&#xD;
     * @return True if a new DiplomacyMessage reply needs to be sent.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QlPOUVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlP1YFJQEeiyW7NaN4qWdw" name="otherPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlP1YVJQEeiyW7NaN4qWdw" name="agreement" type="_Qiaj0FJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlP1YlJQEeiyW7NaN4qWdw" name="session" type="_Qi6TE1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlP1Y1JQEeiyW7NaN4qWdw" name="message" type="_Qh0t8FJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlP1ZFJQEeiyW7NaN4qWdw" name="cs" type="_P6C8QFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlP1ZVJQEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_QlQccFJQEeiyW7NaN4qWdw" name="europeanFirstContact" method="_QoCDrlJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_Qoc6clJQEeiyW7NaN4qWdw">
                    <body>Handle first contact between European players.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> making contact.&#xD;
     * @param ourUnit Our &lt;code>Unit&lt;/code>.&#xD;
     * @param otherUnit The other &lt;code>unit&lt;/code>.&#xD;
     * @param agreement The &lt;code>DiplomaticTrade&lt;/code> to consider.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QlQccVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlQcclJQEeiyW7NaN4qWdw" name="ourUnit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlQcc1JQEeiyW7NaN4qWdw" name="otherUnit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlQcdFJQEeiyW7NaN4qWdw" name="agreement" type="_Qiaj0FJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlQcdVJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QlRqkFJQEeiyW7NaN4qWdw" name="europeanFirstContact" method="_QoCDtFJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QodhcFJQEeiyW7NaN4qWdw">
                    <body>Handle first contact between European players.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> making contact.&#xD;
     * @param ourUnit Our &lt;code>Unit&lt;/code>.&#xD;
     * @param otherColony The other &lt;code>Colony&lt;/code>.&#xD;
     * @param agreement The &lt;code>DiplomaticTrade&lt;/code> to consider.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QlRqkVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlRqklJQEeiyW7NaN4qWdw" name="ourUnit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlRqk1JQEeiyW7NaN4qWdw" name="otherColony" type="_QiYuoVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlRqlFJQEeiyW7NaN4qWdw" name="agreement" type="_Qiaj0FJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlRqlVJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QlSRoFJQEeiyW7NaN4qWdw" name="europeanFirstContact" method="_QoCDulJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QodhcVJQEeiyW7NaN4qWdw">
                    <body>Handle first contact between European players.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> making contact.&#xD;
     * @param ourColony Our &lt;code>Colony&lt;/code>.&#xD;
     * @param otherUnit The other &lt;code>Unit&lt;/code>.&#xD;
     * @param agreement The &lt;code>DiplomaticTrade&lt;/code> to consider.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QlSRoVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlSRolJQEeiyW7NaN4qWdw" name="ourColony" type="_QiYuoVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlS4sFJQEeiyW7NaN4qWdw" name="otherUnit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlS4sVJQEeiyW7NaN4qWdw" name="agreement" type="_Qiaj0FJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlS4slJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QlTfwFJQEeiyW7NaN4qWdw" name="diplomacy" method="_QoCqsFJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QodhclJQEeiyW7NaN4qWdw">
                    <body>Diplomacy.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that is trading.&#xD;
     * @param ourUnit The &lt;code>Unit&lt;/code> that is trading.&#xD;
     * @param otherColony The &lt;code>Colony&lt;/code> to trade with.&#xD;
     * @param agreement The &lt;code>DiplomaticTrade&lt;/code> to consider.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QlTfwVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlTfwlJQEeiyW7NaN4qWdw" name="ourUnit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlTfw1JQEeiyW7NaN4qWdw" name="otherColony" type="_QiYuoVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlTfxFJQEeiyW7NaN4qWdw" name="agreement" type="_Qiaj0FJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlUG0FJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QlUt4FJQEeiyW7NaN4qWdw" name="diplomacy" method="_QoCqtlJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_Qodhc1JQEeiyW7NaN4qWdw">
                    <body>Diplomacy.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that is trading.&#xD;
     * @param ourColony Our &lt;code>Colony&lt;/code>.&#xD;
     * @param otherUnit The other &lt;code>Unit&lt;/code> that is trading.&#xD;
     * @param agreement The &lt;code>DiplomaticTrade&lt;/code> to consider.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QlUt4VJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlUt4lJQEeiyW7NaN4qWdw" name="ourColony" type="_QiYuoVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlUt41JQEeiyW7NaN4qWdw" name="otherUnit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlUt5FJQEeiyW7NaN4qWdw" name="agreement" type="_Qiaj0FJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlUt5VJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QlVU8FJQEeiyW7NaN4qWdw" name="spySettlement" method="_QoCqvFJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QodhdFJQEeiyW7NaN4qWdw">
                    <body>Spy on a settlement.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that is spying.&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is spying.&#xD;
     * @param settlement The &lt;code>Settlement&lt;/code> to spy on.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QlVU8VJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlVU8lJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlVU81JQEeiyW7NaN4qWdw" name="settlement" type="_QitewVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlV8AFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QlWjEFJQEeiyW7NaN4qWdw" name="work" method="_QoCqwVJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QodhdVJQEeiyW7NaN4qWdw">
                    <body>Change work location.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that owns the unit.&#xD;
     * @param unit The &lt;code>Unit&lt;/code> to change the work location of.&#xD;
     * @param workLocation The &lt;code>WorkLocation&lt;/code> to change to.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QlWjEVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlWjElJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlWjE1JQEeiyW7NaN4qWdw" name="workLocation" type="_Qi2BoFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlWjFFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QlXKIFJQEeiyW7NaN4qWdw" name="lootCargo" method="_QoCqxlJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QodhdlJQEeiyW7NaN4qWdw">
                    <body>Loot cargo.&#xD;
     *&#xD;
     * Note loser is passed by identifier, as by the time we get here&#xD;
     * the unit may have been sunk.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that owns the winner.&#xD;
     * @param winner The &lt;code>Unit&lt;/code> that looting.&#xD;
     * @param loserId The object identifier of the &lt;code>Unit&lt;/code>&#xD;
     *     that is looted.&#xD;
     * @param loot The &lt;code>Goods&lt;/code> to loot.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QlXKIVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlXKIlJQEeiyW7NaN4qWdw" name="winner" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlXKI1JQEeiyW7NaN4qWdw" name="loserId">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QlXKJFJQEeiyW7NaN4qWdw" name="loot" type="_QhldYVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlXxMFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QlY_UFJQEeiyW7NaN4qWdw" name="payArrears" method="_QoCqzFJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QoeIgFJQEeiyW7NaN4qWdw">
                    <body>Pay arrears.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that owns the unit.&#xD;
     * @param type The &lt;code>GoodsType&lt;/code> to pay the arrears for.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QlY_UVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlZmYFJQEeiyW7NaN4qWdw" name="type" type="_QigDYVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlZmYVJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QlaNcFJQEeiyW7NaN4qWdw" name="equipForRole" method="_QoDRwFJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QoeIgVJQEeiyW7NaN4qWdw">
                    <body>Equip a unit for a specific role.&#xD;
     * Currently the unit is either in Europe or in a settlement.&#xD;
     * Might one day allow the unit to be on a tile co-located with&#xD;
     * an equipment-bearing wagon.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that owns the unit.&#xD;
     * @param unit The &lt;code>Unit&lt;/code> to equip.&#xD;
     * @param role The &lt;code>Role&lt;/code> to equip for.&#xD;
     * @param roleCount The role count.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QlaNcVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qla0gFJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qla0gVJQEeiyW7NaN4qWdw" name="role" type="_QizlYVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qla0glJQEeiyW7NaN4qWdw" name="roleCount">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Qla0g1JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QlbbkFJQEeiyW7NaN4qWdw" name="payForBuilding" method="_QoDRxlJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QoeIglJQEeiyW7NaN4qWdw">
                    <body>Pay for a building.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that owns the&#xD;
     *     colony.&#xD;
     * @param colony The &lt;code>Colony&lt;/code> that is building.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QlbbkVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlbbklJQEeiyW7NaN4qWdw" name="colony" type="_QiYuoVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qlbbk1JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QlcCoFJQEeiyW7NaN4qWdw" name="indianDemand" method="_QoDRylJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QoeIg1JQEeiyW7NaN4qWdw">
                    <body>Indians making demands of a colony.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that is demanding.&#xD;
     * @param unit The &lt;code>Unit&lt;/code> making the demands.&#xD;
     * @param colony The &lt;code>Colony&lt;/code> that is demanded of.&#xD;
     * @param type The &lt;code>GoodsType&lt;/code> being demanded, null&#xD;
     *     implies gold.&#xD;
     * @param amount The amount of goods/gold being demanded.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QlcCoVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw">
                    <eAnnotations xmi:id="_QldQwFJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                      <details xmi:id="_QldQwVJQEeiyW7NaN4qWdw" key="final"/>
                    </eAnnotations>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QlcpsFJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlcpsVJQEeiyW7NaN4qWdw" name="colony" type="_QiYuoVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlcpslJQEeiyW7NaN4qWdw" name="type" type="_QigDYVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qlcps1JQEeiyW7NaN4qWdw" name="amount">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QlcptFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Qld30FJQEeiyW7NaN4qWdw" name="trainUnitInEurope" method="_QoDR01JQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QoeIhFJQEeiyW7NaN4qWdw">
                    <body>Train a unit in Europe.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that is demanding.&#xD;
     * @param type The &lt;code>UnitType&lt;/code> to train.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qld30VJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qlee4FJQEeiyW7NaN4qWdw" name="type" type="_Qi0zgVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qlee4VJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QlfF8FJQEeiyW7NaN4qWdw" name="setBuildQueue" method="_QoD40FJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QoeIhVJQEeiyW7NaN4qWdw">
                    <body>Set build queue.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that owns the colony.&#xD;
     * @param colony The &lt;code>Colony&lt;/code> to set the queue of.&#xD;
     * @param queue The new build queue.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QlfF8VJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlftAFJQEeiyW7NaN4qWdw" name="colony" type="_QiYuoVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlftAVJQEeiyW7NaN4qWdw" name="queue" type="_QhldYVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlftAlJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QlhiMFJQEeiyW7NaN4qWdw" name="setGoodsLevels" method="_QoD41VJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QoeIhlJQEeiyW7NaN4qWdw">
                    <body>Set goods levels.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that owns the colony.&#xD;
     * @param colony The &lt;code>Colony&lt;/code> to set the goods levels in.&#xD;
     * @param exportData The new &lt;code>ExportData&lt;/code>.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QlhiMVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QliJQFJQEeiyW7NaN4qWdw" name="colony" type="_QiYuoVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QliJQVJQEeiyW7NaN4qWdw" name="exportData" type="_QidAEVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QliJQlJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QliwUFJQEeiyW7NaN4qWdw" name="putOutsideColony" method="_QoD42lJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QoeIh1JQEeiyW7NaN4qWdw">
                    <body>Put outside colony.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that owns the unit.&#xD;
     * @param unit The &lt;code>Unit&lt;/code> to be put out.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QliwUVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QliwUlJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QljXYFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Qlj-cFJQEeiyW7NaN4qWdw" name="changeWorkType" method="_QoD43lJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QoeIiFJQEeiyW7NaN4qWdw">
                    <body>Change work type.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that owns the unit.&#xD;
     * @param unit The &lt;code>Unit&lt;/code> to change the work type of.&#xD;
     * @param type The new &lt;code>GoodsType&lt;/code> to produce.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qlj-cVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qlj-clJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qlj-c1JQEeiyW7NaN4qWdw" name="type" type="_QigDYVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qlj-dFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QlklgFJQEeiyW7NaN4qWdw" name="changeWorkImprovementType" method="_QoD441JQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QoeIiVJQEeiyW7NaN4qWdw">
                    <body>Change improvement work type.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that owns the unit.&#xD;
     * @param unit The &lt;code>Unit&lt;/code> to change the work type of.&#xD;
     * @param type The new &lt;code>TileImprovementType&lt;/code> to produce.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QlklgVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlklglJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qlklg1JQEeiyW7NaN4qWdw" name="type" type="_QiwiEVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QllMkFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QllzoFJQEeiyW7NaN4qWdw" name="changeState" method="_QoD46FJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QoeIilJQEeiyW7NaN4qWdw">
                    <body>Change a units state.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that owns the unit.&#xD;
     * @param unit The &lt;code>Unit&lt;/code> to change the state of.&#xD;
     * @param state The new &lt;code>UnitState&lt;/code>.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QllzoVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QllzolJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qllzo1JQEeiyW7NaN4qWdw" name="state" type="_QizlY1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QllzpFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QlmasFJQEeiyW7NaN4qWdw" name="assignTeacher" method="_QoD47VJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QoeIi1JQEeiyW7NaN4qWdw">
                    <body>Assign a student to a teacher.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that owns the unit.&#xD;
     * @param student The student &lt;code>Unit&lt;/code>.&#xD;
     * @param teacher The teacher &lt;code>Unit&lt;/code>.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QlmasVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlmaslJQEeiyW7NaN4qWdw" name="student" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qlmas1JQEeiyW7NaN4qWdw" name="teacher" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlmatFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QlnBwFJQEeiyW7NaN4qWdw" name="assignTradeRoute" method="_QoEf4FJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QoeIjFJQEeiyW7NaN4qWdw">
                    <body>Assign a trade route to a unit.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that owns the unit.&#xD;
     * @param unit The unit &lt;code>Unit&lt;/code> to assign to.&#xD;
     * @param tradeRoute The &lt;code>TradeRoute&lt;/code> to assign.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qlno0FJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qlno0VJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qlno0lJQEeiyW7NaN4qWdw" name="tradeRoute" type="_QixwMVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qlno01JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QloP4FJQEeiyW7NaN4qWdw" name="setTradeRoutes" method="_QoEf5VJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QoeIjVJQEeiyW7NaN4qWdw">
                    <body>Set trade routes for a player.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> to set trade&#xD;
     *    routes for.&#xD;
     * @param routes The new list of &lt;code>TradeRoute&lt;/code>s.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QloP4VJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QloP4lJQEeiyW7NaN4qWdw" name="routes" type="_QhldYVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QloP41JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QlpeAFJQEeiyW7NaN4qWdw" name="getNewTradeRoute" method="_QoEf6VJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QoeIjlJQEeiyW7NaN4qWdw">
                    <body>Get a new trade route for a player.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> to get a trade&#xD;
     *    route for.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QlpeAVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlpeAlJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QlpeA1JQEeiyW7NaN4qWdw" name="getREFUnits" method="_QoEf7FJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QoeIj1JQEeiyW7NaN4qWdw">
                    <body>Get a list of abstract REF units for a player.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> to query the REF of.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QlqFEFJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlqFEVJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QlqFElJQEeiyW7NaN4qWdw" name="getHighScores" method="_QoEf71JQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QoeIkFJQEeiyW7NaN4qWdw">
                    <body>Gets the list of high scores.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that is querying.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QlqFE1JQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlqsIFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QlqsIVJQEeiyW7NaN4qWdw" name="chat" method="_QoEf8lJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QoeIkVJQEeiyW7NaN4qWdw">
                    <body>Chat.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that is chatting.&#xD;
     * @param message The chat message.&#xD;
     * @param pri A privacy setting, currently a noop.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QlqsIlJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QlqsI1JQEeiyW7NaN4qWdw" name="message">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QlqsJFJQEeiyW7NaN4qWdw" name="pri">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QlrTMFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QlrTMVJQEeiyW7NaN4qWdw" name="getStatistics" method="_QoEf91JQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QoeIklJQEeiyW7NaN4qWdw">
                    <body>Get the current game statistics.&#xD;
     *&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QlrTMlJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qlr6QFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Qlr6QVJQEeiyW7NaN4qWdw" name="enterRevengeMode" method="_QoEf-lJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QoevkFJQEeiyW7NaN4qWdw">
                    <body>Enters revenge mode against those evil AIs.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> entering revenge mode.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qlr6QlJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qlr6Q1JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QlshUFJQEeiyW7NaN4qWdw" name="rearrangeColony" method="_QoFG8FJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QoevkVJQEeiyW7NaN4qWdw">
                    <body>Rearrange a colony.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that is querying.&#xD;
     * @param colony The &lt;code>Colony&lt;/code> to rearrange.&#xD;
     * @param unitChanges A list of &lt;code>UnitChange&lt;/code>s to apply.&#xD;
     * @return An &lt;code>Element&lt;/code> encapsulating this action.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QltIYFJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QltIYVJQEeiyW7NaN4qWdw" name="colony" type="_QiYuoVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QltIYlJQEeiyW7NaN4qWdw" name="unitChanges" type="_QhldYVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QltIY1JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <nestedClassifier xmi:type="uml:Interface" xmi:id="_P5N10FJQEeiyW7NaN4qWdw" name="DOMMessageHandler" visibility="private">
                  <ownedOperation xmi:id="_Qktp4FJQEeiyW7NaN4qWdw" name="handle">
                    <ownedParameter xmi:id="_Qktp4VJQEeiyW7NaN4qWdw" name="message" type="_QhZ3MVJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_Qktp4lJQEeiyW7NaN4qWdw" type="_QhZ3MVJQEeiyW7NaN4qWdw" direction="return"/>
                  </ownedOperation>
                </nestedClassifier>
                <nestedClassifier xmi:type="uml:Class" xmi:id="_P5Oc4FJQEeiyW7NaN4qWdw" name="DOMMessageCallable" visibility="private">
                  <eAnnotations xmi:id="_P5PD8FJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_P5PD8VJQEeiyW7NaN4qWdw" key="static"/>
                  </eAnnotations>
                  <ownedAttribute xmi:id="_QnZKdVJQEeiyW7NaN4qWdw" name="connection" visibility="private" isLeaf="true" type="_QhZQIlJQEeiyW7NaN4qWdw" isReadOnly="true" association="_QozfsFJQEeiyW7NaN4qWdw"/>
                  <ownedAttribute xmi:id="_QnZxgVJQEeiyW7NaN4qWdw" name="game" visibility="private" isLeaf="true" type="_QhYpEVJQEeiyW7NaN4qWdw" isReadOnly="true" association="_Qozfs1JQEeiyW7NaN4qWdw"/>
                  <ownedAttribute xmi:id="_QnZxg1JQEeiyW7NaN4qWdw" name="message" visibility="private" isLeaf="true" type="_QhZ3MVJQEeiyW7NaN4qWdw" isReadOnly="true" association="_Qo0GwFJQEeiyW7NaN4qWdw"/>
                  <ownedAttribute xmi:id="_QnaYkVJQEeiyW7NaN4qWdw" name="handler" visibility="private" isLeaf="true" type="_P5N10FJQEeiyW7NaN4qWdw" isReadOnly="true" association="_Qo0Gw1JQEeiyW7NaN4qWdw"/>
                  <interfaceRealization xmi:id="_Qktp41JQEeiyW7NaN4qWdw" client="_P5Oc4FJQEeiyW7NaN4qWdw" supplier="_QiQy0VJQEeiyW7NaN4qWdw" contract="_QiQy0VJQEeiyW7NaN4qWdw"/>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn79B1JQEeiyW7NaN4qWdw" name="DOMMessageCallable" specification="_Qku4AFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_Qn79CFJQEeiyW7NaN4qWdw" name="connection" type="_QhZQIlJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_Qn79CVJQEeiyW7NaN4qWdw" name="game" type="_QhYpEVJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_Qn79ClJQEeiyW7NaN4qWdw" name="message" type="_QhZ3MVJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_Qn79C1JQEeiyW7NaN4qWdw" name="handler" type="_P5N10FJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_Qn79DFJQEeiyW7NaN4qWdw" type="_P5Oc4FJQEeiyW7NaN4qWdw" direction="return"/>
                    <language>java</language>
                    <body>this.connection = connection;&#xD;
         this.game = game;&#xD;
         this.message = message;&#xD;
         this.handler = handler;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_Qn79DVJQEeiyW7NaN4qWdw" name="call" specification="_P5PrAFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_Qn79DlJQEeiyW7NaN4qWdw" type="_QhZ3MVJQEeiyW7NaN4qWdw" direction="return"/>
                    <language>java</language>
                    <body>Element reply;&#xD;
         try {&#xD;
             reply = connection.ask(message.toXMLElement());&#xD;
         } catch (IOException e) {&#xD;
             return null;&#xD;
         }&#xD;
         DOMMessage replyMessage = DOMMessage.createMessage(game, reply);&#xD;
         return (replyMessage == null) ? null&#xD;
             : handler.handle(replyMessage);&#xD;
     </body>
                  </ownedBehavior>
                  <ownedOperation xmi:id="_P5PrAFJQEeiyW7NaN4qWdw" name="call" method="_Qn79DVJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_Qku4CFJQEeiyW7NaN4qWdw" type="_QhZ3MVJQEeiyW7NaN4qWdw" direction="return"/>
                  </ownedOperation>
                  <ownedOperation xmi:id="_Qku4AFJQEeiyW7NaN4qWdw" name="DOMMessageCallable" method="_Qn79B1JQEeiyW7NaN4qWdw">
                    <eAnnotations xmi:id="_Qku4BVJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                      <details xmi:id="_Qku4BlJQEeiyW7NaN4qWdw" key="create"/>
                    </eAnnotations>
                    <ownedParameter xmi:id="_Qku4AVJQEeiyW7NaN4qWdw" name="connection" type="_QhZQIlJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_Qku4AlJQEeiyW7NaN4qWdw" name="game" type="_QhYpEVJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_Qku4A1JQEeiyW7NaN4qWdw" name="message" type="_QhZ3MVJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_Qku4BFJQEeiyW7NaN4qWdw" name="handler" type="_P5N10FJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_Qku4B1JQEeiyW7NaN4qWdw" type="_P5Oc4FJQEeiyW7NaN4qWdw" direction="return"/>
                  </ownedOperation>
                </nestedClassifier>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_P6C8QFJQEeiyW7NaN4qWdw" name="ChangeSet">
                <ownedComment xmi:id="_QoevklJQEeiyW7NaN4qWdw">
                  <body>Changes to be sent to the client.</body>
                </ownedComment>
                <ownedAttribute xmi:id="_QneC8FJQEeiyW7NaN4qWdw" name="changeComparator" visibility="private" isLeaf="true" isStatic="true" type="_QiNvgFJQEeiyW7NaN4qWdw" isReadOnly="true" association="_Qo0t1FJQEeiyW7NaN4qWdw">
                  <defaultValue xmi:type="uml:LiteralString" xmi:id="_QneqAFJQEeiyW7NaN4qWdw" value="Comparator.comparingInt(Change::getPriority)"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_Qnf4IFJQEeiyW7NaN4qWdw" name="changes" visibility="private" isLeaf="true" type="_Qhk2UFJQEeiyW7NaN4qWdw" isReadOnly="true" association="_Qo1U4VJQEeiyW7NaN4qWdw"/>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoRUP1JQEeiyW7NaN4qWdw" name="ChangeSet" specification="_P6-JUFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoRUQFJQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>changes = new ArrayList&lt;>();&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoRUQVJQEeiyW7NaN4qWdw" name="ChangeSet" specification="_Qjx1wFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoRUQlJQEeiyW7NaN4qWdw" name="other" type="_P6C8QFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoRUQ1JQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>changes = new ArrayList&lt;>(other.changes);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoRURFJQEeiyW7NaN4qWdw" name="remove" specification="_QmpjklJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoRURVJQEeiyW7NaN4qWdw" name="fcgo" type="_QidnIlJQEeiyW7NaN4qWdw"/>
                  <language>java</language>
                  <body>Iterator&lt;Change> ci = changes.iterator();&#xD;
     while (ci.hasNext()) {&#xD;
         Change c = ci.next();&#xD;
         if (c.matches(fcgo)) ci.remove();&#xD;
     }&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoSiUFJQEeiyW7NaN4qWdw" name="add" specification="_QmqKoFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoSiUVJQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoSiUlJQEeiyW7NaN4qWdw" name="objects" type="_QidnIlJQEeiyW7NaN4qWdw">
                    <upperValue xmi:type="uml:LiteralUnlimitedNatural" xmi:id="_QoSiU1JQEeiyW7NaN4qWdw" value="*"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QoSiVFJQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>for (FreeColGameObject o : objects) {&#xD;
         changes.add(new ObjectChange(see, o));&#xD;
     }&#xD;
     return this;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoSiVVJQEeiyW7NaN4qWdw" name="add" specification="_QmqxslJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoSiVlJQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoSiV1JQEeiyW7NaN4qWdw" name="objects" type="_QjdssFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoSiWFJQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>for (FreeColGameObject o : objects) {&#xD;
         changes.add(new ObjectChange(see, o));&#xD;
     }&#xD;
     return this;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoSiWVJQEeiyW7NaN4qWdw" name="add" specification="_Qmr_0FJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoSiWlJQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoSiW1JQEeiyW7NaN4qWdw" name="cp" type="_P6EKYFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoSiXFJQEeiyW7NaN4qWdw" name="message" type="_QhZ3MVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoSiXVJQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>changes.add(new MessageChange(see, cp, message));&#xD;
     return this;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoSiXlJQEeiyW7NaN4qWdw" name="addAttack" specification="_Qmsm4FJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoSiX1JQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoSiYFJQEeiyW7NaN4qWdw" name="attacker" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoSiYVJQEeiyW7NaN4qWdw" name="defender" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoSiYlJQEeiyW7NaN4qWdw" name="success">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QoSiY1JQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>changes.add(new AttackChange(see, attacker, defender, success));&#xD;
     return this;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoSiZFJQEeiyW7NaN4qWdw" name="addAttribute" specification="_Qjyc0FJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoSiZVJQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoSiZlJQEeiyW7NaN4qWdw" name="key">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QoSiZ1JQEeiyW7NaN4qWdw" name="value">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QoSiaFJQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>changes.add(new AttributeChange(see, key, value));&#xD;
     return this;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoSiaVJQEeiyW7NaN4qWdw" name="addDead" specification="_QmtN8FJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoSialJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoSia1JQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>addTrivial(See.all(), &quot;setDead&quot;, ChangePriority.CHANGE_EARLY,&#xD;
             &quot;player&quot;, serverPlayer.getId());&#xD;
     return this;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoSibFJQEeiyW7NaN4qWdw" name="addDisappear" specification="_Qmt1AFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoSibVJQEeiyW7NaN4qWdw" name="owner" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoSiblJQEeiyW7NaN4qWdw" name="tile" type="_QivT8VJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoSib1JQEeiyW7NaN4qWdw" name="fcgo" type="_QidnIlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoSicFJQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>List&lt;FreeColGameObject> objects = new ArrayList&lt;>();&#xD;
     objects.add(fcgo);&#xD;
     changes.add(new RemoveChange(See.perhaps().except(owner), tile, objects));&#xD;
     changes.add(new ObjectChange(See.perhaps().except(owner), tile));&#xD;
     return this;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoSicVJQEeiyW7NaN4qWdw" name="addFather" specification="_QmucEFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoSiclJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoSic1JQEeiyW7NaN4qWdw" name="father" type="_QidnIFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoSidFJQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>changes.add(new OwnedChange(See.only(serverPlayer), father));&#xD;
     serverPlayer.addFather(father);&#xD;
     return this;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoSidVJQEeiyW7NaN4qWdw" name="addFeatureChange" specification="_QmvDIFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoSidlJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoSid1JQEeiyW7NaN4qWdw" name="object" type="_QidnIlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoSieFJQEeiyW7NaN4qWdw" name="ability" type="_QiW5cVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoSieVJQEeiyW7NaN4qWdw" name="add">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QoSielJQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>changes.add(new FeatureChange(See.only(serverPlayer), object, ability, add));&#xD;
     if (add) {&#xD;
         object.addAbility(ability);&#xD;
     } else {&#xD;
         object.removeAbility(ability);&#xD;
     }&#xD;
     return this;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoTJYFJQEeiyW7NaN4qWdw" name="addFeatureChange" specification="_QmvqMFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoTJYVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoTJYlJQEeiyW7NaN4qWdw" name="object" type="_QidnIlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoTJY1JQEeiyW7NaN4qWdw" name="modifier" type="_Qjfh4VJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoTJZFJQEeiyW7NaN4qWdw" name="add">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QoTJZVJQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>changes.add(new FeatureChange(See.only(serverPlayer), object, modifier, add));&#xD;
     if (add) {&#xD;
         object.addModifier(modifier);&#xD;
     } else {&#xD;
         object.removeModifier(modifier);&#xD;
     }&#xD;
     return this;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoTJZlJQEeiyW7NaN4qWdw" name="addGlobalHistory" specification="_QmwRQFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoTJZ1JQEeiyW7NaN4qWdw" name="game" type="_QhYpEVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoTJaFJQEeiyW7NaN4qWdw" name="history" type="_QihRgVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoTJaVJQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>changes.add(new OwnedChange(See.all(), history));&#xD;
     for (Player p : game.getLiveEuropeanPlayers(null)) {&#xD;
         p.addHistory(history);&#xD;
     }&#xD;
     return this;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoTJalJQEeiyW7NaN4qWdw" name="addHistory" specification="_Qmw4U1JQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoTJa1JQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoTJbFJQEeiyW7NaN4qWdw" name="history" type="_QihRgVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoTJbVJQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>changes.add(new OwnedChange(See.only(serverPlayer), history));&#xD;
     serverPlayer.addHistory(history);&#xD;
     return this;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoTJblJQEeiyW7NaN4qWdw" name="addMessage" specification="_QmxfYlJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoTJb1JQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoTJcFJQEeiyW7NaN4qWdw" name="message" type="_QinYIFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoTJcVJQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>changes.add(new OwnedChange(see, message));&#xD;
     return this;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoTJclJQEeiyW7NaN4qWdw" name="addMove" specification="_QmyGcFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoTJc1JQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoTJdFJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoTJdVJQEeiyW7NaN4qWdw" name="loc" type="_QikU0FJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoTJdlJQEeiyW7NaN4qWdw" name="tile" type="_QivT8VJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoTJd1JQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>changes.add(new MoveChange(see, unit, loc, tile));&#xD;
     return this;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoTwcFJQEeiyW7NaN4qWdw" name="addPartial" specification="_QmzUkFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoTwcVJQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoTwclJQEeiyW7NaN4qWdw" name="fcgo" type="_QidnIlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoTwc1JQEeiyW7NaN4qWdw" name="fields">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    <upperValue xmi:type="uml:LiteralUnlimitedNatural" xmi:id="_QoTwdFJQEeiyW7NaN4qWdw" value="*"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QoTwdVJQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>changes.add(new PartialObjectChange(see, fcgo, fields));&#xD;
     return this;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoTwdlJQEeiyW7NaN4qWdw" name="addPlayer" specification="_Qmz7olJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoTwd1JQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoTweFJQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>changes.add(new PlayerChange(See.all().except(serverPlayer),&#xD;
                                  serverPlayer));&#xD;
     return this;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoTweVJQEeiyW7NaN4qWdw" name="addRemove" specification="_Qm0islJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoTwelJQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoTwe1JQEeiyW7NaN4qWdw" name="loc" type="_QikU0FJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoTwfFJQEeiyW7NaN4qWdw" name="obj" type="_QidnIlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoTwfVJQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>changes.add(new RemoveChange(see, loc, obj.getDisposeList()));//-vis&#xD;
     return this;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoTwflJQEeiyW7NaN4qWdw" name="addRemoves" specification="_Qm1JxFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoTwf1JQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoTwgFJQEeiyW7NaN4qWdw" name="loc" type="_QikU0FJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoTwgVJQEeiyW7NaN4qWdw" name="objects" type="_QhldYVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoTwglJQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>for (FreeColGameObject fcgo : objects) {&#xD;
         changes.add(new RemoveChange(see, loc, fcgo.getDisposeList()));&#xD;
     }&#xD;
     return this;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoUXgFJQEeiyW7NaN4qWdw" name="addSale" specification="_Qm2X4VJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoUXgVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoUXglJQEeiyW7NaN4qWdw" name="settlement" type="_QitewVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoUXg1JQEeiyW7NaN4qWdw" name="type" type="_QigDYVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoUXhFJQEeiyW7NaN4qWdw" name="price">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QoUXhVJQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>Game game = settlement.getGame();&#xD;
     LastSale sale = new LastSale(settlement, type, game.getTurn(), price);&#xD;
     changes.add(new OwnedChange(See.only(serverPlayer), sale));&#xD;
     serverPlayer.addLastSale(sale);&#xD;
     return this;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoUXhlJQEeiyW7NaN4qWdw" name="addSpy" specification="_Qm2-9FJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoUXh1JQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoUXiFJQEeiyW7NaN4qWdw" name="settlement" type="_QitewVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoUXiVJQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>changes.add(new SpyChange(see, settlement));&#xD;
     return this;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoUXilJQEeiyW7NaN4qWdw" name="addStance" specification="_Qm3mAlJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoUXi1JQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoUXjFJQEeiyW7NaN4qWdw" name="first" type="_QhZQIFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoUXjVJQEeiyW7NaN4qWdw" name="stance" type="_QisQoFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoUXjlJQEeiyW7NaN4qWdw" name="second" type="_QhZQIFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoUXj1JQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>changes.add(new StanceChange(see, first, stance, second));&#xD;
     return this;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoUXkFJQEeiyW7NaN4qWdw" name="addTradeRoute" specification="_Qm4NFFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoUXkVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoUXklJQEeiyW7NaN4qWdw" name="tradeRoute" type="_QixwMVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoUXk1JQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>changes.add(new OwnedChange(See.only(serverPlayer), tradeRoute));&#xD;
     return this;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoUXlFJQEeiyW7NaN4qWdw" name="addTrivial" specification="_Qj05EFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoUXlVJQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoUXllJQEeiyW7NaN4qWdw" name="name">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QoUXl1JQEeiyW7NaN4qWdw" name="cp" type="_P6EKYFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoUXmFJQEeiyW7NaN4qWdw" name="attributes">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    <upperValue xmi:type="uml:LiteralUnlimitedNatural" xmi:id="_QoUXmVJQEeiyW7NaN4qWdw" value="*"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QoUXmlJQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>changes.add(new TrivialChange(see, name, cp.getPriority(), attributes));&#xD;
     return this;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoUXm1JQEeiyW7NaN4qWdw" name="canSeeUnit" specification="_Qm40IlJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoUXnFJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoUXnVJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoUXnlJQEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>Tile tile;&#xD;
     return (serverPlayer.owns(unit)) ? true&#xD;
         : ((tile = unit.getTile()) == null) ? false&#xD;
         : (!serverPlayer.canSee(tile)) ? false&#xD;
         : (tile.hasSettlement()) ? false&#xD;
         : (unit.isOnCarrier()) ? false&#xD;
         : true;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoU-kFJQEeiyW7NaN4qWdw" name="collapseElements" specification="_Qm5bMFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoU-kVJQEeiyW7NaN4qWdw" name="head" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoU-klJQEeiyW7NaN4qWdw" name="tail" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  <language>java</language>
                  <body>while (tail.hasChildNodes()) {&#xD;
         head.appendChild(tail.removeChild(tail.getFirstChild()));&#xD;
     }&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoU-k1JQEeiyW7NaN4qWdw" name="collapseOK" specification="_Qm6CQFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoU-lFJQEeiyW7NaN4qWdw" name="e1" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoU-lVJQEeiyW7NaN4qWdw" name="e2" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoU-llJQEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>if (!e1.getTagName().equals(e2.getTagName())) return false;&#xD;
     NamedNodeMap nnm1 = e1.getAttributes();&#xD;
     NamedNodeMap nnm2 = e2.getAttributes();&#xD;
     if (nnm1.getLength() != nnm2.getLength()) return false;&#xD;
     for (int i = 0; i &lt; nnm1.getLength(); i++) {&#xD;
         if (nnm1.item(i).getNodeType() != nnm2.item(i).getNodeType()) {&#xD;
             return false;&#xD;
         }&#xD;
         if (!nnm1.item(i).getNodeName().equals(nnm2.item(i).getNodeName())) {&#xD;
             return false;&#xD;
         }&#xD;
         if (!nnm1.item(i).getNodeValue().equals(nnm2.item(i).getNodeValue())) {&#xD;
             return false;&#xD;
         }&#xD;
     }&#xD;
     return true;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoU-l1JQEeiyW7NaN4qWdw" name="collapseElementList" specification="_Qm6pU1JQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoU-mFJQEeiyW7NaN4qWdw" name="elements" type="_QhldYVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoU-mVJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" isOrdered="true" direction="return">
                    <upperValue xmi:type="uml:LiteralUnlimitedNatural" xmi:id="_QoU-mlJQEeiyW7NaN4qWdw" value="*"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>List&lt;Element> results = new ArrayList&lt;>();&#xD;
     if (!elements.isEmpty()) {&#xD;
         Element head = elements.remove(0);&#xD;
         while (!elements.isEmpty()) {&#xD;
             Element e = elements.remove(0);&#xD;
             if (collapseOK(head, e)) {&#xD;
                 collapseElements(head, e);&#xD;
             } else {&#xD;
                 results.add(head);&#xD;
                 head = e;&#xD;
             }&#xD;
         }&#xD;
         results.add(head);&#xD;
     }&#xD;
     return results;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoU-m1JQEeiyW7NaN4qWdw" name="build" specification="_Qm73cFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoU-nFJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoU-nVJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>List&lt;Change> c = new ArrayList&lt;>(changes);&#xD;
     List&lt;Element> elements = new ArrayList&lt;>();&#xD;
     List&lt;Change> diverted = new ArrayList&lt;>();&#xD;
     Document doc = DOMMessage.createNewDocument();&#xD;
&#xD;
     // For all sorted changes, if it is notifiable to the target&#xD;
     // player then convert it to an Element, or divert for later&#xD;
     // attachment.  Then add all consequence changes to the list.&#xD;
     Collections.sort(c, changeComparator);&#xD;
     while (!c.isEmpty()) {&#xD;
         Change change = c.remove(0);&#xD;
         if (change.isNotifiable(serverPlayer)) {&#xD;
             if (change.convertsToElement()) {&#xD;
                 elements.add(change.toElement(serverPlayer, doc));&#xD;
             } else {&#xD;
                 diverted.add(change);&#xD;
             }&#xD;
             c.addAll(change.consequences(serverPlayer));&#xD;
         }&#xD;
     }&#xD;
     elements = collapseElementList(elements);&#xD;
&#xD;
     // Decide what to return.  If there are several parts with&#xD;
     // children then return multiple, if there is one viable part,&#xD;
     // return that, if there is none return null unless there are&#xD;
     // attributes in which case they become viable as an update.&#xD;
     Element result;&#xD;
     switch (elements.size()) {&#xD;
     case 0:&#xD;
         if (diverted.isEmpty()) return null;&#xD;
         result = doc.createElement(&quot;update&quot;);&#xD;
         break;&#xD;
     case 1:&#xD;
         result = elements.get(0);&#xD;
         break;&#xD;
     default:&#xD;
         result = doc.createElement(&quot;multiple&quot;);&#xD;
         for (Element e : elements) result.appendChild(e);&#xD;
         break;&#xD;
     }&#xD;
     doc.appendChild(result);&#xD;
     for (Change change : diverted) change.attachToElement(result);&#xD;
     return result;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoU-nlJQEeiyW7NaN4qWdw" name="toString" specification="_P7CawFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoU-n1JQEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <language>java</language>
                  <body>StringBuilder sb = new StringBuilder();&#xD;
     Collections.sort(changes, changeComparator);&#xD;
     for (Change c : changes) sb.append(c).append(&quot;\n&quot;);&#xD;
     return sb.toString();&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_P6-JUFJQEeiyW7NaN4qWdw" name="ChangeSet" method="_QoRUP1JQEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_P6-wYFJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_P6-wYVJQEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_QohL1FJQEeiyW7NaN4qWdw">
                    <body>Simple constructor.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_P6-wYlJQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_P7CawFJQEeiyW7NaN4qWdw" name="toString" method="_QoU-nlJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_P7DB0FJQEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_Qjx1wFJQEeiyW7NaN4qWdw" name="ChangeSet" method="_QoRUQVJQEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_Qjx1wlJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_Qjx1w1JQEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_QohL1VJQEeiyW7NaN4qWdw">
                    <body>Copying constructor.&#xD;
     *&#xD;
     * @param other The other &lt;code>ChangeSet&lt;/code> to copy.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qjx1wVJQEeiyW7NaN4qWdw" name="other" type="_P6C8QFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qjx1xFJQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Qjyc0FJQEeiyW7NaN4qWdw" name="addAttribute" method="_QoSiZFJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QohL2lJQEeiyW7NaN4qWdw">
                    <body>Helper function to add an attribute setting to a ChangeSet.&#xD;
     *&#xD;
     * @param see The visibility of this change.&#xD;
     * @param key A key &lt;code>String&lt;/code>.&#xD;
     * @param value The corresponding value as a &lt;code>String&lt;/code>.&#xD;
     * @return The updated &lt;code>ChangeSet&lt;/code>.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qjyc0VJQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qjyc0lJQEeiyW7NaN4qWdw" name="key">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Qjyc01JQEeiyW7NaN4qWdw" name="value">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Qjyc1FJQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Qj05EFJQEeiyW7NaN4qWdw" name="addTrivial" method="_QoUXlFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_Qj05EVJQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qj1gIFJQEeiyW7NaN4qWdw" name="name">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Qj1gIVJQEeiyW7NaN4qWdw" name="cp" type="_P6EKYFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qj1gIlJQEeiyW7NaN4qWdw" name="attributes">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    <upperValue xmi:type="uml:LiteralUnlimitedNatural" xmi:id="_Qj2HMFJQEeiyW7NaN4qWdw" value="*"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Qj1gI1JQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QmpjklJQEeiyW7NaN4qWdw" name="remove" method="_QoRURFJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QohL1lJQEeiyW7NaN4qWdw">
                    <body>Sometimes we need to backtrack on making a change.&#xD;
     *&#xD;
     * @param fcgo A &lt;code>FreeColGameObject&lt;/code> to remove a matching&#xD;
     *     change for.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qmpjk1JQEeiyW7NaN4qWdw" name="fcgo" type="_QidnIlJQEeiyW7NaN4qWdw"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QmqKoFJQEeiyW7NaN4qWdw" name="add" method="_QoSiUFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QmqKoVJQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QmqKolJQEeiyW7NaN4qWdw" name="objects" type="_QidnIlJQEeiyW7NaN4qWdw">
                    <upperValue xmi:type="uml:LiteralUnlimitedNatural" xmi:id="_QmqxsFJQEeiyW7NaN4qWdw" value="*"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QmqKo1JQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QmqxslJQEeiyW7NaN4qWdw" name="add" method="_QoSiVVJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QohL11JQEeiyW7NaN4qWdw">
                    <body>Helper function to add updates for multiple objects to a ChangeSet.&#xD;
     *&#xD;
     * @param see The visibility of this change.&#xD;
     * @param objects The &lt;code>FreeColGameObject&lt;/code>s that changed.&#xD;
     * @return The updated &lt;code>ChangeSet&lt;/code>.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qmqxs1JQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QmrYwFJQEeiyW7NaN4qWdw" name="objects" type="_QjdssFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QmrYwVJQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Qmr_0FJQEeiyW7NaN4qWdw" name="add" method="_QoSiWVJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QohL2FJQEeiyW7NaN4qWdw">
                    <body>Helper function to add a Message to a ChangeSet.&#xD;
     *&#xD;
     * @param see The visibility of this change.&#xD;
     * @param cp The priority of this change.&#xD;
     * @param message The &lt;code>Message&lt;/code> to add.&#xD;
     * @return The updated &lt;code>ChangeSet&lt;/code>.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qmr_0VJQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qmr_0lJQEeiyW7NaN4qWdw" name="cp" type="_P6EKYFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qmr_01JQEeiyW7NaN4qWdw" name="message" type="_QhZ3MVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qmr_1FJQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Qmsm4FJQEeiyW7NaN4qWdw" name="addAttack" method="_QoSiXlJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QohL2VJQEeiyW7NaN4qWdw">
                    <body>Helper function to add an attack to a ChangeSet.&#xD;
     *&#xD;
     * @param see The visibility of this change.&#xD;
     * @param attacker The &lt;code>Unit&lt;/code> that is attacking.&#xD;
     * @param defender The &lt;code>Unit&lt;/code> that is defending.&#xD;
     * @param success Did the attack succeed?&#xD;
     * @return The updated &lt;code>ChangeSet&lt;/code>.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qmsm4VJQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qmsm4lJQEeiyW7NaN4qWdw" name="attacker" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qmsm41JQEeiyW7NaN4qWdw" name="defender" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qmsm5FJQEeiyW7NaN4qWdw" name="success">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Qmsm5VJQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QmtN8FJQEeiyW7NaN4qWdw" name="addDead" method="_QoSiaVJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QohL21JQEeiyW7NaN4qWdw">
                    <body>Helper function to add a dead player event to a ChangeSet.&#xD;
     * Deaths are public knowledge.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> that died.&#xD;
     * @return The updated &lt;code>ChangeSet&lt;/code>.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QmtN8VJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QmtN8lJQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Qmt1AFJQEeiyW7NaN4qWdw" name="addDisappear" method="_QoSibFJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QohL3FJQEeiyW7NaN4qWdw">
                    <body>Helper function to add a removal for an object that disappears&#xD;
     * (that is, moves where it can not be seen) to a ChangeSet.&#xD;
     *&#xD;
     * @param owner The &lt;code>ServerPlayer&lt;/code> that owns this object.&#xD;
     * @param tile The &lt;code>Tile&lt;/code> where the object was.&#xD;
     * @param fcgo The &lt;code>FreeColGameObject&lt;/code> that disappears.&#xD;
     * @return The updated &lt;code>ChangeSet&lt;/code>.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qmt1AVJQEeiyW7NaN4qWdw" name="owner" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qmt1AlJQEeiyW7NaN4qWdw" name="tile" type="_QivT8VJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qmt1A1JQEeiyW7NaN4qWdw" name="fcgo" type="_QidnIlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qmt1BFJQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QmucEFJQEeiyW7NaN4qWdw" name="addFather" method="_QoSicVJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QohL3VJQEeiyW7NaN4qWdw">
                    <body>Helper function to add a founding father addition event to a ChangeSet.&#xD;
     * Also adds the father to the owner.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> adding the father.&#xD;
     * @param father The &lt;code>FoundingFather&lt;/code> to add.&#xD;
     * @return The updated &lt;code>ChangeSet&lt;/code>.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QmucEVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QmucElJQEeiyW7NaN4qWdw" name="father" type="_QidnIFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QmucE1JQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QmvDIFJQEeiyW7NaN4qWdw" name="addFeatureChange" method="_QoSidVJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QohL3lJQEeiyW7NaN4qWdw">
                    <body>Helper function to add an Ability to a FreeColGameObject, or remove it.&#xD;
     *&#xD;
     * @param serverPlayer a &lt;code>ServerPlayer&lt;/code> value&#xD;
     * @param object a &lt;code>FreeColGameObject&lt;/code> value&#xD;
     * @param ability an &lt;code>Ability&lt;/code> value&#xD;
     * @param add a &lt;code>boolean&lt;/code> value&#xD;
     * @return a &lt;code>ChangeSet&lt;/code> value</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QmvDIVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QmvDIlJQEeiyW7NaN4qWdw" name="object" type="_QidnIlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QmvDI1JQEeiyW7NaN4qWdw" name="ability" type="_QiW5cVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QmvDJFJQEeiyW7NaN4qWdw" name="add">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QmvDJVJQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QmvqMFJQEeiyW7NaN4qWdw" name="addFeatureChange" method="_QoTJYFJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QohL31JQEeiyW7NaN4qWdw">
                    <body>Helper function to add a Modifier to a FreeColGameObject, or remove it.&#xD;
     *&#xD;
     * @param serverPlayer a &lt;code>ServerPlayer&lt;/code> value&#xD;
     * @param object a &lt;code>FreeColGameObject&lt;/code> value&#xD;
     * @param modifier a &lt;code>Modifier&lt;/code> value&#xD;
     * @param add a &lt;code>boolean&lt;/code> value&#xD;
     * @return a &lt;code>ChangeSet&lt;/code> value</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QmvqMVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QmvqMlJQEeiyW7NaN4qWdw" name="object" type="_QidnIlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QmvqM1JQEeiyW7NaN4qWdw" name="modifier" type="_Qjfh4VJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QmvqNFJQEeiyW7NaN4qWdw" name="add">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QmvqNVJQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QmwRQFJQEeiyW7NaN4qWdw" name="addGlobalHistory" method="_QoTJZlJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QohL4FJQEeiyW7NaN4qWdw">
                    <body>Helper function to add a global history event to a ChangeSet.&#xD;
     * Also adds the history to all the European players.&#xD;
     *&#xD;
     * @param game The &lt;code>Game&lt;/code> to find players in.&#xD;
     * @param history The &lt;code>HistoryEvent&lt;/code> to add.&#xD;
     * @return The updated &lt;code>ChangeSet&lt;/code>.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qmw4UFJQEeiyW7NaN4qWdw" name="game" type="_QhYpEVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qmw4UVJQEeiyW7NaN4qWdw" name="history" type="_QihRgVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qmw4UlJQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Qmw4U1JQEeiyW7NaN4qWdw" name="addHistory" method="_QoTJalJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QohL4VJQEeiyW7NaN4qWdw">
                    <body>Helper function to add a history event to a ChangeSet.&#xD;
     * Also adds the history to the owner.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> making history.&#xD;
     * @param history The &lt;code>HistoryEvent&lt;/code> to add.&#xD;
     * @return The updated &lt;code>ChangeSet&lt;/code>.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qmw4VFJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QmxfYFJQEeiyW7NaN4qWdw" name="history" type="_QihRgVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QmxfYVJQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QmxfYlJQEeiyW7NaN4qWdw" name="addMessage" method="_QoTJblJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QohL4lJQEeiyW7NaN4qWdw">
                    <body>Helper function to add a message to a ChangeSet.&#xD;
     *&#xD;
     * @param see The visibility of this change.&#xD;
     * @param message The &lt;code>ModelMessage&lt;/code> to add.&#xD;
     * @return The updated &lt;code>ChangeSet&lt;/code>.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QmxfY1JQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QmxfZFJQEeiyW7NaN4qWdw" name="message" type="_QinYIFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QmxfZVJQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QmyGcFJQEeiyW7NaN4qWdw" name="addMove" method="_QoTJclJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_Qohy4FJQEeiyW7NaN4qWdw">
                    <body>Helper function to add a move to a ChangeSet.&#xD;
     *&#xD;
     * @param see The visibility of this change.&#xD;
     * @param unit The &lt;code>Unit&lt;/code> that is moving.&#xD;
     * @param loc The location from which the unit is moving.&#xD;
     * @param tile The &lt;code>Tile&lt;/code> to which the unit is moving.&#xD;
     * @return The updated &lt;code>ChangeSet&lt;/code>.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QmyGcVJQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QmytgFJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QmytgVJQEeiyW7NaN4qWdw" name="loc" type="_QikU0FJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QmytglJQEeiyW7NaN4qWdw" name="tile" type="_QivT8VJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qmytg1JQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QmzUkFJQEeiyW7NaN4qWdw" name="addPartial" method="_QoTwcFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QmzUkVJQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QmzUklJQEeiyW7NaN4qWdw" name="fcgo" type="_QidnIlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QmzUk1JQEeiyW7NaN4qWdw" name="fields">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    <upperValue xmi:type="uml:LiteralUnlimitedNatural" xmi:id="_Qmz7oFJQEeiyW7NaN4qWdw" value="*"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QmzUlFJQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Qmz7olJQEeiyW7NaN4qWdw" name="addPlayer" method="_QoTwdlJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_Qohy4VJQEeiyW7NaN4qWdw">
                    <body>Helper function to add a new player to a ChangeSet.&#xD;
     *&#xD;
     * @param serverPlayer The new &lt;code>ServerPlayer&lt;/code> to add.&#xD;
     * @return The updated &lt;code>ChangeSet&lt;/code>.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qm0isFJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qm0isVJQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Qm0islJQEeiyW7NaN4qWdw" name="addRemove" method="_QoTweVJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_Qohy4lJQEeiyW7NaN4qWdw">
                    <body>Helper function to add a removal to a ChangeSet.&#xD;
     *&#xD;
     * -vis: If disposing of units or colonies, this routine changes&#xD;
     * player visibility.&#xD;
     *&#xD;
     * @param see The visibility of this change.&#xD;
     * @param loc The &lt;code>Location&lt;/code> where the object was.&#xD;
     * @param obj The &lt;code>FreeColGameObject&lt;/code> to remove.&#xD;
     * @return The updated &lt;code>ChangeSet&lt;/code>.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qm1JwFJQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qm1JwVJQEeiyW7NaN4qWdw" name="loc" type="_QikU0FJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qm1JwlJQEeiyW7NaN4qWdw" name="obj" type="_QidnIlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qm1Jw1JQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Qm1JxFJQEeiyW7NaN4qWdw" name="addRemoves" method="_QoTwflJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_Qohy41JQEeiyW7NaN4qWdw">
                    <body>Helper function to add removals for several objects to a ChangeSet.&#xD;
     *&#xD;
     * @param see The visibility of this change.&#xD;
     * @param loc The &lt;code>Location&lt;/code> where the object was.&#xD;
     * @param objects A list of &lt;code>FreeColGameObject&lt;/code>s to remove.&#xD;
     * @return The updated &lt;code>ChangeSet&lt;/code>.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qm1w0FJQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qm1w0VJQEeiyW7NaN4qWdw" name="loc" type="_QikU0FJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qm1w0lJQEeiyW7NaN4qWdw" name="objects" type="_QhldYVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qm1w01JQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Qm2X4VJQEeiyW7NaN4qWdw" name="addSale" method="_QoUXgFJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_Qohy5FJQEeiyW7NaN4qWdw">
                    <body>Helper function to add a sale change to a ChangeSet.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> making the sale.&#xD;
     * @param settlement The &lt;code>Settlement&lt;/code> that is buying.&#xD;
     * @param type The &lt;code>GoodsType&lt;/code> bought.&#xD;
     * @param price The per unit price.&#xD;
     * @return The updated &lt;code>ChangeSet&lt;/code>.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qm2X4lJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qm2-8FJQEeiyW7NaN4qWdw" name="settlement" type="_QitewVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qm2-8VJQEeiyW7NaN4qWdw" name="type" type="_QigDYVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qm2-8lJQEeiyW7NaN4qWdw" name="price">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_Qm2-81JQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Qm2-9FJQEeiyW7NaN4qWdw" name="addSpy" method="_QoUXhlJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_Qohy5VJQEeiyW7NaN4qWdw">
                    <body>Helper function to add a spying change to a ChangeSet.&#xD;
     *&#xD;
     * @param see The visibility of this change.&#xD;
     * @param settlement The &lt;code>Settlement&lt;/code> to spy on.&#xD;
     * @return The updated &lt;code>ChangeSet&lt;/code>.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qm2-9VJQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qm3mAFJQEeiyW7NaN4qWdw" name="settlement" type="_QitewVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qm3mAVJQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Qm3mAlJQEeiyW7NaN4qWdw" name="addStance" method="_QoUXilJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_Qohy5lJQEeiyW7NaN4qWdw">
                    <body>Helper function to add a stance change to a ChangeSet.&#xD;
     *&#xD;
     * @param see The visibility of this change.&#xD;
     * @param first The &lt;code>Player&lt;/code> changing stance.&#xD;
     * @param stance The &lt;code>Stance&lt;/code> to change to.&#xD;
     * @param second The &lt;code>Player&lt;/code> wrt with to change.&#xD;
     * @return The updated &lt;code>ChangeSet&lt;/code>.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qm3mA1JQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qm4NEFJQEeiyW7NaN4qWdw" name="first" type="_QhZQIFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qm4NEVJQEeiyW7NaN4qWdw" name="stance" type="_QisQoFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qm4NElJQEeiyW7NaN4qWdw" name="second" type="_QhZQIFJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qm4NE1JQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Qm4NFFJQEeiyW7NaN4qWdw" name="addTradeRoute" method="_QoUXkFJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_Qohy51JQEeiyW7NaN4qWdw">
                    <body>Helper function to add a new trade route change to a ChangeSet.&#xD;
     * Also adds the trade route to the player.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> adding the route.&#xD;
     * @param tradeRoute The new &lt;code>TradeRoute&lt;/code>.&#xD;
     * @return The updated &lt;code>ChangeSet&lt;/code>.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qm4NFVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qm40IFJQEeiyW7NaN4qWdw" name="tradeRoute" type="_QixwMVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qm40IVJQEeiyW7NaN4qWdw" type="_P6C8QFJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Qm40IlJQEeiyW7NaN4qWdw" name="canSeeUnit" visibility="private" isStatic="true" method="_QoUXm1JQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_Qohy6FJQEeiyW7NaN4qWdw">
                    <body>Checks if a player can see a unit.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> looking for the unit.&#xD;
     * @param unit The &lt;code>Unit&lt;/code> to check.&#xD;
     * @return True if the &lt;code>Unit&lt;/code> is visible to the player.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qm40I1JQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qm40JFJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qm40JVJQEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_Qm5bMFJQEeiyW7NaN4qWdw" name="collapseElements" visibility="private" isStatic="true" method="_QoU-kFJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_Qohy6VJQEeiyW7NaN4qWdw">
                    <body>Collapse one element into another.&#xD;
     *&#xD;
     * @param head The &lt;code>Element&lt;/code> to collapse into.&#xD;
     * @param tail The &lt;code>Element&lt;/code> to extract nodes from.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qm5bMVJQEeiyW7NaN4qWdw" name="head" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qm5bMlJQEeiyW7NaN4qWdw" name="tail" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                </ownedOperation>
                <ownedOperation xmi:id="_Qm6CQFJQEeiyW7NaN4qWdw" name="collapseOK" visibility="private" isStatic="true" method="_QoU-k1JQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_Qohy6lJQEeiyW7NaN4qWdw">
                    <body>Can two elements be collapsed?&#xD;
     * They need to have the same name and attributes.&#xD;
     *&#xD;
     * @param e1 The first &lt;code>Element&lt;/code>.&#xD;
     * @param e2 The second &lt;code>Element&lt;/code>.&#xD;
     * @return True if they can be collapsed.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qm6pUFJQEeiyW7NaN4qWdw" name="e1" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qm6pUVJQEeiyW7NaN4qWdw" name="e2" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qm6pUlJQEeiyW7NaN4qWdw" direction="return">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_Qm6pU1JQEeiyW7NaN4qWdw" name="collapseElementList" visibility="private" isStatic="true" method="_QoU-l1JQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_Qohy61JQEeiyW7NaN4qWdw">
                    <body>Collapse adjacent elements in a list with the same tag.&#xD;
     *&#xD;
     * @param elements The list of &lt;code>Element&lt;/code>s to consider.&#xD;
     * @return A collapsed list of elements.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qm6pVFJQEeiyW7NaN4qWdw" name="elements" type="_QhldYVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qm6pVVJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" isOrdered="true" direction="return">
                    <upperValue xmi:type="uml:LiteralUnlimitedNatural" xmi:id="_Qm7QYFJQEeiyW7NaN4qWdw" value="*"/>
                  </ownedParameter>
                </ownedOperation>
                <ownedOperation xmi:id="_Qm73cFJQEeiyW7NaN4qWdw" name="build" method="_QoU-m1JQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_Qohy7FJQEeiyW7NaN4qWdw">
                    <body>Build a generalized update.&#xD;
     * Beware that removing an object does not necessarily update&#xD;
     * its tile correctly on the client side--- if a tile update&#xD;
     * is needed the tile should be supplied in the objects list.&#xD;
     *&#xD;
     * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> to send the&#xD;
     *            update to.&#xD;
     * @return An element encapsulating an update of the objects to&#xD;
     *         consider, or null if there is nothing to report.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_Qm73cVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_Qm73clJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <nestedClassifier xmi:type="uml:Enumeration" xmi:id="_P6EKYFJQEeiyW7NaN4qWdw" name="ChangePriority">
                  <eAnnotations xmi:id="_P6EKYVJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_P6EKYlJQEeiyW7NaN4qWdw" key="static"/>
                  </eAnnotations>
                  <ownedAttribute xmi:id="_QnfREFJQEeiyW7NaN4qWdw" name="level" visibility="private" isLeaf="true" isReadOnly="true">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedAttribute>
                  <ownedOperation xmi:id="_P6F_kFJQEeiyW7NaN4qWdw" name="ChangePriority" visibility="package" method="_QoGVEFJQEeiyW7NaN4qWdw">
                    <eAnnotations xmi:id="_P6F_klJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                      <details xmi:id="_P6F_k1JQEeiyW7NaN4qWdw" key="create"/>
                    </eAnnotations>
                    <ownedParameter xmi:id="_P6F_kVJQEeiyW7NaN4qWdw" name="level">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_P6F_lFJQEeiyW7NaN4qWdw" type="_P6EKYFJQEeiyW7NaN4qWdw" direction="return"/>
                  </ownedOperation>
                  <ownedOperation xmi:id="_P6GmoFJQEeiyW7NaN4qWdw" name="getPriority" method="_QoHjMFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_P6GmoVJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedLiteral xmi:id="_P6EKY1JQEeiyW7NaN4qWdw" name="CHANGE_ATTRIBUTE">
                    <specification xmi:type="uml:Expression" xmi:id="_P6EKZFJQEeiyW7NaN4qWdw">
                      <operand xmi:type="uml:LiteralString" xmi:id="_Qoevk1JQEeiyW7NaN4qWdw" value="-1"/>
                    </specification>
                  </ownedLiteral>
                  <ownedLiteral xmi:id="_P6ExcFJQEeiyW7NaN4qWdw" name="CHANGE_ANIMATION">
                    <specification xmi:type="uml:Expression" xmi:id="_P6ExcVJQEeiyW7NaN4qWdw">
                      <operand xmi:type="uml:LiteralString" xmi:id="_QoevlFJQEeiyW7NaN4qWdw" value="0"/>
                    </specification>
                  </ownedLiteral>
                  <ownedLiteral xmi:id="_P6ExclJQEeiyW7NaN4qWdw" name="CHANGE_REMOVE">
                    <specification xmi:type="uml:Expression" xmi:id="_P6Exc1JQEeiyW7NaN4qWdw">
                      <operand xmi:type="uml:LiteralString" xmi:id="_QoevlVJQEeiyW7NaN4qWdw" value="100"/>
                    </specification>
                  </ownedLiteral>
                  <ownedLiteral xmi:id="_P6ExdFJQEeiyW7NaN4qWdw" name="CHANGE_STANCE">
                    <specification xmi:type="uml:Expression" xmi:id="_P6ExdVJQEeiyW7NaN4qWdw">
                      <operand xmi:type="uml:LiteralString" xmi:id="_QoevllJQEeiyW7NaN4qWdw" value="5"/>
                    </specification>
                  </ownedLiteral>
                  <ownedLiteral xmi:id="_P6ExdlJQEeiyW7NaN4qWdw" name="CHANGE_OWNED">
                    <specification xmi:type="uml:Expression" xmi:id="_P6Exd1JQEeiyW7NaN4qWdw">
                      <operand xmi:type="uml:LiteralString" xmi:id="_Qoevl1JQEeiyW7NaN4qWdw" value="20"/>
                    </specification>
                  </ownedLiteral>
                  <ownedLiteral xmi:id="_P6ExeFJQEeiyW7NaN4qWdw" name="CHANGE_UPDATE">
                    <specification xmi:type="uml:Expression" xmi:id="_P6ExeVJQEeiyW7NaN4qWdw">
                      <operand xmi:type="uml:LiteralString" xmi:id="_QoevmFJQEeiyW7NaN4qWdw" value="10"/>
                    </specification>
                  </ownedLiteral>
                  <ownedLiteral xmi:id="_P6ExelJQEeiyW7NaN4qWdw" name="CHANGE_EARLY">
                    <specification xmi:type="uml:Expression" xmi:id="_P6Exe1JQEeiyW7NaN4qWdw">
                      <operand xmi:type="uml:LiteralString" xmi:id="_QoevmVJQEeiyW7NaN4qWdw" value="1"/>
                    </specification>
                  </ownedLiteral>
                  <ownedLiteral xmi:id="_P6ExfFJQEeiyW7NaN4qWdw" name="CHANGE_NORMAL">
                    <specification xmi:type="uml:Expression" xmi:id="_P6FYgFJQEeiyW7NaN4qWdw">
                      <operand xmi:type="uml:LiteralString" xmi:id="_QoevmlJQEeiyW7NaN4qWdw" value="15"/>
                    </specification>
                  </ownedLiteral>
                  <ownedLiteral xmi:id="_P6FYgVJQEeiyW7NaN4qWdw" name="CHANGE_LATE">
                    <specification xmi:type="uml:Expression" xmi:id="_P6FYglJQEeiyW7NaN4qWdw">
                      <operand xmi:type="uml:LiteralString" xmi:id="_Qoevm1JQEeiyW7NaN4qWdw" value="90"/>
                    </specification>
                  </ownedLiteral>
                </nestedClassifier>
                <nestedClassifier xmi:type="uml:Class" xmi:id="_P6HNsFJQEeiyW7NaN4qWdw" name="See">
                  <eAnnotations xmi:id="_P6HNsVJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_P6H0wFJQEeiyW7NaN4qWdw" key="static"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_QoevnFJQEeiyW7NaN4qWdw">
                    <body>Class to control the visibility of a change.</body>
                  </ownedComment>
                  <ownedAttribute xmi:id="_QngfMVJQEeiyW7NaN4qWdw" name="ALL" visibility="private" isLeaf="true" isStatic="true" isReadOnly="true">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    <defaultValue xmi:type="uml:LiteralString" xmi:id="_QngfMlJQEeiyW7NaN4qWdw" value="1"/>
                  </ownedAttribute>
                  <ownedAttribute xmi:id="_QngfM1JQEeiyW7NaN4qWdw" name="PERHAPS" visibility="private" isLeaf="true" isStatic="true" isReadOnly="true">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    <defaultValue xmi:type="uml:LiteralString" xmi:id="_QngfNFJQEeiyW7NaN4qWdw" value="0"/>
                  </ownedAttribute>
                  <ownedAttribute xmi:id="_QnhGQFJQEeiyW7NaN4qWdw" name="ONLY" visibility="private" isLeaf="true" isStatic="true" isReadOnly="true">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    <defaultValue xmi:type="uml:LiteralString" xmi:id="_QnhGQVJQEeiyW7NaN4qWdw" value="-1"/>
                  </ownedAttribute>
                  <ownedAttribute xmi:id="_QnhGQlJQEeiyW7NaN4qWdw" name="seeAlways" visibility="private" type="_QhaeQ1JQEeiyW7NaN4qWdw" association="_Qo1U5FJQEeiyW7NaN4qWdw"/>
                  <ownedAttribute xmi:id="_QnhGRFJQEeiyW7NaN4qWdw" name="seePerhaps" visibility="private" type="_QhaeQ1JQEeiyW7NaN4qWdw" association="_Qo178VJQEeiyW7NaN4qWdw"/>
                  <ownedAttribute xmi:id="_QnhtUVJQEeiyW7NaN4qWdw" name="seeNever" visibility="private" type="_QhaeQ1JQEeiyW7NaN4qWdw" association="_Qo2jAFJQEeiyW7NaN4qWdw"/>
                  <ownedAttribute xmi:id="_QniUYVJQEeiyW7NaN4qWdw" name="type" visibility="private" isLeaf="true" isReadOnly="true">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedAttribute>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoHjMlJQEeiyW7NaN4qWdw" name="See" specification="_P6H0wVJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoHjM1JQEeiyW7NaN4qWdw" name="type">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_QoHjNFJQEeiyW7NaN4qWdw" type="_P6HNsFJQEeiyW7NaN4qWdw" direction="return"/>
                    <language>java</language>
                    <body>this.seeAlways = this.seePerhaps = this.seeNever = null;&#xD;
         this.type = type;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoHjNVJQEeiyW7NaN4qWdw" name="check" specification="_QlyA4FJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoHjNlJQEeiyW7NaN4qWdw" name="player" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoHjN1JQEeiyW7NaN4qWdw" name="perhapsResult">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_QoHjOFJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>return (seeNever == player) ? false&#xD;
             : (seeAlways == player) ? true&#xD;
             : (seePerhaps == player) ? perhapsResult&#xD;
             : (type == ONLY) ? false&#xD;
             : (type == ALL) ? true&#xD;
             : perhapsResult;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoHjOVJQEeiyW7NaN4qWdw" name="all" specification="_P6Ib1FJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoHjOlJQEeiyW7NaN4qWdw" type="_P6HNsFJQEeiyW7NaN4qWdw" direction="return"/>
                    <language>java</language>
                    <body>return new See(ALL);&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoHjO1JQEeiyW7NaN4qWdw" name="perhaps" specification="_P6JC4FJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoHjPFJQEeiyW7NaN4qWdw" type="_P6HNsFJQEeiyW7NaN4qWdw" direction="return"/>
                    <language>java</language>
                    <body>return new See(PERHAPS);&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoHjPVJQEeiyW7NaN4qWdw" name="only" specification="_Qlyn8lJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoHjPlJQEeiyW7NaN4qWdw" name="player" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoHjP1JQEeiyW7NaN4qWdw" type="_P6HNsFJQEeiyW7NaN4qWdw" direction="return"/>
                    <language>java</language>
                    <body>return new See(ONLY).always(player);&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoHjQFJQEeiyW7NaN4qWdw" name="always" specification="_QlzPAVJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoHjQVJQEeiyW7NaN4qWdw" name="player" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoHjQlJQEeiyW7NaN4qWdw" type="_P6HNsFJQEeiyW7NaN4qWdw" direction="return"/>
                    <language>java</language>
                    <body>seeAlways = player;&#xD;
         return this;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoHjQ1JQEeiyW7NaN4qWdw" name="perhaps" specification="_Qlz2EFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoHjRFJQEeiyW7NaN4qWdw" name="player" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoHjRVJQEeiyW7NaN4qWdw" type="_P6HNsFJQEeiyW7NaN4qWdw" direction="return"/>
                    <language>java</language>
                    <body>seePerhaps = player;&#xD;
         return this;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoHjRlJQEeiyW7NaN4qWdw" name="except" specification="_Qlz2E1JQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoHjR1JQEeiyW7NaN4qWdw" name="player" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoHjSFJQEeiyW7NaN4qWdw" type="_P6HNsFJQEeiyW7NaN4qWdw" direction="return"/>
                    <language>java</language>
                    <body>seeNever = player;&#xD;
         return this;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoHjSVJQEeiyW7NaN4qWdw" name="toString" specification="_P6Jp8FJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoHjSlJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>StringBuilder sb = new StringBuilder(64);&#xD;
         sb.append((type == ALL) ? &quot;ALL&quot; : (type == PERHAPS) ? &quot;PERHAPS&quot;&#xD;
             : (type == ONLY) ? &quot;ONLY&quot; : &quot;BADTYPE&quot;);&#xD;
         if (seeAlways != null) {&#xD;
             sb.append(&quot;,always(&quot;).append(seeAlways.getId()).append(&quot;)&quot;);&#xD;
         }&#xD;
         if (seePerhaps != null) {&#xD;
             sb.append(&quot;,perhaps(&quot;).append(seePerhaps.getId()).append(&quot;)&quot;);&#xD;
         }&#xD;
         if (seeNever != null) {&#xD;
             sb.append(&quot;,never(&quot;).append(seeNever.getId()).append(&quot;)&quot;);&#xD;
         }&#xD;
         return sb.toString();&#xD;
     </body>
                  </ownedBehavior>
                  <ownedOperation xmi:id="_P6H0wVJQEeiyW7NaN4qWdw" name="See" visibility="private" method="_QoHjMlJQEeiyW7NaN4qWdw">
                    <eAnnotations xmi:id="_P6Ib0VJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                      <details xmi:id="_P6Ib0lJQEeiyW7NaN4qWdw" key="create"/>
                    </eAnnotations>
                    <ownedParameter xmi:id="_P6Ib0FJQEeiyW7NaN4qWdw" name="type">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_P6Ib01JQEeiyW7NaN4qWdw" type="_P6HNsFJQEeiyW7NaN4qWdw" direction="return"/>
                  </ownedOperation>
                  <ownedOperation xmi:id="_P6Ib1FJQEeiyW7NaN4qWdw" name="all" isStatic="true" method="_QoHjOVJQEeiyW7NaN4qWdw">
                    <ownedComment xmi:id="_QoevnlJQEeiyW7NaN4qWdw">
                      <body>Make this change visible to all players.&#xD;
         *&#xD;
         * @return a &lt;code>See&lt;/code> value</body>
                    </ownedComment>
                    <ownedParameter xmi:id="_QjhXEFJQEeiyW7NaN4qWdw" type="_P6HNsFJQEeiyW7NaN4qWdw" direction="return"/>
                  </ownedOperation>
                  <ownedOperation xmi:id="_P6JC4FJQEeiyW7NaN4qWdw" name="perhaps" isStatic="true" method="_QoHjO1JQEeiyW7NaN4qWdw">
                    <ownedComment xmi:id="_Qoevn1JQEeiyW7NaN4qWdw">
                      <body>Make this change visible to all players, provided they can&#xD;
         * see the objects that are being changed.&#xD;
         *&#xD;
         * @return a &lt;code>See&lt;/code> value</body>
                    </ownedComment>
                    <ownedParameter xmi:id="_QjhXEVJQEeiyW7NaN4qWdw" type="_P6HNsFJQEeiyW7NaN4qWdw" direction="return"/>
                  </ownedOperation>
                  <ownedOperation xmi:id="_P6Jp8FJQEeiyW7NaN4qWdw" name="toString" method="_QoHjSVJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_P6Jp8VJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_QlyA4FJQEeiyW7NaN4qWdw" name="check" method="_QoHjNVJQEeiyW7NaN4qWdw">
                    <ownedComment xmi:id="_QoevnVJQEeiyW7NaN4qWdw">
                      <body>Check this visibility with respect to a player.&#xD;
         *&#xD;
         * @param player The &lt;code>ServerPlayer&lt;/code> to consider.&#xD;
         * @param perhapsResult The result if the visibility is ambiguous.&#xD;
         * @return True if the player satisfies the visibility test.</body>
                    </ownedComment>
                    <ownedParameter xmi:id="_QlyA4VJQEeiyW7NaN4qWdw" name="player" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_Qlyn8FJQEeiyW7NaN4qWdw" name="perhapsResult">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_Qlyn8VJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_Qlyn8lJQEeiyW7NaN4qWdw" name="only" isStatic="true" method="_QoHjPVJQEeiyW7NaN4qWdw">
                    <ownedComment xmi:id="_QoevoFJQEeiyW7NaN4qWdw">
                      <body>Make this change visible only to the given player.&#xD;
         *&#xD;
         * @param player a &lt;code>ServerPlayer&lt;/code> value&#xD;
         * @return a &lt;code>See&lt;/code> value</body>
                    </ownedComment>
                    <ownedParameter xmi:id="_Qlyn81JQEeiyW7NaN4qWdw" name="player" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QlzPAFJQEeiyW7NaN4qWdw" type="_P6HNsFJQEeiyW7NaN4qWdw" direction="return"/>
                  </ownedOperation>
                  <ownedOperation xmi:id="_QlzPAVJQEeiyW7NaN4qWdw" name="always" method="_QoHjQFJQEeiyW7NaN4qWdw">
                    <ownedComment xmi:id="_QoevoVJQEeiyW7NaN4qWdw">
                      <body>Make this change visible to the given player.&#xD;
         *&#xD;
         * @param player a &lt;code>ServerPlayer&lt;/code> value&#xD;
         * @return a &lt;code>See&lt;/code> value</body>
                    </ownedComment>
                    <ownedParameter xmi:id="_QlzPAlJQEeiyW7NaN4qWdw" name="player" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QlzPA1JQEeiyW7NaN4qWdw" type="_P6HNsFJQEeiyW7NaN4qWdw" direction="return"/>
                  </ownedOperation>
                  <ownedOperation xmi:id="_Qlz2EFJQEeiyW7NaN4qWdw" name="perhaps" method="_QoHjQ1JQEeiyW7NaN4qWdw">
                    <ownedComment xmi:id="_QoevolJQEeiyW7NaN4qWdw">
                      <body>Make this change visible to the given player, provided the&#xD;
         * player can see the objects being changed.&#xD;
         *&#xD;
         * @param player a &lt;code>ServerPlayer&lt;/code> value&#xD;
         * @return a &lt;code>See&lt;/code> value</body>
                    </ownedComment>
                    <ownedParameter xmi:id="_Qlz2EVJQEeiyW7NaN4qWdw" name="player" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_Qlz2ElJQEeiyW7NaN4qWdw" type="_P6HNsFJQEeiyW7NaN4qWdw" direction="return"/>
                  </ownedOperation>
                  <ownedOperation xmi:id="_Qlz2E1JQEeiyW7NaN4qWdw" name="except" method="_QoHjRlJQEeiyW7NaN4qWdw">
                    <ownedComment xmi:id="_Qoevo1JQEeiyW7NaN4qWdw">
                      <body>Make this change invisible to the given player.&#xD;
         *&#xD;
         * @param player a &lt;code>ServerPlayer&lt;/code> value&#xD;
         * @return a &lt;code>See&lt;/code> value</body>
                    </ownedComment>
                    <ownedParameter xmi:id="_Qlz2FFJQEeiyW7NaN4qWdw" name="player" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_Ql0dIFJQEeiyW7NaN4qWdw" type="_P6HNsFJQEeiyW7NaN4qWdw" direction="return"/>
                  </ownedOperation>
                </nestedClassifier>
                <nestedClassifier xmi:type="uml:Class" xmi:id="_P6LfIFJQEeiyW7NaN4qWdw" name="Change" visibility="private" isAbstract="true">
                  <eAnnotations xmi:id="_P6LfIVJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_P6LfIlJQEeiyW7NaN4qWdw" key="static"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_QoevpFJQEeiyW7NaN4qWdw">
                    <body>Abstract template for all types of Change.</body>
                  </ownedComment>
                  <ownedAttribute xmi:id="_Qni7cFJQEeiyW7NaN4qWdw" name="see" visibility="protected" isLeaf="true" type="_P6HNsFJQEeiyW7NaN4qWdw" isReadOnly="true" association="_Qo2jA1JQEeiyW7NaN4qWdw"/>
                  <ownedAttribute xmi:id="_QnjigVJQEeiyW7NaN4qWdw" name="priority" isLeaf="true" isReadOnly="true">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                  </ownedAttribute>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoIKQFJQEeiyW7NaN4qWdw" name="Change" specification="_Qjh-IFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoIKQVJQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoIKQlJQEeiyW7NaN4qWdw" type="_P6LfIFJQEeiyW7NaN4qWdw" direction="return"/>
                    <language>java</language>
                    <body>this.see = see;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoIKQ1JQEeiyW7NaN4qWdw" name="matches" specification="_Ql0dIVJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoIKRFJQEeiyW7NaN4qWdw" name="fcgo" type="_QidnIlJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoIKRVJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>return false;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoIKRlJQEeiyW7NaN4qWdw" name="isNotifiable" specification="_Ql1EMVJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoIKR1JQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoIKSFJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>return see.check(serverPlayer, isPerhapsNotifiable(serverPlayer));&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoIKSVJQEeiyW7NaN4qWdw" name="isPerhapsNotifiable" specification="_Ql1rQFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoIKSlJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoIKS1JQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>return false;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoIKTFJQEeiyW7NaN4qWdw" name="consequences" specification="_Ql1rQ1JQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoIKTVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoIKTlJQEeiyW7NaN4qWdw" type="_P6LfIFJQEeiyW7NaN4qWdw" isOrdered="true" direction="return">
                      <upperValue xmi:type="uml:LiteralUnlimitedNatural" xmi:id="_QoIKT1JQEeiyW7NaN4qWdw" value="*"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>return Collections.&lt;Change>emptyList();&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoIxUFJQEeiyW7NaN4qWdw" name="convertsToElement" specification="_P6NUUFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoIxUVJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>return true;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedOperation xmi:id="_P6NUUFJQEeiyW7NaN4qWdw" name="convertsToElement" method="_QoIxUFJQEeiyW7NaN4qWdw">
                    <ownedComment xmi:id="_Qof9s1JQEeiyW7NaN4qWdw">
                      <body>Can this Change be directly converted to an Element?&#xD;
         *&#xD;
         * @return True if this change can be directly converted to an Element.</body>
                    </ownedComment>
                    <ownedParameter xmi:id="_P6N7YFJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_Qjh-IFJQEeiyW7NaN4qWdw" name="Change" method="_QoIKQFJQEeiyW7NaN4qWdw">
                    <eAnnotations xmi:id="_Qjh-IlJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                      <details xmi:id="_Qjh-I1JQEeiyW7NaN4qWdw" key="create"/>
                    </eAnnotations>
                    <ownedComment xmi:id="_QoevpVJQEeiyW7NaN4qWdw">
                      <body>Make a new Change.</body>
                    </ownedComment>
                    <ownedParameter xmi:id="_Qjh-IVJQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_Qjh-JFJQEeiyW7NaN4qWdw" type="_P6LfIFJQEeiyW7NaN4qWdw" direction="return"/>
                  </ownedOperation>
                  <ownedOperation xmi:id="_Ql0dIVJQEeiyW7NaN4qWdw" name="matches" method="_QoIKQ1JQEeiyW7NaN4qWdw">
                    <ownedComment xmi:id="_QofWoFJQEeiyW7NaN4qWdw">
                      <body>Does this Change operate on the given object?&#xD;
         *&#xD;
         * @param fcgo The &lt;code>FreeColGameObject&lt;/code> to check.&#xD;
         * @return True if the object is a subject of this change.</body>
                    </ownedComment>
                    <ownedParameter xmi:id="_Ql0dIlJQEeiyW7NaN4qWdw" name="fcgo" type="_QidnIlJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_Ql1EMFJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_Ql1EMVJQEeiyW7NaN4qWdw" name="isNotifiable" method="_QoIKRlJQEeiyW7NaN4qWdw">
                    <ownedComment xmi:id="_Qof9sFJQEeiyW7NaN4qWdw">
                      <body>Should a player be notified of this Change?&#xD;
         *&#xD;
         * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> to consider.&#xD;
         * @return True if this &lt;code>Change&lt;/code> should be sent.</body>
                    </ownedComment>
                    <ownedParameter xmi:id="_Ql1EMlJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_Ql1EM1JQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_Ql1rQFJQEeiyW7NaN4qWdw" name="isPerhapsNotifiable" method="_QoIKSVJQEeiyW7NaN4qWdw">
                    <ownedComment xmi:id="_Qof9sVJQEeiyW7NaN4qWdw">
                      <body>Should a player be notified of a Change for which the&#xD;
         * visibility is delegated to the change type, allowing&#xD;
         * special change-specific overrides.&#xD;
         *&#xD;
         * This is false by default, subclasses should override when&#xD;
         * special case handling is required.&#xD;
         *&#xD;
         * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> to consider.&#xD;
         * @return False.</body>
                    </ownedComment>
                    <ownedParameter xmi:id="_Ql1rQVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_Ql1rQlJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_Ql1rQ1JQEeiyW7NaN4qWdw" name="consequences" method="_QoIKTFJQEeiyW7NaN4qWdw">
                    <ownedComment xmi:id="_Qof9slJQEeiyW7NaN4qWdw">
                      <body>Are the secondary changes consequent to this Change?&#xD;
         *&#xD;
         * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> to consider.&#xD;
         * @return A list of secondary &lt;code>Change&lt;/code>s or the&#xD;
         *     empty list if there are none, which is usually the case.</body>
                    </ownedComment>
                    <ownedParameter xmi:id="_Ql1rRFJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_Ql2SUFJQEeiyW7NaN4qWdw" type="_P6LfIFJQEeiyW7NaN4qWdw" isOrdered="true" direction="return">
                      <upperValue xmi:type="uml:LiteralUnlimitedNatural" xmi:id="_Ql2SUVJQEeiyW7NaN4qWdw" value="*"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_Ql25YFJQEeiyW7NaN4qWdw" name="toElement" isAbstract="true">
                    <ownedComment xmi:id="_Qof9tFJQEeiyW7NaN4qWdw">
                      <body>Specialize a Change for a particular player.&#xD;
         *&#xD;
         * @param serverPlayer The &lt;code>ServerPlayer&lt;/code> to update.&#xD;
         * @param doc The owner &lt;code>Document&lt;/code> to build the element in.&#xD;
         * @return An &lt;code>Element&lt;/code> encapsulating this change.</body>
                    </ownedComment>
                    <ownedParameter xmi:id="_Ql25YVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_Ql25YlJQEeiyW7NaN4qWdw" name="doc" type="_QjgI8FJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_Ql25Y1JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  </ownedOperation>
                  <ownedOperation xmi:id="_Ql3gcFJQEeiyW7NaN4qWdw" name="attachToElement" isAbstract="true">
                    <ownedComment xmi:id="_Qof9tVJQEeiyW7NaN4qWdw">
                      <body>Some changes can not be directly specialized, but need to be&#xD;
         * directly attached to an element.&#xD;
         *&#xD;
         * @param element The &lt;code>Element&lt;/code> to attach to.</body>
                    </ownedComment>
                    <ownedParameter xmi:id="_Ql3gcVJQEeiyW7NaN4qWdw" name="element" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  </ownedOperation>
                </nestedClassifier>
                <nestedClassifier xmi:type="uml:Class" xmi:id="_P6PwkFJQEeiyW7NaN4qWdw" name="AttackChange" visibility="private">
                  <eAnnotations xmi:id="_P6PwkVJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_P6PwklJQEeiyW7NaN4qWdw" key="static"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_Qof9tlJQEeiyW7NaN4qWdw">
                    <body>Encapsulate an attack.</body>
                  </ownedComment>
                  <generalization xmi:id="_QjjMQFJQEeiyW7NaN4qWdw" general="_P6LfIFJQEeiyW7NaN4qWdw"/>
                  <ownedAttribute xmi:id="_QnkJkVJQEeiyW7NaN4qWdw" name="attacker" visibility="private" isLeaf="true" type="_Qiy-UlJQEeiyW7NaN4qWdw" isReadOnly="true" association="_Qo2jBlJQEeiyW7NaN4qWdw"/>
                  <ownedAttribute xmi:id="_QnkwoFJQEeiyW7NaN4qWdw" name="defender" visibility="private" isLeaf="true" type="_Qiy-UlJQEeiyW7NaN4qWdw" isReadOnly="true" association="_Qo3KEVJQEeiyW7NaN4qWdw"/>
                  <ownedAttribute xmi:id="_QnkwolJQEeiyW7NaN4qWdw" name="success" visibility="private" isLeaf="true" isReadOnly="true">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedAttribute>
                  <ownedAttribute xmi:id="_QnkwpFJQEeiyW7NaN4qWdw" name="defenderInSettlement" visibility="private" isLeaf="true" isReadOnly="true">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedAttribute>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoIxUlJQEeiyW7NaN4qWdw" name="AttackChange" specification="_Ql4HgFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoIxU1JQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoIxVFJQEeiyW7NaN4qWdw" name="attacker" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoIxVVJQEeiyW7NaN4qWdw" name="defender" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoIxVlJQEeiyW7NaN4qWdw" name="success">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_QoIxV1JQEeiyW7NaN4qWdw" type="_P6PwkFJQEeiyW7NaN4qWdw" direction="return"/>
                    <language>java</language>
                    <body>super(see);&#xD;
         Game game = attacker.getGame();&#xD;
         this.defenderInSettlement = defender.getTile().hasSettlement();&#xD;
         this.attacker = attacker.copy(game, Unit.class);&#xD;
         this.attacker.setLocationNoUpdate(this.attacker.getTile());&#xD;
         this.defender = defender.copy(game, Unit.class);&#xD;
         this.defender.setLocationNoUpdate(this.defender.getTile());&#xD;
         this.success = success;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoIxWFJQEeiyW7NaN4qWdw" name="getPriority" specification="_P6QXoFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoIxWVJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>return ChangePriority.CHANGE_ANIMATION.getPriority();&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoIxWlJQEeiyW7NaN4qWdw" name="isPerhapsNotifiable" specification="_Ql4ulVJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoIxW1JQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoIxXFJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>return serverPlayer == attacker.getOwner()&#xD;
             || serverPlayer == defender.getOwner()&#xD;
             || (serverPlayer.canSee(attacker.getTile())&#xD;
                 &amp;&amp; serverPlayer.canSee(defender.getTile()));&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoJYYFJQEeiyW7NaN4qWdw" name="toElement" specification="_Ql58sVJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoJYYVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoJYYlJQEeiyW7NaN4qWdw" name="doc" type="_QjgI8FJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoJYY1JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                    <language>java</language>
                    <body>final Game game = serverPlayer.getGame();&#xD;
         Element element = doc.createElement(&quot;animateAttack&quot;);&#xD;
         element.setAttribute(&quot;attacker&quot;, attacker.getId());&#xD;
         element.setAttribute(&quot;defender&quot;, defender.getId());&#xD;
         element.setAttribute(&quot;attackerTile&quot;, attacker.getTile().getId());&#xD;
         element.setAttribute(&quot;defenderTile&quot;, defender.getTile().getId());&#xD;
         element.setAttribute(&quot;success&quot;, Boolean.toString(success));&#xD;
         if (!canSeeUnit(serverPlayer, attacker)) {&#xD;
             element.appendChild(attacker.toXMLElement(doc));&#xD;
             if (attacker.getLocation() instanceof Unit) {&#xD;
                 Unit loc = (Unit)attacker.getLocation();&#xD;
                 element.appendChild(loc.toXMLElement(doc, serverPlayer));&#xD;
             }&#xD;
         }&#xD;
         if (!canSeeUnit(serverPlayer, defender)&#xD;
             || this.defenderInSettlement) {&#xD;
             defender.setWorkType(null);&#xD;
             element.appendChild(defender.toXMLElement(doc));&#xD;
         }&#xD;
         return element;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoJYZFJQEeiyW7NaN4qWdw" name="toString" specification="_P6RlwFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoJYZVJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>StringBuilder sb = new StringBuilder(64);&#xD;
         sb.append(&quot;[&quot;).append(getClass().getName())&#xD;
             .append(&quot; &quot;).append(see)&#xD;
             .append(&quot; #&quot;).append(getPriority())&#xD;
             .append(&quot; &quot;).append(attacker.getId())&#xD;
             .append(&quot;@&quot;).append(attacker.getTile().getId())&#xD;
             .append(&quot; &quot;).append(success)&#xD;
             .append(&quot; &quot;).append(defender.getId())&#xD;
             .append(&quot;@&quot;).append(defender.getTile().getId())&#xD;
             .append(&quot;]&quot;);&#xD;
         return sb.toString();&#xD;
     </body>
                  </ownedBehavior>
                  <ownedOperation xmi:id="_P6QXoFJQEeiyW7NaN4qWdw" name="getPriority" method="_QoIxWFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_P6QXoVJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_P6RlwFJQEeiyW7NaN4qWdw" name="toString" method="_QoJYZFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_P6RlwVJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_Ql4HgFJQEeiyW7NaN4qWdw" name="AttackChange" method="_QoIxUlJQEeiyW7NaN4qWdw">
                    <eAnnotations xmi:id="_Ql4uklJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                      <details xmi:id="_Ql4uk1JQEeiyW7NaN4qWdw" key="create"/>
                    </eAnnotations>
                    <ownedComment xmi:id="_Qof9t1JQEeiyW7NaN4qWdw">
                      <body>Build a new AttackChange.&#xD;
         *&#xD;
         * Note that we must copy attackers and defenders because a&#xD;
         * successful attacker can move, any an unsuccessful&#xD;
         * participant can die, and unsuccessful defenders can be&#xD;
         * captured.  Furthermore for defenders, insufficient&#xD;
         * information is serialized when a unit is inside a&#xD;
         * settlement, but if unscoped too much is disclosed.  So we&#xD;
         * make a copy and neuter it.&#xD;
         *&#xD;
         * We have to remember if the defender was in a settlement&#xD;
         * because by the time serialization occurs the settlement&#xD;
         * might have been destroyed.&#xD;
         *&#xD;
         * We just have to accept that combat animation is an&#xD;
         * exception to the normal visibility rules.&#xD;
         *&#xD;
         * @param see The visibility of this change.&#xD;
         * @param attacker The &lt;code>Unit&lt;/code> that is attacking.&#xD;
         * @param defender The &lt;code>Unit&lt;/code> that is defending.&#xD;
         * @param success Did the attack succeed.</body>
                    </ownedComment>
                    <ownedParameter xmi:id="_Ql4HgVJQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_Ql4HglJQEeiyW7NaN4qWdw" name="attacker" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_Ql4ukFJQEeiyW7NaN4qWdw" name="defender" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_Ql4ukVJQEeiyW7NaN4qWdw" name="success">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_Ql4ulFJQEeiyW7NaN4qWdw" type="_P6PwkFJQEeiyW7NaN4qWdw" direction="return"/>
                  </ownedOperation>
                  <ownedOperation xmi:id="_Ql4ulVJQEeiyW7NaN4qWdw" name="isPerhapsNotifiable" method="_QoIxWlJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_Ql5VoFJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_Ql5VoVJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_Ql58sVJQEeiyW7NaN4qWdw" name="toElement" method="_QoJYYFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_Ql58slJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_Ql58s1JQEeiyW7NaN4qWdw" name="doc" type="_QjgI8FJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_Ql6jwFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  </ownedOperation>
                  <ownedOperation xmi:id="_Ql7K0FJQEeiyW7NaN4qWdw" name="attachToElement">
                    <ownedParameter xmi:id="_Ql7K0VJQEeiyW7NaN4qWdw" name="element" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  </ownedOperation>
                </nestedClassifier>
                <nestedClassifier xmi:type="uml:Class" xmi:id="_P6VQIFJQEeiyW7NaN4qWdw" name="AttributeChange" visibility="private">
                  <eAnnotations xmi:id="_P6VQIVJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_P6VQIlJQEeiyW7NaN4qWdw" key="static"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_Qof9uFJQEeiyW7NaN4qWdw">
                    <body>Encapsulate an attribute change.</body>
                  </ownedComment>
                  <generalization xmi:id="_QjlBcFJQEeiyW7NaN4qWdw" general="_P6LfIFJQEeiyW7NaN4qWdw"/>
                  <ownedAttribute xmi:id="_QnlXsVJQEeiyW7NaN4qWdw" name="key" visibility="private" isLeaf="true" isReadOnly="true">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedAttribute>
                  <ownedAttribute xmi:id="_Qnl-wVJQEeiyW7NaN4qWdw" name="value" visibility="private" isLeaf="true" isReadOnly="true">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedAttribute>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoJYZlJQEeiyW7NaN4qWdw" name="AttributeChange" specification="_QjkaYFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoJYZ1JQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoJYaFJQEeiyW7NaN4qWdw" name="key">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_QoJYaVJQEeiyW7NaN4qWdw" name="value">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_QoJYalJQEeiyW7NaN4qWdw" type="_P6VQIFJQEeiyW7NaN4qWdw" direction="return"/>
                    <language>java</language>
                    <body>super(see);&#xD;
         this.key = key;&#xD;
         this.value = value;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoJYa1JQEeiyW7NaN4qWdw" name="getPriority" specification="_P6V3MFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoJYbFJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>return ChangePriority.CHANGE_ATTRIBUTE.getPriority();&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoJ_cFJQEeiyW7NaN4qWdw" name="convertsToElement" specification="_P6XFUFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoJ_cVJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>return false;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoJ_clJQEeiyW7NaN4qWdw" name="toElement" specification="_Ql8Y8FJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoJ_c1JQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoJ_dFJQEeiyW7NaN4qWdw" name="doc" type="_QjgI8FJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoJ_dVJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                    <language>java</language>
                    <body>return null;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoJ_dlJQEeiyW7NaN4qWdw" name="attachToElement" specification="_Ql9AAlJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoJ_d1JQEeiyW7NaN4qWdw" name="element" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                    <language>java</language>
                    <body>element.setAttribute(key, value);&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoJ_eFJQEeiyW7NaN4qWdw" name="toString" specification="_P6XsYlJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoJ_eVJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>StringBuilder sb = new StringBuilder(32);&#xD;
         sb.append(&quot;[&quot;).append(getClass().getName())&#xD;
             .append(&quot; &quot;).append(see)&#xD;
             .append(&quot; #&quot;).append(getPriority())&#xD;
             .append(&quot; &quot;).append(key)&#xD;
             .append(&quot;=&quot;).append(value)&#xD;
             .append(&quot;]&quot;);&#xD;
         return sb.toString();&#xD;
     </body>
                  </ownedBehavior>
                  <ownedOperation xmi:id="_P6V3MFJQEeiyW7NaN4qWdw" name="getPriority" method="_QoJYa1JQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_P6WeQFJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_P6XFUFJQEeiyW7NaN4qWdw" name="convertsToElement" method="_QoJ_cFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_P6XFUVJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_P6XsYlJQEeiyW7NaN4qWdw" name="toString" method="_QoJ_eFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_P6Y6gFJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_QjkaYFJQEeiyW7NaN4qWdw" name="AttributeChange" method="_QoJYZlJQEeiyW7NaN4qWdw">
                    <eAnnotations xmi:id="_QjkaZFJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                      <details xmi:id="_QjkaZVJQEeiyW7NaN4qWdw" key="create"/>
                    </eAnnotations>
                    <ownedComment xmi:id="_Qof9uVJQEeiyW7NaN4qWdw">
                      <body>Build a new AttributeChange.&#xD;
         *&#xD;
         * @param see The visibility of this change.&#xD;
         * @param key A key &lt;code>String&lt;/code>.&#xD;
         * @param value The corresponding value as a &lt;code>String&lt;/code>.</body>
                    </ownedComment>
                    <ownedParameter xmi:id="_QjkaYVJQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QjkaYlJQEeiyW7NaN4qWdw" name="key">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_QjkaY1JQEeiyW7NaN4qWdw" name="value">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_QjkaZlJQEeiyW7NaN4qWdw" type="_P6VQIFJQEeiyW7NaN4qWdw" direction="return"/>
                  </ownedOperation>
                  <ownedOperation xmi:id="_Ql8Y8FJQEeiyW7NaN4qWdw" name="toElement" method="_QoJ_clJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_Ql8Y8VJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_Ql8Y8lJQEeiyW7NaN4qWdw" name="doc" type="_QjgI8FJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_Ql8Y81JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  </ownedOperation>
                  <ownedOperation xmi:id="_Ql9AAlJQEeiyW7NaN4qWdw" name="attachToElement" method="_QoJ_dlJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_Ql9AA1JQEeiyW7NaN4qWdw" name="element" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  </ownedOperation>
                </nestedClassifier>
                <nestedClassifier xmi:type="uml:Class" xmi:id="_P6b90FJQEeiyW7NaN4qWdw" name="MessageChange" visibility="private">
                  <eAnnotations xmi:id="_P6b90VJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_P6b90lJQEeiyW7NaN4qWdw" key="static"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_Qof9ulJQEeiyW7NaN4qWdw">
                    <body>Encapsulate a Message.</body>
                  </ownedComment>
                  <generalization xmi:id="_QjlogFJQEeiyW7NaN4qWdw" general="_P6LfIFJQEeiyW7NaN4qWdw"/>
                  <ownedAttribute xmi:id="_Qnl-w1JQEeiyW7NaN4qWdw" name="priority" visibility="private" isLeaf="true" type="_P6EKYFJQEeiyW7NaN4qWdw" isReadOnly="true"/>
                  <ownedAttribute xmi:id="_Qnml0VJQEeiyW7NaN4qWdw" name="message" visibility="private" isLeaf="true" type="_QhZ3MVJQEeiyW7NaN4qWdw" isReadOnly="true" association="_Qo3KFFJQEeiyW7NaN4qWdw"/>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoKmgFJQEeiyW7NaN4qWdw" name="MessageChange" specification="_Ql-1MFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoKmgVJQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoKmglJQEeiyW7NaN4qWdw" name="priority" type="_P6EKYFJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoKmg1JQEeiyW7NaN4qWdw" name="message" type="_QhZ3MVJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoKmhFJQEeiyW7NaN4qWdw" type="_P6b90FJQEeiyW7NaN4qWdw" direction="return"/>
                    <language>java</language>
                    <body>super(see);&#xD;
         this.priority = priority;&#xD;
         this.message = message;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoKmhVJQEeiyW7NaN4qWdw" name="getPriority" specification="_P6ck4FJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoKmhlJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>return priority.getPriority();&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoKmh1JQEeiyW7NaN4qWdw" name="toElement" specification="_Ql_cQFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoKmiFJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoKmiVJQEeiyW7NaN4qWdw" name="doc" type="_QjgI8FJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoKmilJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                    <language>java</language>
                    <body>Element element = message.toXMLElement();&#xD;
         return (Element) doc.importNode(element, true);&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoKmi1JQEeiyW7NaN4qWdw" name="toString" specification="_P6dzAlJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoKmjFJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>StringBuilder sb = new StringBuilder(32);&#xD;
         sb.append(&quot;[&quot;).append(getClass().getName())&#xD;
             .append(&quot; &quot;).append(see)&#xD;
             .append(&quot; #&quot;).append(getPriority())&#xD;
             .append(&quot; &quot;).append(message)&#xD;
             .append(&quot;]&quot;);&#xD;
         return sb.toString();&#xD;
     </body>
                  </ownedBehavior>
                  <ownedOperation xmi:id="_P6ck4FJQEeiyW7NaN4qWdw" name="getPriority" method="_QoKmhVJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_P6dL8FJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_P6dzAlJQEeiyW7NaN4qWdw" name="toString" method="_QoKmi1JQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_P6dzA1JQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_Ql-1MFJQEeiyW7NaN4qWdw" name="MessageChange" method="_QoKmgFJQEeiyW7NaN4qWdw">
                    <eAnnotations xmi:id="_Ql-1NFJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                      <details xmi:id="_Ql-1NVJQEeiyW7NaN4qWdw" key="create"/>
                    </eAnnotations>
                    <ownedComment xmi:id="_Qof9u1JQEeiyW7NaN4qWdw">
                      <body>Build a new MessageChange.&#xD;
         *&#xD;
         * @param see The visibility of this change.&#xD;
         * @param priority The priority of the change.&#xD;
         * @param message The &lt;code>Message&lt;/code> to add.</body>
                    </ownedComment>
                    <ownedParameter xmi:id="_Ql-1MVJQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_Ql-1MlJQEeiyW7NaN4qWdw" name="priority" type="_P6EKYFJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_Ql-1M1JQEeiyW7NaN4qWdw" name="message" type="_QhZ3MVJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_Ql-1NlJQEeiyW7NaN4qWdw" type="_P6b90FJQEeiyW7NaN4qWdw" direction="return"/>
                  </ownedOperation>
                  <ownedOperation xmi:id="_Ql_cQFJQEeiyW7NaN4qWdw" name="toElement" method="_QoKmh1JQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_Ql_cQVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_Ql_cQlJQEeiyW7NaN4qWdw" name="doc" type="_QjgI8FJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_Ql_cQ1JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  </ownedOperation>
                  <ownedOperation xmi:id="_QmADUlJQEeiyW7NaN4qWdw" name="attachToElement">
                    <ownedParameter xmi:id="_QmADU1JQEeiyW7NaN4qWdw" name="element" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  </ownedOperation>
                </nestedClassifier>
                <nestedClassifier xmi:type="uml:Class" xmi:id="_P6foMFJQEeiyW7NaN4qWdw" name="MoveChange" visibility="private">
                  <eAnnotations xmi:id="_P6foMVJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_P6foMlJQEeiyW7NaN4qWdw" key="static"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_Qof9vFJQEeiyW7NaN4qWdw">
                    <body>Encapsulate a move.</body>
                  </ownedComment>
                  <generalization xmi:id="_Qjm2oFJQEeiyW7NaN4qWdw" general="_P6LfIFJQEeiyW7NaN4qWdw"/>
                  <ownedAttribute xmi:id="_QnnM4VJQEeiyW7NaN4qWdw" name="unit" visibility="private" isLeaf="true" type="_Qiy-UlJQEeiyW7NaN4qWdw" isReadOnly="true" association="_Qo3xIVJQEeiyW7NaN4qWdw"/>
                  <ownedAttribute xmi:id="_Qnnz8FJQEeiyW7NaN4qWdw" name="oldLocation" visibility="private" isLeaf="true" type="_QikU0FJQEeiyW7NaN4qWdw" isReadOnly="true" association="_Qo3xJFJQEeiyW7NaN4qWdw"/>
                  <ownedAttribute xmi:id="_QnobAFJQEeiyW7NaN4qWdw" name="newTile" visibility="private" isLeaf="true" type="_QivT8VJQEeiyW7NaN4qWdw" isReadOnly="true" association="_Qo4YMVJQEeiyW7NaN4qWdw"/>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoLNkFJQEeiyW7NaN4qWdw" name="seeOld" specification="_QmB4gFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoLNkVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoLNklJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>Tile oldTile = oldLocation.getTile();&#xD;
         return serverPlayer.owns(unit)&#xD;
             || (oldTile != null&#xD;
                 &amp;&amp; serverPlayer.canSee(oldTile)&#xD;
                 &amp;&amp; !oldTile.hasSettlement()&#xD;
                 &amp;&amp; !(oldLocation instanceof Unit));&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoL0oFJQEeiyW7NaN4qWdw" name="seeNew" specification="_QmCfkFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoL0oVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoL0olJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>return canSeeUnit(serverPlayer, unit);&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoL0o1JQEeiyW7NaN4qWdw" name="MoveChange" specification="_QmDGoFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoL0pFJQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoL0pVJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoL0plJQEeiyW7NaN4qWdw" name="oldLocation" type="_QikU0FJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoL0p1JQEeiyW7NaN4qWdw" name="newTile" type="_QivT8VJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoL0qFJQEeiyW7NaN4qWdw" type="_P6foMFJQEeiyW7NaN4qWdw" direction="return"/>
                    <language>java</language>
                    <body>super(see);&#xD;
         this.unit = unit;&#xD;
         this.oldLocation = oldLocation;&#xD;
         this.newTile = newTile;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoL0qVJQEeiyW7NaN4qWdw" name="getPriority" specification="_P6hdYFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoL0qlJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>return ChangePriority.CHANGE_ANIMATION.getPriority();&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoL0q1JQEeiyW7NaN4qWdw" name="isPerhapsNotifiable" specification="_QmDtsFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoL0rFJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoL0rVJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>return seeOld(serverPlayer) || seeNew(serverPlayer);&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoL0rlJQEeiyW7NaN4qWdw" name="consequences" specification="_QmEUwlJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoL0r1JQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoL0sFJQEeiyW7NaN4qWdw" type="_P6LfIFJQEeiyW7NaN4qWdw" isOrdered="true" direction="return">
                      <upperValue xmi:type="uml:LiteralUnlimitedNatural" xmi:id="_QoL0sVJQEeiyW7NaN4qWdw" value="*"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>if (seeOld(serverPlayer) &amp;&amp; !seeNew(serverPlayer)&#xD;
             &amp;&amp; !unit.isDisposed()) {&#xD;
             List&lt;Unit> units = new ArrayList&lt;>();&#xD;
             units.add(unit);&#xD;
             List&lt;Change> changes = new ArrayList&lt;>();&#xD;
             changes.add(new RemoveChange(See.only(serverPlayer),&#xD;
                                          unit.getLocation(), units));&#xD;
             return changes;&#xD;
         }&#xD;
         return Collections.&lt;Change>emptyList();&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoL0slJQEeiyW7NaN4qWdw" name="toElement" specification="_QmFi4FJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoL0s1JQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoL0tFJQEeiyW7NaN4qWdw" name="doc" type="_QjgI8FJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoL0tVJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                    <language>java</language>
                    <body>Element element = doc.createElement(&quot;animateMove&quot;);&#xD;
         element.setAttribute(&quot;unit&quot;, unit.getId());&#xD;
         element.setAttribute(&quot;oldTile&quot;, oldLocation.getTile().getId());&#xD;
         element.setAttribute(&quot;newTile&quot;, newTile.getId());&#xD;
         if (!seeOld(serverPlayer)) {&#xD;
             // We can not rely on the unit that is about to move&#xD;
             // being present on the client side, and it is needed&#xD;
             // before we can run the animation, so it is attached&#xD;
             // to animateMove.&#xD;
             element.appendChild(unit.toXMLElement(doc, serverPlayer));&#xD;
         }&#xD;
         return element;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoL0tlJQEeiyW7NaN4qWdw" name="toString" specification="_P6hdZVJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoL0t1JQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>StringBuilder sb = new StringBuilder(32);&#xD;
         sb.append(&quot;[&quot;).append(getClass().getName())&#xD;
             .append(&quot; &quot;).append(see)&#xD;
             .append(&quot; #&quot;).append(getPriority())&#xD;
             .append(&quot; &quot;).append(unit.getId())&#xD;
             .append(&quot; &quot;).append(oldLocation.getId())&#xD;
             .append(&quot; &quot;).append(newTile.getId())&#xD;
             .append(&quot;]&quot;);&#xD;
         return sb.toString();&#xD;
     </body>
                  </ownedBehavior>
                  <ownedOperation xmi:id="_P6hdYFJQEeiyW7NaN4qWdw" name="getPriority" method="_QoL0qVJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_P6hdYVJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_P6hdZVJQEeiyW7NaN4qWdw" name="toString" method="_QoL0tlJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_P6iEcFJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_QmB4gFJQEeiyW7NaN4qWdw" name="seeOld" visibility="private" method="_QoLNkFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QmB4gVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmB4glJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_QmCfkFJQEeiyW7NaN4qWdw" name="seeNew" visibility="private" method="_QoL0oFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QmCfkVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmCfklJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_QmDGoFJQEeiyW7NaN4qWdw" name="MoveChange" method="_QoL0o1JQEeiyW7NaN4qWdw">
                    <eAnnotations xmi:id="_QmDGpVJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                      <details xmi:id="_QmDGplJQEeiyW7NaN4qWdw" key="create"/>
                    </eAnnotations>
                    <ownedComment xmi:id="_QogkwFJQEeiyW7NaN4qWdw">
                      <body>Build a new MoveChange.&#xD;
         *&#xD;
         * @param see The visibility of this change.&#xD;
         * @param unit The &lt;code>Unit&lt;/code> that is moving.&#xD;
         * @param oldLocation The location from which the unit is moving.&#xD;
         * @param newTile The &lt;code>Tile&lt;/code> to which the unit is moving.</body>
                    </ownedComment>
                    <ownedParameter xmi:id="_QmDGoVJQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmDGolJQEeiyW7NaN4qWdw" name="unit" type="_Qiy-UlJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmDGo1JQEeiyW7NaN4qWdw" name="oldLocation" type="_QikU0FJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmDGpFJQEeiyW7NaN4qWdw" name="newTile" type="_QivT8VJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmDGp1JQEeiyW7NaN4qWdw" type="_P6foMFJQEeiyW7NaN4qWdw" direction="return"/>
                  </ownedOperation>
                  <ownedOperation xmi:id="_QmDtsFJQEeiyW7NaN4qWdw" name="isPerhapsNotifiable" method="_QoL0q1JQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QmDtsVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmDtslJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_QmEUwlJQEeiyW7NaN4qWdw" name="consequences" method="_QoL0rlJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QmEUw1JQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmEUxFJQEeiyW7NaN4qWdw" type="_P6LfIFJQEeiyW7NaN4qWdw" isOrdered="true" direction="return">
                      <upperValue xmi:type="uml:LiteralUnlimitedNatural" xmi:id="_QmEUxVJQEeiyW7NaN4qWdw" value="*"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_QmFi4FJQEeiyW7NaN4qWdw" name="toElement" method="_QoL0slJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QmFi4VJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmFi4lJQEeiyW7NaN4qWdw" name="doc" type="_QjgI8FJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmFi41JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  </ownedOperation>
                  <ownedOperation xmi:id="_QmGJ8lJQEeiyW7NaN4qWdw" name="attachToElement">
                    <ownedParameter xmi:id="_QmGJ81JQEeiyW7NaN4qWdw" name="element" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  </ownedOperation>
                </nestedClassifier>
                <nestedClassifier xmi:type="uml:Class" xmi:id="_P6j5oFJQEeiyW7NaN4qWdw" name="ObjectChange" visibility="private">
                  <eAnnotations xmi:id="_P6j5oVJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_P6j5olJQEeiyW7NaN4qWdw" key="static"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_QogkwVJQEeiyW7NaN4qWdw">
                    <body>Encapsulate a FreeColGameObject update.</body>
                  </ownedComment>
                  <generalization xmi:id="_Qjor0FJQEeiyW7NaN4qWdw" general="_P6LfIFJQEeiyW7NaN4qWdw"/>
                  <ownedAttribute xmi:id="_QnpCEFJQEeiyW7NaN4qWdw" name="fcgo" visibility="protected" isLeaf="true" type="_QidnIlJQEeiyW7NaN4qWdw" isReadOnly="true" association="_Qo4YNFJQEeiyW7NaN4qWdw"/>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoL0uFJQEeiyW7NaN4qWdw" name="ObjectChange" specification="_QmHYEFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoL0uVJQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoL0ulJQEeiyW7NaN4qWdw" name="fcgo" type="_QidnIlJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoL0u1JQEeiyW7NaN4qWdw" type="_P6j5oFJQEeiyW7NaN4qWdw" direction="return"/>
                    <language>java</language>
                    <body>super(see);&#xD;
         this.fcgo = fcgo;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoMbsFJQEeiyW7NaN4qWdw" name="matches" specification="_QmH_I1JQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoMbsVJQEeiyW7NaN4qWdw" name="fcgo" type="_QidnIlJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoMbslJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>return this.fcgo == fcgo;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoMbs1JQEeiyW7NaN4qWdw" name="getPriority" specification="_P6kgsFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoMbtFJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>return ChangePriority.CHANGE_UPDATE.getPriority();&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoMbtVJQEeiyW7NaN4qWdw" name="isPerhapsNotifiable" specification="_QmImM1JQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoMbtlJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoMbt1JQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>if (fcgo instanceof Unit) {&#xD;
             // Units have a precise test, use that rather than&#xD;
             // the more general interface-based tests.&#xD;
             return canSeeUnit(serverPlayer, (Unit)fcgo);&#xD;
         }&#xD;
         // If we own it, we can see it.&#xD;
         if (fcgo instanceof Ownable &amp;&amp; serverPlayer.owns((Ownable)fcgo)) {&#xD;
             return true;&#xD;
         }&#xD;
         // We do not own it, so the only way we could see it is if&#xD;
         // it is on the map.  Would like to use getTile() to&#xD;
         // decide that, but this will include ColonyTiles, which&#xD;
         // report the colony center tile, yet should never be visible.&#xD;
         // So just brutally disallow WorkLocations which should always&#xD;
         // be invisible inside colonies.&#xD;
         if (fcgo instanceof WorkLocation) {&#xD;
             return false;&#xD;
         }&#xD;
         if (fcgo instanceof Location) {&#xD;
             Tile tile = ((Location)fcgo).getTile();&#xD;
             return serverPlayer.canSee(tile);&#xD;
         }&#xD;
         return false;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoMbuFJQEeiyW7NaN4qWdw" name="toElement" specification="_QmJ0UVJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoMbuVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoMbulJQEeiyW7NaN4qWdw" name="doc" type="_QjgI8FJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoMbu1JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                    <language>java</language>
                    <body>Element element = doc.createElement(&quot;update&quot;);&#xD;
         element.appendChild(fcgo.toXMLElement(doc, serverPlayer));&#xD;
         return element;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoMbvFJQEeiyW7NaN4qWdw" name="toString" specification="_P6lHw1JQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoMbvVJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>StringBuilder sb = new StringBuilder(32);&#xD;
         sb.append(&quot;[&quot;).append(getClass().getName())&#xD;
             .append(&quot; &quot;).append(see)&#xD;
             .append(&quot; #&quot;).append(getPriority())&#xD;
             .append(&quot; &quot;).append(fcgo.getId())&#xD;
             .append(&quot;]&quot;);&#xD;
         return sb.toString();&#xD;
     </body>
                  </ownedBehavior>
                  <ownedOperation xmi:id="_P6kgsFJQEeiyW7NaN4qWdw" name="getPriority" method="_QoMbs1JQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_P6kgsVJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_P6lHw1JQEeiyW7NaN4qWdw" name="toString" method="_QoMbvFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_P6lu0FJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_QmHYEFJQEeiyW7NaN4qWdw" name="ObjectChange" method="_QoL0uFJQEeiyW7NaN4qWdw">
                    <eAnnotations xmi:id="_QmH_IFJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                      <details xmi:id="_QmH_IVJQEeiyW7NaN4qWdw" key="create"/>
                    </eAnnotations>
                    <ownedComment xmi:id="_QogkwlJQEeiyW7NaN4qWdw">
                      <body>Build a new ObjectChange for a single object.&#xD;
         *&#xD;
         * @param see The visibility of this change.&#xD;
         * @param fcgo The &lt;code>FreeColGameObject&lt;/code> to update.</body>
                    </ownedComment>
                    <ownedParameter xmi:id="_QmHYEVJQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmHYElJQEeiyW7NaN4qWdw" name="fcgo" type="_QidnIlJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmH_IlJQEeiyW7NaN4qWdw" type="_P6j5oFJQEeiyW7NaN4qWdw" direction="return"/>
                  </ownedOperation>
                  <ownedOperation xmi:id="_QmH_I1JQEeiyW7NaN4qWdw" name="matches" method="_QoMbsFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QmH_JFJQEeiyW7NaN4qWdw" name="fcgo" type="_QidnIlJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmH_JVJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_QmImM1JQEeiyW7NaN4qWdw" name="isPerhapsNotifiable" method="_QoMbtVJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QmJNQFJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmJNQVJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_QmJ0UVJQEeiyW7NaN4qWdw" name="toElement" method="_QoMbuFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QmJ0UlJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmJ0U1JQEeiyW7NaN4qWdw" name="doc" type="_QjgI8FJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmKbYFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  </ownedOperation>
                  <ownedOperation xmi:id="_QmLCcFJQEeiyW7NaN4qWdw" name="attachToElement">
                    <ownedParameter xmi:id="_QmLCcVJQEeiyW7NaN4qWdw" name="element" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  </ownedOperation>
                </nestedClassifier>
                <nestedClassifier xmi:type="uml:Class" xmi:id="_P6nkAFJQEeiyW7NaN4qWdw" name="PartialObjectChange" visibility="private">
                  <eAnnotations xmi:id="_P6nkAVJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_P6nkAlJQEeiyW7NaN4qWdw" key="static"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_Qogkw1JQEeiyW7NaN4qWdw">
                    <body>Encapsulate a partial update of a FreeColGameObject.</body>
                  </ownedComment>
                  <generalization xmi:id="_QjpS4FJQEeiyW7NaN4qWdw" general="_P6j5oFJQEeiyW7NaN4qWdw"/>
                  <ownedAttribute xmi:id="_QnppIFJQEeiyW7NaN4qWdw" name="fields" visibility="private" isLeaf="true" isReadOnly="true">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    <upperValue xmi:type="uml:LiteralUnlimitedNatural" xmi:id="_QnppIVJQEeiyW7NaN4qWdw" value="*"/>
                  </ownedAttribute>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoNCwFJQEeiyW7NaN4qWdw" name="PartialObjectChange" specification="_QmLpgFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoNCwVJQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoNCwlJQEeiyW7NaN4qWdw" name="fcgo" type="_QidnIlJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoNCw1JQEeiyW7NaN4qWdw" name="fields">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                      <upperValue xmi:type="uml:LiteralUnlimitedNatural" xmi:id="_QoNCxFJQEeiyW7NaN4qWdw" value="*"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_QoNCxVJQEeiyW7NaN4qWdw" type="_P6nkAFJQEeiyW7NaN4qWdw" direction="return"/>
                    <language>java</language>
                    <body>super(see, fcgo);&#xD;
         this.fields = fields;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoNCxlJQEeiyW7NaN4qWdw" name="isPerhapsNotifiable" specification="_QmM3oFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoNCx1JQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoNCyFJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>return false;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoNCyVJQEeiyW7NaN4qWdw" name="toElement" specification="_QmNes1JQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoNCylJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoNCy1JQEeiyW7NaN4qWdw" name="doc" type="_QjgI8FJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoNCzFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                    <language>java</language>
                    <body>Element element = doc.createElement(&quot;update&quot;);&#xD;
         element.appendChild(fcgo.toXMLElementPartial(doc, fields));&#xD;
         return element;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoNp0FJQEeiyW7NaN4qWdw" name="toString" specification="_P6oLEFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoNp0VJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>StringBuilder sb = new StringBuilder(32);&#xD;
         sb.append(&quot;[&quot;).append(getClass().getName())&#xD;
             .append(&quot; &quot;).append(see)&#xD;
             .append(&quot; #&quot;).append(getPriority())&#xD;
             .append(&quot; &quot;).append(fcgo.getId());&#xD;
         for (String f : fields) sb.append(&quot; &quot;).append(f);&#xD;
         sb.append(&quot;]&quot;);&#xD;
         return sb.toString();&#xD;
     </body>
                  </ownedBehavior>
                  <ownedOperation xmi:id="_P6oLEFJQEeiyW7NaN4qWdw" name="toString" method="_QoNp0FJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_P6oyIFJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_QmLpgFJQEeiyW7NaN4qWdw" name="PartialObjectChange" method="_QoNCwFJQEeiyW7NaN4qWdw">
                    <eAnnotations xmi:id="_QmLphFJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                      <details xmi:id="_QmMQkFJQEeiyW7NaN4qWdw" key="create"/>
                    </eAnnotations>
                    <ownedParameter xmi:id="_QmLpgVJQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmLpglJQEeiyW7NaN4qWdw" name="fcgo" type="_QidnIlJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmLpg1JQEeiyW7NaN4qWdw" name="fields">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                      <upperValue xmi:type="uml:LiteralUnlimitedNatural" xmi:id="_QmMQk1JQEeiyW7NaN4qWdw" value="*"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_QmMQklJQEeiyW7NaN4qWdw" type="_P6nkAFJQEeiyW7NaN4qWdw" direction="return"/>
                  </ownedOperation>
                  <ownedOperation xmi:id="_QmM3oFJQEeiyW7NaN4qWdw" name="isPerhapsNotifiable" method="_QoNCxlJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QmM3oVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmM3olJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_QmNes1JQEeiyW7NaN4qWdw" name="toElement" method="_QoNCyVJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QmOFwFJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmOFwVJQEeiyW7NaN4qWdw" name="doc" type="_QjgI8FJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmOFwlJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  </ownedOperation>
                </nestedClassifier>
                <nestedClassifier xmi:type="uml:Class" xmi:id="_P6pZMFJQEeiyW7NaN4qWdw" name="PlayerChange" visibility="private">
                  <eAnnotations xmi:id="_P6qAQFJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_P6qAQVJQEeiyW7NaN4qWdw" key="static"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_QogkxFJQEeiyW7NaN4qWdw">
                    <body>Encapsulate a new player change.</body>
                  </ownedComment>
                  <generalization xmi:id="_QjqhAFJQEeiyW7NaN4qWdw" general="_P6LfIFJQEeiyW7NaN4qWdw"/>
                  <ownedAttribute xmi:id="_QnqQMVJQEeiyW7NaN4qWdw" name="player" visibility="private" isLeaf="true" type="_QhaeQ1JQEeiyW7NaN4qWdw" isReadOnly="true" association="_Qo4_QVJQEeiyW7NaN4qWdw"/>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoNp0lJQEeiyW7NaN4qWdw" name="PlayerChange" specification="_QmOs0FJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoNp01JQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoNp1FJQEeiyW7NaN4qWdw" name="player" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoNp1VJQEeiyW7NaN4qWdw" type="_P6pZMFJQEeiyW7NaN4qWdw" direction="return"/>
                    <language>java</language>
                    <body>super(see);&#xD;
         this.player = player;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoNp1lJQEeiyW7NaN4qWdw" name="getPriority" specification="_P6qAQlJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoNp11JQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>return ChangePriority.CHANGE_EARLY.getPriority();&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoNp2FJQEeiyW7NaN4qWdw" name="isNotifiable" specification="_QmPT4lJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoNp2VJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoNp2lJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>return true;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoNp21JQEeiyW7NaN4qWdw" name="toElement" specification="_QmQiAlJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoNp3FJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoNp3VJQEeiyW7NaN4qWdw" name="doc" type="_QjgI8FJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoNp3lJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                    <language>java</language>
                    <body>final Game game = serverPlayer.getGame();&#xD;
         Element element = doc.createElement(&quot;addPlayer&quot;);&#xD;
         element.appendChild(this.player.toXMLElement(doc, serverPlayer));&#xD;
         return element;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoOQ4FJQEeiyW7NaN4qWdw" name="toString" specification="_P6rOYFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoOQ4VJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>StringBuilder sb = new StringBuilder(32);&#xD;
         sb.append(&quot;[&quot;).append(getClass().getName())&#xD;
             .append(&quot; &quot;).append(see)&#xD;
             .append(&quot; #&quot;).append(getPriority())&#xD;
             .append(&quot; &quot;).append(player.getId())&#xD;
             .append(&quot;]&quot;);&#xD;
         return sb.toString();&#xD;
     </body>
                  </ownedBehavior>
                  <ownedOperation xmi:id="_P6qAQlJQEeiyW7NaN4qWdw" name="getPriority" method="_QoNp1lJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_P6qAQ1JQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_P6rOYFJQEeiyW7NaN4qWdw" name="toString" method="_QoOQ4FJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_P6rOYVJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_QmOs0FJQEeiyW7NaN4qWdw" name="PlayerChange" method="_QoNp0lJQEeiyW7NaN4qWdw">
                    <eAnnotations xmi:id="_QmOs01JQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                      <details xmi:id="_QmPT4FJQEeiyW7NaN4qWdw" key="create"/>
                    </eAnnotations>
                    <ownedComment xmi:id="_QogkxVJQEeiyW7NaN4qWdw">
                      <body>Build a new PlayerChange.&#xD;
         *&#xD;
         * @param see The visibility of this change.&#xD;
         * @param player The &lt;code>Player&lt;/code> to add.</body>
                    </ownedComment>
                    <ownedParameter xmi:id="_QmOs0VJQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmOs0lJQEeiyW7NaN4qWdw" name="player" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmPT4VJQEeiyW7NaN4qWdw" type="_P6pZMFJQEeiyW7NaN4qWdw" direction="return"/>
                  </ownedOperation>
                  <ownedOperation xmi:id="_QmPT4lJQEeiyW7NaN4qWdw" name="isNotifiable" method="_QoNp2FJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QmPT41JQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmPT5FJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_QmQiAlJQEeiyW7NaN4qWdw" name="toElement" method="_QoNp21JQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QmQiA1JQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmQiBFJQEeiyW7NaN4qWdw" name="doc" type="_QjgI8FJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmQiBVJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  </ownedOperation>
                  <ownedOperation xmi:id="_QmRwIFJQEeiyW7NaN4qWdw" name="attachToElement">
                    <ownedParameter xmi:id="_QmRwIVJQEeiyW7NaN4qWdw" name="element" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  </ownedOperation>
                </nestedClassifier>
                <nestedClassifier xmi:type="uml:Class" xmi:id="_P6scgFJQEeiyW7NaN4qWdw" name="RemoveChange" visibility="private">
                  <eAnnotations xmi:id="_P6tDkFJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_P6tDkVJQEeiyW7NaN4qWdw" key="static"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_QogkxlJQEeiyW7NaN4qWdw">
                    <body>Encapsulates removing some objects.&#xD;
     *&#xD;
     * -vis: If removing settlements or units, visibility changes.</body>
                  </ownedComment>
                  <generalization xmi:id="_QjrIEFJQEeiyW7NaN4qWdw" general="_P6LfIFJQEeiyW7NaN4qWdw"/>
                  <ownedAttribute xmi:id="_Qnq3QFJQEeiyW7NaN4qWdw" name="tile" visibility="private" isLeaf="true" type="_QivT8VJQEeiyW7NaN4qWdw" isReadOnly="true" association="_Qo5mUVJQEeiyW7NaN4qWdw"/>
                  <ownedAttribute xmi:id="_QnreUFJQEeiyW7NaN4qWdw" name="fcgo" visibility="private" isLeaf="true" type="_QidnIlJQEeiyW7NaN4qWdw" isReadOnly="true" association="_Qo5mVFJQEeiyW7NaN4qWdw"/>
                  <ownedAttribute xmi:id="_QnreUlJQEeiyW7NaN4qWdw" name="contents" visibility="private" isLeaf="true" type="_QhldYVJQEeiyW7NaN4qWdw" isReadOnly="true" association="_Qo6NYVJQEeiyW7NaN4qWdw"/>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoOQ4lJQEeiyW7NaN4qWdw" name="RemoveChange" specification="_QmTlUFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoOQ41JQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoOQ5FJQEeiyW7NaN4qWdw" name="loc" type="_QikU0FJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoOQ5VJQEeiyW7NaN4qWdw" name="objects" type="_QhldYVJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoOQ5lJQEeiyW7NaN4qWdw" type="_P6scgFJQEeiyW7NaN4qWdw" direction="return"/>
                    <language>java</language>
                    <body>super(see);&#xD;
         this.tile = (loc instanceof Tile) ? (Tile)loc : null;&#xD;
         this.fcgo = objects.remove(objects.size() - 1);&#xD;
         this.contents = objects;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoOQ51JQEeiyW7NaN4qWdw" name="getPriority" specification="_P6tqoFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoOQ6FJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>return ChangePriority.CHANGE_REMOVE.getPriority();&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoOQ6VJQEeiyW7NaN4qWdw" name="isPerhapsNotifiable" specification="_QmUzcVJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoOQ6lJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoOQ61JQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>Settlement settlement;&#xD;
         return tile != null&#xD;
             &amp;&amp; serverPlayer.canSee(tile)&#xD;
             &amp;&amp; ((settlement = tile.getSettlement()) == null&#xD;
                 || settlement.isDisposed()&#xD;
                 || serverPlayer.owns(settlement));&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoOQ7FJQEeiyW7NaN4qWdw" name="toElement" specification="_QmWooFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoOQ7VJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoOQ7lJQEeiyW7NaN4qWdw" name="doc" type="_QjgI8FJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoOQ71JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                    <language>java</language>
                    <body>Element element = doc.createElement(&quot;remove&quot;);&#xD;
         // The main object may be visible, but the contents are&#xD;
         // only visible if the deeper ownership test succeeds.&#xD;
         if (fcgo instanceof Ownable &amp;&amp; serverPlayer.owns((Ownable)fcgo)) {&#xD;
             for (FreeColGameObject o : contents) {&#xD;
                 element.appendChild(o.toXMLElementPartial(doc));&#xD;
             }&#xD;
             element.setAttribute(&quot;divert&quot;, (tile != null) ? tile.getId()&#xD;
                                  : serverPlayer.getId());&#xD;
         }&#xD;
         element.appendChild(fcgo.toXMLElementPartial(doc));&#xD;
         return element;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoO38FJQEeiyW7NaN4qWdw" name="toString" specification="_P6uRslJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoO38VJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>StringBuilder sb = new StringBuilder(32);&#xD;
         sb.append(&quot;[&quot;).append(getClass().getName())&#xD;
             .append(&quot; &quot;).append(see)&#xD;
             .append(&quot; #&quot;).append(getPriority())&#xD;
             .append(&quot; &quot;).append(((tile == null) ? &quot;&lt;null>&quot; : tile.getId()));&#xD;
         for (FreeColGameObject f : contents) {&#xD;
             sb.append(&quot; &quot;).append(f.getId());&#xD;
         }&#xD;
         sb.append(&quot; &quot;).append(fcgo.getId()).append(&quot;]&quot;);&#xD;
         return sb.toString();&#xD;
     </body>
                  </ownedBehavior>
                  <ownedOperation xmi:id="_P6tqoFJQEeiyW7NaN4qWdw" name="getPriority" method="_QoOQ51JQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_P6tqoVJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_P6uRslJQEeiyW7NaN4qWdw" name="toString" method="_QoO38FJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_P6u4wFJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_QmTlUFJQEeiyW7NaN4qWdw" name="RemoveChange" method="_QoOQ4lJQEeiyW7NaN4qWdw">
                    <eAnnotations xmi:id="_QmTlVFJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                      <details xmi:id="_QmTlVVJQEeiyW7NaN4qWdw" key="create"/>
                    </eAnnotations>
                    <ownedComment xmi:id="_Qogkx1JQEeiyW7NaN4qWdw">
                      <body>Build a new RemoveChange for an object that is disposed.&#xD;
         *&#xD;
         * @param see The visibility of this change.&#xD;
         * @param loc The &lt;code>Location&lt;/code> where the object was.&#xD;
         * @param objects The &lt;code>FreeColGameObject&lt;/code>s to remove.</body>
                    </ownedComment>
                    <ownedParameter xmi:id="_QmTlUVJQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmTlUlJQEeiyW7NaN4qWdw" name="loc" type="_QikU0FJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmTlU1JQEeiyW7NaN4qWdw" name="objects" type="_QhldYVJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmTlVlJQEeiyW7NaN4qWdw" type="_P6scgFJQEeiyW7NaN4qWdw" direction="return"/>
                  </ownedOperation>
                  <ownedOperation xmi:id="_QmUzcVJQEeiyW7NaN4qWdw" name="isPerhapsNotifiable" method="_QoOQ6VJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QmVagFJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmVagVJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_QmWooFJQEeiyW7NaN4qWdw" name="toElement" method="_QoOQ7FJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QmWooVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmWoolJQEeiyW7NaN4qWdw" name="doc" type="_QjgI8FJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmWoo1JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  </ownedOperation>
                  <ownedOperation xmi:id="_QmXPslJQEeiyW7NaN4qWdw" name="attachToElement">
                    <ownedParameter xmi:id="_QmXPs1JQEeiyW7NaN4qWdw" name="element" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  </ownedOperation>
                </nestedClassifier>
                <nestedClassifier xmi:type="uml:Class" xmi:id="_P6wG4FJQEeiyW7NaN4qWdw" name="OwnedChange" visibility="private">
                  <eAnnotations xmi:id="_P6wG4VJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_P6wG4lJQEeiyW7NaN4qWdw" key="static"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_QogkyFJQEeiyW7NaN4qWdw">
                    <body>Encapsulate an owned object change.</body>
                  </ownedComment>
                  <generalization xmi:id="_QjsWMFJQEeiyW7NaN4qWdw" general="_P6LfIFJQEeiyW7NaN4qWdw"/>
                  <ownedAttribute xmi:id="_QnsscVJQEeiyW7NaN4qWdw" name="fco" visibility="private" isLeaf="true" type="_Qje60FJQEeiyW7NaN4qWdw" isReadOnly="true" association="_Qo60cVJQEeiyW7NaN4qWdw"/>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoO38lJQEeiyW7NaN4qWdw" name="OwnedChange" specification="_QmYd0FJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoO381JQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoO39FJQEeiyW7NaN4qWdw" name="fco" type="_Qje60FJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoO39VJQEeiyW7NaN4qWdw" type="_P6wG4FJQEeiyW7NaN4qWdw" direction="return"/>
                    <language>java</language>
                    <body>super(see);&#xD;
         this.fco = fco;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoO39lJQEeiyW7NaN4qWdw" name="getPriority" specification="_P6wt8FJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoO391JQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>return ChangePriority.CHANGE_OWNED.getPriority();&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoO3-FJQEeiyW7NaN4qWdw" name="toElement" specification="_QmZr8FJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoO3-VJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoO3-lJQEeiyW7NaN4qWdw" name="doc" type="_QjgI8FJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoO3-1JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                    <language>java</language>
                    <body>Element element = doc.createElement(&quot;addObject&quot;);&#xD;
         Element child = fco.toXMLElement(doc, serverPlayer);&#xD;
         child.setAttribute(&quot;owner&quot;, serverPlayer.getId());&#xD;
         element.appendChild(child);&#xD;
         return element;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoO3_FJQEeiyW7NaN4qWdw" name="toString" specification="_P6xVA1JQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoO3_VJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>StringBuilder sb = new StringBuilder(32);&#xD;
         sb.append(&quot;[&quot;).append(getClass().getName())&#xD;
             .append(&quot; &quot;).append(see)&#xD;
             .append(&quot; #&quot;).append(getPriority())&#xD;
             .append(&quot; &quot;).append(fco.getId())&#xD;
             .append(&quot;]&quot;);&#xD;
         return sb.toString();&#xD;
     </body>
                  </ownedBehavior>
                  <ownedOperation xmi:id="_P6wt8FJQEeiyW7NaN4qWdw" name="getPriority" method="_QoO39lJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_P6wt8VJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_P6xVA1JQEeiyW7NaN4qWdw" name="toString" method="_QoO3_FJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_P6xVBFJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_QmYd0FJQEeiyW7NaN4qWdw" name="OwnedChange" method="_QoO38lJQEeiyW7NaN4qWdw">
                    <eAnnotations xmi:id="_QmZE4lJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                      <details xmi:id="_QmZE41JQEeiyW7NaN4qWdw" key="create"/>
                    </eAnnotations>
                    <ownedComment xmi:id="_QogkyVJQEeiyW7NaN4qWdw">
                      <body>Build a new OwnedChange.&#xD;
         *&#xD;
         * @param see The visibility of this change.&#xD;
         * @param fco The &lt;code>FreeColObject&lt;/code> to update.</body>
                    </ownedComment>
                    <ownedParameter xmi:id="_QmZE4FJQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmZE4VJQEeiyW7NaN4qWdw" name="fco" type="_Qje60FJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmZE5FJQEeiyW7NaN4qWdw" type="_P6wG4FJQEeiyW7NaN4qWdw" direction="return"/>
                  </ownedOperation>
                  <ownedOperation xmi:id="_QmZr8FJQEeiyW7NaN4qWdw" name="toElement" method="_QoO3-FJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QmZr8VJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmZr8lJQEeiyW7NaN4qWdw" name="doc" type="_QjgI8FJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmZr81JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  </ownedOperation>
                  <ownedOperation xmi:id="_Qma6ElJQEeiyW7NaN4qWdw" name="attachToElement">
                    <ownedParameter xmi:id="_Qma6E1JQEeiyW7NaN4qWdw" name="element" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  </ownedOperation>
                </nestedClassifier>
                <nestedClassifier xmi:type="uml:Class" xmi:id="_P6yjIFJQEeiyW7NaN4qWdw" name="FeatureChange" visibility="private">
                  <eAnnotations xmi:id="_P6yjIVJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_P6yjIlJQEeiyW7NaN4qWdw" key="static"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_QogkylJQEeiyW7NaN4qWdw">
                    <body>Encapsulate a feature change.</body>
                  </ownedComment>
                  <generalization xmi:id="_Qjs9QFJQEeiyW7NaN4qWdw" general="_P6LfIFJQEeiyW7NaN4qWdw"/>
                  <ownedAttribute xmi:id="_QntTgFJQEeiyW7NaN4qWdw" name="object" visibility="private" isLeaf="true" type="_QidnIlJQEeiyW7NaN4qWdw" isReadOnly="true" association="_Qo60dFJQEeiyW7NaN4qWdw"/>
                  <ownedAttribute xmi:id="_QntTglJQEeiyW7NaN4qWdw" name="feature" visibility="private" isLeaf="true" type="_QjeTwVJQEeiyW7NaN4qWdw" isReadOnly="true" association="_Qo7bgVJQEeiyW7NaN4qWdw"/>
                  <ownedAttribute xmi:id="_QnuhoVJQEeiyW7NaN4qWdw" name="add" visibility="private" isLeaf="true" isReadOnly="true">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  </ownedAttribute>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoPfAFJQEeiyW7NaN4qWdw" name="FeatureChange" specification="_QmcvQFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoPfAVJQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoPfAlJQEeiyW7NaN4qWdw" name="object" type="_QidnIlJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoPfA1JQEeiyW7NaN4qWdw" name="feature" type="_QjeTwVJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoPfBFJQEeiyW7NaN4qWdw" name="add">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_QoPfBVJQEeiyW7NaN4qWdw" type="_P6yjIFJQEeiyW7NaN4qWdw" direction="return"/>
                    <language>java</language>
                    <body>super(see);&#xD;
         this.object = object;&#xD;
         this.feature = feature;&#xD;
         this.add = add;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoPfBlJQEeiyW7NaN4qWdw" name="getPriority" specification="_P6zKMFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoPfB1JQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>return ChangePriority.CHANGE_OWNED.getPriority();&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoPfCFJQEeiyW7NaN4qWdw" name="toElement" specification="_Qmd9YFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoPfCVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoPfClJQEeiyW7NaN4qWdw" name="doc" type="_QjgI8FJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoPfC1JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                    <language>java</language>
                    <body>Element element = doc.createElement(&quot;featureChange&quot;);&#xD;
         element.setAttribute(&quot;add&quot;, Boolean.toString(add));&#xD;
         element.setAttribute(FreeColObject.ID_ATTRIBUTE_TAG, object.getId());&#xD;
         Element child = feature.toXMLElement(doc);&#xD;
         element.appendChild(child);&#xD;
         return element;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoPfDFJQEeiyW7NaN4qWdw" name="toString" specification="_P60YUFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoPfDVJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>StringBuilder sb = new StringBuilder(32);&#xD;
         sb.append(&quot;[&quot;).append(getClass().getName())&#xD;
             .append(&quot; &quot;).append(see)&#xD;
             .append(&quot; #&quot;).append(getPriority())&#xD;
             .append(&quot; &quot;).append((add) ? &quot;add&quot; : &quot;remove&quot;)&#xD;
             .append(&quot; &quot;).append(feature)&#xD;
             .append(&quot; &quot;).append((add) ? &quot;to&quot; : &quot;from&quot;)&#xD;
             .append(&quot; &quot;).append(object.getId())&#xD;
             .append(&quot;]&quot;);&#xD;
         return sb.toString();&#xD;
     </body>
                  </ownedBehavior>
                  <ownedOperation xmi:id="_P6zKMFJQEeiyW7NaN4qWdw" name="getPriority" method="_QoPfBlJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_P6zxQFJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_P60YUFJQEeiyW7NaN4qWdw" name="toString" method="_QoPfDFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_P60YUVJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_QmcvQFJQEeiyW7NaN4qWdw" name="FeatureChange" method="_QoPfAFJQEeiyW7NaN4qWdw">
                    <eAnnotations xmi:id="_QmcvRVJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                      <details xmi:id="_QmcvRlJQEeiyW7NaN4qWdw" key="create"/>
                    </eAnnotations>
                    <ownedComment xmi:id="_Qogky1JQEeiyW7NaN4qWdw">
                      <body>Build a new FeatureChange.&#xD;
         *&#xD;
         * @param see The visibility of this change.&#xD;
         * @param object The &lt;code>FreeColGameObject&lt;/code> to update.&#xD;
         * @param feature a &lt;code>Feature&lt;/code> value to add or remove.&#xD;
         * @param add a &lt;code>boolean&lt;/code> value</body>
                    </ownedComment>
                    <ownedParameter xmi:id="_QmcvQVJQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmcvQlJQEeiyW7NaN4qWdw" name="object" type="_QidnIlJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmcvQ1JQEeiyW7NaN4qWdw" name="feature" type="_QjeTwVJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmcvRFJQEeiyW7NaN4qWdw" name="add">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_QmcvR1JQEeiyW7NaN4qWdw" type="_P6yjIFJQEeiyW7NaN4qWdw" direction="return"/>
                  </ownedOperation>
                  <ownedOperation xmi:id="_Qmd9YFJQEeiyW7NaN4qWdw" name="toElement" method="_QoPfCFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_Qmd9YVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_Qmd9YlJQEeiyW7NaN4qWdw" name="doc" type="_QjgI8FJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_Qmd9Y1JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  </ownedOperation>
                  <ownedOperation xmi:id="_QmfLgFJQEeiyW7NaN4qWdw" name="attachToElement">
                    <ownedParameter xmi:id="_QmfLgVJQEeiyW7NaN4qWdw" name="element" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  </ownedOperation>
                </nestedClassifier>
                <nestedClassifier xmi:type="uml:Class" xmi:id="_P61mcFJQEeiyW7NaN4qWdw" name="SpyChange" visibility="private">
                  <eAnnotations xmi:id="_P61mcVJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_P61mclJQEeiyW7NaN4qWdw" key="static"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_QogkzFJQEeiyW7NaN4qWdw">
                    <body>Encapsulates a spying action.</body>
                  </ownedComment>
                  <generalization xmi:id="_QjuLYFJQEeiyW7NaN4qWdw" general="_P6LfIFJQEeiyW7NaN4qWdw"/>
                  <ownedAttribute xmi:id="_QnvIsFJQEeiyW7NaN4qWdw" name="tile" visibility="private" isLeaf="true" type="_QivT8VJQEeiyW7NaN4qWdw" isReadOnly="true" association="_Qo7bhFJQEeiyW7NaN4qWdw"/>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoQGEFJQEeiyW7NaN4qWdw" name="SpyChange" specification="_QmgZoFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoQGEVJQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoQGElJQEeiyW7NaN4qWdw" name="settlement" type="_QitewVJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoQGE1JQEeiyW7NaN4qWdw" type="_P61mcFJQEeiyW7NaN4qWdw" direction="return"/>
                    <language>java</language>
                    <body>super(see);&#xD;
         tile = settlement.getTile();&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoQGFFJQEeiyW7NaN4qWdw" name="getPriority" specification="_P62NgFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoQGFVJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>return ChangePriority.CHANGE_NORMAL.getPriority();&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoQGFlJQEeiyW7NaN4qWdw" name="toElement" specification="_QmhnwFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoQGF1JQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoQGGFJQEeiyW7NaN4qWdw" name="doc" type="_QjgI8FJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoQGGVJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                    <language>java</language>
                    <body>Element element = doc.createElement(&quot;spyResult&quot;);&#xD;
         element.setAttribute(&quot;tile&quot;, tile.getId());&#xD;
         // Have to tack on two copies of the settlement tile.&#xD;
         // One full version, one ordinary version to restore.&#xD;
         element.appendChild(tile.toXMLElement(doc));&#xD;
         element.appendChild(tile.getCachedTile(serverPlayer)&#xD;
             .toXMLElement(doc, serverPlayer));&#xD;
         return element;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoQGGlJQEeiyW7NaN4qWdw" name="toString" specification="_P620klJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoQGG1JQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>StringBuilder sb = new StringBuilder(32);&#xD;
         sb.append(&quot;[&quot;).append(getClass().getName())&#xD;
             .append(&quot; &quot;).append(see)&#xD;
             .append(&quot; #&quot;).append(getPriority())&#xD;
             .append(&quot; &quot;).append(tile.getId())&#xD;
             .append(&quot;]&quot;);&#xD;
         return sb.toString();&#xD;
     </body>
                  </ownedBehavior>
                  <ownedOperation xmi:id="_P62NgFJQEeiyW7NaN4qWdw" name="getPriority" method="_QoQGFFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_P62NgVJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_P620klJQEeiyW7NaN4qWdw" name="toString" method="_QoQGGlJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_P620k1JQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_QmgZoFJQEeiyW7NaN4qWdw" name="SpyChange" method="_QoQGEFJQEeiyW7NaN4qWdw">
                    <eAnnotations xmi:id="_QmhAsVJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                      <details xmi:id="_QmhAslJQEeiyW7NaN4qWdw" key="create"/>
                    </eAnnotations>
                    <ownedComment xmi:id="_QogkzVJQEeiyW7NaN4qWdw">
                      <body>Build a new SpyChange.&#xD;
         *&#xD;
         * @param see The visibility of this change.&#xD;
         * @param settlement The &lt;code>Settlement&lt;/code> to spy on.</body>
                    </ownedComment>
                    <ownedParameter xmi:id="_QmgZoVJQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmhAsFJQEeiyW7NaN4qWdw" name="settlement" type="_QitewVJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmhAs1JQEeiyW7NaN4qWdw" type="_P61mcFJQEeiyW7NaN4qWdw" direction="return"/>
                  </ownedOperation>
                  <ownedOperation xmi:id="_QmhnwFJQEeiyW7NaN4qWdw" name="toElement" method="_QoQGFlJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QmhnwVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmhnwlJQEeiyW7NaN4qWdw" name="doc" type="_QjgI8FJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_Qmhnw1JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  </ownedOperation>
                  <ownedOperation xmi:id="_QmiO01JQEeiyW7NaN4qWdw" name="attachToElement">
                    <ownedParameter xmi:id="_Qmi14FJQEeiyW7NaN4qWdw" name="element" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  </ownedOperation>
                </nestedClassifier>
                <nestedClassifier xmi:type="uml:Class" xmi:id="_P64CsFJQEeiyW7NaN4qWdw" name="StanceChange" visibility="private">
                  <eAnnotations xmi:id="_P64pwFJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_P64pwVJQEeiyW7NaN4qWdw" key="static"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_QohL0FJQEeiyW7NaN4qWdw">
                    <body>Encapsulate a stance change.</body>
                  </ownedComment>
                  <generalization xmi:id="_QjvZgFJQEeiyW7NaN4qWdw" general="_P6LfIFJQEeiyW7NaN4qWdw"/>
                  <ownedAttribute xmi:id="_QnvvwFJQEeiyW7NaN4qWdw" name="first" visibility="private" isLeaf="true" type="_QhZQIFJQEeiyW7NaN4qWdw" isReadOnly="true" association="_Qo8CkVJQEeiyW7NaN4qWdw"/>
                  <ownedAttribute xmi:id="_QnvvwlJQEeiyW7NaN4qWdw" name="stance" visibility="private" isLeaf="true" type="_QisQoFJQEeiyW7NaN4qWdw" isReadOnly="true"/>
                  <ownedAttribute xmi:id="_QnvvxFJQEeiyW7NaN4qWdw" name="second" visibility="private" isLeaf="true" type="_QhZQIFJQEeiyW7NaN4qWdw" isReadOnly="true" association="_Qo8poVJQEeiyW7NaN4qWdw"/>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoQGHFJQEeiyW7NaN4qWdw" name="StanceChange" specification="_QmkEAFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoQGHVJQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoQGHlJQEeiyW7NaN4qWdw" name="first" type="_QhZQIFJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoQGH1JQEeiyW7NaN4qWdw" name="stance" type="_QisQoFJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoQGIFJQEeiyW7NaN4qWdw" name="second" type="_QhZQIFJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoQGIVJQEeiyW7NaN4qWdw" type="_P64CsFJQEeiyW7NaN4qWdw" direction="return"/>
                    <language>java</language>
                    <body>super(see);&#xD;
         this.first = first;&#xD;
         this.stance = stance;&#xD;
         this.second = second;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoQtIFJQEeiyW7NaN4qWdw" name="getPriority" specification="_P65Q0FJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoQtIVJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>return ChangePriority.CHANGE_STANCE.getPriority();&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoQtIlJQEeiyW7NaN4qWdw" name="toElement" specification="_QmlSIFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoQtI1JQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoQtJFJQEeiyW7NaN4qWdw" name="doc" type="_QjgI8FJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoQtJVJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                    <language>java</language>
                    <body>Element element = doc.createElement(&quot;setStance&quot;);&#xD;
         element.setAttribute(&quot;stance&quot;, stance.toString());&#xD;
         element.setAttribute(&quot;first&quot;, first.getId());&#xD;
         element.setAttribute(&quot;second&quot;, second.getId());&#xD;
         return element;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoQtJlJQEeiyW7NaN4qWdw" name="toString" specification="_P6534lJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoQtJ1JQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>StringBuilder sb = new StringBuilder(32);&#xD;
         sb.append(&quot;[&quot;).append(getClass().getName())&#xD;
             .append(&quot; &quot;).append(see)&#xD;
             .append(&quot; #&quot;).append(getPriority())&#xD;
             .append(&quot; &quot;).append(first.getId())&#xD;
             .append(&quot; &quot;).append(stance)&#xD;
             .append(&quot; &quot;).append(second.getId())&#xD;
             .append(&quot;]&quot;);&#xD;
         return sb.toString();&#xD;
     </body>
                  </ownedBehavior>
                  <ownedOperation xmi:id="_P65Q0FJQEeiyW7NaN4qWdw" name="getPriority" method="_QoQtIFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_P65Q0VJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_P6534lJQEeiyW7NaN4qWdw" name="toString" method="_QoQtJlJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_P65341JQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_QmkEAFJQEeiyW7NaN4qWdw" name="StanceChange" method="_QoQGHFJQEeiyW7NaN4qWdw">
                    <eAnnotations xmi:id="_QmkrFFJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                      <details xmi:id="_QmkrFVJQEeiyW7NaN4qWdw" key="create"/>
                    </eAnnotations>
                    <ownedComment xmi:id="_QohL0VJQEeiyW7NaN4qWdw">
                      <body>Build a new StanceChange.&#xD;
         *&#xD;
         * @param see The visibility of this change.&#xD;
         * @param first The &lt;code>Player&lt;/code> changing stance.&#xD;
         * @param stance The &lt;code>Stance&lt;/code> to change to.&#xD;
         * @param second The &lt;code>Player&lt;/code> wrt with to change.</body>
                    </ownedComment>
                    <ownedParameter xmi:id="_QmkrEFJQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmkrEVJQEeiyW7NaN4qWdw" name="first" type="_QhZQIFJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmkrElJQEeiyW7NaN4qWdw" name="stance" type="_QisQoFJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmkrE1JQEeiyW7NaN4qWdw" name="second" type="_QhZQIFJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmkrFlJQEeiyW7NaN4qWdw" type="_P64CsFJQEeiyW7NaN4qWdw" direction="return"/>
                  </ownedOperation>
                  <ownedOperation xmi:id="_QmlSIFJQEeiyW7NaN4qWdw" name="toElement" method="_QoQtIlJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QmlSIVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmlSIlJQEeiyW7NaN4qWdw" name="doc" type="_QjgI8FJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmlSI1JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  </ownedOperation>
                  <ownedOperation xmi:id="_QmmgQlJQEeiyW7NaN4qWdw" name="attachToElement">
                    <ownedParameter xmi:id="_QmmgQ1JQEeiyW7NaN4qWdw" name="element" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  </ownedOperation>
                </nestedClassifier>
                <nestedClassifier xmi:type="uml:Class" xmi:id="_P67tEFJQEeiyW7NaN4qWdw" name="TrivialChange" visibility="private">
                  <eAnnotations xmi:id="_P67tEVJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_P67tElJQEeiyW7NaN4qWdw" key="static"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_QohL0lJQEeiyW7NaN4qWdw">
                    <body>Encapsulate trivial element, which will only have attributes apart&#xD;
     * from its name.</body>
                  </ownedComment>
                  <generalization xmi:id="_QjxOsFJQEeiyW7NaN4qWdw" general="_P6LfIFJQEeiyW7NaN4qWdw"/>
                  <ownedAttribute xmi:id="_QnwW0VJQEeiyW7NaN4qWdw" name="name" visibility="private" isLeaf="true" isReadOnly="true">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedAttribute>
                  <ownedAttribute xmi:id="_Qnw94FJQEeiyW7NaN4qWdw" name="attributes" visibility="private" isLeaf="true" isReadOnly="true">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    <upperValue xmi:type="uml:LiteralUnlimitedNatural" xmi:id="_Qnw94VJQEeiyW7NaN4qWdw" value="*"/>
                  </ownedAttribute>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoRUMFJQEeiyW7NaN4qWdw" name="TrivialChange" specification="_QjwnoFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoRUMVJQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoRUMlJQEeiyW7NaN4qWdw" name="name">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_QoRUM1JQEeiyW7NaN4qWdw" name="priority">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_QoRUNFJQEeiyW7NaN4qWdw" name="attributes">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                      <upperValue xmi:type="uml:LiteralUnlimitedNatural" xmi:id="_QoRUNVJQEeiyW7NaN4qWdw" value="*"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_QoRUNlJQEeiyW7NaN4qWdw" type="_P67tEFJQEeiyW7NaN4qWdw" direction="return"/>
                    <language>java</language>
                    <body>super(see);&#xD;
         if ((attributes.length &amp; 1) == 1) {&#xD;
             throw new IllegalArgumentException(&quot;Attributes must be even sized&quot;);&#xD;
         }&#xD;
         this.name = name;&#xD;
         this.priority = priority;&#xD;
         this.attributes = attributes;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoRUN1JQEeiyW7NaN4qWdw" name="getPriority" specification="_P68UIFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoRUOFJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>return priority;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoRUOVJQEeiyW7NaN4qWdw" name="toElement" specification="_QmnuYFJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoRUOlJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoRUO1JQEeiyW7NaN4qWdw" name="doc" type="_QjgI8FJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QoRUPFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                    <language>java</language>
                    <body>Element element = doc.createElement(name);&#xD;
         for (int i = 0; i &lt; attributes.length; i += 2) {&#xD;
             element.setAttribute(attributes[i], attributes[i+1]);&#xD;
         }&#xD;
         return element;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoRUPVJQEeiyW7NaN4qWdw" name="toString" specification="_P687MlJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QoRUPlJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                    <language>java</language>
                    <body>String ret = &quot;[&quot; + getClass().getName() + &quot; &quot; + see&#xD;
             + &quot; #&quot; + getPriority()&#xD;
             + &quot; &quot; + name;&#xD;
         for (String a : attributes) ret += &quot; &quot; + a;&#xD;
         return ret + &quot;]&quot;;&#xD;
     </body>
                  </ownedBehavior>
                  <ownedOperation xmi:id="_P68UIFJQEeiyW7NaN4qWdw" name="getPriority" method="_QoRUN1JQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_P68UIVJQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_P687MlJQEeiyW7NaN4qWdw" name="toString" method="_QoRUPVJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_P687M1JQEeiyW7NaN4qWdw" direction="return">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                  </ownedOperation>
                  <ownedOperation xmi:id="_QjwnoFJQEeiyW7NaN4qWdw" name="TrivialChange" method="_QoRUMFJQEeiyW7NaN4qWdw">
                    <eAnnotations xmi:id="_QjwnpVJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                      <details xmi:id="_QjwnplJQEeiyW7NaN4qWdw" key="create"/>
                    </eAnnotations>
                    <ownedComment xmi:id="_QohL01JQEeiyW7NaN4qWdw">
                      <body>Build a new TrivialChange.&#xD;
         *&#xD;
         * @param see The visibility of this change.&#xD;
         * @param name The name of the element.&#xD;
         * @param priority The sort priority of this change.</body>
                    </ownedComment>
                    <ownedParameter xmi:id="_QjwnoVJQEeiyW7NaN4qWdw" name="see" type="_P6HNsFJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QjwnolJQEeiyW7NaN4qWdw" name="name">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_Qjwno1JQEeiyW7NaN4qWdw" name="priority">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_QjwnpFJQEeiyW7NaN4qWdw" name="attributes">
                      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                      <upperValue xmi:type="uml:LiteralUnlimitedNatural" xmi:id="_QjwnqFJQEeiyW7NaN4qWdw" value="*"/>
                    </ownedParameter>
                    <ownedParameter xmi:id="_Qjwnp1JQEeiyW7NaN4qWdw" type="_P67tEFJQEeiyW7NaN4qWdw" direction="return"/>
                  </ownedOperation>
                  <ownedOperation xmi:id="_QmnuYFJQEeiyW7NaN4qWdw" name="toElement" method="_QoRUOVJQEeiyW7NaN4qWdw">
                    <ownedParameter xmi:id="_QmnuYVJQEeiyW7NaN4qWdw" name="serverPlayer" type="_QhaeQ1JQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmoVcFJQEeiyW7NaN4qWdw" name="doc" type="_QjgI8FJQEeiyW7NaN4qWdw"/>
                    <ownedParameter xmi:id="_QmoVcVJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  </ownedOperation>
                  <ownedOperation xmi:id="_Qmo8gFJQEeiyW7NaN4qWdw" name="attachToElement">
                    <ownedParameter xmi:id="_Qmo8gVJQEeiyW7NaN4qWdw" name="element" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  </ownedOperation>
                </nestedClassifier>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_P7jYIFJQEeiyW7NaN4qWdw" name="PreGameInputHandler" isLeaf="true">
                <ownedComment xmi:id="_Qohy7VJQEeiyW7NaN4qWdw">
                  <body>Handles the network messages that arrives before the game starts.&#xD;
&#xD;
@see PreGameController</body>
                </ownedComment>
                <generalization xmi:id="_QkLeYFJQEeiyW7NaN4qWdw" general="_P4_MUFJQEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_Qn1PUFJQEeiyW7NaN4qWdw" name="logger" visibility="private" isLeaf="true" isStatic="true" type="_QhXa8VJQEeiyW7NaN4qWdw" isReadOnly="true" association="_Qo8ppFJQEeiyW7NaN4qWdw">
                  <defaultValue xmi:type="uml:LiteralString" xmi:id="_Qn1PUVJQEeiyW7NaN4qWdw" value="Logger.getLogger(PreGameInputHandler.class.getName())"/>
                </ownedAttribute>
                <ownedAttribute xmi:id="_Qn1PUlJQEeiyW7NaN4qWdw" name="launching" visibility="private">
                  <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#boolean"/>
                  <defaultValue xmi:type="uml:LiteralString" xmi:id="_Qn1PU1JQEeiyW7NaN4qWdw" value="false"/>
                </ownedAttribute>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoWzwFJQEeiyW7NaN4qWdw" name="PreGameInputHandler" specification="_QnAv8FJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoWzwVJQEeiyW7NaN4qWdw" name="freeColServer" type="_QhaeQVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoWzwlJQEeiyW7NaN4qWdw" type="_P7jYIFJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(freeColServer);&#xD;
     // FIXME: move and simplify methods later, for now just delegate&#xD;
     register(&quot;ready&quot;,&#xD;
         (Connection connection, Element element) ->&#xD;
         ready(connection, element));&#xD;
     register(&quot;requestLaunch&quot;,&#xD;
         (Connection connection, Element element) -> {&#xD;
             Element reply = requestLaunch(connection, element);&#xD;
             if (reply != null) {&#xD;
                 launching = false;&#xD;
             }&#xD;
             return reply;&#xD;
         });&#xD;
     register(&quot;setColor&quot;,&#xD;
         (Connection connection, Element element) ->&#xD;
         setColor(connection, element));&#xD;
     register(&quot;setNation&quot;,&#xD;
         (Connection connection, Element element) ->&#xD;
         setNation(connection, element));&#xD;
     register(&quot;setNationType&quot;,&#xD;
         (Connection connection, Element element) ->&#xD;
         setNationType(connection, element));&#xD;
     register(&quot;setAvailable&quot;,&#xD;
         (Connection connection, Element element) ->&#xD;
         setAvailable(connection, element));&#xD;
     register(&quot;updateGameOptions&quot;,&#xD;
         (Connection connection, Element element) ->&#xD;
         updateGameOptions(connection, element));&#xD;
     register(&quot;updateMapGeneratorOptions&quot;,&#xD;
         (Connection connection, Element element) ->&#xD;
         updateMapGeneratorOptions(connection, element));&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoWzw1JQEeiyW7NaN4qWdw" name="logout" specification="_QnBXA1JQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoWzxFJQEeiyW7NaN4qWdw" name="connection" type="_QhZQIlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoWzxVJQEeiyW7NaN4qWdw" name="element" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoWzxlJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>logger.info(&quot;Logout from: &quot; + connection);&#xD;
     ServerPlayer player = getFreeColServer().getPlayer(connection);&#xD;
     player.setConnected(false);&#xD;
     getGame().removePlayer(player);&#xD;
     getFreeColServer().getServer()&#xD;
         .sendToAll(DOMMessage.createMessage(&quot;logout&quot;,&#xD;
                 &quot;reason&quot;, &quot;User has logged out.&quot;,&#xD;
                 &quot;player&quot;, player.getId()),&#xD;
             connection);&#xD;
     getFreeColServer().updateMetaServer();&#xD;
     return null;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoWzx1JQEeiyW7NaN4qWdw" name="ready" specification="_QnClIVJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoWzyFJQEeiyW7NaN4qWdw" name="connection" type="_QhZQIlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoWzyVJQEeiyW7NaN4qWdw" name="element" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoWzylJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>ServerPlayer player = getFreeColServer().getPlayer(connection);&#xD;
     if (player != null) {&#xD;
         boolean ready = Boolean.parseBoolean(element.getAttribute(&quot;value&quot;));&#xD;
         player.setReady(ready);&#xD;
         getFreeColServer().getServer()&#xD;
             .sendToAll(DOMMessage.createMessage(&quot;playerReady&quot;,&#xD;
                     &quot;player&quot;, player.getId(),&#xD;
                     &quot;value&quot;, Boolean.toString(ready)),&#xD;
                 player.getConnection());&#xD;
     } else {&#xD;
         logger.warning(&quot;Ready from unknown connection.&quot;);&#xD;
     }&#xD;
     return null;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoXa0FJQEeiyW7NaN4qWdw" name="requestLaunch" specification="_QnDMMVJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoXa0VJQEeiyW7NaN4qWdw" name="connection" type="_QhZQIlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoXa0lJQEeiyW7NaN4qWdw" name="element" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoXa01JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>FreeColServer freeColServer = getFreeColServer();&#xD;
&#xD;
     // Check if launching player is an admin.&#xD;
     ServerPlayer launchingPlayer = freeColServer.getPlayer(connection);&#xD;
     if (!launchingPlayer.isAdmin()) {&#xD;
         return DOMMessage.createError(&quot;server.onlyAdminCanLaunch&quot;,&#xD;
             &quot;Only the server admin can launch the game.&quot;);&#xD;
     }&#xD;
&#xD;
     if (launching) return null;&#xD;
     launching = true;&#xD;
&#xD;
     // Check that no two players have the same nation&#xD;
     ArrayList&lt;Nation> nations = new ArrayList&lt;>();&#xD;
     for (Player player : getGame().getLivePlayers(null)) {&#xD;
         final Nation nation = getGame().getSpecification()&#xD;
             .getNation(player.getNationId());&#xD;
         if (nations.contains(nation)) {&#xD;
             return DOMMessage.createError(&quot;server.invalidPlayerNations&quot;,&#xD;
                 &quot;All players need to pick a unique nation before the game can start.&quot;);&#xD;
         }&#xD;
         nations.add(nation);&#xD;
     }&#xD;
&#xD;
     // Check if all players are ready.&#xD;
     if (!getGame().allPlayersReadyToLaunch()) {&#xD;
         return DOMMessage.createError(&quot;server.notAllReady&quot;,&#xD;
             &quot;Not all players are ready to begin the game!&quot;);&#xD;
     }&#xD;
     try {&#xD;
         ((PreGameController)freeColServer.getController()).startGame();&#xD;
     } catch (FreeColException e) {&#xD;
         return DOMMessage.createError(&quot;server.errorStartingGame&quot;,&#xD;
                                       e.getMessage());&#xD;
     }&#xD;
&#xD;
     return null;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoXa1FJQEeiyW7NaN4qWdw" name="setAvailable" specification="_QnEaUFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoXa1VJQEeiyW7NaN4qWdw" name="connection" type="_QhZQIlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoXa1lJQEeiyW7NaN4qWdw" name="element" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoXa11JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>ServerPlayer player = getFreeColServer().getPlayer(connection);&#xD;
     if (player != null) {&#xD;
         Nation nation = getGame().getSpecification()&#xD;
             .getNation(element.getAttribute(&quot;nation&quot;));&#xD;
         NationState state = Enum.valueOf(NationState.class,&#xD;
                                          element.getAttribute(&quot;state&quot;));&#xD;
         getGame().getNationOptions().setNationState(nation, state);&#xD;
         getFreeColServer().getServer().sendToAll(element, &#xD;
             player.getConnection());&#xD;
     } else {&#xD;
         logger.warning(&quot;Available from unknown connection.&quot;);&#xD;
     }&#xD;
     return null;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoXa2FJQEeiyW7NaN4qWdw" name="setColor" specification="_QnFBYFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoXa2VJQEeiyW7NaN4qWdw" name="connection" type="_QhZQIlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoXa2lJQEeiyW7NaN4qWdw" name="element" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoXa21JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>ServerPlayer player = getFreeColServer().getPlayer(connection);&#xD;
     if (player != null) {&#xD;
         Nation nation = getGame().getSpecification()&#xD;
             .getNation(element.getAttribute(&quot;nation&quot;));&#xD;
         String str = element.getAttribute(&quot;color&quot;);&#xD;
         Color color;&#xD;
         try {&#xD;
             int rgb = Integer.decode(str);&#xD;
             color = new Color(rgb);&#xD;
         } catch (NumberFormatException nfe) {&#xD;
             return DOMMessage.createError(&quot;server.badColor&quot;,&#xD;
                                           &quot;Invalid color: &quot; + str);&#xD;
         }&#xD;
         nation.setColor(color);&#xD;
         getFreeColServer().getServer()&#xD;
             .sendToAll(DOMMessage.createMessage(&quot;updateColor&quot;,&#xD;
                     &quot;nation&quot;, nation.getId(),&#xD;
                     &quot;color&quot;, Integer.toString(color.getRGB())),&#xD;
                 player.getConnection());&#xD;
     } else {&#xD;
         logger.warning(&quot;setColor from unknown connection.&quot;);&#xD;
     }&#xD;
     return null;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoXa3FJQEeiyW7NaN4qWdw" name="setNation" specification="_QnFocFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoXa3VJQEeiyW7NaN4qWdw" name="connection" type="_QhZQIlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoXa3lJQEeiyW7NaN4qWdw" name="element" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoXa31JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>ServerPlayer player = getFreeColServer().getPlayer(connection);&#xD;
     if (player != null) {&#xD;
         Nation nation = getGame().getSpecification()&#xD;
             .getNation(element.getAttribute(&quot;value&quot;));&#xD;
         if (getGame().getNationOptions().getNations().get(nation)&#xD;
             == NationState.AVAILABLE) {&#xD;
             player.setNation(nation);&#xD;
             getFreeColServer().getServer()&#xD;
                 .sendToAll(DOMMessage.createMessage(&quot;updateNation&quot;,&#xD;
                         &quot;player&quot;, player.getId(),&#xD;
                         &quot;value&quot;, nation.getId()),&#xD;
                     player.getConnection());&#xD;
         } else {&#xD;
             return DOMMessage.createError(&quot;server.badNation&quot;,&#xD;
                 &quot;Selected non-selectable nation: &quot; + nation);&#xD;
         }&#xD;
     } else {&#xD;
         logger.warning(&quot;setNation from unknown connection.&quot;);&#xD;
     }&#xD;
     return null;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoXa4FJQEeiyW7NaN4qWdw" name="setNationType" specification="_QnGPgFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoXa4VJQEeiyW7NaN4qWdw" name="connection" type="_QhZQIlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoXa4lJQEeiyW7NaN4qWdw" name="element" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoXa41JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>ServerPlayer player = getFreeColServer().getPlayer(connection);&#xD;
     if (player != null) {&#xD;
         final Specification spec = getGame().getSpecification();&#xD;
         NationType nationType = spec.getNationType(element.getAttribute(&quot;value&quot;));&#xD;
         NationType fixedNationType = spec.getNation(player.getNationId())&#xD;
             .getType();&#xD;
         Advantages advantages = getGame().getNationOptions()&#xD;
             .getNationalAdvantages();&#xD;
         boolean ok;&#xD;
         switch (advantages) {&#xD;
         case SELECTABLE:&#xD;
             ok = true;&#xD;
             break;&#xD;
         case FIXED:&#xD;
             ok = nationType.equals(fixedNationType);&#xD;
             break;&#xD;
         case NONE:&#xD;
             ok = nationType == spec.getDefaultNationType();&#xD;
             break;&#xD;
         default:&#xD;
             ok = false;&#xD;
             break;&#xD;
         }&#xD;
         if (ok) {&#xD;
             player.changeNationType(nationType);&#xD;
             getFreeColServer().getServer()&#xD;
                 .sendToAll(DOMMessage.createMessage(&quot;updateNationType&quot;,&#xD;
                         &quot;player&quot;, player.getId(),&#xD;
                         &quot;value&quot;, nationType.getId()),&#xD;
                     player.getConnection());&#xD;
         } else {&#xD;
             return DOMMessage.createError(&quot;server.badNationType&quot;,&#xD;
                 &quot;Selected non-selectable nation type: &quot; + nationType);&#xD;
         }&#xD;
     } else {&#xD;
         logger.warning(&quot;setNationType from unknown connection.&quot;);&#xD;
     }&#xD;
     return null;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoYB4FJQEeiyW7NaN4qWdw" name="updateGameOptions" specification="_QnG2kFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoYB4VJQEeiyW7NaN4qWdw" name="connection" type="_QhZQIlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoYB4lJQEeiyW7NaN4qWdw" name="element" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoYB41JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>ServerPlayer player = getFreeColServer().getPlayer(connection);&#xD;
     if (!player.isAdmin()) {&#xD;
         throw new IllegalStateException(&quot;Not an admin&quot;);&#xD;
     }&#xD;
     final Specification spec = getGame().getSpecification();&#xD;
     OptionGroup gameOptions = spec.getGameOptions();&#xD;
     Element child = (Element)element.getChildNodes().item(0);&#xD;
     gameOptions.readFromXMLElement(child);&#xD;
     spec.clean(&quot;update game options (server)&quot;);&#xD;
&#xD;
     Element up = DOMMessage.createMessage(&quot;updateGameOptions&quot;);&#xD;
     up.appendChild(gameOptions.toXMLElement(up.getOwnerDocument()));&#xD;
     getFreeColServer().getServer().sendToAll(up, connection);&#xD;
     return null;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoYB5FJQEeiyW7NaN4qWdw" name="updateMapGeneratorOptions" specification="_QnHdoVJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoYB5VJQEeiyW7NaN4qWdw" name="connection" type="_QhZQIlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoYB5lJQEeiyW7NaN4qWdw" name="element" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoYB51JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>ServerPlayer player = getFreeColServer().getPlayer(connection);&#xD;
     if (!player.isAdmin()) {&#xD;
         throw new IllegalStateException(&quot;Not an admin&quot;);&#xD;
     }&#xD;
     final Specification spec = getGame().getSpecification();&#xD;
     OptionGroup mgo = spec.getMapGeneratorOptions();&#xD;
     Element child = (Element)element.getChildNodes().item(0);&#xD;
     mgo.readFromXMLElement(child);&#xD;
     Element umge = DOMMessage.createMessage(&quot;updateMapGeneratorOptions&quot;);&#xD;
     umge.appendChild(mgo.toXMLElement(umge.getOwnerDocument()));&#xD;
     getFreeColServer().getServer().sendToAll(umge, connection);&#xD;
     return null;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_QnAv8FJQEeiyW7NaN4qWdw" name="PreGameInputHandler" method="_QoWzwFJQEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_QnBXAFJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_QnBXAVJQEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedComment xmi:id="_Qohy7lJQEeiyW7NaN4qWdw">
                    <body>The constructor to use.&#xD;
     * &#xD;
     * @param freeColServer The main server object.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QnAv8VJQEeiyW7NaN4qWdw" name="freeColServer" type="_QhaeQVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QnBXAlJQEeiyW7NaN4qWdw" type="_P7jYIFJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QnBXA1JQEeiyW7NaN4qWdw" name="logout" visibility="protected" method="_QoWzw1JQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QnBXBFJQEeiyW7NaN4qWdw" name="connection" type="_QhZQIlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QnB-EFJQEeiyW7NaN4qWdw" name="element" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QnB-EVJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QnClIVJQEeiyW7NaN4qWdw" name="ready" visibility="private" method="_QoWzx1JQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_Qohy71JQEeiyW7NaN4qWdw">
                    <body>Handles a &quot;ready&quot;-message from a client.&#xD;
     * &#xD;
     * @param connection The &lt;code>Connection&lt;/code> the message came from.&#xD;
     * @param element The &lt;code>Element&lt;/code> containing the request.&#xD;
     * @return Null.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QnClIlJQEeiyW7NaN4qWdw" name="connection" type="_QhZQIlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QnClI1JQEeiyW7NaN4qWdw" name="element" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QnDMMFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QnDMMVJQEeiyW7NaN4qWdw" name="requestLaunch" visibility="private" method="_QoXa0FJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QnDMMlJQEeiyW7NaN4qWdw" name="connection" type="_QhZQIlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QnDMM1JQEeiyW7NaN4qWdw" name="element" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QnDzQFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QnEaUFJQEeiyW7NaN4qWdw" name="setAvailable" visibility="private" method="_QoXa1FJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_Qohy8VJQEeiyW7NaN4qWdw">
                    <body>Handles a &quot;setAvailable&quot;-message from a client.&#xD;
     * &#xD;
     * @param connection The &lt;code>Connection&lt;/code> the message came from.&#xD;
     * @param element The &lt;code>Element&lt;/code> containing the request.&#xD;
     * @return Null, or an error message on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QnEaUVJQEeiyW7NaN4qWdw" name="connection" type="_QhZQIlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QnEaUlJQEeiyW7NaN4qWdw" name="element" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QnEaU1JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QnFBYFJQEeiyW7NaN4qWdw" name="setColor" visibility="private" method="_QoXa2FJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_Qohy8lJQEeiyW7NaN4qWdw">
                    <body>Handles a &quot;setColor&quot;-message from a client.&#xD;
     * &#xD;
     * @param connection The &lt;code>Connection&lt;/code> the message came from.&#xD;
     * @param element The &lt;code>Element&lt;/code> containing the request.&#xD;
     * @return Null, or an error message on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QnFBYVJQEeiyW7NaN4qWdw" name="connection" type="_QhZQIlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QnFBYlJQEeiyW7NaN4qWdw" name="element" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QnFBY1JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QnFocFJQEeiyW7NaN4qWdw" name="setNation" visibility="private" method="_QoXa3FJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QoiZ8FJQEeiyW7NaN4qWdw">
                    <body>Handles a &quot;setNation&quot;-message from a client.&#xD;
     * &#xD;
     * @param connection The &lt;code>Connection&lt;/code> the message came from.&#xD;
     * @param element The &lt;code>Element&lt;/code> containing the request.&#xD;
     * @return Null.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QnFocVJQEeiyW7NaN4qWdw" name="connection" type="_QhZQIlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QnFoclJQEeiyW7NaN4qWdw" name="element" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QnFoc1JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QnGPgFJQEeiyW7NaN4qWdw" name="setNationType" visibility="private" method="_QoXa4FJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QoiZ8VJQEeiyW7NaN4qWdw">
                    <body>Handles a &quot;setNationType&quot;-message from a client.&#xD;
     * &#xD;
     * @param connection The &lt;code>Connection&lt;/code> the message came from.&#xD;
     * @param element The &lt;code>Element&lt;/code> containing the request.&#xD;
     * @return Null, or an error message on failure.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QnGPgVJQEeiyW7NaN4qWdw" name="connection" type="_QhZQIlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QnGPglJQEeiyW7NaN4qWdw" name="element" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QnGPg1JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QnG2kFJQEeiyW7NaN4qWdw" name="updateGameOptions" visibility="private" method="_QoYB4FJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QoiZ8lJQEeiyW7NaN4qWdw">
                    <body>Handles a &quot;updateGameOptions&quot;-message from a client.&#xD;
     * &#xD;
     * @param connection The &lt;code>Connection&lt;/code> the message came from.&#xD;
     * @param element The &lt;code>Element&lt;/code> containing the request.&#xD;
     * @return Null.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QnG2kVJQEeiyW7NaN4qWdw" name="connection" type="_QhZQIlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QnG2klJQEeiyW7NaN4qWdw" name="element" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QnHdoFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QnHdoVJQEeiyW7NaN4qWdw" name="updateMapGeneratorOptions" visibility="private" method="_QoYB5FJQEeiyW7NaN4qWdw">
                  <ownedComment xmi:id="_QoiZ81JQEeiyW7NaN4qWdw">
                    <body>Handles a &quot;updateMapGeneratorOptions&quot;-message from a client.&#xD;
     * &#xD;
     * @param connection The &lt;code>Connection&lt;/code> the message came from.&#xD;
     * @param element The &lt;code>Element&lt;/code> containing the request.&#xD;
     * @return Null.</body>
                  </ownedComment>
                  <ownedParameter xmi:id="_QnHdolJQEeiyW7NaN4qWdw" name="connection" type="_QhZQIlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QnIEsFJQEeiyW7NaN4qWdw" name="element" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QnIrwFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_P7oQoFJQEeiyW7NaN4qWdw" name="UserConnectionHandler" isLeaf="true">
                <ownedComment xmi:id="_QoiZ9FJQEeiyW7NaN4qWdw">
                  <body>Handles a new client connection.  {@link PreGameInputHandler} is&#xD;
set as the message handler when the client has successfully logged&#xD;
on.</body>
                </ownedComment>
                <generalization xmi:id="_QkOhsFJQEeiyW7NaN4qWdw" general="_P49XIFJQEeiyW7NaN4qWdw"/>
                <ownedAttribute xmi:id="_Qn12YVJQEeiyW7NaN4qWdw" name="logger" visibility="private" isLeaf="true" isStatic="true" type="_QhXa8VJQEeiyW7NaN4qWdw" isReadOnly="true" association="_Qo9QsVJQEeiyW7NaN4qWdw">
                  <defaultValue xmi:type="uml:LiteralString" xmi:id="_Qn2dcFJQEeiyW7NaN4qWdw" value="Logger.getLogger(UserConnectionHandler.class.getName())"/>
                </ownedAttribute>
                <interfaceRealization xmi:id="_QnJS0FJQEeiyW7NaN4qWdw" client="_P7oQoFJQEeiyW7NaN4qWdw" supplier="_Qhgk41JQEeiyW7NaN4qWdw" contract="_Qhgk41JQEeiyW7NaN4qWdw"/>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoYB6FJQEeiyW7NaN4qWdw" name="UserConnectionHandler" specification="_QnJS0VJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoYB6VJQEeiyW7NaN4qWdw" name="freeColServer" type="_QhaeQVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoYB6lJQEeiyW7NaN4qWdw" type="_P7oQoFJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>super(freeColServer);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoYB61JQEeiyW7NaN4qWdw" name="handle" specification="_QnJ541JQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoYB7FJQEeiyW7NaN4qWdw" name="conn" type="_QhZQIlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoYB7VJQEeiyW7NaN4qWdw" name="element" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoYB7lJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final String tag = element.getTagName();&#xD;
     return (&quot;disconnect&quot;.equals(tag)) &#xD;
         ? disconnect(conn, element)&#xD;
         : (&quot;gameState&quot;.equals(tag))&#xD;
         ? gameState(conn, element)&#xD;
         : (&quot;getVacantPlayers&quot;.equals(tag))&#xD;
         ? getVacantPlayers(conn, element)&#xD;
         : (&quot;login&quot;.equals(tag))&#xD;
         ? login(conn, element)&#xD;
         : unknown(tag);&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoYB71JQEeiyW7NaN4qWdw" name="disconnect" specification="_QnLIAFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoYB8FJQEeiyW7NaN4qWdw" name="connection" type="_QhZQIlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoYB8VJQEeiyW7NaN4qWdw" name="element" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoYB8lJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>connection.reallyClose();&#xD;
     return null;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoYB81JQEeiyW7NaN4qWdw" name="gameState" specification="_QnM9MFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoYB9FJQEeiyW7NaN4qWdw" name="connection" type="_QhZQIlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoYB9VJQEeiyW7NaN4qWdw" name="element" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoYB9lJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final FreeColServer freeColServer = getFreeColServer();&#xD;
&#xD;
     Element reply = DOMMessage.createMessage(&quot;gameState&quot;);&#xD;
     reply.setAttribute(&quot;state&quot;,&#xD;
                        freeColServer.getGameState().toString());&#xD;
     return reply;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoYo8FJQEeiyW7NaN4qWdw" name="getVacantPlayers" specification="_QnOLUFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoYo8VJQEeiyW7NaN4qWdw" name="connection" type="_QhZQIlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoYo8lJQEeiyW7NaN4qWdw" name="element" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoYo81JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final FreeColServer freeColServer = getFreeColServer();&#xD;
     final Game game = getGame();&#xD;
&#xD;
     Element reply = DOMMessage.createMessage(&quot;vacantPlayers&quot;);&#xD;
     Document doc = reply.getOwnerDocument();&#xD;
     for (Player p : game.getLiveEuropeanPlayers(null)) {&#xD;
         if (!p.isREF()&#xD;
             &amp;&amp; (p.isAI() || !((ServerPlayer)p).isConnected())) {&#xD;
             Element playerElement = doc.createElement(&quot;player&quot;);&#xD;
             playerElement.setAttribute(&quot;username&quot;, p.getNationId());&#xD;
             reply.appendChild(playerElement);&#xD;
         }&#xD;
     }&#xD;
     return reply;&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoYo9FJQEeiyW7NaN4qWdw" name="login" specification="_QnPZc1JQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoYo9VJQEeiyW7NaN4qWdw" name="connection" type="_QhZQIlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoYo9lJQEeiyW7NaN4qWdw" name="element" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QoYo91JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>final String userName = element.getAttribute(&quot;userName&quot;);&#xD;
     final String version = element.getAttribute(&quot;version&quot;);&#xD;
&#xD;
     if (userName == null || userName.isEmpty()) {&#xD;
         return DOMMessage.createError(&quot;server.missingUserName&quot;, null);&#xD;
     } else if (version == null || version.isEmpty()) {&#xD;
         return DOMMessage.createError(&quot;server.missingVersion&quot;, null);&#xD;
     } else if (!version.equals(FreeCol.getVersion())) {&#xD;
         return DOMMessage.createError(&quot;server.wrongFreeColVersion&quot;,&#xD;
             version + &quot; != &quot; + FreeCol.getVersion());&#xD;
     }&#xD;
&#xD;
     final FreeColServer freeColServer = getFreeColServer();&#xD;
     final Server server = freeColServer.getServer();&#xD;
     Game game;&#xD;
     ServerPlayer player;&#xD;
     Unit active = null;&#xD;
     boolean isCurrentPlayer = false;&#xD;
     MessageHandler mh;&#xD;
     boolean starting = freeColServer.getGameState()&#xD;
         == FreeColServer.GameState.STARTING_GAME;&#xD;
     if (starting) {&#xD;
         // Wait until the game has been created.&#xD;
         // FIXME: is this still needed?&#xD;
         int timeOut = 20000;&#xD;
         while (freeColServer.getGame() == null) {&#xD;
             try {&#xD;
                 Thread.sleep(1000);&#xD;
             } catch (InterruptedException e) {}&#xD;
             if ((timeOut -= 1000) &lt;= 0) {&#xD;
                 return DOMMessage.createError(&quot;server.timeOut&quot;, null);&#xD;
             }&#xD;
         }&#xD;
&#xD;
         game = freeColServer.getGame();&#xD;
         if (!game.canAddNewPlayer()) {&#xD;
             return DOMMessage.createError(&quot;server.maximumPlayers&quot;, null);&#xD;
         } else if (game.playerNameInUse(userName)) {&#xD;
             return DOMMessage.createError(&quot;server.userNameInUse&quot;,&#xD;
                 userName + &quot; is already in use.&quot;);&#xD;
         }&#xD;
&#xD;
         // Create and add the new player:&#xD;
         boolean admin = game.getLivePlayers(null).isEmpty();&#xD;
         player = new ServerPlayer(game, admin, game.getVacantNation(),&#xD;
                                   connection.getSocket(), connection);&#xD;
         player.setName(userName);&#xD;
         game.addPlayer(player);&#xD;
&#xD;
         // Send message to all players except to the new player.&#xD;
         // FIXME: check visibility.&#xD;
         Element add = DOMMessage.createMessage(&quot;addPlayer&quot;);&#xD;
         add.appendChild(player.toXMLElement(add.getOwnerDocument()));&#xD;
         server.sendToAll(add, connection);&#xD;
&#xD;
         // Ready now to handle pre-game messages.&#xD;
         mh = freeColServer.getPreGameInputHandler();&#xD;
&#xD;
     } else { // Restoring from existing game.&#xD;
         game = freeColServer.getGame();&#xD;
         player = (ServerPlayer)game.getPlayerByName(userName);&#xD;
         if (player == null) {&#xD;
             StringBuilder sb = new StringBuilder(&quot;Player \&quot;&quot;);&#xD;
             sb.append(userName).append(&quot;\&quot; is not present in the game.&quot;)&#xD;
                 .append(&quot;\n  Known players = ( &quot;);&#xD;
             for (Player p : game.getLiveEuropeanPlayers(null)) {&#xD;
                 sb.append(p.getName()).append(&quot; &quot;);&#xD;
             }&#xD;
             sb.append(&quot;)&quot;);&#xD;
             return DOMMessage.createError(&quot;server.userNameNotPresent&quot;,&#xD;
                                           sb.toString());&#xD;
         } else if (player.isConnected() &amp;&amp; !player.isAI()) {&#xD;
             return DOMMessage.createError(&quot;server.userNameInUse&quot;,&#xD;
                 userName + &quot; is already in use.&quot;);&#xD;
         }&#xD;
         player.setConnection(connection);&#xD;
         player.setConnected(true);&#xD;
&#xD;
         if (player.isAI()) {&#xD;
             player.setAI(false);&#xD;
             server.sendToAll(DOMMessage.createMessage(&quot;setAI&quot;,&#xD;
                     &quot;player&quot;, player.getId(),&#xD;
                     &quot;ai&quot;, Boolean.toString(false)));&#xD;
         }&#xD;
&#xD;
         // If this player is the first to reconnect, it is the&#xD;
         // current player.&#xD;
         isCurrentPlayer = game.getCurrentPlayer() == null;&#xD;
         if (isCurrentPlayer) {&#xD;
             game.setCurrentPlayer(player);&#xD;
             active = freeColServer.getActiveUnit();&#xD;
         }&#xD;
&#xD;
         // Go straight into the game.&#xD;
         mh = freeColServer.getInGameInputHandler();&#xD;
     }&#xD;
&#xD;
     connection.setMessageHandler(mh);&#xD;
     server.addConnection(connection);&#xD;
     freeColServer.updateMetaServer();&#xD;
     return new LoginMessage(player, userName, version, !starting,&#xD;
                             freeColServer.getSinglePlayer(),&#xD;
                             isCurrentPlayer, active,&#xD;
                             game).toXMLElement();&#xD;
 </body>
                </ownedBehavior>
                <ownedBehavior xmi:type="uml:OpaqueBehavior" xmi:id="_QoYo-FJQEeiyW7NaN4qWdw" name="unknown" specification="_P7pewFJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QoYo-VJQEeiyW7NaN4qWdw" name="tag">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QoYo-lJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                  <language>java</language>
                  <body>logger.warning(&quot;Unknown user connection request: &quot; + tag);&#xD;
     return null;&#xD;
 </body>
                </ownedBehavior>
                <ownedOperation xmi:id="_P7pewFJQEeiyW7NaN4qWdw" name="unknown" visibility="private" method="_QoYo-FJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_P7pewVJQEeiyW7NaN4qWdw" name="tag">
                    <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/UMLPrimitiveTypes.library.uml#String"/>
                  </ownedParameter>
                  <ownedParameter xmi:id="_QnQAg1JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QnJS0VJQEeiyW7NaN4qWdw" name="UserConnectionHandler" method="_QoYB6FJQEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_QnJ54FJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_QnJ54VJQEeiyW7NaN4qWdw" key="create"/>
                  </eAnnotations>
                  <ownedParameter xmi:id="_QnJS0lJQEeiyW7NaN4qWdw" name="freeColServer" type="_QhaeQVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QnJ54lJQEeiyW7NaN4qWdw" type="_P7oQoFJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QnJ541JQEeiyW7NaN4qWdw" name="handle" method="_QoYB61JQEeiyW7NaN4qWdw">
                  <eAnnotations xmi:id="_QnJ55lJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
                    <details xmi:id="_QnJ551JQEeiyW7NaN4qWdw" key="synchronized"/>
                  </eAnnotations>
                  <ownedParameter xmi:id="_QnJ55FJQEeiyW7NaN4qWdw" name="conn" type="_QhZQIlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QnJ55VJQEeiyW7NaN4qWdw" name="element" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QnJ56FJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QnLIAFJQEeiyW7NaN4qWdw" name="disconnect" visibility="private" method="_QoYB71JQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QnLIAVJQEeiyW7NaN4qWdw" name="connection" type="_QhZQIlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QnLIAlJQEeiyW7NaN4qWdw" name="element" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QnLvEFJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QnM9MFJQEeiyW7NaN4qWdw" name="gameState" visibility="private" method="_QoYB81JQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QnM9MVJQEeiyW7NaN4qWdw" name="connection" type="_QhZQIlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QnM9MlJQEeiyW7NaN4qWdw" name="element" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QnM9M1JQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QnOLUFJQEeiyW7NaN4qWdw" name="getVacantPlayers" visibility="private" method="_QoYo8FJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QnOLUVJQEeiyW7NaN4qWdw" name="connection" type="_QhZQIlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QnOyYFJQEeiyW7NaN4qWdw" name="element" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QnOyYVJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
                <ownedOperation xmi:id="_QnPZc1JQEeiyW7NaN4qWdw" name="login" visibility="private" method="_QoYo9FJQEeiyW7NaN4qWdw">
                  <ownedParameter xmi:id="_QnQAgFJQEeiyW7NaN4qWdw" name="connection" type="_QhZQIlJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QnQAgVJQEeiyW7NaN4qWdw" name="element" type="_QhbFUVJQEeiyW7NaN4qWdw"/>
                  <ownedParameter xmi:id="_QnQAglJQEeiyW7NaN4qWdw" type="_QhbFUVJQEeiyW7NaN4qWdw" direction="return"/>
                </ownedOperation>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_QovOQFJQEeiyW7NaN4qWdw" name="" memberEnd="_QovOQVJQEeiyW7NaN4qWdw _QnVgEFJQEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_QovOQVJQEeiyW7NaN4qWdw" name="" type="_P45swFJQEeiyW7NaN4qWdw" association="_QovOQFJQEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_Qov1UVJQEeiyW7NaN4qWdw" name="" memberEnd="_Qov1UlJQEeiyW7NaN4qWdw _QnVgElJQEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_Qov1UlJQEeiyW7NaN4qWdw" name="" type="_P48JAFJQEeiyW7NaN4qWdw" association="_Qov1UVJQEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_QowcYVJQEeiyW7NaN4qWdw" name="" memberEnd="_QowcYlJQEeiyW7NaN4qWdw _QnWHIFJQEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_QowcYlJQEeiyW7NaN4qWdw" name="" type="_P49XIFJQEeiyW7NaN4qWdw" association="_QowcYVJQEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_QoxDcVJQEeiyW7NaN4qWdw" name="" memberEnd="_QoxDclJQEeiyW7NaN4qWdw _QnWHIlJQEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_QoxDclJQEeiyW7NaN4qWdw" name="" type="_P4_MUFJQEeiyW7NaN4qWdw" association="_QoxDcVJQEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_QoxqgFJQEeiyW7NaN4qWdw" name="" memberEnd="_QoxqgVJQEeiyW7NaN4qWdw _QnWuMFJQEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_QoxqgVJQEeiyW7NaN4qWdw" name="" type="_P4_MUFJQEeiyW7NaN4qWdw" association="_QoxqgFJQEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_Qoxqg1JQEeiyW7NaN4qWdw" name="" memberEnd="_QoxqhFJQEeiyW7NaN4qWdw _QnXVQFJQEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_QoxqhFJQEeiyW7NaN4qWdw" name="" type="_P5FS8FJQEeiyW7NaN4qWdw" association="_Qoxqg1JQEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_QoxqhlJQEeiyW7NaN4qWdw" name="" memberEnd="_Qoxqh1JQEeiyW7NaN4qWdw _QnXVQlJQEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_Qoxqh1JQEeiyW7NaN4qWdw" name="" type="_P5I9UFJQEeiyW7NaN4qWdw" association="_QoxqhlJQEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_QoyRkVJQEeiyW7NaN4qWdw" name="" memberEnd="_QoyRklJQEeiyW7NaN4qWdw _QnX8UVJQEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_QoyRklJQEeiyW7NaN4qWdw" name="" type="_P5I9UFJQEeiyW7NaN4qWdw" association="_QoyRkVJQEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_Qoy4oVJQEeiyW7NaN4qWdw" name="" memberEnd="_Qoy4olJQEeiyW7NaN4qWdw _QnZKclJQEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_Qoy4olJQEeiyW7NaN4qWdw" name="" type="_P5I9UFJQEeiyW7NaN4qWdw" association="_Qoy4oVJQEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_QozfsFJQEeiyW7NaN4qWdw" name="" memberEnd="_QozfsVJQEeiyW7NaN4qWdw _QnZKdVJQEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_QozfsVJQEeiyW7NaN4qWdw" name="" type="_P5Oc4FJQEeiyW7NaN4qWdw" association="_QozfsFJQEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_Qozfs1JQEeiyW7NaN4qWdw" name="" memberEnd="_QozftFJQEeiyW7NaN4qWdw _QnZxgVJQEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_QozftFJQEeiyW7NaN4qWdw" name="" type="_P5Oc4FJQEeiyW7NaN4qWdw" association="_Qozfs1JQEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_Qo0GwFJQEeiyW7NaN4qWdw" name="" memberEnd="_Qo0GwVJQEeiyW7NaN4qWdw _QnZxg1JQEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_Qo0GwVJQEeiyW7NaN4qWdw" name="" type="_P5Oc4FJQEeiyW7NaN4qWdw" association="_Qo0GwFJQEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_Qo0Gw1JQEeiyW7NaN4qWdw" name="" memberEnd="_Qo0GxFJQEeiyW7NaN4qWdw _QnaYkVJQEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_Qo0GxFJQEeiyW7NaN4qWdw" name="" type="_P5Oc4FJQEeiyW7NaN4qWdw" association="_Qo0Gw1JQEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_Qo0t0VJQEeiyW7NaN4qWdw" name="" memberEnd="_Qo0t0lJQEeiyW7NaN4qWdw _Qna_oVJQEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_Qo0t0lJQEeiyW7NaN4qWdw" name="" type="_P5I9UFJQEeiyW7NaN4qWdw" association="_Qo0t0VJQEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_Qo0t1FJQEeiyW7NaN4qWdw" name="" memberEnd="_Qo0t1VJQEeiyW7NaN4qWdw _QneC8FJQEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_Qo0t1VJQEeiyW7NaN4qWdw" name="" type="_P6C8QFJQEeiyW7NaN4qWdw" association="_Qo0t1FJQEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_Qo1U4VJQEeiyW7NaN4qWdw" name="" memberEnd="_Qo1U4lJQEeiyW7NaN4qWdw _Qnf4IFJQEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_Qo1U4lJQEeiyW7NaN4qWdw" name="" type="_P6C8QFJQEeiyW7NaN4qWdw" association="_Qo1U4VJQEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_Qo1U5FJQEeiyW7NaN4qWdw" name="" memberEnd="_Qo1U5VJQEeiyW7NaN4qWdw _QnhGQlJQEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_Qo1U5VJQEeiyW7NaN4qWdw" name="" type="_P6HNsFJQEeiyW7NaN4qWdw" association="_Qo1U5FJQEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_Qo178VJQEeiyW7NaN4qWdw" name="" memberEnd="_Qo178lJQEeiyW7NaN4qWdw _QnhGRFJQEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_Qo178lJQEeiyW7NaN4qWdw" name="" type="_P6HNsFJQEeiyW7NaN4qWdw" association="_Qo178VJQEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_Qo2jAFJQEeiyW7NaN4qWdw" name="" memberEnd="_Qo2jAVJQEeiyW7NaN4qWdw _QnhtUVJQEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_Qo2jAVJQEeiyW7NaN4qWdw" name="" type="_P6HNsFJQEeiyW7NaN4qWdw" association="_Qo2jAFJQEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_Qo2jA1JQEeiyW7NaN4qWdw" name="" memberEnd="_Qo2jBFJQEeiyW7NaN4qWdw _Qni7cFJQEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_Qo2jBFJQEeiyW7NaN4qWdw" name="" type="_P6LfIFJQEeiyW7NaN4qWdw" association="_Qo2jA1JQEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_Qo2jBlJQEeiyW7NaN4qWdw" name="" memberEnd="_Qo2jB1JQEeiyW7NaN4qWdw _QnkJkVJQEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_Qo2jB1JQEeiyW7NaN4qWdw" name="" type="_P6PwkFJQEeiyW7NaN4qWdw" association="_Qo2jBlJQEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_Qo3KEVJQEeiyW7NaN4qWdw" name="" memberEnd="_Qo3KElJQEeiyW7NaN4qWdw _QnkwoFJQEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_Qo3KElJQEeiyW7NaN4qWdw" name="" type="_P6PwkFJQEeiyW7NaN4qWdw" association="_Qo3KEVJQEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_Qo3KFFJQEeiyW7NaN4qWdw" name="" memberEnd="_Qo3KFVJQEeiyW7NaN4qWdw _Qnml0VJQEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_Qo3KFVJQEeiyW7NaN4qWdw" name="" type="_P6b90FJQEeiyW7NaN4qWdw" association="_Qo3KFFJQEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_Qo3xIVJQEeiyW7NaN4qWdw" name="" memberEnd="_Qo3xIlJQEeiyW7NaN4qWdw _QnnM4VJQEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_Qo3xIlJQEeiyW7NaN4qWdw" name="" type="_P6foMFJQEeiyW7NaN4qWdw" association="_Qo3xIVJQEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_Qo3xJFJQEeiyW7NaN4qWdw" name="" memberEnd="_Qo3xJVJQEeiyW7NaN4qWdw _Qnnz8FJQEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_Qo3xJVJQEeiyW7NaN4qWdw" name="" type="_P6foMFJQEeiyW7NaN4qWdw" association="_Qo3xJFJQEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_Qo4YMVJQEeiyW7NaN4qWdw" name="" memberEnd="_Qo4YMlJQEeiyW7NaN4qWdw _QnobAFJQEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_Qo4YMlJQEeiyW7NaN4qWdw" name="" type="_P6foMFJQEeiyW7NaN4qWdw" association="_Qo4YMVJQEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_Qo4YNFJQEeiyW7NaN4qWdw" name="" memberEnd="_Qo4YNVJQEeiyW7NaN4qWdw _QnpCEFJQEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_Qo4YNVJQEeiyW7NaN4qWdw" name="" type="_P6j5oFJQEeiyW7NaN4qWdw" association="_Qo4YNFJQEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_Qo4_QVJQEeiyW7NaN4qWdw" name="" memberEnd="_Qo4_QlJQEeiyW7NaN4qWdw _QnqQMVJQEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_Qo4_QlJQEeiyW7NaN4qWdw" name="" type="_P6pZMFJQEeiyW7NaN4qWdw" association="_Qo4_QVJQEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_Qo5mUVJQEeiyW7NaN4qWdw" name="" memberEnd="_Qo5mUlJQEeiyW7NaN4qWdw _Qnq3QFJQEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_Qo5mUlJQEeiyW7NaN4qWdw" name="" type="_P6scgFJQEeiyW7NaN4qWdw" association="_Qo5mUVJQEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_Qo5mVFJQEeiyW7NaN4qWdw" name="" memberEnd="_Qo5mVVJQEeiyW7NaN4qWdw _QnreUFJQEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_Qo5mVVJQEeiyW7NaN4qWdw" name="" type="_P6scgFJQEeiyW7NaN4qWdw" association="_Qo5mVFJQEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_Qo6NYVJQEeiyW7NaN4qWdw" name="" memberEnd="_Qo6NYlJQEeiyW7NaN4qWdw _QnreUlJQEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_Qo6NYlJQEeiyW7NaN4qWdw" name="" type="_P6scgFJQEeiyW7NaN4qWdw" association="_Qo6NYVJQEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_Qo60cVJQEeiyW7NaN4qWdw" name="" memberEnd="_Qo60clJQEeiyW7NaN4qWdw _QnsscVJQEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_Qo60clJQEeiyW7NaN4qWdw" name="" type="_P6wG4FJQEeiyW7NaN4qWdw" association="_Qo60cVJQEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_Qo60dFJQEeiyW7NaN4qWdw" name="" memberEnd="_Qo60dVJQEeiyW7NaN4qWdw _QntTgFJQEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_Qo60dVJQEeiyW7NaN4qWdw" name="" type="_P6yjIFJQEeiyW7NaN4qWdw" association="_Qo60dFJQEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_Qo7bgVJQEeiyW7NaN4qWdw" name="" memberEnd="_Qo7bglJQEeiyW7NaN4qWdw _QntTglJQEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_Qo7bglJQEeiyW7NaN4qWdw" name="" type="_P6yjIFJQEeiyW7NaN4qWdw" association="_Qo7bgVJQEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_Qo7bhFJQEeiyW7NaN4qWdw" name="" memberEnd="_Qo7bhVJQEeiyW7NaN4qWdw _QnvIsFJQEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_Qo7bhVJQEeiyW7NaN4qWdw" name="" type="_P61mcFJQEeiyW7NaN4qWdw" association="_Qo7bhFJQEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_Qo8CkVJQEeiyW7NaN4qWdw" name="" memberEnd="_Qo8CklJQEeiyW7NaN4qWdw _QnvvwFJQEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_Qo8CklJQEeiyW7NaN4qWdw" name="" type="_P64CsFJQEeiyW7NaN4qWdw" association="_Qo8CkVJQEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_Qo8poVJQEeiyW7NaN4qWdw" name="" memberEnd="_Qo8polJQEeiyW7NaN4qWdw _QnvvxFJQEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_Qo8polJQEeiyW7NaN4qWdw" name="" type="_P64CsFJQEeiyW7NaN4qWdw" association="_Qo8poVJQEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_Qo8ppFJQEeiyW7NaN4qWdw" name="" memberEnd="_Qo8ppVJQEeiyW7NaN4qWdw _Qn1PUFJQEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_Qo8ppVJQEeiyW7NaN4qWdw" name="" type="_P7jYIFJQEeiyW7NaN4qWdw" association="_Qo8ppFJQEeiyW7NaN4qWdw"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Association" xmi:id="_Qo9QsVJQEeiyW7NaN4qWdw" name="" memberEnd="_Qo9QslJQEeiyW7NaN4qWdw _Qn12YVJQEeiyW7NaN4qWdw">
                <ownedEnd xmi:id="_Qo9QslJQEeiyW7NaN4qWdw" name="" type="_P7oQoFJQEeiyW7NaN4qWdw" association="_Qo9QsVJQEeiyW7NaN4qWdw"/>
              </packagedElement>
            </packagedElement>
            <packagedElement xmi:type="uml:Package" xmi:id="_P1zVcFJQEeiyW7NaN4qWdw" name="networking">
              <packagedElement xmi:type="uml:Class" xmi:id="_QhcTcFJQEeiyW7NaN4qWdw" name="Server"/>
            </packagedElement>
            <packagedElement xmi:type="uml:Package" xmi:id="_P2OMMVJQEeiyW7NaN4qWdw" name="ai">
              <packagedElement xmi:type="uml:Class" xmi:id="_Qi5E8VJQEeiyW7NaN4qWdw" name="AIPlayer"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qi5E81JQEeiyW7NaN4qWdw" name="REFAIPlayer"/>
            </packagedElement>
            <packagedElement xmi:type="uml:Class" xmi:id="_QhaeQVJQEeiyW7NaN4qWdw" name="FreeColServer"/>
          </packagedElement>
          <packagedElement xmi:type="uml:Package" xmi:id="_P1vEA1JQEeiyW7NaN4qWdw" name="common">
            <packagedElement xmi:type="uml:Package" xmi:id="_P1vrEFJQEeiyW7NaN4qWdw" name="model">
              <packagedElement xmi:type="uml:Package" xmi:id="_P2J6wFJQEeiyW7NaN4qWdw" name="CombatModel">
                <packagedElement xmi:type="uml:Enumeration" xmi:id="_QiZ8wVJQEeiyW7NaN4qWdw" name="CombatResult"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Package" xmi:id="_P2J6wVJQEeiyW7NaN4qWdw" name="DiplomaticTrade">
                <packagedElement xmi:type="uml:Enumeration" xmi:id="_Qiaj0lJQEeiyW7NaN4qWdw" name="TradeStatus"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Package" xmi:id="_P2Kh0FJQEeiyW7NaN4qWdw" name="Europe">
                <packagedElement xmi:type="uml:Enumeration" xmi:id="_QicZAVJQEeiyW7NaN4qWdw" name="MigrationType"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Package" xmi:id="_P2LI4FJQEeiyW7NaN4qWdw" name="Market">
                <packagedElement xmi:type="uml:Enumeration" xmi:id="_QimKAVJQEeiyW7NaN4qWdw" name="Access"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Package" xmi:id="_P2Lv8FJQEeiyW7NaN4qWdw" name="Monarch">
                <packagedElement xmi:type="uml:Enumeration" xmi:id="_QiomQFJQEeiyW7NaN4qWdw" name="MonarchAction"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Package" xmi:id="_P2Lv8VJQEeiyW7NaN4qWdw" name="Player">
                <packagedElement xmi:type="uml:Enumeration" xmi:id="_QirpkFJQEeiyW7NaN4qWdw" name="PlayerType"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Package" xmi:id="_P2M-EFJQEeiyW7NaN4qWdw" name="Unit">
                <packagedElement xmi:type="uml:Enumeration" xmi:id="_QizlY1JQEeiyW7NaN4qWdw" name="UnitState"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Package" xmi:id="_P2M-EVJQEeiyW7NaN4qWdw" name="UnitTypeChange">
                <packagedElement xmi:type="uml:Enumeration" xmi:id="_Qi1akVJQEeiyW7NaN4qWdw" name="ChangeType"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Package" xmi:id="_P34ZEVJQEeiyW7NaN4qWdw" name="NationOptions">
                <packagedElement xmi:type="uml:Enumeration" xmi:id="_QkIbEVJQEeiyW7NaN4qWdw" name="Advantages"/>
                <packagedElement xmi:type="uml:Enumeration" xmi:id="_QkJCIVJQEeiyW7NaN4qWdw" name="NationState"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_QhYpEVJQEeiyW7NaN4qWdw" name="Game"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QhZQIFJQEeiyW7NaN4qWdw" name="Player"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QiW5cVJQEeiyW7NaN4qWdw" name="Ability"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QiXggVJQEeiyW7NaN4qWdw" name="AbstractGoods"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QiYHkVJQEeiyW7NaN4qWdw" name="AbstractUnit"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QiYHk1JQEeiyW7NaN4qWdw" name="BuildableType"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QiYuoVJQEeiyW7NaN4qWdw" name="Colony"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QiZVsVJQEeiyW7NaN4qWdw" name="ColonyTile"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qiaj0FJQEeiyW7NaN4qWdw" name="DiplomaticTrade"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QibK4VJQEeiyW7NaN4qWdw" name="Disaster"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qibx8VJQEeiyW7NaN4qWdw" name="Europe"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QidAEVJQEeiyW7NaN4qWdw" name="ExportData"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QidnIFJQEeiyW7NaN4qWdw" name="FoundingFather"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QidnIlJQEeiyW7NaN4qWdw" name="FreeColGameObject"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QieOMVJQEeiyW7NaN4qWdw" name="GameOptions"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qie1QVJQEeiyW7NaN4qWdw" name="Goods"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QifcUFJQEeiyW7NaN4qWdw" name="GoodsContainer"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QifcUlJQEeiyW7NaN4qWdw" name="GoodsLocation"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QigDYVJQEeiyW7NaN4qWdw" name="GoodsType"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QigqcVJQEeiyW7NaN4qWdw" name="HighScore"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qigqc1JQEeiyW7NaN4qWdw" name="HighSeas"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QihRgVJQEeiyW7NaN4qWdw" name="HistoryEvent"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qih4kVJQEeiyW7NaN4qWdw" name="IndianNationType"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QiifoFJQEeiyW7NaN4qWdw" name="IndianSettlement"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QikU0FJQEeiyW7NaN4qWdw" name="Location"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qik74VJQEeiyW7NaN4qWdw" name="Map"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qili8FJQEeiyW7NaN4qWdw" name="Market"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QinYIFJQEeiyW7NaN4qWdw" name="ModelMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qin_MFJQEeiyW7NaN4qWdw" name="Monarch"/>
              <packagedElement xmi:type="uml:Interface" xmi:id="_QipNUFJQEeiyW7NaN4qWdw" name="Nameable"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qip0YFJQEeiyW7NaN4qWdw" name="Nation"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QiqbcFJQEeiyW7NaN4qWdw" name="NationSummary"/>
              <packagedElement xmi:type="uml:Interface" xmi:id="_QirCgFJQEeiyW7NaN4qWdw" name="Ownable"/>
              <packagedElement xmi:type="uml:Enumeration" xmi:id="_QisQoFJQEeiyW7NaN4qWdw" name="Stance"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QisQolJQEeiyW7NaN4qWdw" name="RandomRange"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qis3sVJQEeiyW7NaN4qWdw" name="Region"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QitewVJQEeiyW7NaN4qWdw" name="Settlement"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QiuF0VJQEeiyW7NaN4qWdw" name="Specification"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qius4FJQEeiyW7NaN4qWdw" name="StringTemplate"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qius4lJQEeiyW7NaN4qWdw" name="Tension"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QivT8VJQEeiyW7NaN4qWdw" name="Tile"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qiv7AVJQEeiyW7NaN4qWdw" name="TileImprovement"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QiwiEVJQEeiyW7NaN4qWdw" name="TileImprovementType"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QixJIVJQEeiyW7NaN4qWdw" name="TradeItem"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QixwMVJQEeiyW7NaN4qWdw" name="TradeRoute"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QiyXQVJQEeiyW7NaN4qWdw" name="TradeRouteStop"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qiy-UFJQEeiyW7NaN4qWdw" name="Turn"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qiy-UlJQEeiyW7NaN4qWdw" name="Unit"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QizlYVJQEeiyW7NaN4qWdw" name="Role"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qi0McVJQEeiyW7NaN4qWdw" name="UnitLocation"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qi0zgVJQEeiyW7NaN4qWdw" name="UnitType"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qi2BoFJQEeiyW7NaN4qWdw" name="WorkLocation"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QjeTwVJQEeiyW7NaN4qWdw" name="Feature"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qje60FJQEeiyW7NaN4qWdw" name="FreeColObject"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qje60lJQEeiyW7NaN4qWdw" name="LastSale"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qjfh4VJQEeiyW7NaN4qWdw" name="Modifier"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QkJpMVJQEeiyW7NaN4qWdw" name="NationType"/>
            </packagedElement>
            <packagedElement xmi:type="uml:Package" xmi:id="_P1vrEVJQEeiyW7NaN4qWdw" name="networking">
              <packagedElement xmi:type="uml:Package" xmi:id="_P2NlIFJQEeiyW7NaN4qWdw" name="RearrangeColonyMessage">
                <packagedElement xmi:type="uml:Class" xmi:id="_Qi2osFJQEeiyW7NaN4qWdw" name="UnitChange"/>
              </packagedElement>
              <packagedElement xmi:type="uml:Class" xmi:id="_QhZQIlJQEeiyW7NaN4qWdw" name="Connection"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QhZ3MVJQEeiyW7NaN4qWdw" name="DOMMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qhgk4VJQEeiyW7NaN4qWdw" name="ChatMessage"/>
              <packagedElement xmi:type="uml:Interface" xmi:id="_Qhgk41JQEeiyW7NaN4qWdw" name="MessageHandler"/>
              <packagedElement xmi:type="uml:Interface" xmi:id="_QhhL8VJQEeiyW7NaN4qWdw" name="NetworkRequestHandler"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QhmEcVJQEeiyW7NaN4qWdw" name="AbandonColonyMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QhnSkVJQEeiyW7NaN4qWdw" name="AskSkillMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QhogsVJQEeiyW7NaN4qWdw" name="AssignTeacherMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QhpHwVJQEeiyW7NaN4qWdw" name="AssignTradeRouteMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qhpu0VJQEeiyW7NaN4qWdw" name="AttackMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QhqV4VJQEeiyW7NaN4qWdw" name="BuildColonyMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qhq88VJQEeiyW7NaN4qWdw" name="BuyMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QhrkAVJQEeiyW7NaN4qWdw" name="BuyPropositionMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QhsLEVJQEeiyW7NaN4qWdw" name="CashInTreasureTrainMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QhsyIVJQEeiyW7NaN4qWdw" name="ChangeStateMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QhtZMVJQEeiyW7NaN4qWdw" name="ChangeWorkImprovementTypeMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QhuAQVJQEeiyW7NaN4qWdw" name="ChangeWorkTypeMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QhunUVJQEeiyW7NaN4qWdw" name="ChooseFoundingFatherMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QhvOYVJQEeiyW7NaN4qWdw" name="ClaimLandMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qhv1cVJQEeiyW7NaN4qWdw" name="ClearSpecialityMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QhwcgVJQEeiyW7NaN4qWdw" name="CloseTransactionMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QhxDkVJQEeiyW7NaN4qWdw" name="CurrentPlayerNetworkRequestHandler"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QhxqoVJQEeiyW7NaN4qWdw" name="DeclareIndependenceMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QhyRsVJQEeiyW7NaN4qWdw" name="DeclineMoundsMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qhy4wVJQEeiyW7NaN4qWdw" name="DeliverGiftMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qh0G4FJQEeiyW7NaN4qWdw" name="DemandTributeMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qh0t8FJQEeiyW7NaN4qWdw" name="DiplomacyMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qh1VAFJQEeiyW7NaN4qWdw" name="DisbandUnitMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qh1VAlJQEeiyW7NaN4qWdw" name="DisembarkMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qh2jIFJQEeiyW7NaN4qWdw" name="EmbarkMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qh2jIlJQEeiyW7NaN4qWdw" name="EmigrateUnitMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qh3xQFJQEeiyW7NaN4qWdw" name="EquipForRoleMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qh4YUFJQEeiyW7NaN4qWdw" name="FirstContactMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qh4YUlJQEeiyW7NaN4qWdw" name="GetNationSummaryMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qh4_YVJQEeiyW7NaN4qWdw" name="GetTransactionMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qh5mcVJQEeiyW7NaN4qWdw" name="GoodsForSaleMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qh6NgVJQEeiyW7NaN4qWdw" name="InciteMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qh60kVJQEeiyW7NaN4qWdw" name="IndianDemandMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qh7boFJQEeiyW7NaN4qWdw" name="JoinColonyMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qh8CsFJQEeiyW7NaN4qWdw" name="LearnSkillMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qh8CslJQEeiyW7NaN4qWdw" name="LoadGoodsMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qh8pwVJQEeiyW7NaN4qWdw" name="LootCargoMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qh9Q0VJQEeiyW7NaN4qWdw" name="MissionaryMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qh934VJQEeiyW7NaN4qWdw" name="MonarchActionMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qh-e8VJQEeiyW7NaN4qWdw" name="MoveMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qh_GAVJQEeiyW7NaN4qWdw" name="MoveToMessage"/>
              <packagedElement xmi:type="uml:Interface" xmi:id="_Qh_tEFJQEeiyW7NaN4qWdw" name="NetworkConstants"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qh_tElJQEeiyW7NaN4qWdw" name="NewLandNameMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QiAUIVJQEeiyW7NaN4qWdw" name="NewRegionNameMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QiA7MVJQEeiyW7NaN4qWdw" name="PayArrearsMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QiBiQVJQEeiyW7NaN4qWdw" name="PayForBuildingMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QiCJUFJQEeiyW7NaN4qWdw" name="PutOutsideColonyMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QiCJUlJQEeiyW7NaN4qWdw" name="RearrangeColonyMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QiCwYVJQEeiyW7NaN4qWdw" name="RenameMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QiDXcVJQEeiyW7NaN4qWdw" name="ScoutSpeakToChiefMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QiD-gFJQEeiyW7NaN4qWdw" name="ScoutIndianSettlementMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QiD-glJQEeiyW7NaN4qWdw" name="SellMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QiElkVJQEeiyW7NaN4qWdw" name="SellPropositionMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QiFMoVJQEeiyW7NaN4qWdw" name="SetBuildQueueMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QiFzsVJQEeiyW7NaN4qWdw" name="SetCurrentStopMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QiGawFJQEeiyW7NaN4qWdw" name="SetDestinationMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QiGawlJQEeiyW7NaN4qWdw" name="SetGoodsLevelsMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QiHB0VJQEeiyW7NaN4qWdw" name="SetTradeRoutesMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QiIP8FJQEeiyW7NaN4qWdw" name="SpySettlementMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QiI3AFJQEeiyW7NaN4qWdw" name="TrainUnitInEuropeMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QiI3AlJQEeiyW7NaN4qWdw" name="UnloadGoodsMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QiJeEVJQEeiyW7NaN4qWdw" name="UpdateTradeRouteMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QiKFIVJQEeiyW7NaN4qWdw" name="WorkMessage"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QkN6oFJQEeiyW7NaN4qWdw" name="LoginMessage"/>
            </packagedElement>
            <packagedElement xmi:type="uml:Package" xmi:id="_P2JTsVJQEeiyW7NaN4qWdw" name="debug">
              <packagedElement xmi:type="uml:Class" xmi:id="_QiVEQlJQEeiyW7NaN4qWdw" name="FreeColDebugger"/>
            </packagedElement>
            <packagedElement xmi:type="uml:Package" xmi:id="_P2JTslJQEeiyW7NaN4qWdw" name="i18n">
              <packagedElement xmi:type="uml:Class" xmi:id="_QiVrUVJQEeiyW7NaN4qWdw" name="Messages"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_QiWSYVJQEeiyW7NaN4qWdw" name="NameCache"/>
            </packagedElement>
            <packagedElement xmi:type="uml:Package" xmi:id="_P2OMMFJQEeiyW7NaN4qWdw" name="util">
              <packagedElement xmi:type="uml:Class" xmi:id="_Qi2oslJQEeiyW7NaN4qWdw" name="LogBuilder"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qi3PwVJQEeiyW7NaN4qWdw" name="RandomChoice"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qi320VJQEeiyW7NaN4qWdw" name="Utils"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qi3201JQEeiyW7NaN4qWdw" name="CollectionUtils"/>
              <packagedElement xmi:type="uml:Class" xmi:id="_Qi4d4VJQEeiyW7NaN4qWdw" name="RandomUtils"/>
            </packagedElement>
            <packagedElement xmi:type="uml:Package" xmi:id="_P34ZElJQEeiyW7NaN4qWdw" name="option">
              <packagedElement xmi:type="uml:Class" xmi:id="_QkKQQFJQEeiyW7NaN4qWdw" name="OptionGroup"/>
            </packagedElement>
            <packagedElement xmi:type="uml:Class" xmi:id="_QhYCAVJQEeiyW7NaN4qWdw" name="FreeColException"/>
          </packagedElement>
          <packagedElement xmi:type="uml:Class" xmi:id="_QiVEQFJQEeiyW7NaN4qWdw" name="FreeCol"/>
        </packagedElement>
      </packagedElement>
    </packagedElement>
    <packagedElement xmi:type="uml:Package" xmi:id="_P1uc8FJQEeiyW7NaN4qWdw" name="java">
      <packagedElement xmi:type="uml:Package" xmi:id="_P1vEAFJQEeiyW7NaN4qWdw" name="io">
        <packagedElement xmi:type="uml:Class" xmi:id="_QhWM0FJQEeiyW7NaN4qWdw" name="IOException"/>
      </packagedElement>
      <packagedElement xmi:type="uml:Package" xmi:id="_P1vEAVJQEeiyW7NaN4qWdw" name="util">
        <packagedElement xmi:type="uml:Package" xmi:id="_P1vEAlJQEeiyW7NaN4qWdw" name="logging">
          <packagedElement xmi:type="uml:Class" xmi:id="_QhWz4VJQEeiyW7NaN4qWdw" name="Level"/>
          <packagedElement xmi:type="uml:Class" xmi:id="_QhXa8VJQEeiyW7NaN4qWdw" name="Logger"/>
        </packagedElement>
        <packagedElement xmi:type="uml:Package" xmi:id="_P2IFkFJQEeiyW7NaN4qWdw" name="Map">
          <packagedElement xmi:type="uml:Interface" xmi:id="_QiPksVJQEeiyW7NaN4qWdw" name="Entry"/>
        </packagedElement>
        <packagedElement xmi:type="uml:Package" xmi:id="_P2IFkVJQEeiyW7NaN4qWdw" name="concurrent">
          <packagedElement xmi:type="uml:Interface" xmi:id="_QiQy0VJQEeiyW7NaN4qWdw" name="Callable"/>
          <packagedElement xmi:type="uml:Class" xmi:id="_QiRZ4VJQEeiyW7NaN4qWdw" name="ExecutionException"/>
          <packagedElement xmi:type="uml:Interface" xmi:id="_QiRZ41JQEeiyW7NaN4qWdw" name="ExecutorService"/>
          <packagedElement xmi:type="uml:Class" xmi:id="_QiSoAFJQEeiyW7NaN4qWdw" name="Executors"/>
          <packagedElement xmi:type="uml:Interface" xmi:id="_QiSoAlJQEeiyW7NaN4qWdw" name="Future"/>
          <packagedElement xmi:type="uml:Enumeration" xmi:id="_QiTPEVJQEeiyW7NaN4qWdw" name="TimeUnit"/>
          <packagedElement xmi:type="uml:Class" xmi:id="_QiT2IVJQEeiyW7NaN4qWdw" name="TimeoutException"/>
        </packagedElement>
        <packagedElement xmi:type="uml:Package" xmi:id="_P2JTsFJQEeiyW7NaN4qWdw" name="stream">
          <packagedElement xmi:type="uml:Class" xmi:id="_QiUdMVJQEeiyW7NaN4qWdw" name="Collectors"/>
        </packagedElement>
        <packagedElement xmi:type="uml:Class" xmi:id="_QhevsFJQEeiyW7NaN4qWdw" name="Collections"/>
        <packagedElement xmi:type="uml:Class" xmi:id="_QhfWwVJQEeiyW7NaN4qWdw" name="HashMap"/>
        <packagedElement xmi:type="uml:Interface" xmi:id="_Qhf90VJQEeiyW7NaN4qWdw" name="Map"/>
        <packagedElement xmi:type="uml:Class" xmi:id="_Qhk2UFJQEeiyW7NaN4qWdw" name="ArrayList"/>
        <packagedElement xmi:type="uml:Interface" xmi:id="_QhldYVJQEeiyW7NaN4qWdw" name="List"/>
        <packagedElement xmi:type="uml:Interface" xmi:id="_QiNvgFJQEeiyW7NaN4qWdw" name="Comparator"/>
        <packagedElement xmi:type="uml:Class" xmi:id="_QiO9oFJQEeiyW7NaN4qWdw" name="HashSet"/>
        <packagedElement xmi:type="uml:Interface" xmi:id="_QiO9olJQEeiyW7NaN4qWdw" name="Iterator"/>
        <packagedElement xmi:type="uml:Class" xmi:id="_QiQLwFJQEeiyW7NaN4qWdw" name="Random"/>
        <packagedElement xmi:type="uml:Interface" xmi:id="_QiQLwlJQEeiyW7NaN4qWdw" name="Set"/>
        <packagedElement xmi:type="uml:Interface" xmi:id="_QjdssFJQEeiyW7NaN4qWdw" name="Collection"/>
      </packagedElement>
      <packagedElement xmi:type="uml:Package" xmi:id="_P34ZEFJQEeiyW7NaN4qWdw" name="awt">
        <packagedElement xmi:type="uml:Class" xmi:id="_QkH0AFJQEeiyW7NaN4qWdw" name="Color"/>
      </packagedElement>
    </packagedElement>
    <packagedElement xmi:type="uml:Package" xmi:id="_P1wSIVJQEeiyW7NaN4qWdw" name="org">
      <packagedElement xmi:type="uml:Package" xmi:id="_P1wSIlJQEeiyW7NaN4qWdw" name="w3c">
        <packagedElement xmi:type="uml:Package" xmi:id="_P1wSI1JQEeiyW7NaN4qWdw" name="dom">
          <packagedElement xmi:type="uml:Interface" xmi:id="_QhbFUVJQEeiyW7NaN4qWdw" name="Element"/>
          <packagedElement xmi:type="uml:Interface" xmi:id="_QiKsMVJQEeiyW7NaN4qWdw" name="NodeList"/>
          <packagedElement xmi:type="uml:Interface" xmi:id="_QjgI8FJQEeiyW7NaN4qWdw" name="Document"/>
          <packagedElement xmi:type="uml:Interface" xmi:id="_QjgI8lJQEeiyW7NaN4qWdw" name="NamedNodeMap"/>
        </packagedElement>
      </packagedElement>
    </packagedElement>
    <profileApplication xmi:id="_O1Ll8FJQEeiyW7NaN4qWdw">
      <eAnnotations xmi:id="_O1Ll8VJQEeiyW7NaN4qWdw" source="http://www.eclipse.org/uml2/2.0.0/UML">
        <references xmi:type="ecore:EPackage" href="pathmap://UMLLAB_PROFILES/UMLLab.profile.uml#UMLLabProfile-Annotation_2-UMLLabProfile"/>
      </eAnnotations>
      <appliedProfile href="pathmap://UMLLAB_PROFILES/UMLLab.profile.uml#UMLLabProfile"/>
    </profileApplication>
  </uml:Model>
  <UMLLabProfile:TargetLanguage xmi:id="_O1Ll8lJQEeiyW7NaN4qWdw" base_Package="_OB6V8FJQEeiyW7NaN4qWdw">
    <languageName>java</languageName>
  </UMLLabProfile:TargetLanguage>
  <UMLLabProfile:LegacyStyledElement xmi:id="_P5PrAVJQEeiyW7NaN4qWdw" base_Element="_P5PrAFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_P5QSEFJQEeiyW7NaN4qWdw" base_Element="_P5PrAFJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_P5QSEVJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_P6KRAFJQEeiyW7NaN4qWdw" base_Element="_P6Jp8FJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_P6KRAVJQEeiyW7NaN4qWdw" base_Element="_P6Jp8FJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_P6KRAlJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_P6Q-sFJQEeiyW7NaN4qWdw" base_Element="_P6QXoFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_P6Q-sVJQEeiyW7NaN4qWdw" base_Element="_P6QXoFJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_P6Q-slJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_P6RlwlJQEeiyW7NaN4qWdw" base_Element="_P6RlwFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_P6SM0FJQEeiyW7NaN4qWdw" base_Element="_P6RlwFJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_P6SM0VJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_P6WeQVJQEeiyW7NaN4qWdw" base_Element="_P6V3MFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_P6WeQlJQEeiyW7NaN4qWdw" base_Element="_P6V3MFJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_P6WeQ1JQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_P6XFUlJQEeiyW7NaN4qWdw" base_Element="_P6XFUFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_P6XsYFJQEeiyW7NaN4qWdw" base_Element="_P6XFUFJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_P6XsYVJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_P6Y6gVJQEeiyW7NaN4qWdw" base_Element="_P6XsYlJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_P6Y6glJQEeiyW7NaN4qWdw" base_Element="_P6XsYlJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_P6Y6g1JQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_P6dL8VJQEeiyW7NaN4qWdw" base_Element="_P6ck4FJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_P6dzAFJQEeiyW7NaN4qWdw" base_Element="_P6ck4FJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_P6dzAVJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_P6eaEFJQEeiyW7NaN4qWdw" base_Element="_P6dzAlJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_P6eaEVJQEeiyW7NaN4qWdw" base_Element="_P6dzAlJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_P6eaElJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_P6hdYlJQEeiyW7NaN4qWdw" base_Element="_P6hdYFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_P6hdY1JQEeiyW7NaN4qWdw" base_Element="_P6hdYFJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_P6hdZFJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_P6iEcVJQEeiyW7NaN4qWdw" base_Element="_P6hdZVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_P6iEclJQEeiyW7NaN4qWdw" base_Element="_P6hdZVJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_P6iEc1JQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_P6lHwFJQEeiyW7NaN4qWdw" base_Element="_P6kgsFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_P6lHwVJQEeiyW7NaN4qWdw" base_Element="_P6kgsFJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_P6lHwlJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_P6lu0VJQEeiyW7NaN4qWdw" base_Element="_P6lHw1JQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_P6lu0lJQEeiyW7NaN4qWdw" base_Element="_P6lHw1JQEeiyW7NaN4qWdw">
    <annotations xmi:id="_P6lu01JQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_P6oyIVJQEeiyW7NaN4qWdw" base_Element="_P6oLEFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_P6oyIlJQEeiyW7NaN4qWdw" base_Element="_P6oLEFJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_P6oyI1JQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_P6qnUFJQEeiyW7NaN4qWdw" base_Element="_P6qAQlJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_P6qnUVJQEeiyW7NaN4qWdw" base_Element="_P6qAQlJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_P6qnUlJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_P6rOYlJQEeiyW7NaN4qWdw" base_Element="_P6rOYFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_P6r1cFJQEeiyW7NaN4qWdw" base_Element="_P6rOYFJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_P6r1cVJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_P6tqolJQEeiyW7NaN4qWdw" base_Element="_P6tqoFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_P6uRsFJQEeiyW7NaN4qWdw" base_Element="_P6tqoFJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_P6uRsVJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_P6u4wVJQEeiyW7NaN4qWdw" base_Element="_P6uRslJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_P6u4wlJQEeiyW7NaN4qWdw" base_Element="_P6uRslJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_P6u4w1JQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_P6xVAFJQEeiyW7NaN4qWdw" base_Element="_P6wt8FJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_P6xVAVJQEeiyW7NaN4qWdw" base_Element="_P6wt8FJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_P6xVAlJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_P6x8EFJQEeiyW7NaN4qWdw" base_Element="_P6xVA1JQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_P6x8EVJQEeiyW7NaN4qWdw" base_Element="_P6xVA1JQEeiyW7NaN4qWdw">
    <annotations xmi:id="_P6x8ElJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_P6zxQVJQEeiyW7NaN4qWdw" base_Element="_P6zKMFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_P6zxQlJQEeiyW7NaN4qWdw" base_Element="_P6zKMFJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_P6zxQ1JQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_P60YUlJQEeiyW7NaN4qWdw" base_Element="_P60YUFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_P60_YFJQEeiyW7NaN4qWdw" base_Element="_P60YUFJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_P60_YVJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_P62NglJQEeiyW7NaN4qWdw" base_Element="_P62NgFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_P620kFJQEeiyW7NaN4qWdw" base_Element="_P62NgFJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_P620kVJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_P63boFJQEeiyW7NaN4qWdw" base_Element="_P620klJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_P63boVJQEeiyW7NaN4qWdw" base_Element="_P620klJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_P63bolJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_P65Q0lJQEeiyW7NaN4qWdw" base_Element="_P65Q0FJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_P6534FJQEeiyW7NaN4qWdw" base_Element="_P65Q0FJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_P6534VJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_P66e8FJQEeiyW7NaN4qWdw" base_Element="_P6534lJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_P66e8VJQEeiyW7NaN4qWdw" base_Element="_P6534lJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_P66e8lJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_P68UIlJQEeiyW7NaN4qWdw" base_Element="_P68UIFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_P687MFJQEeiyW7NaN4qWdw" base_Element="_P68UIFJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_P687MVJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_P69iQFJQEeiyW7NaN4qWdw" base_Element="_P687MlJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_P69iQVJQEeiyW7NaN4qWdw" base_Element="_P687MlJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_P69iQlJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_P7DB0VJQEeiyW7NaN4qWdw" base_Element="_P7CawFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_P7DB0lJQEeiyW7NaN4qWdw" base_Element="_P7CawFJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_P7DB01JQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:Reference xmi:id="_QhWz4FJQEeiyW7NaN4qWdw" base_Element="_QhWM0FJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QhXa8FJQEeiyW7NaN4qWdw" base_Element="_QhWz4VJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QhYCAFJQEeiyW7NaN4qWdw" base_Element="_QhXa8VJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QhYpEFJQEeiyW7NaN4qWdw" base_Element="_QhYCAVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QhYpElJQEeiyW7NaN4qWdw" base_Element="_QhYpEVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QhZQIVJQEeiyW7NaN4qWdw" base_Element="_QhZQIFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QhZ3MFJQEeiyW7NaN4qWdw" base_Element="_QhZQIlJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QhaeQFJQEeiyW7NaN4qWdw" base_Element="_QhZ3MVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QhaeQlJQEeiyW7NaN4qWdw" base_Element="_QhaeQVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QhbFUFJQEeiyW7NaN4qWdw" base_Element="_QhaeQ1JQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QhbsYFJQEeiyW7NaN4qWdw" base_Element="_QhbFUVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qhc6gFJQEeiyW7NaN4qWdw" base_Element="_QhcTcFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QheIoFJQEeiyW7NaN4qWdw" base_Element="_QhdhkVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QhfWwFJQEeiyW7NaN4qWdw" base_Element="_QhevsFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qhf90FJQEeiyW7NaN4qWdw" base_Element="_QhfWwVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qhgk4FJQEeiyW7NaN4qWdw" base_Element="_Qhf90VJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qhgk4lJQEeiyW7NaN4qWdw" base_Element="_Qhgk4VJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QhhL8FJQEeiyW7NaN4qWdw" base_Element="_Qhgk41JQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QhhzAFJQEeiyW7NaN4qWdw" base_Element="_QhhL8VJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QhldYFJQEeiyW7NaN4qWdw" base_Element="_Qhk2UFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QhmEcFJQEeiyW7NaN4qWdw" base_Element="_QhldYVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QhnSkFJQEeiyW7NaN4qWdw" base_Element="_QhmEcVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QhogsFJQEeiyW7NaN4qWdw" base_Element="_QhnSkVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QhpHwFJQEeiyW7NaN4qWdw" base_Element="_QhogsVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qhpu0FJQEeiyW7NaN4qWdw" base_Element="_QhpHwVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QhqV4FJQEeiyW7NaN4qWdw" base_Element="_Qhpu0VJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qhq88FJQEeiyW7NaN4qWdw" base_Element="_QhqV4VJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QhrkAFJQEeiyW7NaN4qWdw" base_Element="_Qhq88VJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QhsLEFJQEeiyW7NaN4qWdw" base_Element="_QhrkAVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QhsyIFJQEeiyW7NaN4qWdw" base_Element="_QhsLEVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QhtZMFJQEeiyW7NaN4qWdw" base_Element="_QhsyIVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QhuAQFJQEeiyW7NaN4qWdw" base_Element="_QhtZMVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QhunUFJQEeiyW7NaN4qWdw" base_Element="_QhuAQVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QhvOYFJQEeiyW7NaN4qWdw" base_Element="_QhunUVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qhv1cFJQEeiyW7NaN4qWdw" base_Element="_QhvOYVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QhwcgFJQEeiyW7NaN4qWdw" base_Element="_Qhv1cVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QhxDkFJQEeiyW7NaN4qWdw" base_Element="_QhwcgVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QhxqoFJQEeiyW7NaN4qWdw" base_Element="_QhxDkVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QhyRsFJQEeiyW7NaN4qWdw" base_Element="_QhxqoVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qhy4wFJQEeiyW7NaN4qWdw" base_Element="_QhyRsVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qhzf0FJQEeiyW7NaN4qWdw" base_Element="_Qhy4wVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qh0G4VJQEeiyW7NaN4qWdw" base_Element="_Qh0G4FJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qh0t8VJQEeiyW7NaN4qWdw" base_Element="_Qh0t8FJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qh1VAVJQEeiyW7NaN4qWdw" base_Element="_Qh1VAFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qh18EFJQEeiyW7NaN4qWdw" base_Element="_Qh1VAlJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qh2jIVJQEeiyW7NaN4qWdw" base_Element="_Qh2jIFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qh3KMFJQEeiyW7NaN4qWdw" base_Element="_Qh2jIlJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qh3xQVJQEeiyW7NaN4qWdw" base_Element="_Qh3xQFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qh4YUVJQEeiyW7NaN4qWdw" base_Element="_Qh4YUFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qh4_YFJQEeiyW7NaN4qWdw" base_Element="_Qh4YUlJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qh5mcFJQEeiyW7NaN4qWdw" base_Element="_Qh4_YVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qh6NgFJQEeiyW7NaN4qWdw" base_Element="_Qh5mcVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qh60kFJQEeiyW7NaN4qWdw" base_Element="_Qh6NgVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qh60klJQEeiyW7NaN4qWdw" base_Element="_Qh60kVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qh7boVJQEeiyW7NaN4qWdw" base_Element="_Qh7boFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qh8CsVJQEeiyW7NaN4qWdw" base_Element="_Qh8CsFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qh8pwFJQEeiyW7NaN4qWdw" base_Element="_Qh8CslJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qh9Q0FJQEeiyW7NaN4qWdw" base_Element="_Qh8pwVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qh934FJQEeiyW7NaN4qWdw" base_Element="_Qh9Q0VJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qh-e8FJQEeiyW7NaN4qWdw" base_Element="_Qh934VJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qh_GAFJQEeiyW7NaN4qWdw" base_Element="_Qh-e8VJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qh_GAlJQEeiyW7NaN4qWdw" base_Element="_Qh_GAVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qh_tEVJQEeiyW7NaN4qWdw" base_Element="_Qh_tEFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiAUIFJQEeiyW7NaN4qWdw" base_Element="_Qh_tElJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiA7MFJQEeiyW7NaN4qWdw" base_Element="_QiAUIVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiBiQFJQEeiyW7NaN4qWdw" base_Element="_QiA7MVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiBiQlJQEeiyW7NaN4qWdw" base_Element="_QiBiQVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiCJUVJQEeiyW7NaN4qWdw" base_Element="_QiCJUFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiCwYFJQEeiyW7NaN4qWdw" base_Element="_QiCJUlJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiDXcFJQEeiyW7NaN4qWdw" base_Element="_QiCwYVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiDXclJQEeiyW7NaN4qWdw" base_Element="_QiDXcVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiD-gVJQEeiyW7NaN4qWdw" base_Element="_QiD-gFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiElkFJQEeiyW7NaN4qWdw" base_Element="_QiD-glJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiFMoFJQEeiyW7NaN4qWdw" base_Element="_QiElkVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiFzsFJQEeiyW7NaN4qWdw" base_Element="_QiFMoVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiFzslJQEeiyW7NaN4qWdw" base_Element="_QiFzsVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiGawVJQEeiyW7NaN4qWdw" base_Element="_QiGawFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiHB0FJQEeiyW7NaN4qWdw" base_Element="_QiGawlJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiHo4FJQEeiyW7NaN4qWdw" base_Element="_QiHB0VJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiIP8VJQEeiyW7NaN4qWdw" base_Element="_QiIP8FJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiI3AVJQEeiyW7NaN4qWdw" base_Element="_QiI3AFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiJeEFJQEeiyW7NaN4qWdw" base_Element="_QiI3AlJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiKFIFJQEeiyW7NaN4qWdw" base_Element="_QiJeEVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiKsMFJQEeiyW7NaN4qWdw" base_Element="_QiKFIVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiLTQFJQEeiyW7NaN4qWdw" base_Element="_QiKsMVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiOWkFJQEeiyW7NaN4qWdw" base_Element="_QiNvgFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiO9oVJQEeiyW7NaN4qWdw" base_Element="_QiO9oFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiPksFJQEeiyW7NaN4qWdw" base_Element="_QiO9olJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiPkslJQEeiyW7NaN4qWdw" base_Element="_QiPksVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiQLwVJQEeiyW7NaN4qWdw" base_Element="_QiQLwFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiQy0FJQEeiyW7NaN4qWdw" base_Element="_QiQLwlJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiRZ4FJQEeiyW7NaN4qWdw" base_Element="_QiQy0VJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiRZ4lJQEeiyW7NaN4qWdw" base_Element="_QiRZ4VJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiSA8FJQEeiyW7NaN4qWdw" base_Element="_QiRZ41JQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiSoAVJQEeiyW7NaN4qWdw" base_Element="_QiSoAFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiTPEFJQEeiyW7NaN4qWdw" base_Element="_QiSoAlJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiT2IFJQEeiyW7NaN4qWdw" base_Element="_QiTPEVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiUdMFJQEeiyW7NaN4qWdw" base_Element="_QiT2IVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiUdMlJQEeiyW7NaN4qWdw" base_Element="_QiUdMVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiVEQVJQEeiyW7NaN4qWdw" base_Element="_QiVEQFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiVrUFJQEeiyW7NaN4qWdw" base_Element="_QiVEQlJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiWSYFJQEeiyW7NaN4qWdw" base_Element="_QiVrUVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiW5cFJQEeiyW7NaN4qWdw" base_Element="_QiWSYVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiXggFJQEeiyW7NaN4qWdw" base_Element="_QiW5cVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiYHkFJQEeiyW7NaN4qWdw" base_Element="_QiXggVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiYHklJQEeiyW7NaN4qWdw" base_Element="_QiYHkVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiYuoFJQEeiyW7NaN4qWdw" base_Element="_QiYHk1JQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiZVsFJQEeiyW7NaN4qWdw" base_Element="_QiYuoVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiZ8wFJQEeiyW7NaN4qWdw" base_Element="_QiZVsVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiZ8wlJQEeiyW7NaN4qWdw" base_Element="_QiZ8wVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qiaj0VJQEeiyW7NaN4qWdw" base_Element="_Qiaj0FJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QibK4FJQEeiyW7NaN4qWdw" base_Element="_Qiaj0lJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qibx8FJQEeiyW7NaN4qWdw" base_Element="_QibK4VJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QicZAFJQEeiyW7NaN4qWdw" base_Element="_Qibx8VJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QidAEFJQEeiyW7NaN4qWdw" base_Element="_QicZAVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QidAElJQEeiyW7NaN4qWdw" base_Element="_QidAEVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QidnIVJQEeiyW7NaN4qWdw" base_Element="_QidnIFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QieOMFJQEeiyW7NaN4qWdw" base_Element="_QidnIlJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qie1QFJQEeiyW7NaN4qWdw" base_Element="_QieOMVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qie1QlJQEeiyW7NaN4qWdw" base_Element="_Qie1QVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QifcUVJQEeiyW7NaN4qWdw" base_Element="_QifcUFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QigDYFJQEeiyW7NaN4qWdw" base_Element="_QifcUlJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QigqcFJQEeiyW7NaN4qWdw" base_Element="_QigDYVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QigqclJQEeiyW7NaN4qWdw" base_Element="_QigqcVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QihRgFJQEeiyW7NaN4qWdw" base_Element="_Qigqc1JQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qih4kFJQEeiyW7NaN4qWdw" base_Element="_QihRgVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qih4klJQEeiyW7NaN4qWdw" base_Element="_Qih4kVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QijtwFJQEeiyW7NaN4qWdw" base_Element="_QiifoFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qik74FJQEeiyW7NaN4qWdw" base_Element="_QikU0FJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qik74lJQEeiyW7NaN4qWdw" base_Element="_Qik74VJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QimKAFJQEeiyW7NaN4qWdw" base_Element="_Qili8FJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QimxEFJQEeiyW7NaN4qWdw" base_Element="_QimKAVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QinYIVJQEeiyW7NaN4qWdw" base_Element="_QinYIFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qin_MVJQEeiyW7NaN4qWdw" base_Element="_Qin_MFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiomQVJQEeiyW7NaN4qWdw" base_Element="_QiomQFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QipNUVJQEeiyW7NaN4qWdw" base_Element="_QipNUFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qip0YVJQEeiyW7NaN4qWdw" base_Element="_Qip0YFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiqbcVJQEeiyW7NaN4qWdw" base_Element="_QiqbcFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QirCgVJQEeiyW7NaN4qWdw" base_Element="_QirCgFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QirpkVJQEeiyW7NaN4qWdw" base_Element="_QirpkFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QisQoVJQEeiyW7NaN4qWdw" base_Element="_QisQoFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qis3sFJQEeiyW7NaN4qWdw" base_Element="_QisQolJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QitewFJQEeiyW7NaN4qWdw" base_Element="_Qis3sVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiuF0FJQEeiyW7NaN4qWdw" base_Element="_QitewVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiuF0lJQEeiyW7NaN4qWdw" base_Element="_QiuF0VJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qius4VJQEeiyW7NaN4qWdw" base_Element="_Qius4FJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QivT8FJQEeiyW7NaN4qWdw" base_Element="_Qius4lJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qiv7AFJQEeiyW7NaN4qWdw" base_Element="_QivT8VJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiwiEFJQEeiyW7NaN4qWdw" base_Element="_Qiv7AVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QixJIFJQEeiyW7NaN4qWdw" base_Element="_QiwiEVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QixwMFJQEeiyW7NaN4qWdw" base_Element="_QixJIVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiyXQFJQEeiyW7NaN4qWdw" base_Element="_QixwMVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QiyXQlJQEeiyW7NaN4qWdw" base_Element="_QiyXQVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qiy-UVJQEeiyW7NaN4qWdw" base_Element="_Qiy-UFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QizlYFJQEeiyW7NaN4qWdw" base_Element="_Qiy-UlJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QizlYlJQEeiyW7NaN4qWdw" base_Element="_QizlYVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qi0McFJQEeiyW7NaN4qWdw" base_Element="_QizlY1JQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qi0zgFJQEeiyW7NaN4qWdw" base_Element="_Qi0McVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qi1akFJQEeiyW7NaN4qWdw" base_Element="_Qi0zgVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qi1aklJQEeiyW7NaN4qWdw" base_Element="_Qi1akVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qi2BoVJQEeiyW7NaN4qWdw" base_Element="_Qi2BoFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qi2osVJQEeiyW7NaN4qWdw" base_Element="_Qi2osFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qi3PwFJQEeiyW7NaN4qWdw" base_Element="_Qi2oslJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qi320FJQEeiyW7NaN4qWdw" base_Element="_Qi3PwVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qi320lJQEeiyW7NaN4qWdw" base_Element="_Qi320VJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qi4d4FJQEeiyW7NaN4qWdw" base_Element="_Qi3201JQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qi5E8FJQEeiyW7NaN4qWdw" base_Element="_Qi4d4VJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qi5E8lJQEeiyW7NaN4qWdw" base_Element="_Qi5E8VJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qi5sAFJQEeiyW7NaN4qWdw" base_Element="_Qi5E81JQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qi6TEFJQEeiyW7NaN4qWdw" base_Element="_Qi5sAVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qi6TElJQEeiyW7NaN4qWdw" base_Element="_Qi6TEVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qi66IFJQEeiyW7NaN4qWdw" base_Element="_Qi6TE1JQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qi66IlJQEeiyW7NaN4qWdw" base_Element="_Qi66IVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qi7hMFJQEeiyW7NaN4qWdw" base_Element="_Qi66I1JQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qi8IQFJQEeiyW7NaN4qWdw" base_Element="_Qi7hMVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qi8IQlJQEeiyW7NaN4qWdw" base_Element="_Qi8IQVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qi8vUFJQEeiyW7NaN4qWdw" base_Element="_Qi8IQ1JQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qi9WYFJQEeiyW7NaN4qWdw" base_Element="_Qi8vUVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qi9WYlJQEeiyW7NaN4qWdw" base_Element="_Qi9WYVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qi99cFJQEeiyW7NaN4qWdw" base_Element="_Qi9WY1JQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qi-kgFJQEeiyW7NaN4qWdw" base_Element="_Qi99cVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QjeTwFJQEeiyW7NaN4qWdw" base_Element="_QjdssFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QjeTwlJQEeiyW7NaN4qWdw" base_Element="_QjeTwVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qje60VJQEeiyW7NaN4qWdw" base_Element="_Qje60FJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qjfh4FJQEeiyW7NaN4qWdw" base_Element="_Qje60lJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qjfh4lJQEeiyW7NaN4qWdw" base_Element="_Qjfh4VJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QjgI8VJQEeiyW7NaN4qWdw" base_Element="_QjgI8FJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QjgI81JQEeiyW7NaN4qWdw" base_Element="_QjgI8lJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Qj1gJFJQEeiyW7NaN4qWdw" base_Element="_Qj05EFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Array xmi:id="_Qj2HMVJQEeiyW7NaN4qWdw" base_Element="_Qj1gIlJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QkIbEFJQEeiyW7NaN4qWdw" base_Element="_QkH0AFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QkJCIFJQEeiyW7NaN4qWdw" base_Element="_QkIbEVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QkJpMFJQEeiyW7NaN4qWdw" base_Element="_QkJCIVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QkJpMlJQEeiyW7NaN4qWdw" base_Element="_QkJpMVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QkKQQVJQEeiyW7NaN4qWdw" base_Element="_QkKQQFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QkN6oVJQEeiyW7NaN4qWdw" base_Element="_QkN6oFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QkiDsFJQEeiyW7NaN4qWdw" base_Element="_QkhcolJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_QkiDsVJQEeiyW7NaN4qWdw" base_Element="_QkhcolJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_QkiDslJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QkjR01JQEeiyW7NaN4qWdw" base_Element="_QkiqxVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_QkjR1FJQEeiyW7NaN4qWdw" base_Element="_QkiqxVJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_QkjR1VJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QklHBFJQEeiyW7NaN4qWdw" base_Element="_QklHAFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_QklHBVJQEeiyW7NaN4qWdw" base_Element="_QklHAFJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_QklHBlJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:Generics xmi:id="_QkuQ8FJQEeiyW7NaN4qWdw" genericsValue="DOMMessage" base_Element="_Qktp41JQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Generics xmi:id="_QkwGIFJQEeiyW7NaN4qWdw" genericsValue="DOMMessage" base_Element="_QkvfEFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Generics xmi:id="_QkzwgFJQEeiyW7NaN4qWdw" genericsValue="Unit" base_Element="_QkzJclJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Generics xmi:id="_Qk-vpFJQEeiyW7NaN4qWdw" genericsValue="CombatResult" base_Element="_Qk-volJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Generics xmi:id="_QlYYQFJQEeiyW7NaN4qWdw" genericsValue="Goods" base_Element="_QlXKJFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Generics xmi:id="_QlgUEFJQEeiyW7NaN4qWdw" genericsValue="BuildableType" base_Element="_QlftAVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Generics xmi:id="_Qlo28FJQEeiyW7NaN4qWdw" genericsValue="TradeRoute" base_Element="_QloP4lJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Generics xmi:id="_QltvcFJQEeiyW7NaN4qWdw" genericsValue="UnitChange" base_Element="_QltIYlJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Ql5VolJQEeiyW7NaN4qWdw" base_Element="_Ql4ulVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_Ql5Vo1JQEeiyW7NaN4qWdw" base_Element="_Ql4ulVJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_Ql58sFJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Ql6jwVJQEeiyW7NaN4qWdw" base_Element="_Ql58sVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_Ql6jwlJQEeiyW7NaN4qWdw" base_Element="_Ql58sVJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_Ql6jw1JQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Ql7K0lJQEeiyW7NaN4qWdw" base_Element="_Ql7K0FJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_Ql7x4FJQEeiyW7NaN4qWdw" base_Element="_Ql7K0FJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_Ql7x4VJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Ql8Y9FJQEeiyW7NaN4qWdw" base_Element="_Ql8Y8FJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_Ql9AAFJQEeiyW7NaN4qWdw" base_Element="_Ql8Y8FJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_Ql9AAVJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Ql9nEFJQEeiyW7NaN4qWdw" base_Element="_Ql9AAlJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_Ql9nEVJQEeiyW7NaN4qWdw" base_Element="_Ql9AAlJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_Ql9nElJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Ql_cRFJQEeiyW7NaN4qWdw" base_Element="_Ql_cQFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_QmADUFJQEeiyW7NaN4qWdw" base_Element="_Ql_cQFJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_QmADUVJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QmAqYFJQEeiyW7NaN4qWdw" base_Element="_QmADUlJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_QmAqYVJQEeiyW7NaN4qWdw" base_Element="_QmADUlJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_QmAqYlJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QmDts1JQEeiyW7NaN4qWdw" base_Element="_QmDtsFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_QmEUwFJQEeiyW7NaN4qWdw" base_Element="_QmDtsFJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_QmEUwVJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QmE70FJQEeiyW7NaN4qWdw" base_Element="_QmEUwlJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_QmE70VJQEeiyW7NaN4qWdw" base_Element="_QmEUwlJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_QmE70lJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QmFi5FJQEeiyW7NaN4qWdw" base_Element="_QmFi4FJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_QmGJ8FJQEeiyW7NaN4qWdw" base_Element="_QmFi4FJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_QmGJ8VJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QmGxAFJQEeiyW7NaN4qWdw" base_Element="_QmGJ8lJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_QmGxAVJQEeiyW7NaN4qWdw" base_Element="_QmGJ8lJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_QmGxAlJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QmImMFJQEeiyW7NaN4qWdw" base_Element="_QmH_I1JQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_QmImMVJQEeiyW7NaN4qWdw" base_Element="_QmH_I1JQEeiyW7NaN4qWdw">
    <annotations xmi:id="_QmImMlJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QmJNQlJQEeiyW7NaN4qWdw" base_Element="_QmImM1JQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_QmJNQ1JQEeiyW7NaN4qWdw" base_Element="_QmImM1JQEeiyW7NaN4qWdw">
    <annotations xmi:id="_QmJ0UFJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QmKbYVJQEeiyW7NaN4qWdw" base_Element="_QmJ0UVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_QmKbYlJQEeiyW7NaN4qWdw" base_Element="_QmJ0UVJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_QmKbY1JQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QmLCclJQEeiyW7NaN4qWdw" base_Element="_QmLCcFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_QmLCc1JQEeiyW7NaN4qWdw" base_Element="_QmLCcFJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_QmLCdFJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QmMQkVJQEeiyW7NaN4qWdw" base_Element="_QmLpgFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Array xmi:id="_QmMQlFJQEeiyW7NaN4qWdw" base_Element="_QmLpg1JQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QmNesFJQEeiyW7NaN4qWdw" base_Element="_QmM3oFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_QmNesVJQEeiyW7NaN4qWdw" base_Element="_QmM3oFJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_QmNeslJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QmOFw1JQEeiyW7NaN4qWdw" base_Element="_QmNes1JQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_QmOFxFJQEeiyW7NaN4qWdw" base_Element="_QmNes1JQEeiyW7NaN4qWdw">
    <annotations xmi:id="_QmOFxVJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QmP68FJQEeiyW7NaN4qWdw" base_Element="_QmPT4lJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_QmQiAFJQEeiyW7NaN4qWdw" base_Element="_QmPT4lJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_QmQiAVJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QmRJEFJQEeiyW7NaN4qWdw" base_Element="_QmQiAlJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_QmRJEVJQEeiyW7NaN4qWdw" base_Element="_QmQiAlJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_QmRJElJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QmSXMFJQEeiyW7NaN4qWdw" base_Element="_QmRwIFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_QmSXMVJQEeiyW7NaN4qWdw" base_Element="_QmRwIFJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_QmSXMlJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:Generics xmi:id="_QmUzcFJQEeiyW7NaN4qWdw" genericsValue="? extends FreeColGameObject" base_Element="_QmTlU1JQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QmVaglJQEeiyW7NaN4qWdw" base_Element="_QmUzcVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_QmWBkFJQEeiyW7NaN4qWdw" base_Element="_QmUzcVJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_QmWBkVJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QmWopFJQEeiyW7NaN4qWdw" base_Element="_QmWooFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_QmXPsFJQEeiyW7NaN4qWdw" base_Element="_QmWooFJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_QmXPsVJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QmX2wFJQEeiyW7NaN4qWdw" base_Element="_QmXPslJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_QmX2wVJQEeiyW7NaN4qWdw" base_Element="_QmXPslJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_QmX2wlJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QmaTAFJQEeiyW7NaN4qWdw" base_Element="_QmZr8FJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_Qma6EFJQEeiyW7NaN4qWdw" base_Element="_QmZr8FJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_Qma6EVJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QmbhIFJQEeiyW7NaN4qWdw" base_Element="_Qma6ElJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_QmbhIVJQEeiyW7NaN4qWdw" base_Element="_Qma6ElJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_QmbhIlJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QmekcFJQEeiyW7NaN4qWdw" base_Element="_Qmd9YFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_QmekcVJQEeiyW7NaN4qWdw" base_Element="_Qmd9YFJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_QmekclJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QmfLglJQEeiyW7NaN4qWdw" base_Element="_QmfLgFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_QmfykFJQEeiyW7NaN4qWdw" base_Element="_QmfLgFJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_QmfykVJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QmiO0FJQEeiyW7NaN4qWdw" base_Element="_QmhnwFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_QmiO0VJQEeiyW7NaN4qWdw" base_Element="_QmhnwFJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_QmiO0lJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Qmi14VJQEeiyW7NaN4qWdw" base_Element="_QmiO01JQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_Qmjc8FJQEeiyW7NaN4qWdw" base_Element="_QmiO01JQEeiyW7NaN4qWdw">
    <annotations xmi:id="_Qmjc8VJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Qml5MFJQEeiyW7NaN4qWdw" base_Element="_QmlSIFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_QmmgQFJQEeiyW7NaN4qWdw" base_Element="_QmlSIFJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_QmmgQVJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QmnHUFJQEeiyW7NaN4qWdw" base_Element="_QmmgQlJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_QmnHUVJQEeiyW7NaN4qWdw" base_Element="_QmmgQlJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_QmnHUlJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QmoVclJQEeiyW7NaN4qWdw" base_Element="_QmnuYFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_QmoVc1JQEeiyW7NaN4qWdw" base_Element="_QmnuYFJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_QmoVdFJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Qmo8glJQEeiyW7NaN4qWdw" base_Element="_Qmo8gFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_QmpjkFJQEeiyW7NaN4qWdw" base_Element="_Qmo8gFJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_QmpjkVJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QmqKpFJQEeiyW7NaN4qWdw" base_Element="_QmqKoFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Array xmi:id="_QmqxsVJQEeiyW7NaN4qWdw" base_Element="_QmqKolJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Generics xmi:id="_QmrYwlJQEeiyW7NaN4qWdw" genericsValue="? extends FreeColGameObject" base_Element="_QmrYwFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QmzUlVJQEeiyW7NaN4qWdw" base_Element="_QmzUkFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Array xmi:id="_Qmz7oVJQEeiyW7NaN4qWdw" base_Element="_QmzUk1JQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Generics xmi:id="_Qm2X4FJQEeiyW7NaN4qWdw" genericsValue="? extends FreeColGameObject" base_Element="_Qm1w0lJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Generics xmi:id="_Qm7QYVJQEeiyW7NaN4qWdw" genericsValue="Element" base_Element="_Qm6pVFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QnB-ElJQEeiyW7NaN4qWdw" base_Element="_QnBXA1JQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_QnB-E1JQEeiyW7NaN4qWdw" base_Element="_QnBXA1JQEeiyW7NaN4qWdw">
    <annotations xmi:id="_QnClIFJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QnDzQVJQEeiyW7NaN4qWdw" base_Element="_QnDMMVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_QnDzQlJQEeiyW7NaN4qWdw" base_Element="_QnDMM1JQEeiyW7NaN4qWdw">
    <annotations xmi:id="_QnDzQ1JQEeiyW7NaN4qWdw" name="SuppressWarnings">
      <annotationParameters xmi:id="_QnDzRFJQEeiyW7NaN4qWdw" skipName="true" skipArray="true">
        <valueSpecifications xmi:type="uml:LiteralString" xmi:id="_Qohy8FJQEeiyW7NaN4qWdw" value="&quot;unused&quot;"/>
      </annotationParameters>
    </annotations>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QnKg8FJQEeiyW7NaN4qWdw" base_Element="_QnJ541JQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_QnKg8VJQEeiyW7NaN4qWdw" base_Element="_QnJ541JQEeiyW7NaN4qWdw">
    <annotations xmi:id="_QnKg8lJQEeiyW7NaN4qWdw" name="Override"/>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QnLvEVJQEeiyW7NaN4qWdw" base_Element="_QnLIAFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_QnLvElJQEeiyW7NaN4qWdw" base_Element="_QnLIAlJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_QnLvE1JQEeiyW7NaN4qWdw" name="SuppressWarnings">
      <annotationParameters xmi:id="_QnLvFFJQEeiyW7NaN4qWdw" skipName="true" skipArray="true">
        <valueSpecifications xmi:type="uml:LiteralString" xmi:id="_QoiZ9VJQEeiyW7NaN4qWdw" value="&quot;unused&quot;"/>
      </annotationParameters>
    </annotations>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QnNkQFJQEeiyW7NaN4qWdw" base_Element="_QnM9MFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_QnNkQVJQEeiyW7NaN4qWdw" base_Element="_QnM9MVJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_QnNkQlJQEeiyW7NaN4qWdw" name="SuppressWarnings">
      <annotationParameters xmi:id="_QnNkQ1JQEeiyW7NaN4qWdw" skipName="true" skipArray="true">
        <valueSpecifications xmi:type="uml:LiteralString" xmi:id="_QoiZ9lJQEeiyW7NaN4qWdw" value="&quot;unused&quot;"/>
      </annotationParameters>
    </annotations>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:Annotations xmi:id="_QnNkRFJQEeiyW7NaN4qWdw" base_Element="_QnM9MlJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_QnNkRVJQEeiyW7NaN4qWdw" name="SuppressWarnings">
      <annotationParameters xmi:id="_QnNkRlJQEeiyW7NaN4qWdw" skipName="true" skipArray="true">
        <valueSpecifications xmi:type="uml:LiteralString" xmi:id="_QoiZ91JQEeiyW7NaN4qWdw" value="&quot;unused&quot;"/>
      </annotationParameters>
    </annotations>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QnOyYlJQEeiyW7NaN4qWdw" base_Element="_QnOLUFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Annotations xmi:id="_QnOyY1JQEeiyW7NaN4qWdw" base_Element="_QnOLUVJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_QnOyZFJQEeiyW7NaN4qWdw" name="SuppressWarnings">
      <annotationParameters xmi:id="_QnOyZVJQEeiyW7NaN4qWdw" skipName="true" skipArray="true">
        <valueSpecifications xmi:type="uml:LiteralString" xmi:id="_QoiZ-FJQEeiyW7NaN4qWdw" value="&quot;unused&quot;"/>
      </annotationParameters>
    </annotations>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:Annotations xmi:id="_QnPZcFJQEeiyW7NaN4qWdw" base_Element="_QnOyYFJQEeiyW7NaN4qWdw">
    <annotations xmi:id="_QnPZcVJQEeiyW7NaN4qWdw" name="SuppressWarnings">
      <annotationParameters xmi:id="_QnPZclJQEeiyW7NaN4qWdw" skipName="true" skipArray="true">
        <valueSpecifications xmi:type="uml:LiteralString" xmi:id="_QoiZ-VJQEeiyW7NaN4qWdw" value="&quot;unused&quot;"/>
      </annotationParameters>
    </annotations>
  </UMLLabProfile:Annotations>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QnWHIVJQEeiyW7NaN4qWdw" base_Element="_QnWHIFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QnWuMlJQEeiyW7NaN4qWdw" base_Element="_QnWuMFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QnX8UlJQEeiyW7NaN4qWdw" base_Element="_QnX8UVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QnYjYlJQEeiyW7NaN4qWdw" base_Element="_QnYjYFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QnZKcVJQEeiyW7NaN4qWdw" base_Element="_QnYjY1JQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QnZKdFJQEeiyW7NaN4qWdw" base_Element="_QnZKclJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QnZxgFJQEeiyW7NaN4qWdw" base_Element="_QnZKdVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QnZxglJQEeiyW7NaN4qWdw" base_Element="_QnZxgVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QnaYkFJQEeiyW7NaN4qWdw" base_Element="_QnZxg1JQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Qna_oFJQEeiyW7NaN4qWdw" base_Element="_QnaYkVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Qna_o1JQEeiyW7NaN4qWdw" base_Element="_Qna_oVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Generics xmi:id="_QneC8VJQEeiyW7NaN4qWdw" genericsValue="Change" base_Element="_QneC8FJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QnfREVJQEeiyW7NaN4qWdw" base_Element="_QnfREFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Generics xmi:id="_Qnf4IVJQEeiyW7NaN4qWdw" genericsValue="Change" base_Element="_Qnf4IFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QngfMFJQEeiyW7NaN4qWdw" base_Element="_Qnf4IFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QnhGQ1JQEeiyW7NaN4qWdw" base_Element="_QnhGQlJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QnhtUFJQEeiyW7NaN4qWdw" base_Element="_QnhGRFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QniUYFJQEeiyW7NaN4qWdw" base_Element="_QnhtUVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QniUYlJQEeiyW7NaN4qWdw" base_Element="_QniUYVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QnjigFJQEeiyW7NaN4qWdw" base_Element="_Qni7cFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QnjiglJQEeiyW7NaN4qWdw" base_Element="_QnjigVJQEeiyW7NaN4qWdw">
    <associatedElement xmi:type="uml:Operation" xmi:id="_Qnjig1JQEeiyW7NaN4qWdw" name="getPriority" isAbstract="true">
      <ownedParameter xmi:id="_QnkJkFJQEeiyW7NaN4qWdw" direction="return">
        <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
      </ownedParameter>
    </associatedElement>
  </UMLLabProfile:LegacyStyledElement>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QnkJklJQEeiyW7NaN4qWdw" base_Element="_QnkJkVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QnkwoVJQEeiyW7NaN4qWdw" base_Element="_QnkwoFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Qnkwo1JQEeiyW7NaN4qWdw" base_Element="_QnkwolJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QnlXsFJQEeiyW7NaN4qWdw" base_Element="_QnkwpFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Qnl-wFJQEeiyW7NaN4qWdw" base_Element="_QnlXsVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Qnl-wlJQEeiyW7NaN4qWdw" base_Element="_Qnl-wVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Qnml0FJQEeiyW7NaN4qWdw" base_Element="_Qnl-w1JQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QnnM4FJQEeiyW7NaN4qWdw" base_Element="_Qnml0VJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QnnM4lJQEeiyW7NaN4qWdw" base_Element="_QnnM4VJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Qnnz8VJQEeiyW7NaN4qWdw" base_Element="_Qnnz8FJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QnobAVJQEeiyW7NaN4qWdw" base_Element="_QnobAFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QnpCEVJQEeiyW7NaN4qWdw" base_Element="_QnpCEFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Array xmi:id="_QnppIlJQEeiyW7NaN4qWdw" base_Element="_QnppIFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QnqQMFJQEeiyW7NaN4qWdw" base_Element="_QnppIFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QnqQMlJQEeiyW7NaN4qWdw" base_Element="_QnqQMVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Qnq3QVJQEeiyW7NaN4qWdw" base_Element="_Qnq3QFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QnreUVJQEeiyW7NaN4qWdw" base_Element="_QnreUFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Generics xmi:id="_QnsFYFJQEeiyW7NaN4qWdw" genericsValue="? extends FreeColGameObject" base_Element="_QnreUlJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QnsscFJQEeiyW7NaN4qWdw" base_Element="_QnreUlJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QnssclJQEeiyW7NaN4qWdw" base_Element="_QnsscVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QntTgVJQEeiyW7NaN4qWdw" base_Element="_QntTgFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QnuhoFJQEeiyW7NaN4qWdw" base_Element="_QntTglJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QnuholJQEeiyW7NaN4qWdw" base_Element="_QnuhoVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QnvIsVJQEeiyW7NaN4qWdw" base_Element="_QnvIsFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QnvvwVJQEeiyW7NaN4qWdw" base_Element="_QnvvwFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Qnvvw1JQEeiyW7NaN4qWdw" base_Element="_QnvvwlJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QnwW0FJQEeiyW7NaN4qWdw" base_Element="_QnvvxFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_QnwW0lJQEeiyW7NaN4qWdw" base_Element="_QnwW0VJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Array xmi:id="_Qnw94lJQEeiyW7NaN4qWdw" base_Element="_Qnw94FJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Qnw941JQEeiyW7NaN4qWdw" base_Element="_Qnw94FJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:LegacyStyledElement xmi:id="_Qn12YFJQEeiyW7NaN4qWdw" base_Element="_Qn1PUlJQEeiyW7NaN4qWdw"/>
  <uml:OpaqueBehavior xmi:id="_QoGVEFJQEeiyW7NaN4qWdw" name="ChangePriority" specification="_P6F_kFJQEeiyW7NaN4qWdw">
    <ownedParameter xmi:id="_QoG8IFJQEeiyW7NaN4qWdw" name="level">
      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
    </ownedParameter>
    <ownedParameter xmi:id="_QoG8IVJQEeiyW7NaN4qWdw" type="_P6EKYFJQEeiyW7NaN4qWdw" direction="return"/>
    <language>java</language>
    <body>this.level = level;&#xD;
     </body>
  </uml:OpaqueBehavior>
  <uml:OpaqueBehavior xmi:id="_QoHjMFJQEeiyW7NaN4qWdw" name="getPriority" specification="_P6GmoFJQEeiyW7NaN4qWdw">
    <ownedParameter xmi:id="_QoHjMVJQEeiyW7NaN4qWdw" direction="return">
      <type xmi:type="uml:PrimitiveType" href="pathmap://UML_LIBRARIES/JavaPrimitiveTypes.library.uml#int"/>
    </ownedParameter>
    <language>java</language>
    <body>return level;&#xD;
     </body>
  </uml:OpaqueBehavior>
  <UMLLabProfile:Reference xmi:id="_Qov1UFJQEeiyW7NaN4qWdw" base_Element="_QovOQFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QowcYFJQEeiyW7NaN4qWdw" base_Element="_Qov1UVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QoxDcFJQEeiyW7NaN4qWdw" base_Element="_QowcYVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QoxDc1JQEeiyW7NaN4qWdw" base_Element="_QoxDcVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QoxqglJQEeiyW7NaN4qWdw" base_Element="_QoxqgFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QoxqhVJQEeiyW7NaN4qWdw" base_Element="_Qoxqg1JQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QoyRkFJQEeiyW7NaN4qWdw" base_Element="_QoxqhlJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qoy4oFJQEeiyW7NaN4qWdw" base_Element="_QoyRkVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qoy4o1JQEeiyW7NaN4qWdw" base_Element="_Qoy4oVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QozfslJQEeiyW7NaN4qWdw" base_Element="_QozfsFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_QozftVJQEeiyW7NaN4qWdw" base_Element="_Qozfs1JQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qo0GwlJQEeiyW7NaN4qWdw" base_Element="_Qo0GwFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qo0t0FJQEeiyW7NaN4qWdw" base_Element="_Qo0Gw1JQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qo0t01JQEeiyW7NaN4qWdw" base_Element="_Qo0t0VJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qo1U4FJQEeiyW7NaN4qWdw" base_Element="_Qo0t1FJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qo1U41JQEeiyW7NaN4qWdw" base_Element="_Qo1U4VJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qo178FJQEeiyW7NaN4qWdw" base_Element="_Qo1U5FJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qo1781JQEeiyW7NaN4qWdw" base_Element="_Qo178VJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qo2jAlJQEeiyW7NaN4qWdw" base_Element="_Qo2jAFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qo2jBVJQEeiyW7NaN4qWdw" base_Element="_Qo2jA1JQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qo3KEFJQEeiyW7NaN4qWdw" base_Element="_Qo2jBlJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qo3KE1JQEeiyW7NaN4qWdw" base_Element="_Qo3KEVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qo3xIFJQEeiyW7NaN4qWdw" base_Element="_Qo3KFFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qo3xI1JQEeiyW7NaN4qWdw" base_Element="_Qo3xIVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qo4YMFJQEeiyW7NaN4qWdw" base_Element="_Qo3xJFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qo4YM1JQEeiyW7NaN4qWdw" base_Element="_Qo4YMVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qo4_QFJQEeiyW7NaN4qWdw" base_Element="_Qo4YNFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qo5mUFJQEeiyW7NaN4qWdw" base_Element="_Qo4_QVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qo5mU1JQEeiyW7NaN4qWdw" base_Element="_Qo5mUVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qo6NYFJQEeiyW7NaN4qWdw" base_Element="_Qo5mVFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qo60cFJQEeiyW7NaN4qWdw" base_Element="_Qo6NYVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qo60c1JQEeiyW7NaN4qWdw" base_Element="_Qo60cVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qo7bgFJQEeiyW7NaN4qWdw" base_Element="_Qo60dFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qo7bg1JQEeiyW7NaN4qWdw" base_Element="_Qo7bgVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qo8CkFJQEeiyW7NaN4qWdw" base_Element="_Qo7bhFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qo8poFJQEeiyW7NaN4qWdw" base_Element="_Qo8CkVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qo8po1JQEeiyW7NaN4qWdw" base_Element="_Qo8poVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qo9QsFJQEeiyW7NaN4qWdw" base_Element="_Qo8ppFJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Reference xmi:id="_Qo9Qs1JQEeiyW7NaN4qWdw" base_Element="_Qo9QsVJQEeiyW7NaN4qWdw"/>
  <UMLLabProfile:Patch xmi:id="_R0oZoFJQEeiyW7NaN4qWdw" base_Element="_P5I9UFJQEeiyW7NaN4qWdw" patchText="@@ -16884,24 +16884,27 @@&#xA; age);%0D%0A    %7D&#xA;+;%0D%0A&#xA; %0D%0A    privat&#xA;@@ -17940,24 +17940,67 @@&#xA;     %7D%0D%0A    %7D&#xA;+;%0D%0A%0D%0A    // A service to run the futures.%0D%0A&#xA;     private &#xA;" conflicting="false"/>
  <UMLLabProfile:Patch xmi:id="_R0t5MFJQEeiyW7NaN4qWdw" base_Element="_P6C8QFJQEeiyW7NaN4qWdw" patchText="@@ -7407,45 +7407,8 @@&#xA; */%0D%0A&#xA;-        private final int priority;%0D%0A&#xA;     &#xA;@@ -45456,32 +45456,69 @@&#xA; tends Change %7B%0D%0A&#xA;+        private final int priority;%0D%0A&#xA;         private &#xA;" conflicting="false"/>
</xmi:XMI>
